System.register("chunks:///_virtual/AAModelLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts"],(function(o){"use strict";var t,n,e,r;return{setters:[function(o){t=o.inheritsLoose},function(o){n=o.cclegacy,e=o._decorator},function(o){r=o.BaseLayer}],execute:function(){var c;n._RF.push({},"9a6458D4U5M1pdY0YQYdSP8","AAModelLayer",void 0);var i=e.ccclass;e.property,o("ModelLayer",i("ModelLayer")(c=function(o){function n(){return o.apply(this,arguments)||this}t(n,o);var e=n.prototype;return e.onLoad=function(){o.prototype.onLoad.call(this)},e.onEnable=function(){o.prototype.onEnable.call(this)},e.onDisable=function(){o.prototype.onDisable.call(this)},e.onDestroy=function(){o.prototype.onDestroy.call(this)},e.initUI=function(){},e.processEvent=function(o,t){},e.onButtonClick=function(o,t){},n}(r))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/AnimationCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){"use strict";var t,i,e,o,s,a,l,p;return{setters:[function(n){t=n.inheritsLoose,i=n.asyncToGenerator,e=n.regeneratorRuntime},function(n){o=n.cclegacy,s=n._decorator,a=n.sp,l=n.Animation,p=n.Component}],execute:function(){var r;o._RF.push({},"517fcBVlr9DKIQaityUmdFx","AnimationCtrl",void 0);var m=s.ccclass;s.property,n("AnimationCtrl",m("AnimationCtrl")(r=function(n){function o(){for(var t,i=arguments.length,e=new Array(i),o=0;o<i;o++)e[o]=arguments[o];return(t=n.call.apply(n,[this].concat(e))||this).spineSkeleton=void 0,t.animationComponent=void 0,t.lastAni=void 0,t.lastLoop=void 0,t.animationEndCallback=void 0,t}t(o,n);var s=o.prototype;return s.onLoad=function(){this.spineSkeleton||(this.spineSkeleton=this.getComponent(a.Skeleton)),this.spineSkeleton||(this.spineSkeleton=this.getComponentInChildren(a.Skeleton)),this.spineSkeleton||(this.animationComponent=this.getComponent(l)),this.animationComponent||(this.animationComponent=this.getComponentInChildren(l)),this.animationComponent&&this.animationComponent.on(l.EventType.FINISHED,this.animationFinished,this)},s.setSpineSkeletonNode=function(n){this.spineSkeleton=n.getComponent(a.Skeleton)},s.setAnimationNode=function(n){this.animationComponent=n.getComponent(l)},s.pauseAnimation=function(){this.spineSkeleton&&(this.spineSkeleton.paused=!0)},s.resumeAnimation=function(){this.spineSkeleton&&(this.spineSkeleton.paused=!1)},s.animationFinished=function(n,t){n==l.EventType.FINISHED&&this.animationEndCallback&&this.animationEndCallback(t.name)},s.playAnimation=function(n,t,i){if(void 0===t&&(t=!0),n)return this.spineSkeleton?(this.spineSkeleton.loop=t,this.spineSkeleton.setAnimation(0,n,t),void(i?this.spineSkeleton.setCompleteListener((function(){i(n)})):this.spineSkeleton.setCompleteListener(null))):this.animationComponent?(this.animationEndCallback=i,void this.animationComponent.play(n)):void 0},s.playAnimationOnce=function(){var n=i(e().mark((function n(t,i){var o=this;return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,e){if(!t)return n(),void(i&&i());o.spineSkeleton&&(null==o.lastAni&&(o.lastAni=o.spineSkeleton.animation),null==o.lastLoop&&(o.lastLoop=o.spineSkeleton.loop)),o.playAnimation(t,!1,(function(){o.spineSkeleton&&(o.playAnimation(o.lastAni,o.lastLoop),o.lastAni=void 0,o.lastLoop=void 0),n(),i&&i()}))})));case 1:case"end":return n.stop()}}),n)})));return function(t,i){return n.apply(this,arguments)}}(),o}(p))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/AnimationTrack.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts"],(function(t){"use strict";var i,a,o,n,e,s,r,c,h,l,d;return{setters:[function(t){i=t.inheritsLoose},function(t){a=t.cclegacy,o=t._decorator,n=t.Tween,e=t.Vec2,s=t.tween,r=t.v3,c=t.Component},function(t){h=t.cocosUtil},function(t){l=t.utilTools},function(t){d=t.mapModel}],execute:function(){var u;a._RF.push({},"1aaeck613xITIbUbbtA/wml","AnimationTrack",void 0);var v=o.ccclass;o.property,t("AnimationTrack",v("AnimationTrack")(u=function(t){function a(){for(var i,a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).duration=.6,i.time=0,i.g=-2e3,i.v=800,i.vx=0,i.vy=0,i.endY=0,i.aniFlag=0,i.targetPos=void 0,i.endCallback=void 0,i}i(a,t);var o=a.prototype;return o.startShowThrow=function(t){this.endCallback=t,this.aniFlag=1,n.stopAllByTarget(this.node);var i=l.getFloatValue(l.angleToRadian(75),l.angleToRadian(85));Math.random()>.5&&(i=Math.PI-i),this.v=800+200*Math.random(),this.vx=this.v*Math.cos(i),this.vy=this.v*Math.sin(i),this.endY=this.node.position.y-20-50*Math.random()},o.startBeiSaiEr=function(){this.aniFlag=2,this.targetPos=h.convertToWorldSpace(d.mapLayer.coinIconNode)},o.moveTargetUpdate=function(t){var i=h.convertToNodeSpace(this.node,this.targetPos),a=d.player.node.position;i.x+=a.x,i.y+=a.y;var o=this.node.getPosition();if(e.distance(o,i)<=20)this.endCallback&&this.endCallback();else{var n=i.subtract(o).normalize(),s=1500*t;n.multiplyScalar(s),o.add(n),this.node.position=o}},o.showThrowUpdate=function(t){var i=this,a=this.node.getPosition();if(a.x+=this.vx*t,a.y+=this.vy*t,this.vy+=this.g*t,this.node.setPosition(a),a.y<=this.endY){this.aniFlag=0;var o=15;this.vx<0&&(o=-o),s(this.node).by(.1,{position:r(o,40)},{easing:"quadOut"}).by(.1,{position:r(o,-40)},{easing:"quadIn"}).delay(.5+.3*Math.random()).call((function(){i.startBeiSaiEr()})).start()}},o.update=function(t){switch(this.aniFlag){case 1:this.showThrowUpdate(t);break;case 2:this.moveTargetUpdate(t)}},a}(c))||u);a._RF.pop()}}}));

System.register("chunks:///_virtual/audioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./constants.ts","./resManager.ts"],(function(e){"use strict";var u,i,t,n,o,s,c,r;return{setters:[function(e){u=e.createClass,i=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){n=e.cclegacy,o=e.AudioClip},function(e){s=e.myLog},function(e){c=e.constants},function(e){r=e.resManager}],execute:function(){n._RF.push({},"2976bjwcONEkaYppxD7Xhz0","audioManager",void 0);var a=function(){function e(){this.musicAudioSource=void 0,this.effectAudioSource=void 0,this.audioClips={},this.musicVolume=1,this.effectVolume=1,this.musicName=""}var n=e.prototype;return n.setMusicAudioSource=function(e){this.musicAudioSource=e},n.setEffectAudioSource=function(e){this.effectAudioSource=e},n.initData=function(e){e||(e={}),null!=e.musicVolume&&(this.musicVolume=e.musicVolume),null!=e.effectVolume&&(this.effectVolume=e.effectVolume)},n.getSaveData=function(e){var u={};return u.musicVolume=this.musicVolume,u.effectVolume=this.effectVolume,u},n.loadAllAudio=function(e,u){var i=this;r.loadAssetByBundleDir(c.bundles.audio,"",o,(function(u,i){u>.96&&(u=.96),e&&e(u)}),(function(e){for(var t in e){var n=e[t],o=n.name;o&&(i.audioClips[o]=n)}u&&u()}))},n.loadAudios=function(e,u,i){var t=this;r.loadAssetByPathArr(c.bundles.audio,e,o,(function(e){e>.96&&(e=.96),u&&u(e)}),(function(e){for(var u in e){var n=e[u],o=n.name;o&&(t.audioClips[o]=n)}i&&i()}))},n.loadAudio=function(e,u){var i=this;r.loadAsset(c.bundles.audio,e,o,null,(function(e,t){e?u&&u():(i.audioClips[t.name]=t,u&&u(t))}))},n.getMusiceVolume=function(){return this.musicVolume},n.setMusicVolume=function(e){e=Math.round(1e3*e)/1e3,this.musicVolume=e,this.musicAudioSource.volume=e,e<=0?this.musicAudioSource.pause():this.playMusic(this.musicName)},n.playMusic=function(){var e=i(t().mark((function e(u){var i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return");case 2:if(this.musicName=u,!(this.musicVolume<=0)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.getAudioClip(u);case 7:if(i=e.sent){e.next=10;break}return e.abrupt("return");case 10:if(!this.musicAudioSource.playing){e.next=14;break}if(this.musicAudioSource.clip!=i){e.next=13;break}return e.abrupt("return");case 13:this.musicAudioSource.stop();case 14:this.musicAudioSource.clip=i,this.musicAudioSource.loop=!0,this.musicAudioSource.play();case 17:case"end":return e.stop()}}),e,this)})));return function(u){return e.apply(this,arguments)}}(),n.gameOnShow=function(e){void 0===e&&(e=!1),!this.musicAudioSource||this.musicVolume<=0||(s.i("===========gameOnShow:",this.musicAudioSource.playing,this.musicAudioSource.state),this.musicAudioSource.playing&&!e||(s.i("=======call playing"),this.musicAudioSource.play()))},n.getEffectVolume=function(){return this.effectVolume},n.setEffectVolume=function(e){e=Math.round(1e3*e)/1e3,this.effectVolume=e,this.effectAudioSource.volume=e},n.playEffect=function(){var e=i(t().mark((function e(u){var i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u&&!(this.effectVolume<=0)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getAudioClip(u);case 4:if(i=e.sent){e.next=7;break}return e.abrupt("return");case 7:this.effectAudioSource.playOneShot(i);case 8:case"end":return e.stop()}}),e,this)})));return function(u){return e.apply(this,arguments)}}(),n.getAudioClip=function(e){var u=this;return new Promise((function(i){var t=u.audioClips[e];t?i(t):u.loadAudio(e,(function(e){i(e)}))}))},u(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();a._instance=void 0;e("audioManager",a.instance);n._RF.pop()}}}));

System.register("chunks:///_virtual/AwardInfoLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts","./constants.ts"],(function(t){"use strict";var e,n,o,r,i,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,r=t.find},function(t){i=t.BaseLayer},function(t){a=t.constants}],execute:function(){var s;n._RF.push({},"24d91kKegVDn5us4NfnRGDS","AwardInfoLayer",void 0);var c=o.ccclass;o.property,t("AwardInfoLayer",c("AwardInfoLayer")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var o=n.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this)},o.onEnable=function(){t.prototype.onEnable.call(this)},o.onDisable=function(){t.prototype.onDisable.call(this)},o.onDestroy=function(){t.prototype.onDestroy.call(this)},o.initUI=function(){this.setItemLayer(this.getNodeByPath("ui/itemLayer"),this.layerData.awardArr,this.refreshAwardItem.bind(this)),this.getNodeByPath("ui/titleLabel").localize("text",a.layers.AwardInfoLayer),this.getNodeByPath("ui/btnSure/text").localize("btnSure",a.catName.common)},o.refreshAwardItem=function(t,e){this.setPropItem(e[0],r("icon",t),e[1],r("bg",t),r("num",t))},o.processEvent=function(t,e){},o.onButtonClick=function(t,e){},o.onClickBtnSure=function(){this.closeLayer()},o.onClickBg=function(){this.closeLayer()},n}(i))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/BackHomeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./msgac.ts","./serverMsg.ts","./BaseLayer.ts","./constants.ts"],(function(t){"use strict";var e,o,n,i,a,c,s,r;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator},function(t){i=t.cocosUtil},function(t){a=t.msgac},function(t){c=t.serverMsg},function(t){s=t.BaseLayer},function(t){r=t.constants}],execute:function(){var l;o._RF.push({},"c7122ITL3dBxJTT4wZtwJfh","BackHomeLayer",void 0);var u=n.ccclass;n.property,t("BackHomeLayer",u("BackHomeLayer")(l=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).uiNode=void 0,e}e(o,t);var n=o.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),this.uiNode=this.getNodeByPath("ui"),this.isShowBannerAd=!0},n.onEnable=function(){t.prototype.onEnable.call(this)},n.onDisable=function(){t.prototype.onDisable.call(this)},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.initUI=function(){i.tweenScaleIn2(this.uiNode),this.getNodeByPath("ui/info").localize("info",r.layers.BackHomeLayer),this.getNodeByPath("ui/titleLabel").localize("title",r.layers.BackHomeLayer),this.getNodeByPath("ui/btns/btnExit/exitLabel").localize("exit",r.layers.BackHomeLayer),this.getNodeByPath("ui/btns/btnGoOn/goOnLabel").localize("goOn",r.layers.BackHomeLayer)},n.onButtonClick=function(t,e){},n.onClickBtnGoOn=function(){this.closeLayer()},n.onClickBtnExit=function(){this.closeLayer(),c.send(a.mapLeave)},o}(s))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/BackLifeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./tyqAdManager.ts","./cocosUtil.ts","./designManager.ts","./mapModel.ts","./UserData.ts","./BaseLayer.ts","./localization.ts","./constants.ts"],(function(e){"use strict";var t,n,i,o,a,c,s,l,r,f,u,d,m,h,y,L;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e._decorator,o=e.tween,a=e.v3,c=e.Color},function(e){s=e.sdkManager},function(e){l=e.tyqAdManager,r=e.Channel},function(e){f=e.cocosUtil},function(e){u=e.designManager},function(e){d=e.mapModel},function(e){m=e.UserData},function(e){h=e.BaseLayer},function(e){y=e.localizeManager},function(e){L=e.constants}],execute:function(){var g;n._RF.push({},"c3674+8/wVPk67jTPRnM3jt","BackLifeLayer",void 0);var p=i.ccclass;i.property,e("BackLifeLayer",p("BackLifeLayer")(g=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).timeNode=void 0,t.time=9,t.diamondNumNode=void 0,t}t(n,e);var i=n.prototype;return i.onLoad=function(){e.prototype.onLoad.call(this),this.timeNode=this.getNodeByPath("ui/time/time"),this.diamondNumNode=this.getNodeByPath("ui/btns/btnDiamond/info/num"),this.isShowBannerAd=!0},i.onEnable=function(){e.prototype.onEnable.call(this),m.getInstance().mapData=null},i.onDisable=function(){e.prototype.onDisable.call(this)},i.onDestroy=function(){e.prototype.onDestroy.call(this)},i.initUI=function(){var e=this;if(u.config.backLifeCount>0&&d.mapSystem.backlifeCount>=u.config.backLifeCount)return d.mapSystem.doSettlement(!1),void this.closeLayer();o(this.timeNode).delay(.2).to(.6,{scale:a(1.3,1.3,1)}).call((function(){e.time--,e.time<0&&(e.time=0,l.getChannel()==r.H5_4399&&e.onClickBtnClose()),e.setString(e.timeNode,e.time)})).to(.6,{scale:a(1,1,1)}).union().repeat(10).start(),this.setString(this.diamondNumNode,"x"+u.config.backLifeDiamond),m.getInstance().baoshi<u.config.backLifeDiamond?f.setRenderableColor(this.diamondNumNode,c.RED):f.setRenderableColor(this.diamondNumNode,c.WHITE),this.getNodeByPath("ui/btns/btnAd/freeReviveLabel").localize("btnFreeRevive",L.layers.BackLifeLayer),this.getNodeByPath("ui/info").localize("info",L.layers.BackLifeLayer),this.getNodeByPath("ui/title").localizeAnim()},i.processEvent=function(e,t){},i.onButtonClick=function(e,t){},i.roleBackLife=function(){d.mapSystem.backlifeCount++,d.player.backLife(),this.closeLayer()},i.onClickBtnClose=function(){d.mapSystem.doSettlement(!1),this.closeLayer()},i.onClickBtnAd=function(){var e=this;s.openAd("复活",(function(t){1==t&&e.roleBackLife()}))},i.onClickBtnDiamond=function(){m.getInstance().baoshi<u.config.backLifeDiamond?this.createNotice(y._localize(null,"lackDiamond",L.layers.BackLifeLayer)):(m.getInstance().useBaoShi(-u.config.backLifeDiamond,!0),this.roleBackLife())},n}(h))||g);n._RF.pop()}}}));

System.register("chunks:///_virtual/BackMaplLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UserData.ts","./BaseLayer.ts","./constants.ts"],(function(t){"use strict";var e,a,n,o,i,s;return{setters:[function(t){e=t.inheritsLoose},function(t){a=t.cclegacy,n=t._decorator},function(t){o=t.UserData},function(t){i=t.BaseLayer},function(t){s=t.constants}],execute:function(){var c;a._RF.push({},"d7f58XJjSFF0Yg9arSRiiWI","BackMaplLayer",void 0);var r=n.ccclass;n.property,t("BackMapLayer",r("BackMapLayer")(c=function(t){function a(){return t.apply(this,arguments)||this}e(a,t);var n=a.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),this.isShowBannerAd=!0},n.onEnable=function(){t.prototype.onEnable.call(this)},n.onDisable=function(){t.prototype.onDisable.call(this)},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.initUI=function(){this.getNodeByPath("ui/titleLabel").localize("title",s.layers.BackMapLayer),this.getNodeByPath("ui/info").localize("info",s.layers.BackMapLayer),this.getNodeByPath("ui/btns/btnClose/closeLabel").localize("btnCancel",s.layers.BackMapLayer),this.getNodeByPath("ui/btns/btnSure/sureLabel").localize("btnSure",s.layers.BackMapLayer)},n.processEvent=function(t,e){},n.onButtonClick=function(t,e){},n.onClickBtnClose=function(){o.getInstance().mapData=null,this.closeLayer()},n.onClickBtnSure=function(){var t=o.getInstance().mapData.mapModel.mapId;this.layerCb(t),this.closeLayer()},a}(i))||c);a._RF.pop()}}}));

System.register("chunks:///_virtual/BaseLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./tyqSDK.ts","./cocosUtil.ts","./constants.ts","./localText.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./layerManager.ts","./resManager.ts","./playerModel.ts","./UserData.ts","./ItemLayer.ts","./ScrollViewUtil.ts"],(function(e){"use strict";var t,n,o,i,r,a,s,l,c,d,h,u,f,p,g,v,m,L,y,C,I,S,B,b,A,T,w,N,R,P,V,D;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e.view,i=e.ResolutionPolicy,r=e.find,a=e.Widget,s=e.v3,l=e.Button,c=e.Node,d=e.ScrollView,h=e.sp,u=e.ProgressBar,f=e.Label,p=e.RichText,g=e.Sprite,v=e.Component},function(e){m=e.myLog},function(e){L=e.tyqSDK},function(e){y=e.cocosUtil},function(e){C=e.constants},function(e){I=e.localText},function(e){S=e.msgac},function(e){B=e.audioManager},function(e){b=e.designManager},function(e){A=e.eventManager},function(e){T=e.layerManager},function(e){w=e.resManager,N=e.ResLoader},function(e){R=e.playerModel},function(e){P=e.UserData},function(e){V=e.ItemLayer},function(e){D=e.ScrollViewUtil}],execute:function(){n._RF.push({},"2672bmyPkFNdbrkVilq/shn","BaseLayer",void 0);e("BaseLayer",function(e){function n(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(t=e.call.apply(e,[this].concat(o))||this).layerName="DefaultLayer",t.layerData={},t.layerCb=null,t.layerId=-1,t.pathNodeObj=new Map,t.resLoader=new N,t.autoReleaseAsset=!1,t.preLoadAssetConfigArr=void 0,t.eventArr=void 0,t.openUpdateSecond=!1,t.updateSecondInterval=void 0,t.openAllBtnInteractive=!0,t.openBtnLongPress=!1,t.btnLongTrigTime=.5,t.btnLognTrigTimeCount=0,t.btnLongTrigCount=0,t.btnLongNode=null,t.isShowBannerAd=!1,t}t(n,e);var v=n.prototype;return v.onLoad=function(){this.addPathNode(this.node,"")},v.DesignResolutionHeight=function(){o.setDesignResolutionSize(720,1660,i.FIXED_HEIGHT),m.i("-----ResolutionPolicy.FIXED_HEIGHT")},v.chooseDesignResolution=function(){var e=o.getVisibleSize();e.width/e.height>.5625?(o.setDesignResolutionSize(720,1280,i.FIXED_HEIGHT),m.i("choose  ResolutionPolicy.FIXED_HEIGHT")):(m.i("choose  ResolutionPolicy.FIXED_WIDTH"),o.setDesignResolutionSize(720,1280,i.FIXED_WIDTH))},v.onEnable=function(){var e=this;this.addButtonListener(this.node),this.initUI(),this.refreshRedPoint(),this.openUpdateSecond&&(this.updateSecondInterval&&clearInterval(this.updateSecondInterval),this.updateSecondInterval=setInterval((function(){e.updateSecond()}),1e3),this.updateSecond()),this.isShowBannerAd&&!R.isRecordAd&&L.showBannerAd(),A.on(S.refreshRedPoint,this.refreshRedPoint,this),A.on(S.refreshLocalization,this.refreshLocalization,this),A.on(S.refreshDebugPannel,this.refreshDebugPannel,this),A.on(S.refreshMapFightWindow,this.refreshMapFightWindow,this),A.send(S.refreshLocalization)},v.updateSecond=function(){},v.refreshRedPoint=function(){},v.refreshLocalization=function(){},v.refreshDebugPannel=function(){},v.refreshMapFightWindow=function(){},v.initUI=function(){},v.onDisable=function(){this.removeEventArr(this.eventArr),A.off(S.refreshRedPoint,this.refreshRedPoint,this),A.off(S.refreshLocalization,this.refreshLocalization,this),this.updateSecondInterval&&(clearInterval(this.updateSecondInterval),this.updateSecondInterval=void 0),this.isShowBannerAd&&L.hideBannerAd()},v.onDestroy=function(){switch(this.layerName){case C.layers.HomeLayer:return}this.autoReleaseAsset&&this.resLoader.releaseAllAsset()},v.addPathNode=function(e,t){e!=this.node&&this.pathNodeObj.set(t,e),t&&(t+="/");for(var n=e.children,o=0,i=n.length;o<i;o++){var r=n[o];this.addPathNode(r,t+r.name)}},v.getNodeByPath=function(e){var t=this.pathNodeObj.get(e);return t||((t=r(e,this.node))?(this.pathNodeObj.set(e,t),t):null)},v.screenAdapterBG=function(e){if(y.isValid(e)){var t=e.getComponent(a);t&&(t.enabled=!1);var n=y.getScreenBgAdapterScale(),o=e.getScale().x,i=e.getScale().y;e.setScale(s(o*n,i*n,1))}},v.screenAdapterUI=function(e){if(y.isValid(e)){var t=y.getScreenAdapterScale(),n=e.getScale().x,o=e.getScale().y;e.setScale(s(n*t,o*t,1))}},v.addButtonListener=function(e){(e.getComponent(l)&&(e.on("click",this.preOnButtonClick,this),this.openBtnLongPress&&(e.on(c.EventType.TOUCH_START,this.preOnButtonTouchStart,this),e.on(c.EventType.TOUCH_MOVE,this.preOnButtonTouchMove,this),e.on(c.EventType.TOUCH_END,this.preOnButtonTouchEnd,this),e.on(c.EventType.TOUCH_CANCEL,this.preOnButtonTouchCancel,this))),e.getComponent(d))&&(-1!=e.name.indexOf("NoUtil")||e.getComponent(D)||e.addComponent(D));for(var t=e.children,n=0,o=t.length;n<o;n++){var i=t[n];this.addButtonListener(i)}},v.preOnButtonClick=function(e){if(this.openAllBtnInteractive)if(this.openBtnLongPress&&this.btnLongTrigCount>0)this.btnLongTrigCount=0;else{var t=e.node,n=t.name;if(m.i(this.layerName+" onButtonClick "+n),this.onButtonClick&&this.onButtonClick(t,t.name),n.length>=2){var o=n.substring(0,1),i=n.substring(1,n.length),r="onClick"+o.toLocaleUpperCase()+i;this[r]&&this[r](t)}t.hasPlayAudio}},v.preOnButtonLongClick=function(e){if(this.openAllBtnInteractive){var t=e.name;if(m.i(this.layerName+" onButtonLongClick "+t),this.onButtonLongClick)return this.onButtonLongClick(e,t);if(t.length>=2){var n=t.substring(0,1),o=t.substring(1,t.length),i="onLongClick"+n.toLocaleUpperCase()+o;if(this[i])return this[i](e)}return!1}},v.preOnButtonTouchStart=function(e){var t=e.target;e.touch;this.btnLongNode=t,this.btnLognTrigTimeCount=0,this.btnLongTrigCount=0},v.preOnButtonTouchMove=function(e){},v.preOnButtonTouchEnd=function(e){this.btnLongNode=null},v.preOnButtonTouchCancel=function(e){this.btnLongNode=null},v.openPropInfoLayer2=function(e,t){void 0===t&&(t=void 0),null==t&&(t=P.getInstance().getPropNumById(e));var n={id:e,num:t};this.openLayer(C.layers.PropInfoLayer2,n)},v.isShowingLayer=function(e){return T.isShowingLayer(e)},v.showHintLayer=function(e,t){var n=r("Canvas/hintLayer");n.active=!0,n.cb=t,this.setString(r("ui/hint",n),e)},v.hideHintLayer=function(){var e=r("Canvas/hintLayer");e.active=!1,e.cb&&e.cb()},v.openMsgBoxLayer=function(e){var t={hint:e};this.openLayer(C.layers.MsgBoxLayer,t)},v.openAwardGetLayer=function(e){!e||e.length<=0||this.openLayer(C.layers.RewardLayer,{propArr:e,notMoveAni:!0})},v.openAwardInfoLayer=function(e){!e||e.length<=0||this.openLayer(C.layers.AwardInfoLayer,{awardArr:e})},v.setRoleSkin=function(e,t){void 0===t&&(t=0);var n=P.getInstance().getHeroSkin(t);e.getComponent(h.Skeleton).setSkin(n)},v.playAudioEffect=function(e,t,n){n||(n=0),y.isValid(t)&&(t.hasPlayAudio=!0),this.scheduleOnce((function(){B.playEffect(e),y.isValid(t)&&(t.hasPlayAudio=void 0)}),n)},v.onClickBtnClose=function(e){this.closeLayer()},v.openLayer=function(e,t,n,o){"function"==typeof t&&(n=t,t=null),T.openSingleLayer(e,t,n,(function(e,t){e.autoReleaseAsset&&e.resLoader&&(e.resLoader.addAsset(t),e.preLoadAssetConfigArr&&e.preLoadAssetConfigArr.forEach((function(t){t.asset&&e.resLoader.addAsset(t.asset)}))),o&&o()}))},v.closeLayer=function(e){if(e||(e=this.layerId),e&&-1!=e)return T.closeLayer(e),void A.send(S.refreshMapFightWindow);this.node.destroy(),A.send(S.refreshMapFightWindow)},v.addEventArr=function(e){for(var t in this.eventArr=e,e){var n=e[t];n&&A.on(n,this.preProcessEvent,this)}},v.removeEventArr=function(e){for(var t in e){var n=e[t];n&&A.off(n,this.preProcessEvent,this)}},v.preProcessEvent=function(e){var t=e.ac,n=e.data,o=S.ac2KeyObj[t]+"Ret";this[o]&&this[o].call(this,n),this.processEvent(t,n)},v.processEvent=function(e,t){},v.showLackItem=function(e){var t=b.getRowById(C.tableName.prop,e);t&&this.createNotice(I.lackItemHint.format(t.name))},v.showGetItem=function(e,t){},v.createNotice=function(e){T.createNotice(e)},v.scrollViewSetData=function(e,t,n,o,i){var r=this;void 0===o&&(o=!0),void 0===i&&(i=!1);var a=e.getComponent(D);a&&a.setData(t,(function(e,t,o){n&&n(e,t,o),r.addButtonListener(e)}),o,i)},v.scrollViewAddData=function(e,t,n){void 0===n&&(n=!1);var o=e.getComponent(D);o&&o.pushData(t,n)},v.scrollViewRefreshList=function(e){var t=e.getComponent(D);t&&t.refreshList()},v.scrollViewRefreshItemUI=function(e,t,n){var o=e.getComponent(D);o&&o.refreshIndex(t.index,n)},v.scrollViewRefreshItemUIByIndex=function(e,t,n){var o=e.getComponent(D);o&&o.refreshIndex(t,n)},v.scrollViewRemoveItemUI=function(e,t,n){void 0===n&&(n=!1);var o=e.getComponent(D);o&&o.removeByIndex(t.index,n)},v.scrollViewRemoveItemUIByIndex=function(e,t,n){void 0===n&&(n=!1);var o=e.getComponent(D);o&&o.removeByIndex(t,n)},v.scrollViewScrollToEnd=function(e,t){var n=e.getComponent(D);n&&n.scrollToEnd(t)},v.scrollViewScrollToItemUI=function(e,t,n){this.scrollViewScrollToIndex(e,t.index,n)},v.scrollViewScrollToIndex=function(e,t,n){var o=e.getComponent(D);o&&null!=t&&o.scrollToIndex(t)},v.setProgressBar=function(e,t){e instanceof c&&(e=e.getComponent(u)),e&&(e.progress=t)},v.setNumString=function(e,t){t=y.formatNum(t),this.setString(e,t)},v.setItemLayer=function(e,t,n){y.addComponentOnce(e,V).initUI(this,t,n)},v.setNumItemLayer=function(e,t,n){for(var o=[],i=0;i<t;i++)o.push(i+1);var r=e.getComponent(V);r||(r=e.addComponent(V)),r.initUI(this,o,(function(e,t,o){n&&n(e,t,o)}))},v.setPropItem=function(e,t,n,o,i){void 0===n&&(n=0);var r=b.getRowById(C.tableName.prop,e);r||m.e("setPropItem error id:"+e);var a="prop/"+r.icon;11==r.type&&(a="weapon/"+b.getRowById(C.tableName.weapon,r.weaponid).icon);this.setSpriteFrame2(t,a),o&&this.setSpriteFrame2(o,"prop/propbg"+r.quality),n>0&&i&&this.setString(i,"x"+n)},v.shakeScreen=function(){y.tweenShakeNode(T.getPopLayerParentNode())},v.removeRenderBatch=function(e){var t=e.parent.getComponent(V);t&&t.renderChildBatch&&t.renderChildBatch.removeRootItemNode(e)},v.addRenderBatch=function(e){var t=e.parent.getComponent(V);t&&t.renderChildBatch&&t.renderChildBatch.addRootItemNode(e)},v.setString=function(e,t){if(e){t+="";var n=e.getComponent(f);if(n)n.string=t;else{var o=e.getComponent(p);o&&(o.string=t)}}else m.e("setString error:node is null",t)},v.setSpriteFrame=function(e,t,n,o){var i=this;if(void 0===o&&(o=C.bundles.icon),t&&y.isValid(e)){var r=e.getComponent(g);if(y.isValid(r)){r.enabled=!1,e.loadName=t;var a=o,s=t.split("_")[0]+"/"+t,l=t.split("|");l.length>=2&&(a=l[0],s=l[1]),w.loadSpriteFrame(a,s,(function(o,a){o||y.isValid(e)&&y.isValid(r)&&e.loadName==t&&(i.autoReleaseAsset&&i.resLoader.addAsset(a),r.enabled=!0,r.spriteFrame=a,n&&n())}))}}},v.setSpriteFrame2=function(e,t,n,o){var i=this;if(void 0===o&&(o=C.bundles.icon),t&&y.isValid(e)){var r=e.getComponent(g);if(y.isValid(r)){r.enabled=!1,e.loadName=t;var a=o,s=t;w.loadSpriteFrame(a,s,(function(o,a){o||y.isValid(e)&&y.isValid(r)&&e.loadName==t&&(i.autoReleaseAsset&&i.resLoader.addAsset(a),r.enabled=!0,r.spriteFrame=a,n&&n())}))}}},v.setSpineData=function(e,t,n){var o=this;if(y.isValid(e)){var i=e.getComponent(h.Skeleton);if(y.isValid(i)){i.enabled=!1,e.loadName=t;var r=C.bundles.spine,a=t+"/"+t;w.loadSpineData(r,a,(function(r,a){r||y.isValid(e)&&y.isValid(i)&&e.loadName==t&&(o.autoReleaseAsset&&o.resLoader.addAsset(a),i.enabled=!0,i.skeletonData=a,n&&n(i))}))}}},v.setSpineData2=function(e,t,n,o){var i=this;if(y.isValid(e)){var r=e.getComponent(h.Skeleton);if(y.isValid(r)){r.enabled=!1,e.loadName=n;var a=n;w.loadSpineData(t,a,(function(t,a){t||y.isValid(e)&&y.isValid(r)&&e.loadName==n&&(i.autoReleaseAsset&&i.resLoader.addAsset(a),r.enabled=!0,r.skeletonData=a,o&&o(r))}))}}},v.update=function(e){if(this.openBtnLongPress&&this.btnLongNode&&(this.btnLognTrigTimeCount+=e,this.btnLognTrigTimeCount>=this.btnLongTrigTime)){var t=this.preOnButtonLongClick(this.btnLongNode);this.btnLongTrigCount++,t||(this.btnLongNode=null,this.btnLognTrigTimeCount=0)}},n}(v));n._RF.pop()}}}));

System.register("chunks:///_virtual/BaseUILayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./tyqSDK.ts","./cocosUtil.ts","./constants.ts","./audioManager.ts","./designManager.ts","./layerManager.ts","./resManager.ts","./playerModel.ts","./ScrollViewUtil.ts"],(function(e){"use strict";var t,n,i,o,a,r,s,c,l,d,u,h,p,f,y,g,m,v,w,S,C,L,M,b,D,A;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,s=e.view,c=e.Sprite,l=e.Prefab,d=e.UITransform,u=e.v3,h=e.Button,p=e.Component,f=e.Node,y=e.tween},function(e){g=e.myLog},function(e){m=e.tyqSDK},function(e){v=e.cocosUtil},function(e){w=e.constants},function(e){S=e.audioManager},function(e){C=e.designManager},function(e){L=e.layerManager},function(e){M=e.ResLoader,b=e.resManager},function(e){D=e.playerModel},function(e){A=e.ScrollViewUtil}],execute:function(){var B,I,F;a._RF.push({},"309d0hb9ntM15cYJx7d98Qw","BaseUILayer",void 0);var P=r.ccclass,z=r.property;e("BaseUILayer",P("BaseUILayer")((F=t((I=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).resLoader=new M,t.layerId=-1,t.layerData={},i(t,"isShowBanner",F,o(t)),t}n(t,e);var a=t.prototype;return a.onLoad=function(){},a.onEnable=function(){this.isShowBanner&&!D.isRecordAd&&m.showBannerAd()},a.getScreenScale=function(){var e=s.getVisibleSize(),t=s.getDesignResolutionSize();return e.width/e.height<=.5625?e.width/t.width:e.height/t.height},a.toast=function(e){L.createNotice(e)},a.onDisable=function(){this.isShowBanner&&m.hideBannerAd()},a.onDestroy=function(){},a.setSpriteFrame2=function(e,t,n,i){var o=this;if(void 0===i&&(i=w.bundles.icon),t&&v.isValid(e)){var a=e.getComponent(c);if(v.isValid(a)){a.enabled=!1,e.loadName=t;var r=i,s=t;b.loadSpriteFrame(r,s,(function(i,r){i||v.isValid(e)&&v.isValid(a)&&e.loadName==t&&(o.resLoader.addAsset(r),a.enabled=!0,a.spriteFrame=r,n&&n(a.node))}))}}},a.openLayer=function(e,t,n,i){"function"==typeof t&&(n=t,t=null),L.openSingleLayer(e,t,n,(function(e,t){e.resLoader&&t&&e.resLoader.addAsset(t),i&&i()}))},a.addTopUILayer=function(e){var t=this;b.loadAsset(w.bundles.layer,e,l,null,(function(n,i){if(n)g.e("LayerManager.openLayer error:"+n.message,e,n);else{var o=v.instantiate(i);o.getComponent(e)||o.addComponent(e);o.parent=t.node}}))},a.onClickClose=function(){this.closeLayer()},a.closeLayer=function(e){e||(e=this.layerId),e&&-1!=e?L.closeLayer(e):this.node.destroy()},a.stringToArr=function(e){var t=e.indexOf("["),n=e.indexOf("]");return e.substring(t+1,n).split(",")},a.fitScrollView=function(e,t,n){var i=s.getVisibleSize(),o=s.getDesignResolutionSize(),a=1;a=i.width/i.height<=.5625?i.width/o.width:i.height/o.height,e.getComponent(d).height=Math.min(n,t+(i.height/a/2-640))},a.fitNodeWidget=function(e,t){var n=s.getVisibleSize(),i=s.getDesignResolutionSize(),o=1;o=n.width/n.height<=.5625?n.width/i.width:n.height/i.height,e.position=u(e.position.x,0-n.height/o/2+t,e.position.z),console.log("fitNodeWidget "+e.name,e.position.y)},a.scrollViewSetData=function(e,t,n,i,o){var a=e.getComponent(A);a&&a.setData(t,(function(e,t,o){n&&n(e,t,o,i)}))},a.setImageCustomSize=function(e,t){var n=e.getComponent(d).width,i=e.getComponent(d).height,o=Math.min(t/n,t/i),a=n*o,r=i*o;e.getComponent(d).width=a,e.getComponent(d).height=r},a.addButtonHander=function(e,t,n,i,o){e instanceof h||(e=e.getComponent(h)?e.getComponent(h):e.addComponent(h)),e.transition=h.Transition.SCALE;var a=new p.EventHandler;a.target=t,a.component=n,a.handler=i,a.customEventData=o,e.clickEvents=[a]},a.showGetReward=function(e){var t=this;S.playEffect("coin"),e.forEach((function(e,n){var i=C.getRowById(w.tableName.prop,e.Id),o="prop/"+i.icon;11==i.type&&(o="weapon/"+C.getRowById(w.tableName.weapon,i.weaponid).icon);1==i.type?t.playCoinFlyAnim(8,o,u(0,60,0),u(200,600,0),40):10==i.type?t.playCoinFlyAnim(8,o,u(0,-60,0),u(-300,600,0),40):9==i.type?t.playCoinFlyAnim(8,o,u(0,-60,0),u(50,600,0),40):8==i.type||11==i.type||17==i.type?t.playCoinFlyAnim(e.Num,o,u(0,0,0),u(-150,-600,0),20,100,.02*n):t.playCoinFlyAnim(8,o,u(0,0,0),u(-150,-600,0),20,100,.01*n)}))},a.playCoinFlyAnim=function(e,t,n,i,o,a,r){var s=this;void 0===o&&(o=50),void 0===a&&(a=0),void 0===r&&(r=0),this.getCirclePoints(o,n,e).map((function(e){var o=new f("Sprite");if(o.addComponent(c),a>0){var r=s;s.setSpriteFrame2(o,t,(function(e){r.setImageCustomSize(e,a)}))}else s.setSpriteFrame2(o,t);return o.layer=s.node.layer,s.node.addChild(o),o.setPosition(e.x,e.y,0),o.scale=u(0,0,0),y(o).to(.2,{scale:u(1.2,1.2,1.2)}).to(.2,{scale:u(1,1,1)}).union().repeatForever().start(),{node:o,startPos:n,midPos:e,endPos:i,dis:s.calcDistance(e,i)}})).forEach((function(e,t){y(e.node).to(.15,{position:u(e.midPos.x,e.midPos.y,0)}).delay(.05*t+.5+r).to(.35,{position:u(e.endPos.x,e.endPos.y,0)}).call((function(){e.node.destroy()})).union().start()}))},a.getCirclePoints=function(e,t,n,i){void 0===i&&(i=50);for(var o=[],a=0;a<n;a++){var r=Math.PI/180*Math.round(360/n),s=t.x+e*Math.sin(r*a),c=t.y+e*Math.cos(r*a);o.unshift(u(s+Math.random()*i,c+Math.random()*i,0))}return o},a.calcDistance=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.pow(n*n+i*i,.5)},t}(p)).prototype,"isShowBanner",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=I))||B);a._RF.pop()}}}));

System.register("chunks:///_virtual/beHaviorComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./wechat.ts","./tyqAdManager.ts","./tyqSDKConfig.ts"],(function(t){"use strict";var e,r,i,o,n,a,s,l,c,h,u,p,g,f,y,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){n=t.cclegacy,a=t._decorator,s=t.Node,l=t.SpriteFrame,c=t.Sprite,h=t.assetManager,u=t.Component,p=t.Texture2D},function(t){g=t.Wechat},function(t){f=t.tyqAdManager,y=t.Channel},function(t){v=t.tyqSDKConfig}],execute:function(){var C,d,S,m,b,B,A,H,w;n._RF.push({},"06ca9tRK/tHx7wBwgTDyozz","beHaviorComponent",void 0);var T=a.ccclass,_=a.property;t("beHaviorComponent",(C=T("beHaviorComponent"),d=_({type:s}),S=_({tooltip:"广告业务1：系统分配，0：自定义"}),m=_({tooltip:"强制0：广告，1分享，strategy == 1时才生效"}),C((A=e((B=function(t){function e(){for(var e,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,i(e,"icon",A,o(e)),i(e,"strategy",H,o(e)),i(e,"currentShow",w,o(e)),e.isClick=!1,e}r(e,t);var n=e.prototype;return n.onEnable=function(){},n.start=function(){var t=this;if(!v.isOpenBeHavior)return console.log("beHaviorComponent destroy"),void this.destroy();this.node.on(s.EventType.TOUCH_START,(function(){console.log("beHaviorComponent 点击"),t.isClick=!0}),this),f.getChannel()==y.WECHAT&&(1==this.strategy?g.isShareBehavior()?(this.loadAsset("icon","prop/ui_Share",l,null,(function(e,r){t.icon.getComponent(c).spriteFrame=r})),f.reportShareBehavior(1,this.strategy,1)):f.reportShareBehavior(1,this.strategy,0):1==this.currentShow?(this.loadAsset("icon","prop/ui_Share",l,null,(function(e,r){t.icon.getComponent(c).spriteFrame=r})),f.reportShareBehavior(1,this.strategy,1)):f.reportShareBehavior(1,this.strategy,0))},n.onDisable=function(){var t=this;f.getChannel()==y.WECHAT&&(1==this.strategy?g.isShareBehavior()?(this.loadAsset("icon","prop/ui_Share",l,null,(function(e,r){t.icon.getComponent(c).spriteFrame=r})),f.reportShareBehavior(this.isClick?4:3,this.strategy,1)):f.reportShareBehavior(this.isClick?4:3,this.strategy,0):1==this.currentShow?(this.loadAsset("icon","prop/ui_Share",l,null,(function(e,r){t.icon.getComponent(c).spriteFrame=r})),f.reportShareBehavior(this.isClick?4:3,this.strategy,1)):f.reportShareBehavior(this.isClick?4:3,this.strategy,0))},n.loadAsset=function(t,e,r,i,o){r==l?e+="/spriteFrame":r==p&&(e+="/texture");var n=h.getBundle(t);if(n&&n.get(e,r))o&&o(null,n.get(e,r));else{var a=function(){n.load(e,r,(function(t,e){i&&i(t/e)}),(function(r,i){if(r)return console.log("ResManager.loadAsset error:"+r.message,"bundleName:"+t,"path:"+e,r),void(o&&o(r));o&&o(null,i)}))};n?a():h.loadBundle(t,(function(t,e){t?o&&o(t):(n=e,a())}))}},e}(u)).prototype,"icon",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(B.prototype,"strategy",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),w=e(B.prototype,"currentShow",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b=B))||b));n._RF.pop()}}}));

System.register("chunks:///_virtual/BlessLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./cocosUtil.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./localization.ts"],(function(e){"use strict";var t,i,s,l,r,n,o,a,u,c,p,h,d,y,m,b,f,B,g,N,I,L,_,v,w,C,S,z;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,s=e.initializerDefineProperty,l=e.assertThisInitialized},function(e){r=e.cclegacy,n=e._decorator,o=e.Node,a=e.Prefab,u=e.Label,c=e.RichText,p=e.find,h=e.UITransform,d=e.instantiate,y=e.v3,m=e.tween,b=e.UIOpacity},function(e){f=e.tyqSDK},function(e){B=e.cocosUtil},function(e){g=e.constants},function(e){N=e.msgac},function(e){I=e.audioManager},function(e){L=e.designManager},function(e){_=e.eventManager},function(e){v=e.playerModel},function(e){w=e.UserData},function(e){C=e.PropItemPrefab},function(e){S=e.BaseUILayer},function(e){z=e.localizeManager}],execute:function(){var T,P,x,R,D,q,A,E,k,V,U,M,H,F,j,G,O,K,W,Q,Y,J,X,Z,$,ee,te,ie,se,le,re,ne,oe,ae,ue,ce,pe,he,de;r._RF.push({},"3e45cpHFthAM6Ybsh9jqa6H","BlessLayer",void 0);var ye=n.ccclass,me=n.property;e("BlessLayer",(T=ye("BlessLayer"),P=me({type:o,tooltip:"道具选择容器"}),x=me({type:o,tooltip:"道具结果容器"}),R=me({type:a,tooltip:"道具节点"}),D=me({type:o,tooltip:"道具列表View"}),q=me({type:o,tooltip:"道具列表View"}),A=me({type:o}),E=me({type:o,tooltip:"合成按钮"}),k=me({type:o}),V=me({type:o}),U=me({type:o}),M=me({type:u}),H=me({type:u}),F=me({type:u}),j=me({type:c}),G=me({type:o}),O=me({type:o}),K=me({type:u}),W=me({type:o}),T((J=t((Y=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return t=e.call.apply(e,[this].concat(r))||this,s(t,"propBlessLayer",J,l(t)),s(t,"BlessResultLayer",X,l(t)),s(t,"propItem",Z,l(t)),s(t,"propView",$,l(t)),s(t,"scrollView",ee,l(t)),s(t,"resultLight",te,l(t)),s(t,"btnBless",ie,l(t)),s(t,"btnlayer",se,l(t)),s(t,"blessPropNode",le,l(t)),s(t,"attrIcon",re,l(t)),s(t,"attrlabel",ne,l(t)),s(t,"propNameLab",oe,l(t)),s(t,"attrNumLab",ae,l(t)),s(t,"tishiText",ue,l(t)),s(t,"selectListNode",ce,l(t)),s(t,"selectBtnNode",pe,l(t)),s(t,"needCoinLabel",he,l(t)),s(t,"needIcon",de,l(t)),t._curBlessId=0,t._curBlessNum=0,t.NeedBlessNum=3,t._curAutoIndex=0,t._curIndex=0,t}i(t,e);var r=t.prototype;return r.onLoad=function(){this.fitScrollView(this.propView,320,600),this.fitNodeWidget(this.btnlayer,30)},r.onEnable=function(){e.prototype.onEnable.call(this),_.on(N.wearDrop,this.initList,this),this.btnBless.active=!1},r.onDisable=function(){e.prototype.onDisable.call(this),_.off(N.wearDrop,this.initList,this)},r.onDestroy=function(){e.prototype.onDestroy.call(this)},r.start=function(){this.selectListNode.active=!1,this._curIndex=0,this.initSelectData(),this.blessPropNode.active=!1,this.tishiText.string="",p("btnBless/Label",this.node).localize("btnQuickSelect",g.layers.BlessLayer),this.btnBless.getChildByName("Label").localize("btnBless",g.layers.BlessLayer),p("selectlistbg/selectallbg/Label",this.node).localize("all",g.layers.BlessLayer),p("selectbtnbg/selectcurbg/Label",this.node).localize("all",g.layers.BlessLayer),p("selectbtnbg/Label",this.node).localize("filter",g.layers.BlessLayer),p("herobg/k/Label",this.node).localize("myEquip",g.layers.BlessLayer)},r.initList=function(){var e=this,t=w.getInstance().getPropSort(),i=[];0==this._curIndex?t.forEach((function(t){if((e._curBlessId==t.id||e._curBlessId<=0)&&L.getRowById(g.tableName.prop,t.id).quality<5)for(var s=t.num,l=0;l<s;l++)i.push([t.id,1==t.iswear&&0==l,l<e._curBlessNum])})):t.forEach((function(t){if(e._curBlessId==t.id||e._curBlessId<=0){var s=L.getRowById(g.tableName.prop,t.id);if(s.wearIndex==e._curIndex&&s.quality<5)for(var l=t.num,r=0;r<l;r++)i.push([t.id,1==t.iswear&&0==r,r<e._curBlessNum])}})),this.scrollViewSetData(this.scrollView,i,this.initItem,[this._curBlessId])},r.initItem=function(e,t,i,s){t[0]==s[0]||0==s[0]?e.getComponent(C).setView(t[0],1,C.Type_HideNum|C.Type_UnTouch):e.getComponent(C).setView(t[0],1,C.Type_HideNum|C.Type_UnTouch|C.Type_Grey),e.getChildByName("wear").active=t[1],e.getChildByName("gou").active=t[2],t[2]&&(e.getChildByName("grayMask").active=!0),e.getComponent(C).setScale(125)},r.selectProp=function(e){var t=e.target.item;if(!t[2])if(this._curBlessNum>=this.NeedBlessNum)this.toast(z._localize(null,"tipMaterialsEnough",g.layers.BlessLayer));else{var i=t[0],s=e.target.parent.getComponent(h).convertToWorldSpaceAR(e.target.position);i!=this._curBlessId&&0!=this._curBlessId||this.addSelectProp(i,1,s)}},r.addSelectProp=function(e,t,i){void 0===t&&(t=1),void 0===i&&(i=null),this._curBlessId=e;for(var s=0;s<t;s++){var l=this.propBlessLayer[this._curBlessNum].getChildByName("prop");if(null==l&&((l=d(this.propItem)).position=y(0,0,0),l.name="prop",this.propBlessLayer[this._curBlessNum].addChild(l),l.getComponent(C).setScale(120)),l.on(o.EventType.TOUCH_END,this.unSelectProp,this),l.active=!0,l.getComponent(C).setView(e,1,C.Type_HideNum|C.Type_UnTouch),i){var r=this.propBlessLayer[this._curBlessNum].getComponent(h).convertToNodeSpaceAR(i);l.position=r,m(l).to(.2,{position:y(0,0,0)}).start()}this._curBlessNum+=1}if(this._curBlessNum<this.NeedBlessNum){for(var n=this._curBlessNum;n<this.NeedBlessNum;n++){var a=this.propBlessLayer[n].getChildByName("prop");null==a&&((a=d(this.propItem)).position=y(0,0,0),a.name="prop",this.propBlessLayer[n].addChild(a),a.getComponent(C).setScale(120)),a.active=!0,a.getComponent(C).setView(e,1,C.Type_HideNum|C.Type_UnTouch|C.Type_Grey)}this.btnBless.active=!1}else this.btnBless.active=!0;var u=L.getRowById(g.tableName.prop,this._curBlessId);this.needCoinLabel.string="x"+L.config["compose"+u.quality],4==u.quality?this.setSpriteFrame2(this.needIcon,"prop/prop_diamond2"):this.setSpriteFrame2(this.needIcon,"prop/prop_coin1"),u&&u.blessId&&u.blessId>0&&this.showResultProp([u.blessId]),this.selectBtnNode.active=this._curBlessNum<=0,this.initList()},r.showResultProp=function(){var e=this;this.BlessResultLayer.removeAllChildren();for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];i?(i.forEach((function(t){var i=d(e.propItem);i.getComponent(C).setView(t,1,C.Type_HideNum),i.getComponent(C).setScale(130),i.position=y(0,0,0),e.BlessResultLayer.addChild(i)})),this.showLight(this.BlessResultLayer.children.length>0),this.blessPropNode.active=this.BlessResultLayer.children.length>0,this.showPropInfo(),this.BlessResultLayer.children.length<=0&&(this.tishiText.string="")):(this.showLight(!1),this.blessPropNode.active=!1,this.tishiText.string="")},r.showPropInfo=function(){if(!(this._curBlessId<=0)){var e=L.getRowById(g.tableName.prop,this._curBlessId);if(null!=e){if(e&&e.blessId&&e.blessId>0)var t=L.getRowById(g.tableName.prop,e.blessId);if(e.atk>0?(this.setSpriteFrame2(this.attrIcon,"heroLayer/ui_gj",null,g.bundles.wwqVec),this.attrNumLab.string=""+B.formatNumString(t.atk),this.attrNumLab.color=g.colors.blue.parseColor(),this.attrlabel.string=z._localize(null,"atk",g.catName.common)+" "+B.formatNumString(e.atk)):e.hp>0&&(this.attrNumLab.string=""+B.formatNumString(t.hp),this.setSpriteFrame2(this.attrIcon,"heroLayer/ui_sm",null,g.bundles.wwqVec),this.attrlabel.string=z._localize(null,"hp",g.catName.common)+" "+B.formatNumString(e.hp),this.attrNumLab.color=g.colors.green.parseColor()),this.propNameLab.string=""+z._localize(null,"name"+t.id,g.catName.propSystem),this.NeedBlessNum-this._curBlessNum<=0)this.tishiText.string="";else{this.tishiText.node.localize({cat:g.layers.BlessLayer,key:"tishiText",vars:[this.NeedBlessNum-this._curBlessNum,["#818ca0","#38ff38","#328adc","#ff48d7","#ffb848"][e.quality-1],z._localize(null,"q"+e.quality,g.catName.propSystem),z._localize(null,"name"+e.id,g.catName.propSystem)]})}}}},r.showLight=function(e){this.resultLight.active=!1,e&&(this.resultLight.active=!0,m(this.resultLight.getComponent(b)).stop(),m(this.resultLight.getComponent(b)).to(.7,{opacity:0}).to(.4,{opacity:255}).union().repeatForever().start())},r.unSelectProp=function(){this._curBlessNum--;var e=this.propBlessLayer[this._curBlessNum].getChildByName("prop");if(this._curBlessNum<=0){this._curBlessId=0;for(var t=0;t<this.NeedBlessNum;t++){var i=this.propBlessLayer[t].getChildByName("prop");i&&(i.active=!1,i.off(o.EventType.TOUCH_END,this.unSelectProp,this))}this.showResultProp()}else e&&this._curBlessId>0&&(e.active=!0,e.getComponent(C).setView(this._curBlessId,1,C.Type_HideNum|C.Type_UnTouch|C.Type_Grey));this.btnBless.active=!1,this.selectBtnNode.active=this._curBlessNum<=0,this.initList()},r.blessAction=function(){if(I.playEffect("btnClick"),this._curBlessNum<this.NeedBlessNum)this.toast(z._localize(null,"tipMateriaNotEnough",g.layers.BlessLayer));else{var e=L.getRowById(g.tableName.prop,this._curBlessId);if(e){var t=L.config["compose"+e.quality]||100;4==e.quality&&w.getInstance().checkAndUseBaoshi(t,!0)||4!=e.quality&&w.getInstance().cheackAndUseCoin(t,!0)?e&&e.blessId&&e.blessId>0&&(w.getInstance().blessProp(this._curBlessId,e.blessId,0-this._curBlessNum),this.showResultProp([e.blessId]),this.clearBlessLayer(),this.showResultProp(),this.initList(),f.eventSendCustomEvent("合成装备成功"),this.openLayer(g.layers.BlessResultLayer,{blessId:e.id,getPropId:e.blessId}),v.addDayTaskNum(9)):4!=e.quality?(f.eventSendCustomEvent("合成装备金币不足"),this.toast(z._localize(null,"noGlod",g.catName.common)),this.openLayer(g.layers.RewardItemLayer,{propId:101,num:L.config.adCoin})):(f.eventSendCustomEvent("合成装备钻石不足"),this.toast(z._localize(null,"noDiamond",g.catName.common)),this.openLayer(g.layers.RewardItemLayer,{propId:801,num:L.config.adDiamond}))}}},r.clearBlessLayer=function(){this._curBlessId=0,this._curBlessNum=0,this.tishiText.string="",this.propBlessLayer[0].removeAllChildren(),this.propBlessLayer[1].removeAllChildren(),this.propBlessLayer[2].removeAllChildren()},r.allBlessProp=function(){for(var e=w.getInstance().propData,t=[],i=0;i<e.length;i++)if(e[i].num>=this.NeedBlessNum){var s=L.getRowById(g.tableName.prop,e[i].id);s&&s.blessId&&s.blessId>0&&(t.push(s.blessId),w.getInstance().blessProp(e[i].id,s.blessId,0-this.NeedBlessNum))}this.showResultProp(t),this.clearBlessLayer(),this.initList()},r.autoBlessAction=function(){I.playEffect("btnClick");var e=w.getInstance().propData;if(this._curBlessId>0)if(this._curBlessNum<this.NeedBlessNum)for(var t=this._curAutoIndex+1;t<e.length+this._curAutoIndex+1;t++){var i=t%e.length;if(e[i].id==this._curBlessId&&e[i].num-this._curBlessNum>0)if(L.getRowById(g.tableName.prop,e[i].id).quality<5)return this._curAutoIndex=i,void this.addSelectProp(e[i].id,Math.min(e[i].num-this._curBlessNum,this.NeedBlessNum-this._curBlessNum))}else for(var s=this._curAutoIndex+1;s<e.length+this._curAutoIndex+1;s++){var l=s%e.length;if(e[l].num>=this.NeedBlessNum)if(L.getRowById(g.tableName.prop,e[l].id).quality<5)return this.clearBlessLayer(),this._curAutoIndex=l,void this.addSelectProp(e[l].id,this.NeedBlessNum)}else for(var r=this._curAutoIndex+1;r<e.length+this._curAutoIndex+1;r++){var n=r%e.length;if(e[n].num>=this.NeedBlessNum)if(L.getRowById(g.tableName.prop,e[n].id).quality<5)return this.clearBlessLayer(),this._curAutoIndex=n,void this.addSelectProp(e[n].id,this.NeedBlessNum)}this.toast(z._localize(null,"tipNoEquip",g.layers.BlessLayer))},r.closeBless=function(){I.playEffect("btnClick"),this.closeLayer()},r.onSelectBtnClick=function(){I.playEffect("btnClick"),this.selectListNode.active=!this.selectListNode.active,this.setSpriteFrame2(this.selectBtnNode.getChildByName("jianxia"),this.selectListNode.active?"heroLayer/jianshang":"heroLayer/jianxia",null,g.bundles.wwqVec)},r.onSelectItemClick=function(e,t){I.playEffect("btnClick"),this._curIndex=parseInt(t),this.onSelectBtnClick(),this.initSelectData()},r.initSelectData=function(){var e=this.selectBtnNode.getChildByName("selectcurbg");0==this._curIndex?(e.getChildByName("propicon").active=!1,e.getChildByName("Label").active=!0):(e.getChildByName("propicon").active=!0,e.getChildByName("Label").active=!1,this.setSpriteFrame2(e.getChildByName("propicon"),"heroLayer/propicon"+this._curIndex,null,g.bundles.wwqVec)),this.initList()},t}(S)).prototype,"propBlessLayer",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),X=t(Y.prototype,"BlessResultLayer",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(Y.prototype,"propItem",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(Y.prototype,"propView",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(Y.prototype,"scrollView",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(Y.prototype,"resultLight",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=t(Y.prototype,"btnBless",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=t(Y.prototype,"btnlayer",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=t(Y.prototype,"blessPropNode",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=t(Y.prototype,"attrIcon",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(Y.prototype,"attrlabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=t(Y.prototype,"propNameLab",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=t(Y.prototype,"attrNumLab",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=t(Y.prototype,"tishiText",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=t(Y.prototype,"selectListNode",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=t(Y.prototype,"selectBtnNode",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),he=t(Y.prototype,"needCoinLabel",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=t(Y.prototype,"needIcon",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=Y))||Q));r._RF.pop()}}}));

System.register("chunks:///_virtual/BlessResultLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./constants.ts","./audioManager.ts","./designManager.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./localization.ts"],(function(t){"use strict";var e,a,r,i,o,n,l,s,u,p,c,y,b,h,m,d,f,g,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,a=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,n=t._decorator,l=t.Node,s=t.Prefab,u=t.Label,p=t.instantiate,c=t.v3,y=t.tween},function(t){b=t.myLog},function(t){h=t.constants},function(t){m=t.audioManager},function(t){d=t.designManager},function(t){f=t.PropItemPrefab},function(t){g=t.BaseUILayer},function(t){L=t.localizeManager}],execute:function(){var N,w,B,I,z,v,R,_,D,P,C,T,M,k,S,E,F,U,V,A,H,j,q,x,Q;o._RF.push({},"cec72TRsr9PIb7D7iP2MQX0","BlessResultLayer",void 0);var W=n.ccclass,X=n.property;t("BlessResultLayer",(N=W("BlessResultLayer"),w=X({type:l,tooltip:"道具选择容器"}),B=X({type:l,tooltip:"道具结果容器"}),I=X({type:s,tooltip:"道具节点"}),z=X({type:l}),v=X({type:u}),R=X({type:l}),_=X({type:u}),D=X({type:u}),P=X({type:u}),C=X({type:l}),T=X({type:l}),N((S=e((k=function(t){function e(){for(var e,a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o))||this,r(e,"propBlessLayer",S,i(e)),r(e,"BlessResultLayer",E,i(e)),r(e,"propItem",F,i(e)),r(e,"btnlayer",U,i(e)),r(e,"propNameLab",V,i(e)),r(e,"attrIcon",A,i(e)),r(e,"attrlabel",H,i(e)),r(e,"attrNumLab1",j,i(e)),r(e,"attrNumLab",q,i(e)),r(e,"attrNodebg",x,i(e)),r(e,"title",Q,i(e)),e}a(e,t);var o=e.prototype;return o.onLoad=function(){b.i("BlessResultLayer onLoad"),this.fitNodeWidget(this.btnlayer,0)},o.onEnable=function(){b.i("BlessResultLayer onEnable"),t.prototype.onEnable.call(this);for(var e=this.layerData.blessId,a=this.layerData.getPropId,r=0;r<3;r++){var i=p(this.propItem);i.position=c(0,2==r?0:10,0),i.name="prop",this.propBlessLayer[r].addChild(i),i.getComponent(f).setScale(120),i.getComponent(f).setView(e,1,f.Type_HideNum|f.Type_UnTouch)}this.startAnimal();var o=d.getRowById(h.tableName.prop,e),n=d.getRowById(h.tableName.prop,a);this.propNameLab.node.localize(h.catName.propSystem,"name"+o.id),o.atk>0?(this.setSpriteFrame2(this.attrIcon,"heroLayer/ui_gj",null,h.bundles.wwqVec),this.attrNumLab.string="+"+n.atk,this.attrNumLab.color=h.colors.blue.parseColor(),this.attrlabel.string=L._localize(null,"atk",h.catName.common),this.attrNumLab1.string=""+o.atk):o.hp>0&&(this.attrNumLab.string="+"+n.hp,this.setSpriteFrame2(this.attrIcon,"heroLayer/ui_sm",null,h.bundles.wwqVec),this.attrlabel.string=L._localize(null,"hp",h.catName.common),this.attrNumLab.color=h.colors.green.parseColor(),this.attrNumLab1.string=""+o.hp),this.attrNodebg.active=!1},o.startAnimal=function(){y(this.propBlessLayer[0]).delay(1).to(.1,{position:c(15,268,0)}).hide().start(),y(this.propBlessLayer[1]).delay(1).to(.1,{position:c(15,268,0)}).hide().start();var t=this.layerData.getPropId,e=this.propBlessLayer[2].getChildByName("prop"),a=this;y(this.propBlessLayer[2]).delay(1).hide().delay(.8).call((function(){e.getComponent(f).setView(t,1,f.Type_HideNum|f.Type_UnTouch),a.attrNodebg.active=!0,a.btnlayer.active=!0})).show().set({scale:c(0,0,0)}).to(.2,{scale:c(1,1,1)}).start(),y(this.attrNodebg).delay(1.8).to(.1,{scale:c(1.2,1.2,1.2)}).to(.1,{scale:c(1,1,1)}).start(),y(this.attrIcon).hide().delay(1.9).show().start(),y(this.propNameLab.node).hide().delay(1.9).show().start(),y(this.attrNumLab.node).hide().delay(2.1).show().start(),y(this.attrNumLab1.node).hide().delay(2.1).show().start(),y(this.title).hide().delay(1.7).show().start()},o.onDisable=function(){t.prototype.onDisable.call(this)},o.onDestroy=function(){t.prototype.onDestroy.call(this)},o.start=function(){this.btnlayer.active=!1},o.closeBless=function(){m.playEffect("btnClick"),this.closeLayer()},e}(g)).prototype,"propBlessLayer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E=e(k.prototype,"BlessResultLayer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(k.prototype,"propItem",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(k.prototype,"btnlayer",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(k.prototype,"propNameLab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(k.prototype,"attrIcon",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(k.prototype,"attrlabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(k.prototype,"attrNumLab1",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(k.prototype,"attrNumLab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(k.prototype,"attrNodebg",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(k.prototype,"title",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=k))||M));o._RF.pop()}}}));

System.register("chunks:///_virtual/blockArrow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts"],(function(t){"use strict";var o,n,e,i,r,s,c,a,l,h;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,i=t.UITransform,r=t.Tween,s=t.tween,c=t.v3,a=t.Component},function(t){l=t.cocosUtil},function(t){h=t.mapModel}],execute:function(){var u;n._RF.push({},"26082K0Kx9A84bAyKtyHwII","blockArrow",void 0);var p=e.ccclass;e.property,t("blockArrow",p("blockArrow")(u=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this).hint=void 0,o.monster=void 0,o.outVec1=c(0,0,0),o}o(n,t);var e=n.prototype;return e.init=function(t){var o=this;this.hint=t,this.monster=this.hint.extraObj.monster;var n=this.hint.extraObj.duration,e=this.hint.extraObj.dis,c=this.hint.bodyNode.getComponent(i);c.width=120,r.stopAllByTarget(c),s(c).to(n,{width:e}).call((function(){o.hint.recycleSelf()})).start()},e.update=function(t){h.player.node.getPosition(this.outVec1).subtract(this.monster.node.position),this.node.angle=l.vec2XAngle(this.outVec1),this.node.position=this.monster.node.position},n}(a))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/BoxColliderUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./physicsGroup.ts"],(function(t){"use strict";var i,e,o,n,r,c,s,a,l,h,u,d,f;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized,r=t.createClass},function(t){c=t.cclegacy,s=t._decorator,a=t.Enum,l=t.Vec2,h=t.Rect,u=t.Component,d=t.Size},function(t){f=t.physicsGroup}],execute:function(){var p,b,y,C,g,w,x,v,z,O;c._RF.push({},"83984O8uZdGNKPCi1VRIjBN","BoxColliderUtil",void 0);var j=s.ccclass,B=s.property,m=s.executeInEditMode;t("BoxColliderUtil",(p=j("BoxColliderUtil"),b=m(!0),y=B({type:a(f)}),p(C=b((w=i((g=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),c=0;c<e;c++)r[c]=arguments[c];return i=t.call.apply(t,[this].concat(r))||this,o(i,"_offset",w,n(i)),o(i,"_size",x,n(i)),o(i,"tag",v,n(i)),o(i,"group",z,n(i)),o(i,"isSync",O,n(i)),i.worldPoints=[new l,new l,new l,new l],i.worldAabb=new h,i.contactColliderObj={},i.contactBeginCb=void 0,i.contactEndCb=void 0,i}e(i,t);var c=i.prototype;return c.onDisable=function(){for(var t in this.contactColliderObj){var i=this.contactColliderObj[t];i&&this.contactEnd(i)}},c.getContactKey=function(t){return this.uuid+"_"+t.uuid},c.updateCollider=function(){var t=this.worldAabb;t.x=this.offset.x-.5*this.size.width,t.y=this.offset.y-.5*this.size.height,t.width=this.size.width,t.height=this.size.height;var i=this.worldPoints[0],e=this.worldPoints[1],o=this.worldPoints[2],n=this.worldPoints[3];t.transformMat4ToPoints(this.node.worldMatrix,i,e,o,n);var r=Math.min(i.x,e.x,o.x,n.x),c=Math.max(i.x,e.x,o.x,n.x),s=Math.min(i.y,e.y,o.y,n.y),a=Math.max(i.y,e.y,o.y,n.y);t.x=r,t.y=s,t.width=c-r,t.height=a-s},c.setContactBegin=function(t){this.contactBeginCb=t},c.setContactEnd=function(t){this.contactEndCb=t},c.contactBegin=function(t){var i=this.getContactKey(t),e=t.getContactKey(this);this.contactColliderObj[i]||(this.contactColliderObj[i]=t,this.contactBeginCb&&this.contactBeginCb(this,t)),t.contactColliderObj[e]||(t.contactColliderObj[e]=this,t.contactBeginCb&&t.contactBeginCb(t,this))},c.contactEnd=function(t){var i=this.getContactKey(t),e=t.getContactKey(this),o=this.contactColliderObj[i];o&&o==t&&(this.contactColliderObj[i]=void 0,this.contactEndCb&&this.contactEndCb(this,t));var n=t.contactColliderObj[e];n&&n==this&&(t.contactColliderObj[e]=void 0,t.contactEndCb&&t.contactEndCb(t,this))},c.update=function(){},r(i,[{key:"offset",get:function(){return this._offset},set:function(t){this._offset=t}},{key:"size",get:function(){return this._size},set:function(t){this._size=t}}]),i}(u)).prototype,"_offset",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l}}),i(g.prototype,"offset",[B],Object.getOwnPropertyDescriptor(g.prototype,"offset"),g.prototype),x=i(g.prototype,"_size",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new d(1,1)}}),i(g.prototype,"size",[B],Object.getOwnPropertyDescriptor(g.prototype,"size"),g.prototype),v=i(g.prototype,"tag",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=i(g.prototype,"group",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return f.DEFAULT}}),O=i(g.prototype,"isSync",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C=g))||C)||C));c._RF.pop()}}}));

System.register("chunks:///_virtual/BoxMonsterLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./mapModel.ts","./BaseLayer.ts","./localization.ts"],(function(e){"use strict";var t,n,a,o,r,i,s,c,l,p,d,m,u,h;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,a=e._decorator,o=e.Button,r=e.Color,i=e.find},function(e){s=e.sdkManager},function(e){c=e.cocosUtil},function(e){l=e.utilTools},function(e){p=e.constants},function(e){d=e.designManager},function(e){m=e.mapModel},function(e){u=e.BaseLayer},function(e){h=e.localizeManager}],execute:function(){var f;n._RF.push({},"3a9bbcOj/dPkYkW2JkTGGD8","BoxMonsterLayer",void 0);var y=a.ccclass;a.property,e("BoxMonsterLayer",y("BoxMonsterLayer")(f=function(e){function n(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this).getIndexs={},t.canRefresh=!0,t.refreshCount=0,t}t(n,e);var a=n.prototype;return a.onLoad=function(){e.prototype.onLoad.call(this)},a.onEnable=function(){e.prototype.onEnable.call(this)},a.onDisable=function(){e.prototype.onDisable.call(this)},a.onDestroy=function(){e.prototype.onDestroy.call(this)},a.initUI=function(){var e=this,t=this.getNodeByPath("ui/bg/itemLayer").children,n=this.getItemArr();t.forEach((function(t,a){var o=n[a];t.item=o,t.index=a,e.refreshSelectItem(t,o,a)})),this.refreshBtnsLayer(),this.node.getChildByPath("ui/title/text").localizeImg(),this.node.getChildByPath("ui/bg/btnRefresh/text").localizeImg()},a.refreshBtnsLayer=function(){var e=this.getNodeByPath("ui/bg/btnRefresh");e.getComponent(o).enabled=!0,this.canRefresh&&this.refreshCount<d.config.carTime?c.setRenderableColor(e,r.WHITE,!0):(c.setRenderableColor(e,p.colors.yin.parseColor(),!0),e.getComponent(o).enabled=!1);var t=this.getNodeByPath("ui/bg/btnRefresh/limit");this.setString(t,"(%d/%d)".format(this.refreshCount,d.config.carTime))},a.refreshSelectLayer=function(){var e=this;this.getNodeByPath("ui/bg/itemLayer").children.forEach((function(t,n){e.refreshSelectItem(t,t.item,t.index)}))},a.refreshSelectItem=function(e,t,n){var a,o,r;null==(a=i("hasGet/icon",e))||a.localizeImg(),null==(o=i("propItem/btnGet/text",e))||o.localizeImg(),null==(r=i("btnGetAd/text",e))||r.localizeImg();var s=i("skillItem",e),c=i("propItem",e);if(s&&(s.active=!1),c.active=!1,i("hasGet",e).active=!!this.getIndexs[n],t.name==p.tableName.prop){c.active=!0;var l=d.getRowById(p.tableName.prop,t.id),m=h._localize(null,"info"+l.id,p.catName.propSystem);t.id!=p.propIds.coin&&t.id!=p.propIds.diamond||(m=h._localize(null,{cat:p.catName.common,key:"propGet",vars:[h._localize(null,"name"+l.id,p.catName.propSystem),t.num]})),this.setString(i("info",c),m)}else{s.active=!0;var u=t.info,f=d.getFirstIdByType(t.type);u&&(f=u.id+1);var y=d.getRowById(t.name,f);this.setSpriteFrame(i("icon",s),y.icon);var g=i("starLayer",s);this.setNumItemLayer(g,y.lv,(function(e){var t=i("icon",e),n=i("icon2",e);y.lv>=p.design.maxLv?(t.active=!1,n.active=!0):(t.active=!0,n.active=!1)}))}},a.getItemArr=function(){var e=m.mapSystem.getSelectItemArr();return e.forEach((function(e){e.name==p.tableName.prop&&(e.id=p.propIds.coin,e.num=l.getFloatValue(d.config.carGoldNum[0],d.config.carGoldNum[1],!0))})),e.push({name:p.tableName.prop,id:p.propIds.coin,num:d.config.carGold}),e.push({name:p.tableName.prop,id:p.propIds.diamond,num:d.config.carDiamond}),e.push({name:p.tableName.prop,id:p.propIds.addHpPercent}),e},a.closeLayer=function(){e.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},a.onClickBtnRefresh=function(){var e=this;s.openAd("宝箱怪换一批",(function(t){1==t&&(e.refreshCount++,e.initUI())}))},a.onClickBtnGetAd=function(e){var t=this;s.openAd("宝箱怪奖励",(function(n){if(1==n){var a=e.parent.item;switch(a.name){case p.tableName.weapon:m.weaponSystem.addWeapon(a.type);break;case p.tableName.skill:m.skillSystem.addSkill(a.type);break;case p.tableName.skill2:m.skillSystem.addSkill2(a.type);break;case p.tableName.prop:m.propSystem.getProp(a.id,a.num)}t.canRefresh=!1;var o=e.parent.index;t.getIndexs[o]=1,t.refreshSelectLayer(),t.refreshBtnsLayer()}}))},a.onClickBtnGet=function(e){var t=e.parent.parent.item,n=e.parent.parent.index;m.propSystem.getProp(t.id,t.num),this.getIndexs[n]=1,this.refreshSelectLayer()},n}(u))||f);n._RF.pop()}}}));

System.register("chunks:///_virtual/BtnLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,i,o,h,r,s,a,p,l,d,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){h=t.cclegacy,r=t._decorator,s=t.Label,a=t.Sprite,p=t.UITransform,l=t.v3,d=t.tween,m=t.Component}],execute:function(){var g,u,c,C,w;h._RF.push({},"7a63e1JJGZOm5XaOX2JTDIM","BtnLayer",void 0);var f=r.ccclass,y=r.property;t("BtnLayer",(g=f("BtnLayer"),u=y({type:s,tooltip:"发光"}),g((w=e((C=function(t){function e(){for(var e,n=arguments.length,h=new Array(n),r=0;r<n;r++)h[r]=arguments[r];return(e=t.call.apply(t,[this].concat(h))||this).bolInit=!1,e.intCheckTime=1,e.runTime=void 0,e.runTimeLast=void 0,e.tween=void 0,i(e,"light",w,o(e)),e}n(e,t);var h=e.prototype;return h.onLoad=function(){this.bolInit=!1,this.runTime=0,this.runTimeLast=0,this.intCheckTime=1,this.tween=null,this.node.getChildByName("light").active=!1},h.setStart=function(){if(this.node.parent&&null==this.tween){this.runTime=0,this.runTimeLast=0,null==this.node.getComponent(a).spriteFrame&&(this.node.getComponent(a).spriteFrame=this.node.parent.getComponent(a).spriteFrame),this.node.getComponent(p).width=this.node.parent.getComponent(p).width,this.node.getComponent(p).height=this.node.parent.getComponent(p).height;var t=this.node.getChildByName("light"),e=this.node.parent.getComponent(p).width/t.getComponent(p).width,n=this.node.parent.getComponent(p).height/t.getComponent(p).height,i=Math.max(e,n);t.scale=l(i,i,1),this.node.getChildByName("light").active=!0,this.tween=d(t).show().set({position:l(.5*-(this.node.parent.getComponent(p).width+t.getComponent(p).width),0)}).to(.8,{position:l(.5*(this.node.parent.getComponent(p).width+t.getComponent(p).width),0,0)}).hide().delay(.2+.5*Math.random()).union().repeatForever(),this.tween.start()}},h.setStop=function(){this.tween&&(this.tween.stop(),this.tween=null,this.node.getChildByName("light").active=!1,this.node.getChildByName("light").position=l(.5*-(this.node.parent.getComponent(p).width+this.node.getChildByName("light").getComponent(p).width),0,0))},h.update=function(t){this.runTime+=t,this.runTime>this.intCheckTime&&(this.runTime=0,"ffffff"==this.node.parent.getComponent(a).color.toHEX("#rrggbb").toLowerCase()?this.setStart():this.setStop())},e}(m)).prototype,"light",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=C))||c));h._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./physicsGroup.ts","./Monster.ts"],(function(t){"use strict";var e,l,i,o,n,a,s,c,r,u,h,d,b,g,p,v,y,f,m;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,i=t._decorator,o=t.BoxCollider2D,n=t.Contact2DType,a=t.find,s=t.Tween,c=t.Vec3,r=t.Vec2,u=t.v3,h=t.Component},function(t){d=t.cocosUtil},function(t){b=t.utilTools},function(t){g=t.constants},function(t){p=t.audioManager},function(t){v=t.designManager},function(t){y=t.mapModel},function(t){f=t.physicsGroup},function(t){m=t.Monster}],execute:function(){var T;l._RF.push({},"e223cwh0a9GWbHSl49R/0HT","Bullet",void 0);var C=i.ccclass;i.property,t("Bullet",C("Bullet")(T=function(t){function l(){for(var e,l=arguments.length,i=new Array(l),o=0;o<l;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).id=void 0,e.row=void 0,e.direction=void 0,e.isDestroyInNoShow=void 0,e.extraObj=void 0,e.speed=void 0,e.atk=void 0,e.bodyNode=void 0,e.collider=void 0,e.bulletUtil=void 0,e.timeCount=void 0,e.contactItemArr=void 0,e.isFollow=!1,e.rotateSpeed=Math.PI/3,e.vec3Obj={targetPos:u(0,0,0),direction:u(0,0,0),outVec3:u(0,0,0)},e}e(l,t);var i=l.prototype;return i.onLoad=function(){this.collider=this.node.getComponent(o),this.collider&&(this.collider.on(n.BEGIN_CONTACT,this.contactBegin,this),this.collider.on(n.END_CONTACT,this.contactEnd,this)),this.bodyNode=a("body",this.node)},i.onDestroy=function(){},i.init=function(t,e,l,i,o){this.bodyNode||this.onLoad(),this.collider&&(this.collider.group=e,this.collider.enabled=!0),this.id=t,this.extraObj=o,l||(l=d.convertToWorldSpace(y.player.node));var n=d.convertToNodeSpace(this.node,l);this.node.setPosition(n),i||(i=this.getFacePlayerDirection()),0==i.x&&0==i.y&&(i.x=1),this.direction=i.clone().normalize();var a=v.getRowById(g.tableName.bullet,t);this.row=a,this.speed=a.speed,this.atk=a.atk;var c=b.radianToAngle(Math.atan2(this.direction.y,this.direction.x));this.node.angle=c,this.timeCount=0,this.isFollow=!1,this.contactItemArr=[],this.isDestroyInNoShow=!1,s.stopAllByTarget(this.node),this.unscheduleAllCallbacks();try{var r=this.node.name;switch(this.node.name){case"bullet1011":case"bullet1012":r="bullet1011";break;case"bullet1021":case"bullet1022":r="bullet1021";break;case"bullet1041":case"bullet1043":r="bullet1041";break;case"bullet1042":case"bullet1044":r="bullet1042";break;case"bullet1051":case"bullet1053":r="bullet1051";break;case"bullet1052":case"bullet1054":r="bullet1052";break;case"bullet1061":case"bullet1062":r="bullet1061";break;case"bullet1081":case"bullet1082":r="bullet1081";break;case"bullet1091":case"bullet1092":r="bullet1091";break;case"bullet1101":case"bullet1104":r="bullet1101";break;case"bullet1102":case"bullet1105":r="bullet1102";break;case"bullet1103":case"bullet1106":r="bullet1103";break;case"bullet1111":case"bullet1113":r="bullet1111";break;case"bullet1112":case"bullet1114":r="bullet1112"}var u=d.addComponentOnce(this,r);u.unscheduleAllCallbacks(),this.bulletUtil=u,u.init(this),u.contactBulletTime&&u.contactBulletTime>0&&(this.extraObj.speedCutDuration=u.contactBulletTime)}catch(t){}},i.getFacePlayerDirection=function(){var t=this.node.getPosition();return y.player.node.getPosition().subtract(t)},i.setDirection=function(t){this.direction=t.normalize()},i.contactBegin=function(t,e){var i=null;if(e.group==f.MONSTER&&0==e.tag?i=e.getComponent(m):e.group==f.PLAYER&&(i=y.player),i){this.contactEnmeyCanHide()?this.recycleSelf():-1==this.contactItemArr.indexOf(i)&&(this.contactItemArr.push(i),i.contactBulletTime=0),this.bulletUtil&&this.bulletUtil.contactBegin&&this.bulletUtil.contactBegin(e.node);var o=this.atk;this.extraObj&&this.extraObj.atkPercentAdd>0&&(o*=1+this.extraObj.atkPercentAdd,o=Math.ceil(o)),i.hitWithDam(o,this.getShineColor(),this.extraObj),p.playEffect(this.row.audio)}if(e.group==f.MONSTER_BULLET){var n=e.getComponent(l);n.contactEnmeyCanHide()&&n.recycleSelf()}},i.contactEnd=function(t,e){var l=null;if(e.group==f.MONSTER?l=e.getComponent(m):e.group==f.PLAYER&&(l=y.player),l){var i=this.contactItemArr.indexOf(l);-1!=i&&this.contactItemArr.splice(i,1)}},i.getShineColor=function(){if(this.bulletUtil&&this.bulletUtil.shineColor)return this.bulletUtil.shineColor},i.contactEnmeyCanHide=function(){return!this.bulletUtil||!this.bulletUtil.contactNotHide},i.outScreenCanRecyle=function(){return!this.bulletUtil||!this.bulletUtil.outScreenNotRecycle},i.recycleSelf=function(){y.bulletSystem.recycleBulletNode(this.node),this.bulletUtil&&this.bulletUtil.recycleSelfEnd&&this.bulletUtil.recycleSelfEnd(),s.stopAllByTarget(this.node),s.stopAllByTarget(this.bodyNode),this.unscheduleAllCallbacks(),this.bulletUtil&&this.bulletUtil.unscheduleAllCallbacks()},i.getFollowTargetPos=function(){return this.bulletUtil&&this.bulletUtil.targetPos?d.vec3CopyVal(this.vec3Obj.targetPos,this.bulletUtil.targetPos):d.vec3CopyVal(this.vec3Obj.targetPos,y.player.node.position)},i.update=function(t){var e=this,l=!0;if(this.bulletUtil&&this.bulletUtil.moveStop&&(l=!1),this.speed<=0&&(l=!1),l){var i=this.speed*t,o=this.node.position;if(this.isFollow){var n=this.getFollowTargetPos().subtract(o).normalize(),a=Math.atan2(n.y,n.x);a<0&&(a+=2*Math.PI);var s=Math.atan2(this.direction.y,this.direction.x);s<0&&(s+=2*Math.PI);var u=this.rotateSpeed*t,h=Math.abs(a-s);u>h&&(u=h),a>s?a-s>Math.PI&&(u=-u):s-a<Math.PI&&(u=-u),this.direction=c.rotateZ(this.vec3Obj.outVec3,this.direction,c.ZERO,u);var g=b.radianToAngle(Math.atan2(this.direction.y,this.direction.x));this.node.angle=g}else{var v=b.radianToAngle(Math.atan2(this.direction.y,this.direction.x));this.node.angle=v}var f=null;if(this.bulletUtil&&this.bulletUtil.targetPos&&this.bulletUtil.arriveTargetPos)f=this.getFollowTargetPos().subtract(o);if(o.add(d.vec3CopyVal(this.vec3Obj.direction,this.direction).multiplyScalar(i)),this.node.position=o,f){var m=this.getFollowTargetPos().subtract(o);if(b.radianToAngle(r.angle(f,m))>90)return void this.bulletUtil.arriveTargetPos()}}this.contactItemArr.length>0&&b.forArr(this.contactItemArr,(function(l){l.contactBulletTime+=t;var i=.5;e.bulletUtil&&e.bulletUtil.contactBulletTime>0&&(i=e.bulletUtil.contactBulletTime),l.contactBulletTime>=i&&(l.contactBulletTime=0,l.hitWithDam(e.atk,e.getShineColor(),e.extraObj),p.playEffect(e.row.audio))})),this.timeCount+=t,this.timeCount>=2&&this.outScreenCanRecyle()&&!y.isInScreenVisible(this.node)&&this.recycleSelf()},l}(h))||T);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1011.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts"],(function(t){"use strict";var e,i,o,n,s,l,c,r;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,n=t.tween,s=t.Component},function(t){l=t.cocosUtil},function(t){c=t.utilTools},function(t){r=t.mapModel}],execute:function(){var u;i._RF.push({},"01617jEdq9KILpUXdznmc6J","Bullet1011",void 0);var a=o.ccclass;o.property,t("bullet1011",a("bullet1011")(u=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e.contactNotHide=!0,e.g=-800,e.v=800,e.vx=0,e.vy=0,e}e(i,t);var o=i.prototype;return o.init=function(t){this.bullet=t,n(this.node).by(1,{angle:360}).repeatForever().start();var e=Math.PI/15,i=c.getFloatValue(Math.PI/2-e,Math.PI/2+e);this.vx=this.v*Math.cos(i),this.vy=this.v*Math.sin(i)},o.update=function(t){var e=this.node.getPosition();e.x+=this.vx*t,e.y+=this.vy*t,this.vy+=this.g*t,this.node.setPosition(e),r.isInScreenVisible(this.node)||this.bullet.recycleSelf()},o.recycleSelfEnd=function(){l.isValid(this.bullet.extraObj)&&this.bullet.extraObj.subNum()},i}(s))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/bullet10170.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts"],(function(t){"use strict";var n,e,o,l,i,c,u;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,l=t.Component},function(t){i=t.cocosUtil},function(t){c=t.mapModel},function(t){u=t.HintNames}],execute:function(){var r;e._RF.push({},"cf053ZSiuRAtINPklnj/BxA","bullet10170",void 0);var s=o.ccclass;o.property,t("bullet10170",s("bullet10170")(r=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),l=0;l<e;l++)o[l]=arguments[l];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n}n(e,t);var o=e.prototype;return o.init=function(t){var n=this;this.bullet=t,this.bullet.rotateSpeed=Math.PI/4+Math.random()*Math.PI/2,this.scheduleOnce((function(){n.bullet.isFollow=!0}),.4+.2*Math.random()),this.scheduleOnce((function(){n.bullet.isFollow=!1}),2.5+.5*Math.random())},o.contactBegin=function(t){c.hintSystem.addHint(u.hit2,i.convertToWorldSpace(this.bullet.node))},e}(l))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/bullet10180.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){"use strict";var n,i,o,e,l,c;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,e=t.Component},function(t){l=t.cocosUtil},function(t){c=t.AnimationCtrl}],execute:function(){var r;i._RF.push({},"e7659gNqdVEN4DaILxPJn21","bullet10180",void 0);var a=o.ccclass;o.property,t("bullet10180",a("bullet10180")(r=function(t){function i(){for(var n,i=arguments.length,o=new Array(i),e=0;e<i;e++)o[e]=arguments[e];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n.contactNotHide=!0,n.animationCtrl=void 0,n}return n(i,t),i.prototype.init=function(t){var n=this;this.bullet=t,this.animationCtrl=l.addComponentOnce(this,c),this.animationCtrl.playAnimationOnce("ani",(function(){n.bullet.recycleSelf()}))},i}(e))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/bullet10190.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var e,o,c,l,n,r,u;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,c=t._decorator,l=t.Component},function(t){n=t.cocosUtil},function(t){r=t.mapModel},function(t){u=t.physicsGroup}],execute:function(){var s;o._RF.push({},"6dcb0y+mMtKdLIy4QrhMsv0","bullet10190",void 0);var i=c.ccclass;c.property,t("bullet10190",i("bullet10190")(s=function(t){function o(){for(var e,o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))||this).bullet=void 0,e.contactNotHide=!0,e}return e(o,t),o.prototype.init=function(t){var e=this;this.bullet=t;var o=this.bullet.extraObj;this.scheduleOnce((function(){e.bullet.recycleSelf(),r.bulletSystem.addBullet(o,u.MONSTER_BULLET,n.convertToWorldSpace(e.node))}),.8)},o}(l))||s);o._RF.pop()}}}));

System.register("chunks:///_virtual/bullet10200.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){"use strict";var n,e,i,o,l,c,a,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,o=t.UIOpacity,l=t.v3,c=t.Component},function(t){a=t.cocosUtil},function(t){r=t.AnimationCtrl}],execute:function(){var s;e._RF.push({},"aa3e2m2O79H3ax5qkQRjVv4","bullet10200",void 0);var u=i.ccclass;i.property,t("bullet10200",u("bullet10200")(s=function(t){function e(){for(var n,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(n=t.call.apply(t,[this].concat(i))||this).bullet=void 0,n.contactNotHide=!0,n.contactBulletTime=1,n.animationCtrl=void 0,n.shineColor="#2AA32A".parseColor(),n}return n(e,t),e.prototype.init=function(t){var n=this;this.bullet=t,this.animationCtrl=a.addComponentOnce(this,r),this.node.angle=0,this.animationCtrl.playAnimation("ani",!0),this.getComponent(o).opacity=255,this.node.scale=l(1,1,1);var e=this.bullet.extraObj;e>0&&(this.node.scale=l(e,e,1)),this.scheduleOnce((function(){a.tweenFadeOut(n.node,1,(function(){n.bullet.recycleSelf()}))}),2)},e}(c))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1021.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mapModel.ts","./cocosUtil.ts"],(function(t){"use strict";var e,i,o,n,c,l,s,r,a;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,n=t.v3,c=t.tween,l=t.Vec3,s=t.Component},function(t){r=t.mapModel},function(t){a=t.cocosUtil}],execute:function(){var u;i._RF.push({},"86474WEu6dJGYa5KdH3dG0s","Bullet1021",void 0);var d=o.ccclass;o.property,t("bullet1021",d("bullet1021")(u=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e.contactNotHide=!0,e.outVec3=n(0,0,0),e.direction=void 0,e.speed=1.5*-Math.PI,e}e(i,t);var o=i.prototype;return o.init=function(t){this.bullet=t;var e=this.bullet.extraObj.direction;this.direction=e;var i=this.getScale();this.node.setScale(n(i,i,1)),c(this.node).by(.6,{angle:-360}).repeatForever().start(),this.show(),this.bullet.extraObj.endCb(this.bullet)},o.getScale=function(){return 1+r.skillSystem.getSkill2RangeAddScale()},o.hide=function(t){var e=this;void 0===t&&(t=!1),t?this.bullet.recycleSelf():a.tweenScaleOut(this.node,.5,(function(){e.bullet.recycleSelf()}))},o.show=function(){var t=this.getScale();this.node.setScale(n(0,0,0)),this.node.active=!0,c(this.node).to(.5,{scale:n(t,t,1)}).start()},o.update=function(t){var e=this.speed*t;l.rotateZ(this.direction,this.direction,l.ZERO,e);var i=r.player.node.position.clone();i.add(this.direction),this.node.position=i},i}(s))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1031.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts"],(function(t){"use strict";var e,i,n,o,s,l,r,c,u;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.tween,s=t.UITransform,l=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){u=t.HintNames}],execute:function(){var a;i._RF.push({},"65e7ficzCZFhI6xxZK1d3nb","Bullet1031",void 0);var d=n.ccclass;n.property,t("bullet1031",d("bullet1031")(a=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.contactNotHide=!0,e.moveSpeed=void 0,e.yinTimeCount=void 0,e}e(i,t);var n=i.prototype;return n.init=function(t){this.bullet=t,this.moveSpeed=1200,this.yinTimeCount=0,o(this.node).by(.2,{angle:-360}).repeatForever().start()},n.update=function(t){var e=this.node.getPosition();this.moveSpeed-=30;var i=this.moveSpeed*t,n=this.bullet.direction.clone().multiplyScalar(i);if(e.add(n),this.node.setPosition(e),this.yinTimeCount+=t,this.yinTimeCount>.2){this.yinTimeCount=0;var o=this.bullet.bodyNode.getComponent(s),l={width:o.width,height:o.height};c.hintSystem.addHint(u.feiBiao,r.convertToWorldSpace(this.node),this.node.angle,l)}},n.recycleSelfEnd=function(){r.isValid(this.bullet.extraObj)&&this.bullet.extraObj.subNum()},i}(l))||a);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1041.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var e,l,o,n,r,i,s,u;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,o=t._decorator,n=t.tween,r=t.Component},function(t){i=t.cocosUtil},function(t){s=t.mapModel},function(t){u=t.physicsGroup}],execute:function(){var c;l._RF.push({},"5a38fyki0NACYwygEQJj3a1","Bullet1041",void 0);var a=o.ccclass;o.property,t("bullet1041",a("bullet1041")(c=function(t){function l(){for(var e,l=arguments.length,o=new Array(l),n=0;n<l;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e}return e(l,t),l.prototype.init=function(t){var e=this;this.bullet=t,this.node.angle=0,n(this.node).by(.6,{angle:-360}).repeatForever().start();var l=this.bullet.extraObj.targetPos;n(this.node).to(.6,{position:l},{easing:"quadOut"}).call((function(){e.bullet.recycleSelf(),s.bulletSystem.addBullet(e.bullet.id+1,u.PLAYER_BULLET,i.convertToWorldSpace(e.node),null,e.bullet.extraObj.time)})).start()},l}(r))||c);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1042.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mapModel.ts"],(function(t){"use strict";var e,l,n,o,c,r,i;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,n=t._decorator,o=t.v3,c=t.tween,r=t.Component},function(t){i=t.mapModel}],execute:function(){var s;l._RF.push({},"025b70d3+tO+537adU1A+ju","Bullet1042",void 0);var a=n.ccclass;n.property,t("bullet1042",a("bullet1042")(s=function(t){function l(){for(var e,l=arguments.length,n=new Array(l),o=0;o<l;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.contactNotHide=!0,e.contactBulletTime=.5,e.shineColor="#FF1313".parseColor(),e}e(l,t);var n=l.prototype;return n.init=function(t){var e=this;this.bullet=t,this.node.angle=0,this.node.setScale(o(.3,.3,1));var l=this.getScale();c(this.node).to(.06,{scale:o(l,l,1)}).start(),this.scheduleOnce((function(){c(e.node).to(.15,{scale:o(0,0,1)}).call((function(){e.bullet.recycleSelf()})).start()}),this.bullet.extraObj)},n.getScale=function(){return 1+i.skillSystem.getSkill2RangeAddScale()},l}(r))||s);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1051.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var e,l,c,o,s,n,i;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,c=t._decorator,o=t.Component},function(t){s=t.cocosUtil},function(t){n=t.mapModel},function(t){i=t.physicsGroup}],execute:function(){var u;l._RF.push({},"02c03wPkYNFKKQ64OmVr52/","Bullet1051",void 0);var r=c.ccclass;c.property,t("bullet1051",r("bullet1051")(u=function(t){function l(){for(var e,l=arguments.length,c=new Array(l),o=0;o<l;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))||this).bullet=void 0,e.contactNotHide=!0,e.hasScheduled=void 0,e}e(l,t);var c=l.prototype;return c.init=function(t){this.bullet=t,this.hasScheduled=!1,this.bullet.speed=this.bullet.speed*(1+n.skillSystem.getSkill2BulletSpeedAddPercent())},c.contactBegin=function(){var t=this;this.hasScheduled||(this.hasScheduled=!0,this.scheduleOnce((function(){t.bullet.recycleSelf(),n.bulletSystem.addBullet(t.bullet.id+1,i.PLAYER_BULLET,s.convertToWorldSpace(t.node))}),.15))},l}(o))||u);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1052.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./AnimationCtrl.ts"],(function(t){"use strict";var n,i,e,l,o,c,r;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,e=t._decorator,l=t.Component},function(t){o=t.cocosUtil},function(t){c=t.mapModel},function(t){r=t.AnimationCtrl}],execute:function(){var a;i._RF.push({},"14e52wxr7ZGTpJHd3wViPI2","Bullet1052",void 0);var s=e.ccclass;e.property,t("bullet1052",s("bullet1052")(a=function(t){function i(){for(var n,i=arguments.length,e=new Array(i),l=0;l<i;l++)e[l]=arguments[l];return(n=t.call.apply(t,[this].concat(e))||this).bullet=void 0,n.contactNotHide=!0,n.contactBulletTime=6,n.animationCtrl=void 0,n}return n(i,t),i.prototype.init=function(t){var n=this;this.bullet=t,this.node.angle=0,this.animationCtrl=o.addComponentOnce(this,r);var i=this.bullet.atk*(1+c.skillSystem.getSkill2AtkAddPercent());this.bullet.atk=Math.floor(i),this.animationCtrl.playAnimationOnce("ani",(function(){n.bullet.recycleSelf()}))},i}(l))||a);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1061.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts"],(function(e){"use strict";var t,i,l,n,o,r,s,c,a;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,l=e._decorator,n=e.tween,o=e.Vec3,r=e.Component},function(e){s=e.cocosUtil},function(e){c=e.utilTools},function(e){a=e.mapModel}],execute:function(){var u;i._RF.push({},"b6cefy75lZGXpoB4YkWctUm","Bullet1061",void 0);var f=l.ccclass;l.property,e("bullet1061",f("bullet1061")(u=function(e){function i(){for(var t,i=arguments.length,l=new Array(i),n=0;n<i;n++)l[n]=arguments[n];return(t=e.call.apply(e,[this].concat(l))||this).bullet=void 0,t.contactNotHide=!0,t.outScreenNotRecycle=!0,t.isOutScreenReflex=void 0,t}t(i,e);var l=i.prototype;return l.init=function(e){var t=this;this.bullet=e,this.isOutScreenReflex=!1,s.tweenScaleIn(this.node,.5),n(this.node).by(.6,{angle:360}).repeatForever().start(),this.scheduleOnce((function(){s.tweenScaleOut(t.node,.5,(function(){t.bullet.recycleSelf()}))}),this.bullet.extraObj.time)},l.contactBegin=function(){if(!this.isOutScreenReflex){var e=this.bullet.direction.negative(),t=c.angleToRadian(60);t=c.getFloatValue(-t,t),o.rotateZ(e,e,o.ZERO,t),this.bullet.setDirection(e)}},l.mirrorReflex=function(e,t){void 0===t&&(t=!1),this.isOutScreenReflex&&!t||(this.isOutScreenReflex=!0,e?this.bullet.direction.x*=-1:this.bullet.direction.y*=-1)},l.outScreenX=function(e,t){return Math.abs(t.x-e.x)>=a.visibleHalfSize.width},l.outScreenY=function(e,t){return Math.abs(t.y-e.y)>=a.visibleHalfSize.height},l.outWallX=function(e){return!!a.mapSystem.wallLayer.active&&(e.x>=a.mapSystem.wallRightVal||e.x<=a.mapSystem.wallLeftVal)},l.outWallY=function(e){return!!a.mapSystem.wallLayer.active&&(e.y>=a.mapSystem.wallTopVal||e.y<=a.mapSystem.wallBottomVal)},l.update=function(e){var t=a.player.node.position,i=this.node.position;this.outScreenX(i,t)?this.mirrorReflex(!0):this.outWallX(i)?this.mirrorReflex(!0,!0):this.outScreenY(i,t)?this.mirrorReflex(!1):this.outWallY(i)?this.mirrorReflex(!1,!0):this.isOutScreenReflex=!1},l.recycleSelfEnd=function(){s.isValid(this.bullet.extraObj.invokeClass)&&this.bullet.extraObj.invokeClass.subNum()},i}(r))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1071.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./mapModel.ts"],(function(t){"use strict";var e,o,n,l,i,a,r,s,c,u,d,p,h;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,l=t.Tween,i=t.UIOpacity,a=t.tween,r=t.find,s=t.v3,c=t.Component},function(t){u=t.cocosUtil},function(t){d=t.utilTools},function(t){p=t.constants},function(t){h=t.mapModel}],execute:function(){var f;o._RF.push({},"927fdRjIC5PqoToDG6jaxe2","Bullet1071",void 0);var v=n.ccclass;n.property,t("bullet1071",v("bullet1071")(f=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),l=0;l<o;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.contactNotHide=!0,e.contactBulletTime=1,e.lv=void 0,e.shineColor=void 0,e}e(o,t);var n=o.prototype;return n.init=function(t){var e=this;this.bullet=t,this.node.angle=0;var o=this.bullet.extraObj.lv;this.lv=o;var n="#22D600".parseColor();o==p.design.maxLv&&(n="#FF00F5".parseColor()),this.shineColor=n,this.initScale(),l.stopAllByTarget(this.bullet.bodyNode);var c=this.bullet.bodyNode.getComponent(i);c.opacity=0,a(c).to(2,{opacity:255}).start(),u.setRenderableColor(this.bullet.bodyNode,n);var h=r("frameLayer",this.node);u.setRenderableColor(h,n),l.stopAllByTarget(h),this.scheduleOnce((function(){a(h).call((function(){h.getComponent(i).opacity=255,h.angle=360*Math.random()})).to(1,{scale:s(1,1,1)},{onUpdate:function(t,e){h.getComponent(i).opacity=255*(1-.7*e)}}).union().repeatForever().start()})),d.forArr(h.children,(function(t,o){t.active=!1,u.setRenderableColor(t,n),l.stopAllByTarget(t),e.scheduleOnce((function(){a(t).call((function(){t.active=!0,t.scale=s(0,0,1),t.getComponent(i).opacity=255,t.angle=360*Math.random()})).to(3.2,{scale:s(.8,.8,1)}).to(.8,{scale:s(1,1,1)},{onUpdate:function(e,o){t.getComponent(i).opacity=255*(1-o)}}).union().repeatForever().start()}),.8*o*1.25)})),this.bullet.extraObj.endCb(this)},n.initScale=function(){var t=.8+.4*this.lv;t+=h.skillSystem.getSkill2RangeAddScale(),this.node.scale=s(t,t,1)},n.update=function(){var t=h.player.node.getPosition();this.node.setPosition(t)},n.recycleSelfEnd=function(){this.unscheduleAllCallbacks(),d.forArr(r("frameLayer",this.node).children,(function(t){l.stopAllByTarget(t)}))},o}(c))||f);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1081.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){"use strict";var n,i,o,e,l,c;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,e=t.Component},function(t){l=t.cocosUtil},function(t){c=t.AnimationCtrl}],execute:function(){var r;i._RF.push({},"22c20Yw0epFZpdqi8kryqCu","Bullet1081",void 0);var a=o.ccclass;o.property,t("bullet1081",a("bullet1081")(r=function(t){function i(){for(var n,i=arguments.length,o=new Array(i),e=0;e<i;e++)o[e]=arguments[e];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n.contactNotHide=!0,n.animationCtrl=void 0,n}return n(i,t),i.prototype.init=function(t){var n=this;this.bullet=t,this.node.angle=0,this.animationCtrl=l.addComponentOnce(this,c),this.animationCtrl.playAnimationOnce("ani",(function(){n.bullet.recycleSelf()}))},i}(e))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1091.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts"],(function(t){"use strict";var e,l,i,r,s,o;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,i=t._decorator,r=t.Component},function(t){s=t.cocosUtil},function(t){o=t.mapModel}],execute:function(){var n;l._RF.push({},"fc0ebvS2jlKk7UPVC1qONrd","Bullet1091",void 0);var u=i.ccclass;i.property,t("bullet1091",u("bullet1091")(n=function(t){function l(){for(var e,l=arguments.length,i=new Array(l),r=0;r<l;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.contactNotHide=!0,e.outScreenNotRecycle=!0,e.isOutScreenReflex=void 0,e}e(l,t);var i=l.prototype;return i.init=function(t){var e=this;this.bullet=t,this.isOutScreenReflex=!1,this.bullet.speed=this.bullet.speed*(1+o.skillSystem.getSkill2BulletSpeedAddPercent());var l=this.bullet.atk*(1+o.skillSystem.getSkill2AtkAddPercent());this.bullet.atk=Math.floor(l),this.scheduleOnce((function(){e.bullet.recycleSelf()}),this.bullet.extraObj.time)},i.mirrorReflex=function(t,e){void 0===e&&(e=!1),this.isOutScreenReflex&&!e||(this.isOutScreenReflex=!0,t?this.bullet.direction.x*=-1:this.bullet.direction.y*=-1)},i.outScreenX=function(t,e){return Math.abs(e.x-t.x)>=o.visibleHalfSize.width},i.outScreenY=function(t,e){return Math.abs(e.y-t.y)>=o.visibleHalfSize.height},i.outWallX=function(t){return!!o.mapSystem.wallLayer.active&&(t.x>=o.mapSystem.wallRightVal||t.x<=o.mapSystem.wallLeftVal)},i.outWallY=function(t){return!!o.mapSystem.wallLayer.active&&(t.y>=o.mapSystem.wallTopVal||t.y<=o.mapSystem.wallBottomVal)},i.update=function(t){var e=o.player.node.getPosition(),l=this.node.getPosition();this.outScreenX(l,e)?this.mirrorReflex(!0):this.outWallX(l)?this.mirrorReflex(!0,!0):this.outScreenY(l,e)?this.mirrorReflex(!1):this.outWallY(l)?this.mirrorReflex(!1,!0):this.isOutScreenReflex=!1},i.recycleSelfEnd=function(){s.isValid(this.bullet.extraObj.invokeClass)&&this.bullet.extraObj.invokeClass.subNum()},l}(r))||n);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1101.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var e,i,n,o,s,a,r,l,h,d,c,u,p,v;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.tween,s=t.v3,a=t.Tween,r=t.macro,l=t.Vec3,h=t.Vec2,d=t.Component},function(t){c=t.cocosUtil},function(t){u=t.utilTools},function(t){p=t.mapModel},function(t){v=t.physicsGroup}],execute:function(){var y;i._RF.push({},"75d79Ach4RMub5Zg6PHH5wP","Bullet1101",void 0);var P=n.ccclass;n.property,t("bullet1101",P("bullet1101")(y=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.hasTweenPlay=!1,e.outScreenNotRecycle=!0,e.lv=void 0,e.targetDis=260,e.radianSpeed=void 0,e.radian=void 0,e.shotTimeCount=void 0,e}e(i,t);var n=i.prototype;return n.init=function(t){this.bullet=t,this.node.angle=0,this.radianSpeed=0,this.setUpDownTween(!0);var e=p.player.node.getPosition();e.x+=80,e.y+=80,this.node.setPosition(e),this.lv=this.bullet.extraObj.lv,this.bullet.extraObj.endCb(this)},n.setUpDownTween=function(t){t?this.hasTweenPlay||(this.hasTweenPlay=!0,o(this.node).by(1,{position:s(0,20,0)}).by(1,{position:s(0,-20,0)}).union().repeatForever().start()):this.hasTweenPlay&&(this.hasTweenPlay=!1,a.stopAllByTarget(this.node))},n.startShot=function(t){var e=this;this.radianSpeed=2*Math.PI/t,this.radian=Math.random()*Math.PI*2,this.schedule(this.shot,.1-.01*this.lv,r.REPEAT_FOREVER),this.scheduleOnce((function(){e.radianSpeed=0,e.unschedule(e.shot)}),t)},n.shot=function(){var t=s(this.targetDis+50*(Math.random()-.5),0,0);l.rotateZ(t,t,l.ZERO,this.radian+(Math.random()-.5)*u.angleToRadian(20));var e=p.player.node.getPosition().add(t),i=e.clone().subtract(this.node.getPosition()),n=(Math.random()-.5)*u.angleToRadian(180);l.rotateZ(i,i,l.ZERO,n),p.bulletSystem.addBullet(this.bullet.id+1,v.PLAYER_BULLET,c.convertToWorldSpace(this.node),i,e)},n.update=function(t){var e=this.node.getPosition(),i=p.player.node.getPosition();e.x>i.x?this.node.scale=s(-1,1,1):this.node.scale=s(1,1,1),i.x+=80,i.y+=80;var n=0,o=h.distance(e,i);if(o>5){n=2*o;var a=1.5*p.player.getMoveSpeed();n>a&&(n=a)}if(this.hasTweenPlay&&o<=30&&(n=0),n>0){this.setUpDownTween(!1);var r=i.subtract(e).normalize();r.multiplyScalar(t*n),e.add(r),this.node.setPosition(e)}else this.setUpDownTween(!0);this.radianSpeed>0&&(this.radian-=this.radianSpeed*t)},i}(d))||y);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1102.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){"use strict";var e,i,o,n,l,s,c,r,u,a;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,n=t.Vec2,l=t.macro,s=t.Component},function(t){c=t.cocosUtil},function(t){r=t.mapModel},function(t){u=t.physicsGroup},function(t){a=t.HintNames}],execute:function(){var h;i._RF.push({},"abffdk5IzhFA42U89k/78pc","Bullet1102",void 0);var d=o.ccclass;o.property,t("bullet1102",d("bullet1102")(h=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e.outScreenNotRecycle=!0,e.targetPos=void 0,e.hint=void 0,e}e(i,t);var o=i.prototype;return o.init=function(t){var e=this;this.bullet=t,this.targetPos=this.bullet.extraObj,this.hint=null,this.scheduleOnce((function(){e.bullet.isFollow=!0,e.bullet.rotateSpeed=6*Math.PI}),.02+.02*Math.random()),r.hintSystem.addHint(a.targetPos2,c.convertToWorldSpaceWithPos(this.node,this.targetPos),0,(function(t){c.isValid(e)&&e.node.activeInHierarchy?e.hint=t:t.recycleSelf()})),this.schedule((function(t){var i=e.bullet.speed;(i-=20)<200&&(i=200),e.bullet.speed=i,n.distance(e.targetPos,e.node.getPosition())<=100&&e.arriveTargetPos()}),.1,l.REPEAT_FOREVER)},o.arriveTargetPos=function(){this.bullet.recycleSelf(),c.isValid(this.hint)&&this.hint.hint.recycleSelf(),r.bulletSystem.addBullet(this.bullet.id+1,u.PLAYER_BULLET,c.convertToWorldSpace(this.node))},i}(s))||h);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1103.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){"use strict";var n,i,o,e,l,c;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,e=t.Component},function(t){l=t.cocosUtil},function(t){c=t.AnimationCtrl}],execute:function(){var r;i._RF.push({},"9f56bUVxilGH5JfDJDIaJwR","Bullet1103",void 0);var a=o.ccclass;o.property,t("bullet1103",a("bullet1103")(r=function(t){function i(){for(var n,i=arguments.length,o=new Array(i),e=0;e<i;e++)o[e]=arguments[e];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n.contactNotHide=!0,n.contactBulletTime=6,n.animationCtrl=void 0,n}return n(i,t),i.prototype.init=function(t){var n=this;this.bullet=t,this.node.angle=0,this.animationCtrl=l.addComponentOnce(this,c),this.animationCtrl.playAnimationOnce("ani",(function(){n.bullet.recycleSelf()}))},i}(e))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet1111.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var e,i,o,n,s,l,a,r,c,u,d,h,v;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,n=t.find,s=t.macro,l=t.tween,a=t.v3,r=t.Tween,c=t.Component},function(t){u=t.cocosUtil},function(t){d=t.utilTools},function(t){h=t.mapModel},function(t){v=t.physicsGroup}],execute:function(){var f;i._RF.push({},"172fbeXC0lJAon7qOYqvGpI","Bullet1111",void 0);var p=o.ccclass;o.property,t("bullet1111",p("bullet1111")(f=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e.hasTweenPlay=!1,e.outScreenNotRecycle=!0,e.lv=void 0,e.targetDis=260,e.radianSpeed=void 0,e.radian=void 0,e.shotTimeCount=void 0,e.timeCount=void 0,e.atkCd=void 0,e.direction=void 0,e.targetNode=void 0,e.fireNode=void 0,e.fireAtk=void 0,e}e(i,t);var o=i.prototype;return o.init=function(t){var e=this;this.bullet=t,this.fireNode=n("fire",this.node),this.node.angle=0,this.radianSpeed=0,this.timeCount=0,u.tweenScaleIn(this.node,.5),this.setUpDownTween(!0),this.lv=this.bullet.extraObj.lv,this.fireAtk=this.bullet.extraObj.atk,this.scheduleOnce((function(){u.tweenScaleOut(e.node,.5,(function(){e.bullet.recycleSelf()}))}),this.bullet.extraObj.time),this.schedule((function(){e.shot()}),this.bullet.extraObj.atkCd,s.REPEAT_FOREVER,0)},o.setUpDownTween=function(t){t?this.hasTweenPlay||(this.hasTweenPlay=!0,l(this.node).to(.3,{scale:a(.9,1.1,1)}).to(.5,{scale:a(1.2,.89,1)}).union().repeatForever().start()):this.hasTweenPlay&&(this.hasTweenPlay=!1,r.stopAllByTarget(this.node))},o.shot=function(){var t={atk:this.fireAtk};h.bulletSystem.addBullet(this.bullet.id+1,v.PLAYER_BULLET,u.convertToWorldSpace(this.fireNode),this.direction,t)},o.update=function(t){var e=h.mapSystem.getMinDisTargetNode(this.node.position);if(e){this.targetNode=e;var i=u.convertToWorldSpace(this.node),o=u.convertToWorldSpace(e);o.subtract(i),this.direction=o;d.radianToAngle(Math.atan2(o.y,o.x));this.node.angle=0}},o.recycleSelfEnd=function(){u.isValid(this.bullet.extraObj.invokeClass)&&this.bullet.extraObj.invokeClass.subNum()},i}(c))||f);i._RF.pop()}}}));

System.register("chunks:///_virtual/bullet1112.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,l,r,n;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,r=t._decorator,n=t.Component}],execute:function(){var o;l._RF.push({},"de7cdAu3zRAcoo5jeqrQ4CR","bullet1112",void 0);var u=r.ccclass;r.property,t("bullet1112",u("bullet1112")(o=function(t){function l(){for(var e,l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))||this).bullet=void 0,e}return e(l,t),l.prototype.init=function(t){this.bullet=t,this.bullet.atk=this.bullet.extraObj.atk},l}(n))||o);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet12.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,r,n,l,o;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,l=t.tween,o=t.Component}],execute:function(){var u;r._RF.push({},"a2151oUN3xParIX0Hp7FqxX","Bullet12",void 0);var c=n.ccclass;n.property,t("bullet12",c("bullet12")(u=function(t){function r(){for(var e,r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e}return e(r,t),r.prototype.init=function(t){this.bullet=t,l(this.bullet.node).by(4,{angle:-360}).repeatForever().start()},r}(o))||u);r._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet13.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){"use strict";var e,l,o,n,i,s,u,c,r,a;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,o=t._decorator,n=t.Vec2,i=t.tween,s=t.Component},function(t){u=t.cocosUtil},function(t){c=t.mapModel},function(t){r=t.physicsGroup},function(t){a=t.HintNames}],execute:function(){var d;l._RF.push({},"aede7nqKw5NJo4zrdexd5GL","Bullet13",void 0);var p=o.ccclass;o.property,t("bullet13",p("bullet13")(d=function(t){function l(){for(var e,l=arguments.length,o=new Array(l),n=0;n<l;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e.moveStop=void 0,e.bulletId=1010,e}return e(l,t),l.prototype.init=function(t){var e=this;this.bullet=t,this.moveStop=!0,this.bullet.node.angle=0;var l=this.bullet.extraObj,o=n.distance(this.bullet.node.getPosition(),l)/this.bullet.speed;i(this.bullet.node).by(o,{angle:360}).start(),i(this.bullet.node).to(o,{position:l}).call((function(){e.bullet.recycleSelf(),c.bulletSystem.addBullet(e.bulletId,r.MONSTER_BULLET,u.convertToWorldSpace(e.bullet.node))})).start(),c.hintSystem.addHint(a.targetPos,u.convertToWorldSpaceWithPos(this.bullet.node,l),0,o)},l}(s))||d);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet14.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){"use strict";var e,l,i,o,n,r,s,c,u;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,i=t._decorator,o=t.UIOpacity,n=t.Tween,r=t.tween,s=t.Component},function(t){c=t.cocosUtil},function(t){u=t.AnimationCtrl}],execute:function(){var a;l._RF.push({},"97454HzNdZJp7Cr1EZrtpWC","Bullet14",void 0);var h=i.ccclass;i.property,t("bullet14",h("bullet14")(a=function(t){function l(){for(var e,l=arguments.length,i=new Array(l),o=0;o<l;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.moveStop=void 0,e.contactNotHide=!0,e.aniCtrl=void 0,e}e(l,t);var i=l.prototype;return i.init=function(t){var e=this;this.bullet=t,this.moveStop=!0,this.bullet.node.angle=0;var l=this.bullet.getComponent(o);l&&(l.opacity=255),this.aniCtrl||(this.aniCtrl=this.bullet.addComponent(u)),this.aniCtrl.playAnimation("bashou",!0,(function(){e.startColliderAni()})),this.startColliderAni(),this.scheduleOnce((function(){c.tweenFadeOut(e.bullet.node,1,(function(){e.bullet.recycleSelf()}))}),2.6)},i.startColliderAni=function(){n.stopAllByTarget(this.bullet.collider.size),n.stopAllByTarget(this.bullet.collider.offset),this.bullet.collider.size.width=80,this.bullet.collider.size.height=80,this.bullet.collider.offset.y=0,r(this.bullet.collider.size).delay(.55).to(.05,{width:500,height:180}).delay(.3).to(.05,{width:80,height:80}).start(),r(this.bullet.collider.offset).delay(.55).to(.05,{y:-30}).delay(.3).to(.05,{y:0}).start()},l}(s))||a);l._RF.pop()}}}));

System.register("chunks:///_virtual/bullet16.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,r,c,n;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,c=t._decorator,n=t.Component}],execute:function(){var o;r._RF.push({},"dc488f7X8pJQJKa5fAURiPt","bullet16",void 0);var l=c.ccclass;c.property,t("bullet16",l("bullet16")(o=function(t){function r(){for(var e,r=arguments.length,c=new Array(r),n=0;n<r;n++)c[n]=arguments[n];return(e=t.call.apply(t,[this].concat(c))||this).bullet=void 0,e.contactNotHide=!0,e}return e(r,t),r}(n))||o);r._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet17.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mapModel.ts","./AnimationCtrl.ts"],(function(t){"use strict";var e,l,n,o,i,c;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,n=t._decorator,o=t.Component},function(t){i=t.mapModel},function(t){c=t.AnimationCtrl}],execute:function(){var u;l._RF.push({},"cfb425XKhxK+pvFspil2GnJ","Bullet17",void 0);var r=n.ccclass;n.property,t("bullet17",r("bullet17")(u=function(t){function l(){for(var e,l=arguments.length,n=new Array(l),o=0;o<l;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.moveStop=!0,e.contactNotHide=!0,e}return e(l,t),l.prototype.init=function(t){var e=this;this.bullet=t,this.bullet.collider.enabled=!1,this.scheduleOnce((function(){e.bullet.collider.enabled=!0}),.2),this.bullet.node.angle=this.bullet.extraObj,this.addComponent(c).playAnimation("2",!1,(function(){i.bulletSystem.recycleBulletNode(e.node)}))},l}(o))||u);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet18.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){"use strict";var n,o,i,e,l,c;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,e=t.Component},function(t){l=t.cocosUtil},function(t){c=t.AnimationCtrl}],execute:function(){var r;o._RF.push({},"b18c8bZJTRLvbjF/wPbnPu+","Bullet18",void 0);var u=i.ccclass;i.property,t("bullet18",u("bullet18")(r=function(t){function o(){for(var n,o=arguments.length,i=new Array(o),e=0;e<o;e++)i[e]=arguments[e];return(n=t.call.apply(t,[this].concat(i))||this).bullet=void 0,n.moveStop=void 0,n.contactNotHide=!0,n.aniCtrl=void 0,n}return n(o,t),o.prototype.init=function(t){var n=this;this.bullet=t,this.moveStop=!0,this.bullet.node.angle=0,this.aniCtrl=l.addComponentOnce(this,c),this.aniCtrl.playAnimation("3",!1,(function(){n.bullet.recycleSelf()}))},o}(e))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet19.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){"use strict";var e,l,n,i,o,c,r;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,n=t._decorator,i=t.v3,o=t.Component},function(t){c=t.cocosUtil},function(t){r=t.AnimationCtrl}],execute:function(){var s;l._RF.push({},"3ef6cc1Z8JHaoCfBKN/yXYy","Bullet19",void 0);var u=n.ccclass;n.property,t("bullet19",u("bullet19")(s=function(t){function l(){for(var e,l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e.moveStop=void 0,e.contactNotHide=!0,e.aniCtrl=void 0,e}return e(l,t),l.prototype.init=function(t){var e=this;this.bullet=t,this.moveStop=!0,this.bullet.node.angle=0,this.bullet.collider.enabled=!1;var l=1;this.bullet.extraObj&&this.bullet.extraObj.scale>0&&(l=this.bullet.extraObj.scale),this.node.setScale(i(l,l,1)),this.scheduleOnce((function(){e.bullet.collider.enabled=!0}),.1),this.aniCtrl=c.addComponentOnce(this,r),this.aniCtrl.playAnimation("4",!1,(function(){e.bullet.recycleSelf()}))},l}(o))||s);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet20.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,o,i,l,n,r;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,l=t.find,n=t.UITransform,r=t.Component}],execute:function(){var c;o._RF.push({},"c4b50kNRxxIBJ12K6I74FHo","Bullet20",void 0);var s=i.ccclass;i.property,t("bullet20",s("bullet20")(c=function(t){function o(){for(var e,o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.moveStop=!0,e.contactNotHide=!0,e.contactBulletTime=1,e.bodyNodeTf=void 0,e.aniCtrl=void 0,e}e(o,t);var i=o.prototype;return i.init=function(t){this.bullet=t,this.bodyNodeTf=l("body",this.node).getComponent(n),this.bullet.extraObj.invokeClass(t)},i.setBodyWidth=function(t){this.bodyNodeTf.width=t,this.bullet.collider.size.width=t-15,this.bullet.collider.offset.x=.5*(t-15)-13},o}(r))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet21.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,o,i,l,n,r;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,l=t.find,n=t.UITransform,r=t.Component}],execute:function(){var s;o._RF.push({},"52be2gmUGBPe6z6QYqIIW/I","Bullet21",void 0);var c=i.ccclass;i.property,t("bullet21",c("bullet21")(s=function(t){function o(){for(var e,o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.moveStop=!0,e.contactNotHide=!0,e.contactBulletTime=1,e.bodyNodeTf=void 0,e.aniCtrl=void 0,e}e(o,t);var i=o.prototype;return i.init=function(t){this.bullet=t,this.bodyNodeTf=l("body",this.node).getComponent(n),this.bullet.extraObj.invokeClass(t)},i.setBodyWidth=function(t){this.bodyNodeTf.width=t,this.bullet.collider.size.width=t-15,this.bullet.collider.offset.x=.5*(t-15)-24},o}(r))||s);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet22.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var n,e,o,i,r,l;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.find,r=t.Animation,l=t.Component}],execute:function(){var c;e._RF.push({},"2dfabYDvF5NxLn0MN4pRg1w","Bullet22",void 0);var u=o.ccclass;o.property,t("bullet22",u("bullet22")(c=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).bullet=void 0,n.contactNotHide=!0,n}return n(e,t),e.prototype.init=function(t){this.bullet=t,i("body",this.node).getComponent(r).play("ani")},e}(l))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet4.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts"],(function(t){"use strict";var e,n,o,l,c,i,u;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,l=t.Component},function(t){c=t.cocosUtil},function(t){i=t.mapModel},function(t){u=t.HintNames}],execute:function(){var s;n._RF.push({},"ae144wlNA9LuIlwcq3kyMDY","Bullet4",void 0);var r=o.ccclass;o.property,t("bullet4",r("bullet4")(s=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))||this).bullet=void 0,e}e(n,t);var o=n.prototype;return o.init=function(t){var e=this;this.bullet=t,this.bullet.rotateSpeed=Math.PI,this.scheduleOnce((function(){e.bullet.isFollow=!0}),.3),this.scheduleOnce((function(){e.bullet.isFollow=!1}),3)},o.contactBegin=function(t){i.hintSystem.addHint(u.hit2,c.convertToWorldSpace(this.bullet.node))},n}(l))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet5.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var e,l,i,o,n,c,u,r,s,a,d,h;return{setters:[function(t){e=t.inheritsLoose},function(t){l=t.cclegacy,i=t._decorator,o=t.v3,n=t.UIOpacity,c=t.tween,u=t.macro,r=t.Vec3,s=t.Component},function(t){a=t.cocosUtil},function(t){d=t.mapModel},function(t){h=t.physicsGroup}],execute:function(){var p;l._RF.push({},"cd56afYd4RCRrD+B541mM04","Bullet5",void 0);var b=i.ccclass;i.property,t("bullet5",b("bullet5")(p=function(t){function l(){for(var e,l=arguments.length,i=new Array(l),o=0;o<l;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.contactNotHide=!0,e.moveStop=!1,e.direction1=void 0,e.direction2=void 0,e.bulletId=1005,e.turnSpeed=Math.PI/3,e}e(l,t);var i=l.prototype;return i.init=function(t){var e=this;this.bullet=t,this.bullet.node.setScale(o(1,1,1));var l=this.bullet.getComponent(n);l&&(l.opacity=255),this.moveStop=!0;var i=200;this.bullet.direction.x<0&&(i=-i),c(this.bullet.node).by(.3,{position:o(i,0,0)},{easing:"quadOut"}).call((function(){e.moveStop=!1,e.bullet.direction=d.player.node.getPosition().subtract(e.bullet.node.getPosition()).normalize(),a.tweenBlink(e.bullet.node,.5),e.direction1=o(0,1,0),e.direction2=o(0,-1,0),e.schedule(e.createSmallBullet,.2,u.REPEAT_FOREVER)})).start(),this.scheduleOnce((function(){e.unschedule(e.createSmallBullet),a.tweenScaleOut(e.bullet.node,.2,(function(){e.bullet.recycleSelf()}))}),6)},i.createSmallBullet=function(t){var e=t*this.turnSpeed,l=a.convertToWorldSpace(this.bullet.node);r.rotateZ(this.direction1,this.direction1,r.ZERO,e),d.bulletSystem.addBullet(this.bulletId,h.MONSTER_BULLET,l,this.direction1),r.rotateZ(this.direction2,this.direction2,r.ZERO,e),d.bulletSystem.addBullet(this.bulletId,h.MONSTER_BULLET,l,this.direction2)},l}(s))||p);l._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet6.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,r,n,l,o;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,l=t.tween,o=t.Component}],execute:function(){var u;r._RF.push({},"fa5eb6DaCBL0aeL+J9waOT1","Bullet6",void 0);var c=n.ccclass;n.property,t("bullet6",c("bullet6")(u=function(t){function r(){for(var e,r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))||this).bullet=void 0,e}return e(r,t),r.prototype.init=function(t){this.bullet=t,l(this.bullet.node).by(.5,{angle:-360}).repeatForever().start()},r}(o))||u);r._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet8.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts","./mapModel.ts"],(function(t){"use strict";var e,o,i,n,l,s,a,u,r,c;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,n=t.find,l=t.Vec2,s=t.UITransform,a=t.BoxCollider2D,u=t.Component},function(t){r=t.utilTools},function(t){c=t.mapModel}],execute:function(){var d;o._RF.push({},"d1442W07IpCMqaQMACJmBoZ","Bullet8",void 0);var h=i.ccclass;i.property,t("bullet8",h("bullet8")(d=function(t){function o(){for(var e,o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];return(e=t.call.apply(t,[this].concat(i))||this).bullet=void 0,e.contactNotHide=!0,e.moveStop=!1,e.bodyNode=void 0,e.heightWidthRatio=207/440,e.maxFollowDis=600,e}e(o,t);var i=o.prototype;return i.init=function(t){var e=this;this.bullet=t,this.moveStop=!0,this.bodyNode=n("body",this.bullet.node),this.updateAngleAndDis(),this.scheduleOnce((function(){e.bullet.recycleSelf()}),2.3)},i.updateAngleAndDis=function(){var t=this.bullet.getFacePlayerDirection(),e=r.radianToAngle(Math.atan2(t.y,t.x));this.bullet.node.angle=e;var o=l.distance(this.bullet.node.getPosition(),c.player.node.getPosition())+40;o>this.maxFollowDis&&(o=this.maxFollowDis),this.bodyNode.getComponent(s).width=o,this.bodyNode.getComponent(s).height=this.heightWidthRatio*o,this.bullet.getComponent(a).offset.x=o-50},i.update=function(t){this.updateAngleAndDis()},o}(u))||d);o._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet9.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){"use strict";var e,o,l,n,i,c,s,u,r,a,d,p;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,l=t._decorator,n=t.v3,i=t.tween,c=t.Vec2,s=t.Component},function(t){u=t.cocosUtil},function(t){r=t.utilTools},function(t){a=t.mapModel},function(t){d=t.physicsGroup},function(t){p=t.HintNames}],execute:function(){var f;o._RF.push({},"9af4fCsYKhK9q9CNw1YrS3I","Bullet9",void 0);var b=l.ccclass;l.property,t("bullet9",b("bullet9")(f=function(t){function o(){for(var e,o=arguments.length,l=new Array(o),n=0;n<o;n++)l[n]=arguments[n];return(e=t.call.apply(t,[this].concat(l))||this).bullet=void 0,e.moveStop=!1,e.contactNotHide=!0,e.bulletId=1008,e.timeCount=0,e}return e(o,t),o.prototype.init=function(t){var e=this;this.bullet=t,this.timeCount=0,this.moveStop=!0;this.bullet.node.setScale(n(.1,.1,1)),i(this.bullet.node).to(.7,{scale:n(1.5,1.5,1)}).start(),this.scheduleOnce((function(){e.bullet.direction=e.bullet.getFacePlayerDirection().normalize();var t=a.player.node.getPosition(),o=c.distance(t,e.bullet.node.getPosition())/e.bullet.speed;i(e.bullet.node).to(o,{position:t}).call((function(){e.bullet.recycleSelf();var t=e.bullet.node.getPosition(),o=u.getCircleDirectionArr(10);t=u.convertToWorldSpaceWithPos(e.bullet.node,t),r.forArr(o,(function(o){a.bulletSystem.addBullet(e.bulletId,d.MONSTER_BULLET,t,o)})),a.hintSystem.addHint(p.boom1,t)})).start()}),.7)},o}(s))||f);o._RF.pop()}}}));

System.register("chunks:///_virtual/BulletSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./resManager.ts","./mapModel.ts","./physicsGroup.ts","./BaseLayer.ts","./NodePoolUtil.ts","./Bullet.ts"],(function(e){"use strict";var t,n,r,o,l,i,a,u,s,c,d,f,b,y,p,h,B,g,L;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){o=e.cclegacy,l=e._decorator,i=e.find,a=e.Node,u=e.UITransform,s=e.Prefab},function(e){c=e.cocosUtil},function(e){d=e.utilTools},function(e){f=e.constants},function(e){b=e.designManager},function(e){y=e.resManager},function(e){p=e.mapModel},function(e){h=e.physicsGroup},function(e){B=e.BaseLayer},function(e){g=e.NodePoolUtil},function(e){L=e.Bullet}],execute:function(){var m;o._RF.push({},"9db09W/rHhFgJ7o4TJVZW7b","BulletSystem",void 0);var v=l.ccclass;l.property,e("BulletSystem",v("BulletSystem")(m=function(e){function o(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).idBulletLayerObj={},t.bulletLayer=void 0,t.bulletLayer2=void 0,t.waitAddArr=[],t}t(o,e);var l=o.prototype;return l.onLoad=function(){e.prototype.onLoad.call(this),this.bulletLayer=this.node,this.bulletLayer2=i("bulletLayer2",this.node.parent)},l.onEnable=function(){e.prototype.onEnable.call(this)},l.onDestroy=function(){e.prototype.onDestroy.call(this)},l.getBulletLayerNameById=function(e){return"bulletLayer"+e},l.getBulletLayerById=function(e){var t=b.getRowById(f.tableName.bullet,e),n=this.idBulletLayerObj[e];if(!n){switch((n=new a(this.getBulletLayerNameById(e))).addComponent(u),n.setPosition(0,0),t.prefab){case"bullet1042":case"bullet1044":case"bullet1071":case"bullet10200":n.parent=this.bulletLayer2;break;default:n.parent=this.bulletLayer}this.idBulletLayerObj[e]=n,n.addComponent(g).init(p.bulletPrefabObj[t.prefab])}return n},l.loadBulletPrefab=function(e){return new Promise((function(t,n){y.loadAsset(f.bundles.bullet,e,s,null,(function(e,r){e?n():t(r)}))}))},l.addBullet=function(){var e=n(r().mark((function e(t,n,o,l,i){var a,u,s,d,y=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(526==t&&console.log("产生炮塔"),a=this.getBulletLayerById(t).getComponent(g),u=b.getRowById(f.tableName.bullet,t),s=function(){if(c.isValid(a)){if(a.itemNode||a.init(p.bulletPrefabObj[u.prefab]),!a.node.activeInHierarchy){var e={};return e.id=t,e.group=n,e.startWorldPos=o,e.direction=l,e.extraObj=i,void y.waitAddArr.push(e)}var r=a.getNode();c.addComponentOnce(r,L).init(t,n,o,l,i)}},p.bulletPrefabObj[u.prefab]){e.next=9;break}return e.next=7,this.loadBulletPrefab(u.prefab);case 7:d=e.sent,p.bulletPrefabObj[u.prefab]=d;case 9:s();case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,l){return e.apply(this,arguments)}}(),l.forVisibleMonsterBullet=function(e){d.forArr(this.node.children,(function(t){d.forArr(t.children,(function(t){if(t.active&&p.isInScreenVisible(t)){var n=t.getComponent(L);n.collider&&n.collider.group==h.MONSTER_BULLET&&e(n)}}))}))},l.recycleAllBulletNodeById=function(e){var t=this.getBulletLayerNameById(e),n=i(t,this.bulletLayer);n&&d.forArr(n.children,(function(e){e.getComponent(L).recycleSelf()})),(n=i(t,this.bulletLayer2))&&d.forArr(n.children,(function(e){e.getComponent(L).recycleSelf()}))},l.recycleBulletNode=function(e){var t=e.getComponent(L);this.getBulletLayerById(t.id).getComponent(g).recycleNode(e)},l.updateLogic=function(e){var t=this.waitAddArr.shift();t&&this.addBullet(t.id,t.group,t.startWorldPos,t.direction,t.extraObj)},o}(B))||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/BuyLifeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts"],(function(n){"use strict";var e,t,o,i,a,s,r,c,l,u;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,o=n._decorator},function(n){i=n.sdkManager},function(n){a=n.msgac},function(n){s=n.designManager},function(n){r=n.eventManager},function(n){c=n.playerModel},function(n){l=n.UserData},function(n){u=n.BaseLayer}],execute:function(){var f;t._RF.push({},"92b8crcdL5PUopsmiVmqHrj","BuyLifeLayer",void 0);var d=o.ccclass;o.property,n("BuyLifeLayer",d("BuyLifeLayer")(f=function(n){function t(){for(var e,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return(e=n.call.apply(n,[this].concat(o))||this).diamondNumNode=void 0,e}e(t,n);var o=t.prototype;return o.onLoad=function(){n.prototype.onLoad.call(this),this.diamondNumNode=this.getNodeByPath("ui/btns/btnDiamond/info/num"),this.isShowBannerAd=!0},o.onEnable=function(){n.prototype.onEnable.call(this),l.getInstance().mapData=null},o.onDisable=function(){n.prototype.onDisable.call(this)},o.onDestroy=function(){n.prototype.onDestroy.call(this)},o.initUI=function(){this.setString(this.diamondNumNode,"x"+s.config.backLifeDiamond)},o.onClickBtnDiamond=function(){l.getInstance().useBaoShi(-s.config.backLifeDiamond),c.skillLifeNum++,this.closeLayer(),r.send(a.mapRefreshSkill)},o.onClickBtnAd=function(){var n=this;i.openAd("购买复活",(function(e){1==e&&(c.skillLifeNum++,n.closeLayer(),r.send(a.mapRefreshSkill))}))},o.closeLayer=function(){n.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},t}(u))||f);t._RF.pop()}}}));

System.register("chunks:///_virtual/ChapterLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./sdkManager.ts","./constants.ts","./audioManager.ts","./designManager.ts","./RedPointLogicMgr.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./eventManager.ts","./msgac.ts"],(function(e){"use strict";var t,a,n,r,i,o,l,c,s,u,p,g,h,b,m,d,y,f,L,v,P,w,C,I,R;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,l=e.Node,c=e.PageView,s=e.Prefab,u=e.Label,p=e.instantiate,g=e.v3,h=e.Button,b=e.Sprite},function(e){m=e.myLog},function(e){d=e.sdkManager},function(e){y=e.constants},function(e){f=e.audioManager},function(e){L=e.designManager},function(e){v=e.RedPointLogicMgr},function(e){P=e.UserData},function(e){w=e.PropItemPrefab},function(e){C=e.BaseUILayer},function(e){I=e.eventManager},function(e){R=e.msgac}],execute:function(){var _,z,B,N,S,x,D,M,k,O,T,G,H,V,J,U,A,E,F,j,q,Y,K,Q,W;i._RF.push({},"c8f32J3vFJNJYHqJPCCaOPS","ChapterLayer",void 0);var X=o.ccclass,Z=o.property;e("ChapterLayer",(_=X("ChapterLayer"),z=Z({type:l,tooltip:"地图名字"}),B=Z({type:l,tooltip:"地图节点"}),N=Z({type:l,tooltip:"pageView"}),S=Z({type:l,tooltip:"选择按钮"}),x=Z({type:l,tooltip:"地图详情"}),D=Z({type:c,tooltip:"地图"}),M=Z({type:s,tooltip:"奖励节点"}),k=Z({type:u,tooltip:"提示1"}),O=Z({type:u,tooltip:"提示2"}),T=Z({type:l,tooltip:"单倍奖励"}),G=Z({type:l,tooltip:"双倍奖励"}),_((J=t((V=function(e){function t(){for(var t,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,n(t,"mapName",J,r(t)),n(t,"mapItem",U,r(t)),n(t,"pageContent",A,r(t)),n(t,"selectBtn",E,r(t)),n(t,"rewardLayer",F,r(t)),n(t,"mapPage",j,r(t)),n(t,"rewardItem",q,r(t)),n(t,"tishiLabel",Y,r(t)),n(t,"tishiLabel2",K,r(t)),n(t,"btn1",Q,r(t)),n(t,"btn2",W,r(t)),t._curPageId=0,t._curOpenLevel=1,t._curRewardList=[],t._curIndex=0,t}a(t,e);var i=t.prototype;return i.onLoad=function(){L.getTable(y.tableName.map);for(var e=0;e<3*P.getInstance().openLevel;e++){var t=p(this.mapItem);this.pageContent.addChild(t),t.getChildByName("timeLabel").localize({cat:y.layers.ChapterLayer,key:"timeLabel",vars:[e%3*5+5]}),t.getChildByName("chapterNum").localize({cat:y.layers.ChapterLayer,key:"chapterNum",vars:[Math.floor(e/3)+1]})}},i.start=function(){this.node.getChildByPath("Label").localize("awardTxt",y.layers.ChapterLayer);for(var e=0;e<3*P.getInstance().openLevel;e++){var t=Math.floor(e/3)+1;if(0==P.getInstance().getLevelData(t).ReceiveState[e%3])return this.mapPage.scrollToPage(e),this.setPage(e,t),void(this._curOpenLevel=t)}this.mapPage.scrollToPage(0),this.setPage(0,1)},i.getLevelByScrollIndex=function(e){return Math.floor(e/3)+1},i.setPage=function(e,t){for(var a=L.getTable(y.tableName.map),n=t,r=this.pageContent.children,i=0;i<r.length;i++){var o=r[i];o.getChildByName("light").active=i==e,o.scale=i==e?g(1,1,1):g(.8,.8,1)}this.tishiLabel.node.localize({cat:y.layers.ChapterLayer,key:"tips1",vars:[5*e+5]}),this.tishiLabel2.node.localize({cat:y.layers.ChapterLayer,key:"tips2",vars:[5*e+5]}),this._curIndex=e,this._curOpenLevel=t,this._curRewardList=a[n-1]["reward"+(e+1)],this.updateBtnState(),this.rewardLayer.removeAllChildren();for(var l=0;l<this._curRewardList.length;l++){var c=this._curRewardList[l],s=p(this.rewardItem);s.position=g(0,0,0),this.rewardLayer.addChild(s),s.getComponent(w).setView(c[0],c[1])}},i.updateBtnState=function(){var e=P.getInstance().getLevelData(this._curOpenLevel);this.btn1.getComponent(h).interactable=!1,this.btn2.getComponent(h).interactable=!1,this.btn2.getComponent(b).color=y.colors.yin.parseColor(),this.btn1.getComponent(b).color=y.colors.yin.parseColor(),this.btn2.getChildByName("Label").localize("getDouble",y.catName.common),v.ins().setRPointView(this.btn1,null,!1),e.Time>=5*(this._curIndex+1)*60?(0==e.ReceiveState[this._curIndex]?(this.btn1.getComponent(h).interactable=!0,this.btn1.getComponent(b).color=y.colors.white.parseColor(),this.btn1.getChildByName("Label").localize("get",y.catName.common),v.ins().setRPointView(this.btn1,null,!0)):this.btn1.getChildByName("Label").localize("hasGet",y.catName.common),e.ReceiveState[this._curIndex]<2&&(this.btn2.getComponent(h).interactable=!0,this.btn2.getComponent(b).color=y.colors.white.parseColor())):this.btn1.getChildByName("Label").localize("get",y.catName.common)},i.scrowPage=function(e){m.i("event ",e),this.setPage(e._curPageIdx%3,this.getLevelByScrollIndex(e.curPageIdx))},i.myScrollPage=function(){var e=this,t=this.mapPage.curPageIdx+1;this.mapPage.scrollToPage(function a(){if(0==P.getInstance().getLevelData(e.getLevelByScrollIndex(t)).ReceiveState[t%3]||t==e.mapPage.getPages().length-1)return t;t++,a()}(),1)},i.onGetReward=function(){f.playEffect("btnClick");var e=P.getInstance().tobePropItem(this._curRewardList);P.getInstance().getRewardProp(e,1),this.showGetReward(e);var t=P.getInstance().getLevelData(this._curOpenLevel);t.ReceiveState[this._curIndex]=1,P.getInstance().setLevelData(t),this.updateBtnState(),this.scheduleOnce(this.myScrollPage,.5),I.send(R.refreshRedPoint)},i.onGetRewardDouble=function(){var e=this;f.playEffect("btnClick"),d.openAd("章节宝箱双倍领取"+(5*this._curIndex+5)+"分钟",(function(t){if(1==t){var a=P.getInstance().tobePropItem(e._curRewardList);P.getInstance().getRewardProp(a,2),e.showGetReward(a);var n=P.getInstance().getLevelData(e._curOpenLevel);n.ReceiveState[e._curIndex]=2,P.getInstance().setLevelData(n),e.updateBtnState(),e.scheduleOnce(e.myScrollPage,.5),I.send(R.refreshRedPoint)}}))},i.onDisable=function(){},i.onDestroy=function(){},i.backHome=function(){f.playEffect("btnClick"),m.i("backHome"),this.openLayer(y.layers.HomeLayer),this.closeLayer()},t}(C)).prototype,"mapName",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(V.prototype,"mapItem",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(V.prototype,"pageContent",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(V.prototype,"selectBtn",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(V.prototype,"rewardLayer",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(V.prototype,"mapPage",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(V.prototype,"rewardItem",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(V.prototype,"tishiLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(V.prototype,"tishiLabel2",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(V.prototype,"btn1",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(V.prototype,"btn2",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=V))||H));i._RF.pop()}}}));

System.register("chunks:///_virtual/cocosUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts"],(function(t){"use strict";var e,n,o,r,i,a,c,s,u,l,h,f,p,d,g,v,S,w,y,m,A,P;return{setters:[function(t){e=t.asyncToGenerator,n=t.regeneratorRuntime,o=t.createForOfIteratorHelperLoose},function(t){r=t.cclegacy,i=t.Color,a=t.Node,c=t.UIOpacity,s=t.v3,u=t.Vec3,l=t.view,h=t.UITransform,f=t.tween,p=t.Tween,d=t.Quat,g=t.instantiate,v=t.isValid,S=t.sys,w=t.input,y=t.Input,m=t.UIRenderer,A=t.Button},function(t){P=t.utilTools}],execute:function(){r._RF.push({},"c6b74pmm/VEqaWZqrRtczgX","cocosUtil",void 0),String.prototype.parseColor=function(){return new i(this)},Object.defineProperty(a.prototype,"opacity",{configurable:!0,enumerable:!0,get:function(){return T.addComponentOnce(this,c).opacity},set:function(t){T.addComponentOnce(this,c).opacity=t}});var T=t("cocosUtil",{getAroundPos:function(t,e,n,o){void 0===o&&(o=!1);var r=P.getFloatValue(e,n,!0),i=Math.random()*Math.PI*2,a=s(r,0,0);return u.rotateZ(a,a,u.ZERO,i),a=t.getPosition().add(a),o&&(a=T.convertToWorldSpaceWithPos(t,a)),a},getLeavePos:function(t,e,n,o){void 0===o&&(o=!1);var r=s(e,n,0);return r=t.getPosition().add(r),o&&(r=T.convertToWorldSpaceWithPos(t,r)),r},getRectPos:function(t,e,n,o,r,i){void 0===i&&(i=!1),o||(o=e+10),r||(r=n+10);var a=[],c={};c.x=.5*-o,c.y=.5*n,c.width=o,c.height=.5*(r-n),c.weight=c.width*c.height,a.push(c);var u={};u.x=c.x,u.y=.5*-r,u.width=c.width,u.height=c.height,u.weight=c.weight,a.push(u);var l={};l.x=.5*-o,l.y=.5*-n,l.width=.5*(o-e),l.height=n,l.weight=l.width*l.height,a.push(l);var h={};h.x=.5*e,h.y=l.y,h.width=l.width,h.height=l.height,h.weight=l.weight,a.push(h);var f=P.getRowByWeight(a),p=f.x+Math.random()*f.width,d=f.y+Math.random()*f.height,g=s(p,d);return g=t.getPosition().add(g),i&&(g=T.convertToWorldSpaceWithPos(t,g)),g},vec2XAngle:function(t){var e=Math.atan2(t.y,t.x);return e<0&&(e+=2*Math.PI),P.radianToAngle(e)},vec3CopyVal:function(t,e){return t.x=e.x,t.y=e.y,t.z=e.z,t},schedule:function(t,e,n,o,r,i){void 0===r&&(r=0),void 0===i&&(i=!1),t.schedule(e,n,o,r),i&&e()},addComponentOnce:function(t,e){var n=t.getComponent(e);return n||(n=t.addComponent(e)),n},getSectorDirectionArr:function(t,e,n,o){if(void 0===o&&(o=1),t=t.clone().normalize().multiplyScalar(o),n<=1)return[t];for(var r=Math.floor(n/2),i=P.angleToRadian(e),a=[],c=[],s=r;s>=1;s--){var l=new u(0,0,0),h=i*s;u.rotateZ(l,t,u.ZERO,h),a.push(l);var f=new u(0,0,0);h=-i*(r+1-s),u.rotateZ(f,t,u.ZERO,h),c.push(f)}return a.push(t),a.concat(c)},getCircleDirectionArr:function(t,e){void 0===e&&(e=1);for(var n=2*Math.PI/t,o=s(e,0,0),r=[],i=Math.random()*Math.PI*2,a=0;a<t;a++){var c=i+n*a,l=s(0,0,0);l=u.rotateZ(l,o.clone(),u.ZERO,c),r.push(l)}return r},isInScreenVisible:function(t){if(!t||!t.parent)return!1;var e=l.getVisibleOrigin(),n=T.convertToWorldSpace(t),o=l.getVisibleSize().height,r=l.getVisibleSize().width,i=t.getComponent(h);return n.x+(1-i.anchorX)*i.width>e.x&&n.x-i.anchorX*i.width<r+e.x&&n.y+(1-i.anchorY)*i.height>e.y&&n.y-i.anchorY*i.height<o+e.y},tweenScaleOut:function(t,e,n){f(t).to(e,{scale:s(0,0,0)}).call((function(){n()})).start()},tweenHitScale:function(t,e,n){void 0===e&&(e=.1),p.stopAllByTarget(t);var o=t.getScale();f(t).to(e,{scale:s(.95*o.x,1.1*o.y,1)}).to(2*e,{scale:s(o.x,.9*o.y,1)}).to(2*e,{scale:s(.95*o.x,1.1*o.y,1)}).to(e,{scale:s(o.x,o.y,1)}).call((function(){n&&n()})).start()},tweenScaleShake:function(t,e){var n=new d;d.fromEuler(n,0,0,10);var o=new d;d.fromEuler(o,0,0,-10);var r=new d;d.fromEuler(r,0,0,0),f(t).to(.3,{scale:s(1.3,1.3,1)}).to(.2,{rotation:n}).to(.4,{rotation:o}).to(.2,{rotation:r}).to(.2,{scale:s(1,1,1)}).call((function(){e&&e()})).start()},instantiate:function(t){return g(t)},tweenBubbling:function(t){p.stopAllByTarget(t),t.setScale(s(.4,.4,1)),f(t).to(.5,{scale:s(1,1,1)}).to(.5,{scale:s(.4,.4,1)}).union().repeatForever().start()},waitTimeAsync:function(t,e){return new Promise((function(n){"number"==typeof t?setTimeout((function(){n()}),1e3*t):t.scheduleOnce((function(){n()}),e)}))},getScreenMidWorldPos:function(){var t=l.getVisibleSize();return s(.5*t.width,.5*t.height,0)},nodeChangeParent:function(t,e){if(this.isValid(t)&&this.isValid(e)){var n=T.convertToWorldSpace(t);t.parent=e,n=T.convertToNodeSpace(t,n),t.setPosition(n)}},tweenUIShow:function(t){p.stopAllByTarget(t);var e=t.getScale();t.setScale(s(.5,.5,1)),f(t).to(.1,{scale:e}).start()},tweenBounceAction:function(t){p.stopAllByTarget(t);var e=t.getScale().x,n=t.getScale().y;f(t).to(.15,{scale:s(.4*e,1.2*n,1)},{easing:"bounceInOut"}).to(.15,{scale:s(1.4*e,.8*n,1)},{easing:"bounceInOut"}).to(.2,{scale:s(e,n,1)},{easing:"smooth"}).delay(.7).union().repeatForever().start()},tweenShakeNode:function(t){var e=.1;f(t).to(e,{position:s(5,-5)}).to(e,{position:s(-5,5)}).to(e,{position:s(5,5)}).to(e,{position:s(-5,-5)}).to(e,{position:s(0,0)}).start()},tweenFallDown:function(t,e){t.setScale(.5,.5,1);var n=t.getPosition();T.setNodePositionY(t,n.y+100),f(t).to(.3,{position:n}).to(.2,{scale:s(1,1,1)}).call((function(){e&&e()})).start()},tweenTopFadeOut:function(t,e){var n=t.getComponent(c);n||(n=t.addComponent(c)),n.opacity=255,t.setScale(1,1,1),f(t).to(.05,{scale:s(1.2,1.2,1)}).to(.1,{scale:s(1,1,1)}).by(.5,{position:s(0,40)}).by(1,{position:s(0,0)},{onUpdate:function(t,e){n.opacity=255*(1-e)}}).union().call((function(){e&&e()})).start()},tweenScaleEffect:function(t,e,n){e||(e=.2),t.setScale(1,1,1),f(t).to(e,{scale:s(1.5,1.5,1)}).to(e,{scale:s(1,1,1)}).call((function(){n&&n()})).start()},tweenFlyToPos:function(t,o,r){return e(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.stopAllByTarget(t),e.abrupt("return",new Promise((function(e,n){var i=T.getQuatByAngleZ(360),a=f(t).to(.5,{position:o}),c=f(t).by(.5,{rotation:i},{easing:"quadOut",onUpdate:function(e,n){t.setRotation(T.getQuatByAngleZ(360*n))}});f(t).parallel(a,c).call((function(){t.setRotation(T.getQuatByAngleZ(0)),e(),r&&r()})).start()})));case 2:case"end":return e.stop()}}),e)})))()},tweenTopRightPao:function(t,e){var n=40;n+=20*Math.random(),t.setScale(s(1,1,1)),f(t).by(.3,{position:s(n,100)},{easing:"quadOut",onUpdate:function(e,n){var o=.5*n;t.setScale(s(1+o,1+o,1))}}).by(.3,{position:s(40,-80)},{easing:"quadIn",onUpdate:function(e,n){var o=.5*n;t.setScale(s(1.5-o,1.5-o,1))}}).union().call((function(){e&&e()})).start()},tweenScaleIn:function(t,e,n){e||(e=.2),t.setScale(0,0,1),f(t).to(e,{scale:s(1,1,1)}).call((function(){n&&n()})).start()},tweenScaleIn2:function(t,e,n){e||(e=.2),t.setScale(0,0,1),f(t).to(e,{scale:s(1.3,1.3,1)}).to(e/2,{scale:s(1,1,1)}).union().call((function(){n&&n()})).start()},tweenBlink:function(t,e,n){e||(e=.5);var o=this.addComponentOnce(t,c);o.opacity=255,f(o).to(e,{opacity:80}).to(e,{opacity:255}).call((function(){n&&n()})).union().repeatForever().start()},tweenRotate:function(t,e){e||(e=2);var n=T.getQuatByAngleZ(360);f(t).by(e,{rotation:n},{easing:"linear",onUpdate:function(t,e){var n=360*e;t.setRotation(T.getQuatByAngleZ(n))}}).repeatForever().start()},tweenUpDown:function(t,e,n){e||(e=6),n||(n=1.5);var o=t.getPosition();o.y+=e;var r=t.getPosition();f(t).to(n,{position:o}).to(n,{position:r}).union().repeatForever().start()},tweenFadeIn:function(t,o,r){var i=this;return e(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){o||(o=1);var a=i.addComponentOnce(t,c);a.opacity=0,f(a).to(o,{opacity:255}).call((function(){e(),r&&r()})).start()})));case 1:case"end":return e.stop()}}),e)})))()},tweenFadeOut:function(t,o,r){var i=this;return e(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){o||(o=1.5);var a=i.addComponentOnce(t,c);a.opacity=255,f(a).to(o,{opacity:0}).call((function(){e(),r&&r()})).start()})));case 1:case"end":return e.stop()}}),e)})))()},tweenBreath:function(t,e,n){e||(e=.4),n||(n=1.2),f(t).to(e,{scale:s(n,n,1)}).to(e,{scale:s(1,1,1)}).union().repeatForever().start()},tweenShake:function(t,e,n,o,r){p.stopAllByTarget(t),e||(e=.2),n||(n=6),null==o&&(o=5*e);var i=new d;d.fromEuler(i,0,0,n);var a=new d;d.fromEuler(a,0,0,-n);var c=new d;d.fromEuler(c,0,0,0);var s=f(t).to(e,{rotation:i}).to(2*e,{rotation:a}).to(e,{rotation:c});null==r?s.delay(o).union().repeatForever().start():s.start()},isValid:function(t){return!(!t||!v(t))},isAndroid:function(){return S.platform===S.Platform.ANDROID},isDesktopBrowser:function(){return S.platform===S.Platform.DESKTOP_BROWSER},isIos:function(){return S.platform===S.Platform.IOS},isWechatGame:function(){return S.platform===S.Platform.WECHAT_GAME},addKeyDownListener:function(t,e){w.on(y.EventType.KEY_DOWN,t,e)},init:function(){this.designSize=l.getDesignResolutionSize(),this.frameSize=l.getFrameSize(),this.safeAreaRect=S.getSafeAreaRect(),this.safeAreaMarginTop=this.designSize.height-this.safeAreaRect.height,this.safeAreaMarginTop<0&&(this.safeAreaMarginTop=0),this.intiScreenAdapterWidthScale(),this.initScreenBgAdapterWidthScale()},intiScreenAdapterWidthScale:function(){var t=this.frameSize.height,e=this.frameSize.width,n=t/this.designSize.height,o=this.designSize.width*n,r=1;o>e&&(r=e/o),this.screenAdapterScale=r},getScreenAdapterScale:function(){return this.screenAdapterScale||(this.screenAdapterScale=1),this.screenAdapterScale},initScreenBgAdapterWidthScale:function(){var t=this.frameSize.height,e=this.frameSize.width,n=t/this.designSize.height,o=this.designSize.width*n,r=1;o<e&&(r=e/o),this.screenBgAdapterScale=r},getScreenBgAdapterScale:function(){return this.screenBgAdapterScale||(this.screenBgAdapterScale=1),this.screenBgAdapterScale},convertToWorldSpace:function(t,e){var n=t.parent.getComponent(h),o=t.getPosition();if(e){var r=t.getComponent(h);o.x=o.x+(.5-r.anchorX)*r.width,o.y=o.y+(.5-r.anchorY)*r.height}return n.convertToWorldSpaceAR(o)},convertToWorldSpaceWithPos:function(t,e){return e=t.parent.getComponent(h).convertToWorldSpaceAR(e)},convertToNodeSpace:function(t,e){return t.parent.getComponent(h).convertToNodeSpaceAR(e)},setRenderableColor:function(t,e,n){var r=t.getComponent(m);if(r&&r.color){var i=null;i="string"==typeof e?e.parseColor():e,r.color=i}if(n)for(var a,c=o(t.children);!(a=c()).done;){var s=a.value;this.setRenderableColor(s,e,n)}},getRenderableColor:function(t){var e=t.getComponent(m);return e&&e.color?e.color.clone():null},getColorByHEX:function(t){return new i(t)},setButtonEnabled:function(t,e){var n=t.getComponent(A);n&&(n.enabled=e)},getQuatByAngleZ:function(t){var e=new d;return d.fromEuler(e,0,0,t),e},formatNum:function(t){return t<1e4?t:t<1e6?((t=Math.floor(t/1e3*100))/100).toFixed(2)+"K":((t=Math.floor(t/1e6*100))/100).toFixed(2)+"M"},formatNumString:function(t){return t<1e3?t:t<1e4?((t=Math.floor(t/1e3*10))/10).toFixed(1)+"K":t<1e7?((t=Math.floor(t/1e4*10))/10).toFixed(1)+"w":((t=Math.floor(t/1e6*100))/100).toFixed(2)+"M"},setNodePositionX:function(t,e){var n=t.getPosition();n.x=e,t.setPosition(n)},setNodePositionY:function(t,e){var n=t.getPosition();n.y=e,t.setPosition(n)},drawCurvePath:function(t,e,n,o,r,i){var a;void 0===i&&(i=0);var c=[(e[0]+n[0])/2-(e[1]-n[1])*o,(e[1]+n[1])/2-(n[0]-e[0])*o],u=[];u.push(f(t).delay(i));for(var l=e[0],h=e[1],p=0;p<=r/100;p+=.01){var d=this.quadraticBezier(e[0],c[0],n[0],p),g=this.quadraticBezier(e[1],c[1],n[1],p),v=(Math.abs(d-l)+Math.abs(g-h))/1500;u.push(f(t).to(v,{position:s(d,g,0)})),l=d,h=g}var S=(Math.abs(n[0]-l)+Math.abs(n[1]-h))/1500;u.push(f(t).to(S,{position:s(n[0],n[1],0)})),(a=f(t)).sequence.apply(a,u).start()},quadraticBezier:function(t,e,n,o){var r=1-o;return r*r*t+2*(1-o)*o*e+o*o*n}});r._RF.pop()}}}));

System.register("chunks:///_virtual/comeShine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts"],(function(t){"use strict";var e,n,o,c,i,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,c=t.Component},function(t){i=t.cocosUtil},function(t){r=t.mapModel}],execute:function(){var s;n._RF.push({},"39615xkBlpHPLeCPBzWKu+h","comeShine",void 0);var u=o.ccclass;o.property,t("comeShine",u("comeShine")(s=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))||this).hint=void 0,e}return e(n,t),n.prototype.init=function(t){var e=this;this.hint=t;var n=this.hint.extraObj.monsterId;this.scheduleOnce((function(){r.monsterSystem.createMonster(n,i.convertToWorldSpace(e.node))}),.4)},n}(c))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/conf.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){e("GLoginState",void 0),t._RF.push({},"f97e0MoLgtPP5tALE0CHh/1","conf",void 0);var o;e("GNetConf",{mrtgd_WsUrl:"wss://api.play.xmtyq.com:39001/sh",mrtgd_HttpUrl:"https://api.play.xmtyq.com:39001",mrtgd_jjws_WsUrl:"wss://api.play.xmtyq.com:39002/sh",mrtgd_jjws_HttpUrl:"https://api.play.xmtyq.com:39002"}),e("GNetCmd",{StickPack:1e5,Heartbeat:101e3,UserLogin:101001,UserRegister:101002,AntiAddiction:101003,SensitiveWordsCheck:101004,SaveUserRecord:102003,GetRegionData:102004,GetRegionList:102005,SaveUserRecordAll:102007,UploadAvatar:102008,GetUserDataByKey:102009,ReqWxSession:103001,ReqSendAuthCode:103002,ReqPhoneLogin:103003,SetFriendCode:104001,GetFriendVal:104002,GetRankInfo:201001,GetInviteCode:201002,GetInviteCodeReward:201003,GetInviteLevelReward:201004,PushInviteProcess:201005,IsRankOpen:201006,GetSomeonePlayerInfo:201007,GetMidAutumnRank:301001,SetMidAutumnRank:301002,GetWorldBossRank:301003,SetWorldBossRank:301004,PushWorldBossSettle:301005,SetWorldBossPlayerStatus:301006,GetWorldBossPlayerStatus:301007,GetEmpireSpotData:302001,ActionEmpireSpot:302002}),e("GClientEvent",{}),e("GNetConst",{SaveHead:"game",ServerIsNew:"serverIsNew",ServerIsOld:"serverIsOld",ResSuccess:"success",ResFail:"fail",DataTypeInt:"int",DataTypeString:"string",DataTypeBoolean:"boolean",DataTypeObject:"object",ServerEventHead:"ServerDown_",Http_isAlive:"/isAlive"});!function(e){e.noYet="noYet",e.loginFail="loginFail",e.loginWithoutAccount="loginWithoutAccount",e.loginWithAccount="loginWithAccount"}(o||(o=e("GLoginState",{}))),t._RF.pop()}}}));

System.register("chunks:///_virtual/constants.ts",["cc"],(function(e){"use strict";var a;return{setters:[function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"bd851Zf7BtBf7ZqFmN8xVxt","constants",void 0);e("constants",{gameName:"mrtgd",animations:{animation:"animation",standBy:"standby",attack:"attack",hit:"hit",die:"die",appear:"appear",walk:"walk"},audioNames:{home:"home",map:"map",win:"win"},propIds:{coin:101,dayAct:107,energy:108,exp:201,magnet:301,addHpPercent:401,bomb:501,box1:601,box2:701,diamond:801,boxMonsterCoin:1001,equip:1002},propTypes:{coin:1,exp:2,skin:17},mapTypes:{main:1,tower:2},materials:{shineColor:"shader/shineColor",shineColorSpine:"shader/shineColorSpine"},monsterTypes:{common:1,elite:2,boss:3},monsterIds:{boxMonster:24},skillTypes:{hammer:1,disk:2},times:{minute:6e4,houre:36e5,day:864e5},catName:{lang:"lang",mapSystem:"map",common:"common",propSystem:"prop",skillSystem:"skill",skill2System:"skill2",weaponSystem:"weapon"},tableName:{map:"map",level:"level",monster:"monster",weapon:"weapon",bullet:"bullet",skill:"skill",skill2:"skill2",expLv:"expLv",expType:"expType",prop:"prop",box1:"box1",config:"config",heroLevel:"heroLevel",suit:"suit",draw:"draw",weaponOpt:"weaponOpt",towerFloor:"towerFloor",dayTask:"dayTask",daySign:"daySign",energyAward:"energyAward",CNTM:"CNTM",vip:"vip",share:"share",monsterTimeAdd:"monsterTimeAdd",localization:"localization",font:"font"},bundles:{audio:"audio",bullet:"bullet",common:"common",design:"design",hint:"hint",icon:"icon",layer:"layer",monster:"monster",prefab:"prefab",spine:"spine",ui:"ui",weapon:"weapon",wwqVec:"wwqVec",loading:"loading"},layers:{LoadingLayer:"LoadingLayer",NoticeLayer:"NoticeLayer",MainLayer:"MainLayer",HomeLayer:"HomeLayer",MapLayer:"MapLayer",MapFightLayer:"MapFightLayer",SkillSelectLayer:"SkillSelectLayer",PauseLayer:"PauseLayer",LuckyDrawLayer:"LuckyDrawLayer",LevelLayer:"LevelLayer",ChapterLayer:"ChapterLayer",SettlementLayer:"SettlementLayer",BackHomeLayer:"BackHomeLayer",BackLifeLayer:"BackLifeLayer",BackMapLayer:"BackMapLayer",HandLayer:"HandLayer",TransLayer:"TransLayer",BoxMonsterLayer:"BoxMonsterLayer",TowerLayer:"TowerLayer",TowerFloorLayer:"TowerFloorLayer",TowerRoleLayer:"TowerRoleLayer",DayTaskLayer:"DayTaskLayer",EnergyLayer:"EnergyLayer",DaySignLayer:"DaySignLayer",LetterLayer:"LetterLayer",SkinChangeLayer:"SkinChangeLayer",PropInfoLayer2:"PropInfoLayer2",AwardInfoLayer:"AwardInfoLayer",VipLayer:"VipLayer",ShareLayer:"ShareLayer",MsgBoxLayer:"MsgBoxLayer",BuyLifeLayer:"BuyLifeLayer",PropInfoLayer:"PropInfoLayer",BlessLayer:"BlessLayer",BlessResultLayer:"BlessResultLayer",MoreGameLayer:"MoreGameLayer",HeroLayer:"HeroLayer",RewardItemLayer:"RewardItemLayer",ShopLayer:"ShopLayer",RewardLayer:"RewardLayer",SettingLayer:"SettingLayer",PatrolLayer:"PatrolLayer",PatrolFastLayer:"PatrolFastLayer",GuessGameLayer:"GuessGameLayer",GuessResultLayer:"GuessResultLayer",PyramidDrawLayer:"PyramidDrawLayer",RewardSkinLayer:"RewardSkinLayer",RewardRedBoxLayer:"RewardRedBoxLayer"},saveTimeGap:3e5,colors:{yin:"#666666",white:"#ffffff",green:"#38ff38",blue:"#1096fd",purple:"#f153ff"},design:{maxLv:5,weaponNum:1,skill1Num:5,skill2Num:6,skillNum:6,backLifeMax:1,towerBeginId:10001,chapterBoxNum:3}});a._RF.pop()}}}));

System.register("chunks:///_virtual/CountTimeUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts"],(function(t){"use strict";var e,i,n,o,s,u,r;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.Label,s=t.macro,u=t.Component},function(t){r=t.utilTools}],execute:function(){var l;i._RF.push({},"aa2e7PxHLFHprbziHo7Pp5S","CountTimeUtil",void 0);var c=n.ccclass;n.property,t("CountTimeUtil",c("CountTimeUtil")(l=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this)._time=0,e._callFun=null,e}e(i,t);var n=i.prototype;return n.onLoad=function(){this.node.getComponent(o).string=r.getTimeStr(1e3*this._time,!0)},n.setTime=function(t,e){void 0===e&&(e=null),this._time=t,this._callFun=e,this._time>0?(this.node.getComponent(o).string=r.getTimeStr(1e3*this._time,!0),this.schedule(this.updateTime,1,s.REPEAT_FOREVER)):this.node.getComponent(o).string=""},n.start=function(){},n.updateTime=function(){this._time>0&&(this._time--,this.node.getComponent(o).string=r.getTimeStr(1e3*this._time,!0)),this._time<=0&&(this.unschedule(this.updateTime),this.node.getComponent(o).string="",this._callFun&&this._callFun())},i}(u))||l);i._RF.pop()}}}));

System.register("chunks:///_virtual/CronCtr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./conf.ts","./http.ts","./ServerCtr.ts","./TimeCtr.ts","./wmsocket.ts"],(function(t){"use strict";var e,n,a,s,r,i,o,c,l,u,g,d,h;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,a=t._decorator,s=t.director,r=t.Component},function(t){i=t.tyqSDK},function(t){o=t.GNetCmd,c=t.GNetConst,l=t.GLoginState},function(t){u=t.default},function(t){g=t.default},function(t){d=t.default},function(t){h=t.WmSocket}],execute:function(){var f,v;n._RF.push({},"7166aCA9O1JwpNeRr4Y/Af5","CronCtr",void 0);var I=a.ccclass;a.property,t("default",I("CronCtr")(((v=function(t){function n(){for(var e,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))||this).msgArr=[],e.msgArrIdx=0,e.isPutEnable=!1,e.testTimeDelta=0,e}e(n,t),n.getInstance=function(){return this._instance||(this._instance=new n),this._instance};var a=n.prototype;return a.init=function(){s.on(o.Heartbeat.toString(),this.onHeartbeat),s.on(o.SaveUserRecord.toString(),this.respSaveUserRecord,this),this.schedule(this.reqHeartBeat,3),this.startHeartbeat()},a.startHeartbeat=function(){h.getInstance(),u.getInstance().httpPost(i.getUrl().httpUrl+c.Http_isAlive,{},(function(t){console.log("server response :",t),-1!=t&&(d.GetInstance().UpdateServerTime(t.serverTime),h.getInstance().connect())}),(function(){g.GetInstance().loginState=l.loginFail}))},a.onHeartbeat=function(t){t.status!=c.ResSuccess?(g.GetInstance().loginState==l.loginWithAccount&&(g.GetInstance().loginState=l.noYet),d.GetInstance().ReInit(),n.getInstance().isPutEnable=!1):(d.GetInstance().UpdateServerTimeByHeartbeat(1e3*t.time),h.getInstance().lastHeartbeatTime=d.GetInstance().ServerTime)},a.reqHeartBeat=function(){0==h.getInstance().isConnected()?u.getInstance().httpPost(i.getUrl().httpUrl+c.Http_isAlive,{},(function(t){-1!=t&&(d.GetInstance().UpdateServerTime(t.serverTime),s.emit("ws_reconnect"))}),(function(){g.GetInstance().loginState=l.loginFail})):g.GetInstance().loginState==l.loginFail?g.GetInstance().wxLoginBegin():this.heartbeatCheck()},a.respSaveUserRecord=function(t){t.status==c.ResFail&&console.error("发现作弊1----",t,t.cheatLevel,t.hasOwnProperty("cheatLevel"))},a.sendMultiMsg=function(t){var e={cmd:o.SaveUserRecord,lang:"zh",type:"slice",token:g.GetInstance().token,jsonData:this.msgArr[t],isEnd:t==this.msgArr.length-1,isStart:0==t,idx:t};e.jsonData&&""!=e.jsonData&&"{}"!=e.jsonData&&h.getInstance().send({data:e})},a.saveDataToCloud=function(t,e){if(g.GetInstance().loginState==l.loginWithAccount&&(this.testTimeDelta=(new Date).getTime(),h.getInstance().isConnected())){var n={cmd:o.SaveUserRecord,lang:"zh",type:"single",token:g.GetInstance().token,version:g.GetInstance().dataVersion,key:t,val:String(e),dml:"add upd"};h.getInstance().send({data:n})}},a.uploadAllRecord=function(t){if(g.GetInstance().loginState==l.loginWithAccount){var e={cmd:o.SaveUserRecordAll,lang:"zh",type:"single",token:g.GetInstance().token,version:g.GetInstance().dataVersion,allData:JSON.stringify(t)};console.warn("发送数据到云端---",e),h.getInstance().send({data:e})}},a.heartbeatCheck=function(){var t={cmd:o.Heartbeat,lang:"zh",token:g.GetInstance().token};h.getInstance().send({data:t})},n}(r))._instance=void 0,f=v))||f);n._RF.pop()}}}));

System.register("chunks:///_virtual/DaySignLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./tyqAdManager.ts","./tyqSDK.ts","./cocosUtil.ts","./constants.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts","./localization.ts"],(function(a){"use strict";var t,e,i,n,r,o,s,y,l,c,d,h,g,u,f,b,L,v;return{setters:[function(a){t=a.inheritsLoose},function(a){e=a.cclegacy,i=a._decorator,n=a.find,r=a.Tween},function(a){o=a.sdkManager},function(a){s=a.tyqAdManager,y=a.Channel},function(a){l=a.tyqSDK},function(a){c=a.cocosUtil},function(a){d=a.constants},function(a){h=a.msgac},function(a){g=a.designManager},function(a){u=a.eventManager},function(a){f=a.playerModel},function(a){b=a.UserData},function(a){L=a.BaseLayer},function(a){v=a.localizeManager}],execute:function(){var D;e._RF.push({},"7faeagfy2tN9JzWiIAnph2z","DaySignLayer",void 0);var S=i.ccclass;i.property,a("DaySignLayer",S("DaySignLayer")(D=function(a){function e(){for(var t,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(t=a.call.apply(a,[this].concat(i))||this).itemUIArr=[],t.awardDay=0,t.titleImg=void 0,t.titleLabel=void 0,t.hasLabel=void 0,t.noLabel=void 0,t.fastSginLabel=void 0,t.getAwardLabel=void 0,t.tipLabel=void 0,t}t(e,a);var i=e.prototype;return i.onLoad=function(){var t=this;a.prototype.onLoad.call(this),this.titleImg=this.getNodeByPath("ui/title"),this.titleLabel=this.getNodeByPath("ui/qdyl_text"),this.hasLabel=this.getNodeByPath("ui/bottom/info/has"),this.noLabel=this.getNodeByPath("ui/bottom/info/no"),this.fastSginLabel=this.getNodeByPath("ui/bottom/btnPatch/text"),this.getAwardLabel=this.getNodeByPath("ui/btnGetAward/text"),this.tipLabel=this.getNodeByPath("ui/hintLayer/day");for(var e=this.getNodeByPath("ui/itemLayer"),i=n("propItem",e),r=0;r<2;r++)c.instantiate(i).parent=e;var o=c.instantiate(e);o.parent=e.parent;var l=o.getPosition();l.y-=150,o.position=l,c.instantiate(i).parent=e,e.children.forEach((function(a){t.itemUIArr.push(a)})),o.children.forEach((function(a){t.itemUIArr.push(a)})),s.getChannel()==y.OPPO_MINI_GAME&&(f.daySignObj.notBox=1)},i.onEnable=function(){a.prototype.onEnable.call(this)},i.onDisable=function(){a.prototype.onDisable.call(this)},i.onDestroy=function(){a.prototype.onDestroy.call(this)},i.initUI=function(){var a=new Date,t=Math.floor((a.getTime()-f.daySignObj.startTime)/d.times.day);this.awardDay=t;for(var e=0;e<this.itemUIArr.length;e++){var i=this.itemUIArr[e],o=g.getRowById(d.tableName.daySign,e+1);this.setPropItem(o.award[0],n("icon",i),o.award[1],n("bg",i),n("num/val",i)),n("day",i).localize({cat:d.layers.DaySignLayer,key:"day",vars:[e+1]});var s=n("get",i),y=n("patch",i),l=n("target",i);s.active=!1,y.active=!1,l.active=!1;var h=!1;-1!=f.daySignObj.awardDayArr.indexOf(e)&&(h=!0),h?(s.getChildByName("icon").localizeImg(),s.active=!0):e<t?(y.getChildByName("icon").localizeImg(),y.active=!0):e==t&&(l.active=!0,r.stopAllByTarget(l),c.tweenBlink(l,.3))}this.getNodeByPath("ui/bottom/info/has/info/text").localize({cat:d.layers.DaySignLayer,key:"times",vars:[f.daySignObj.awardDayArr.length]}),this.getNodeByPath("ui/bottom/info/no/info/text").localize({cat:d.layers.DaySignLayer,key:"times",vars:[7-f.daySignObj.awardDayArr.length]}),this.setProgressBar(this.getNodeByPath("ui/bottom/bar"),f.daySignObj.awardDayArr.length/7),this.refreshFinalAwardLayer(),this.refreshBoxLayer()},i.refreshLocalization=function(){this.titleImg.localizeImg(),this.titleLabel.localize("title",d.layers.DaySignLayer),this.hasLabel.localize("sign_done",d.layers.DaySignLayer),this.noLabel.localize("sign_none",d.layers.DaySignLayer),this.fastSginLabel.localize("reSign",d.layers.DaySignLayer),this.getAwardLabel.localize("btnGet",d.layers.DaySignLayer),this.tipLabel.localize("tip",d.layers.DaySignLayer)},i.refreshFinalAwardLayer=function(){var a=this.getNodeByPath("ui/bottom/extraAward/get"),t=this.getNodeByPath("ui/bottom/extraAward/lock");a.active=!1,t.active=!1,f.daySignObj.finalAward?a.active=!0:f.daySignObj.awardDayArr.length<7&&(t.active=!0)},i.refreshBoxLayer=function(){f.daySignObj.notBox?this.getNodeByPath("ui/hintLayer/btnBox/gou").active=!1:this.getNodeByPath("ui/hintLayer/btnBox/gou").active=!0},i.processEvent=function(a,t){},i.onButtonClick=function(a,t){},i.signWithDay=function(a,t){void 0===t&&(t=!1);var e=g.getRowById(d.tableName.daySign,a+1);if(e){var i=[e.award];t&&i.push(e.award),i=b.getInstance().addPropArrByDesign(i),this.openAwardGetLayer(i),f.daySignObj.awardDayArr.push(a),this.initUI(),u.send(h.refreshRedPoint)}},i.onClickBtnGetAward=function(){var a=this;g.getRowById(d.tableName.daySign,this.awardDay+1)?-1==f.daySignObj.awardDayArr.indexOf(this.awardDay)?(f.addDayTaskNum(2),l.eventSendCustomEvent("签到玩家"),f.daySignObj.notBox?this.signWithDay(this.awardDay):o.openAd("签到双倍奖励",(function(t){1==t&&a.signWithDay(a.awardDay,!0)}))):this.createNotice(v._localize(null,"todayHasGet",d.layers.DaySignLayer)):this.createNotice(v._localize(null,"outData",d.layers.DaySignLayer))},i.onClickBtnPatch=function(){for(var a=this,t=-1,e=0;e<7;e++)if(-1==f.daySignObj.awardDayArr.indexOf(e)){t=e;break}-1==t||t>=this.awardDay?this.createNotice(v._localize(null,"noLeave",d.layers.DaySignLayer)):o.openAd("快速补签",(function(e){1==e&&a.signWithDay(t)}))},i.onClickBtnBox=function(){f.daySignObj.notBox?f.daySignObj.notBox=0:f.daySignObj.notBox=1,this.refreshBoxLayer()},i.onClickExtraAward=function(){if(f.daySignObj.awardDayArr.length<7)this.createNotice(v._localize(null,"finalAwardHint",d.layers.DaySignLayer));else if(f.daySignObj.finalAward)this.createNotice(v._localize(null,"hasGet","common"));else{f.daySignObj.finalAward=1;var a=b.getInstance().addPropByDesign(g.config.daySignFinalAward);this.openAwardGetLayer([a]),this.refreshFinalAwardLayer()}},e}(L))||D);e._RF.pop()}}}));

System.register("chunks:///_virtual/DayTaskLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts"],(function(e){"use strict";var t,a,i,r,n,s,o,c,d,l,y,h,u,g;return{setters:[function(e){t=e.inheritsLoose},function(e){a=e.cclegacy,i=e._decorator,r=e.find},function(e){n=e.tyqSDK},function(e){s=e.cocosUtil},function(e){o=e.utilTools},function(e){c=e.constants},function(e){d=e.msgac},function(e){l=e.designManager},function(e){y=e.eventManager},function(e){h=e.playerModel},function(e){u=e.UserData},function(e){g=e.BaseLayer}],execute:function(){var f;a._RF.push({},"e30ce7SVfRMu7LF0Te6TcB1","DayTaskLayer",void 0);var v=i.ccclass;i.property,e("DayTaskLayer",v("DayTaskLayer")(f=function(e){function a(){for(var t,a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).flagArr=[25,50,75,100],t.taskListNode=void 0,t.closeBtnText=void 0,t.hintNode=void 0,t.titleNode=void 0,t}t(a,e);var i=a.prototype;return i.onLoad=function(){e.prototype.onLoad.call(this),this.taskListNode=this.getNodeByPath("ui/listbg/list"),this.titleNode=this.getNodeByPath("ui/title"),this.closeBtnText=this.getNodeByPath("ui/btnClose/text"),this.hintNode=this.getNodeByPath("ui/hint")},i.refreshLocalization=function(){this.closeBtnText.localize("click2close","common"),this.hintNode.localize("hint",c.layers.DayTaskLayer),this.titleNode.localizeImg(c.bundles.ui,"title",c.layers.DayTaskLayer)},i.onEnable=function(){e.prototype.onEnable.call(this),this.addEventArr([d.overDay])},i.onDisable=function(){e.prototype.onDisable.call(this)},i.onDestroy=function(){e.prototype.onDestroy.call(this)},i.initUI=function(){this.refreshTopLayer();for(var e=l.getTable(c.tableName.dayTask),t=[],a=0;a<e.length;a++){var i=e[a],r={};r.id=i.id,t.push(r)}o.sortArr(t,(function(e,t){var a=l.getRowById(c.tableName.dayTask,e.id),i=l.getRowById(c.tableName.dayTask,t.id),r=h.getTaskInfoById(e.id),n=h.getTaskInfoById(t.id),s=r.num/a.needNum,o=n.num/i.needNum;return r.getAward&&(s=-1),n.getAward&&(o=-1),s<o})),this.scrollViewSetData(this.taskListNode,t,this.refreshTaskItem.bind(this),!0,!0)},i.refreshTopLayer=function(){var e=u.getInstance().dayAct;this.setString(this.getNodeByPath("ui/top/act/num"),e),this.setProgressBar(this.getNodeByPath("ui/top/progress"),e/100);for(var t=this.getNodeByPath("ui/top/progress/boxs").children,a=0;a<t.length;a++){var i=t[a];i.index=a;var n=this.flagArr[a];this.setString(r("num",i),n);var o=r("shine",i),c=r("icon",i),d=r("open",i);if(o.active=!1,c.active=!1,d.active=!1,e>=n){var l=this.getAwardFlag(a);-1==h.dayTaskObj.awardFlagArr.indexOf(l)?(c.active=!0,o.active=!0,s.tweenBreath(o,.5,1.2)):d.active=!0}else o.active=!1,c.active=!0,d.active=!1}},i.refreshTaskItem=function(e,t){var a=this,i=l.getRowById(c.tableName.dayTask,t.id);r("info",e).localize("task"+t.id,c.layers.DayTaskLayer),r("awardLayer",e).children.forEach((function(e,t){var n=i.award[t][0],s=i.award[t][1];a.setPropItem(n,r("icon",e),s,null,r("num/val",e)),e.award=i.award[t]}));var n=h.getTaskInfoById(i.id),s=n.num;1==i.id&&s>1&&(s=1),this.setString(r("progress/hint",e),s+"/"+i.needNum),this.setProgressBar(r("progress",e),n.num/i.needNum),r("btnGo/text",e).localize("go","common"),r("btnGet/text",e).localize("get","common");var o=r("btnGet",e),d=r("btnGo",e),y=r("done",e);o.item=t,d.item=t,o.active=!1,d.active=!1,y.active=!1,n.num>=i.needNum?n.getAward?y.active=!0:o.active=!0:d.active=!0,3==i.type&&l.config.taskDoge>u.getInstance().$freeDraw?d.getChildByName("hand").active=!0:d.getChildByName("hand").active=!1},i.overDayRet=function(){this.initUI()},i.getAwardFlag=function(e){return"dayTaskAward"+(e+1)},i.processEvent=function(e,t){},i.onButtonClick=function(e,t){},i.onClickBoxItem=function(e){for(var t=[],a=0;a<this.flagArr.length;a++){var i=this.getAwardFlag(a),r=l.config[i],s=this.flagArr[a];if(!(u.getInstance().dayAct<s)&&-1==h.dayTaskObj.awardFlagArr.indexOf(i)){var o=u.getInstance().addPropNum(r[0],r[1]);h.dayTaskObj.awardFlagArr.push(i),t.push(o),n.eventSendCustomEvent("每日任务-完成"+this.flagArr[a])}}if(t.length>0)this.openAwardGetLayer(t),this.refreshTopLayer();else{var c=this.getAwardFlag(e.index),d=l.config[c];this.openAwardInfoLayer([d])}},i.onClickBtnGo=function(e){var t={};switch(l.getRowById(c.tableName.dayTask,e.item.id).type){case 2:t.layerName=c.layers.DaySignLayer;break;case 3:t.layerName="ShopLayer",t.taskGo=!0;break;case 4:case 5:case 6:case 7:case 10:t.layerName="MainLayer";break;case 8:t.layerName="PatrolLayer";break;case 9:t.layerName="BlessLayer";break;case 11:t.layerName="RewardItemLayer"}y.send(d.jumpLayer,t),this.closeLayer()},i.onClickBtnGet=function(e){var t=h.getTaskInfoById(e.item.id),a=l.getRowById(c.tableName.dayTask,e.item.id);if(!(t.getAward||t.num<a.needNum)){var i=u.getInstance().addPropArrByDesign(a.award);this.openAwardGetLayer(i),t.getAward=1,this.refreshTopLayer(),this.scrollViewRefreshList(this.taskListNode),y.send(d.refreshRedPoint),n.eventSendCustomEvent("每日任务-参与领取奖励")}},i.onClickAwardItem=function(e){var t=e.award;this.openPropInfoLayer2(t[0],t[1])},a}(g))||f);a._RF.pop()}}}));

System.register("chunks:///_virtual/debugLogMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts"],(function(e){"use strict";var o,t,n,s,a,g;return{setters:[function(e){o=e.inheritsLoose},function(e){t=e.cclegacy,n=e._decorator,s=e.Label,a=e.Component},function(e){g=e.myLog}],execute:function(){var r;t._RF.push({},"ccf42J+I8tDmaThh5xgjFd9","debugLogMgr",void 0);var i=n.ccclass;n.property,e("DebugLogManager",i("DebugLogManager")(r=function(e){function t(){for(var o,t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return(o=e.call.apply(e,[this].concat(n))||this).logLabel=null,o.logMessages=[],o}o(t,e);var n=t.prototype;return n.onLoad=function(){var e=this;this.logLabel=this.node.getComponent(s);var o=g.d;g.d=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];var a=n.join(" ");e.logMessages.push(a),e.logMessages.length>100&&e.logMessages.shift(),e.updateLogDisplay(),n.unshift((new Date).toLocaleTimeString()),o(n)}},n.updateLogDisplay=function(){this.logLabel&&(this.logLabel.string=this.logMessages.join("\n"))},t}(a))||r);t._RF.pop()}}}));

System.register("chunks:///_virtual/designManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./resManager.ts"],(function(t){"use strict";var n,e,r,i,s;return{setters:[function(t){n=t.createClass},function(t){e=t.cclegacy,r=t.JsonAsset},function(t){i=t.constants},function(t){s=t.resManager}],execute:function(){e._RF.push({},"2f587trJmZF/Y4kXjIZp9XA","designManager",void 0);var a=function(){function t(){this.tb2Arr={},this.tb2Obj={},this.tbType2Arr={},this.config={}}var e=t.prototype;return e.loadAllDesignTable=function(t,n){var e=this;s.loadAsset(i.bundles.design,"design",r,(function(n){t&&t(n)}),(function(t,r){if(!t){for(var i in e.tb2Arr=r.json,e.tb2Arr){var a=e.tb2Arr[i];e.initTable(i,a)}s.releaseAsset(r),n&&n()}}))},e.initTable=function(t,n){for(var e in this.tb2Obj[t]={},n){var r=n[e];if(this.tb2Obj[t][r.id]=r,r.hasOwnProperty("type")&&""!=r.type&&null!=r.type)this.tbType2Arr[t]||(this.tbType2Arr[t]={}),this.tbType2Arr[t][r.type]||(this.tbType2Arr[t][r.type]=[]),this.tbType2Arr[t][r.type].push(r);"config"==t&&(this.config[r.name]=r.val||r.val2)}},e.getAllTables=function(){return this.tb2Arr},e.getTable=function(t){return this.tb2Arr[t]},e.getRowById=function(t,n){return this.tb2Obj[t][n]},e.getRowsByType=function(t,n){return this.tbType2Arr[t]&&this.tbType2Arr[t][n]?this.tbType2Arr[t][n]:[]},e.getLastRow=function(t){var n=this.getTable(t);return n[n.length-1]},e.getFirstIdByType=function(t){return 10*t+1},n(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}();a._instance=void 0;t("designManager",a.instance);e._RF.pop()}}}));

System.register("chunks:///_virtual/devModel.ts",["cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./layerManager.ts","./mapModel.ts","./playerModel.ts"],(function(){"use strict";var n,o,e,t,a,i,s,c,l;return{setters:[function(o){n=o.cclegacy},function(n){o=n.cocosUtil},function(n){e=n.utilTools},function(n){t=n.constants},function(n){a=n.audioManager},function(n){i=n.designManager},function(n){s=n.layerManager},function(n){c=n.mapModel},function(n){l=n.playerModel}],execute:function(){n._RF.push({},"a9bfcKNUT1MqpA94+oMlUD8","devModel",void 0),o.isDesktopBrowser()&&(window.designManager=i,window.audioManager=a,window.utilTools=e,window.constants=t,window.layerManager=s,window.mapModel=c,window.playerModel=l),n._RF.pop()}}}));

System.register("chunks:///_virtual/DialogEffect.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,o,c,n,s,r;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,c=t._decorator,n=t.tween,s=t.v3,r=t.Component}],execute:function(){var i;o._RF.push({},"41530QtsZtBv5/oXgY+vRZP","DialogEffect",void 0);var a=c.ccclass;c.property,t("DialogEffect",a("DialogEffect")(i=function(t){function o(){return t.apply(this,arguments)||this}return e(o,t),o.prototype.onEnable=function(){n(this.node).set({scale:s(0,0,0)}).to(.17,{scale:s(1.1,1.1,1.2)}).to(.06,{scale:s(1,1,1)}).start()},o}(r))||i);o._RF.pop()}}}));

System.register("chunks:///_virtual/EnergyLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./cocosUtil.ts","./constants.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts"],(function(e){"use strict";var t,r,a,n,i,o,s,h,d,g,c,y,l,f,m,v;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,a=e._decorator,n=e.find,i=e.UITransform,o=e.v2,s=e.ScrollView},function(e){h=e.sdkManager},function(e){d=e.cocosUtil},function(e){g=e.constants},function(e){c=e.msgac},function(e){y=e.designManager},function(e){l=e.eventManager},function(e){f=e.playerModel},function(e){m=e.UserData},function(e){v=e.BaseLayer}],execute:function(){var u;r._RF.push({},"58190TnmwpE/YWd1ec95OgO","EnergyLayer",void 0);var w=a.ccclass;a.property,e("EnergyLayer",w("EnergyLayer")(u=function(e){function r(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(t=e.call.apply(e,[this].concat(a))||this).timeNode=void 0,t.barNode=void 0,t.contentNode=void 0,t.handNode=void 0,t.itemUIArr=[],t}t(r,e);var a=r.prototype;return a.onLoad=function(){this.layerName=g.layers.EnergyLayer,e.prototype.onLoad.call(this),this.getNodeByPath("ui/title").localizeImg(),this.getNodeByPath("ui/bar/lv").localizeImg(),this.getNodeByPath("ui/hint").localize("hint",g.layers.EnergyLayer),this.getNodeByPath("ui/bar/freeText").localize("freeText",g.layers.EnergyLayer),this.getNodeByPath("ui/bar/extraText").localize("extraText",g.layers.EnergyLayer),this.timeNode=this.getNodeByPath("ui/time/text"),this.barNode=this.getNodeByPath("ui/energyListNoUtil/view/content/bar"),this.contentNode=this.getNodeByPath("ui/energyListNoUtil/view/content"),this.handNode=this.getNodeByPath("ui/energyListNoUtil/view/content/hand"),this.handNode.active=!1;for(var t=y.getTable(g.tableName.energyAward),r=n("layer/energyItem",this.contentNode),a=r,o=0;o<t.length;o++){var s=t[o];o>0&&((a=d.instantiate(r)).parent=n("layer",this.contentNode)),a.row=s,this.itemUIArr.push(a)}var h=a.getComponent(i).height;this.contentNode.getComponent(i).height=h*(t.length+.5),this.barNode.getComponent(i).height=h*t.length},a.onEnable=function(){var t=this;e.prototype.onEnable.call(this),this.addEventArr([c.energyObjRefresh]),this.scheduleOnce((function(){t.refreshShowList()}))},a.refreshShowList=function(){this.handNode.active=!1;for(var e=this.getNodeByPath("ui/energyListNoUtil"),t=null,r=0;r<this.itemUIArr.length;r++){var a=this.itemUIArr[r].row,h=f.getEnergyAwardInfoById(a.id);if(m.getInstance().energy>=a.num&&!h.award1){t=this.itemUIArr[r];break}}if(t){this.handNode.active=!0;var g=d.convertToWorldSpace(n("awardLayer/awardItem1",t));g=d.convertToNodeSpace(this.handNode,g),this.handNode.position=g}if(!t)for(var c=0;c<this.itemUIArr.length;c++){var y=this.itemUIArr[c].row;if(m.getInstance().energy<y.num){t=this.itemUIArr[c];break}}t||(t=this.itemUIArr[this.itemUIArr.length-1]);var l=Math.abs(t.position.y)-t.getComponent(i).height;l<0&&(l=0);var v=o(0,0);v.y=l,e.getComponent(s).scrollToOffset(v,.6)},a.onDisable=function(){e.prototype.onDisable.call(this),this.removeEventArr([c.energyObjRefresh])},a.onDestroy=function(){e.prototype.onDestroy.call(this)},a.energyObjRefreshRet=function(e){var t=this.getNodeByPath("ui/energyListNoUtil").getComponent(s);t.stopAutoScroll(),t.scrollToTop(),this.initUI()},a.initUI=function(){this.refreshTimeNode(),this.refreshItemUIArr(),this.refrshProgress()},a.refreshTimeNode=function(){var e=f.energyObj.endTime.getTime()-(new Date).getTime(),t=Math.floor(e/g.times.day),r=Math.ceil((e-t*g.times.day)/g.times.houre);this.timeNode.localize({key:"time",cat:g.layers.EnergyLayer,vars:[t,r]})},a.refrshProgress=function(){for(var e=y.getTable(g.tableName.energyAward),t=0,r=0;r<e.length;r++){var a=e[r];if(m.getInstance().energy<a.num){t=r+1;break}}var n=1/e.length*(t-1);if(0==t)n=1;else{var i=y.getRowById(g.tableName.energyAward,t),o=y.getRowById(g.tableName.energyAward,t-1),s=0;o&&(s=o.num);var h=i.num-s,d=m.getInstance().energy-s;n+=1/e.length*(d/h)}this.setProgressBar(this.barNode,n)},a.refreshItemUIArr=function(){for(var e=0;e<this.itemUIArr.length;e++){var t=this.itemUIArr[e],r=t.row;this.setString(n("flag/rank",t),r.id),n("flag/num",t).localize({key:"energyPoint",cat:g.layers.EnergyLayer,vars:[r.num]});var a=f.getEnergyAwardInfoById(r.id);n("awardLayer/awardItem1",t).row=r;var i=n("awardLayer/awardItem1/shine",t),o=n("awardLayer/awardItem1/lock",t),s=n("awardLayer/awardItem1/hasGet",t);s.getChildByName("get").localizeImg(),i.active=!1,o.active=!1,s.active=!1,m.getInstance().energy>=r.num?a.award1?s.active=!0:i.active=!0:o.active=!0,n("awardLayer/awardItem2",t).row=r;var h=n("awardLayer/awardItem2/shine",t),d=n("awardLayer/awardItem2/lock",t),c=n("awardLayer/awardItem2/hasGet",t);c.getChildByName("get").localizeImg(),h.active=!1,d.active=!1,c.active=!1,m.getInstance().energy>=r.num?a.award2?c.active=!0:h.active=!0:d.active=!0}},a.onClickAwardItem1=function(e){var t=e.row;if(m.getInstance().energy<t.num)this.openAwardInfoLayer(t.award1);else{var r=f.getEnergyAwardInfoById(t.id);if(r.award1)this.openAwardInfoLayer(t.award1);else{r.award1=1;var a=m.getInstance().addPropArrByDesign(t.award1);this.openAwardGetLayer(a),this.initUI(),this.refreshShowList(),l.send(c.refreshRedPoint)}}},a.onClickAwardItem2=function(e){var t=this,r=e.row;if(m.getInstance().energy<r.num)this.openAwardInfoLayer(r.award2);else{var a=f.getEnergyAwardInfoById(r.id);a.award2?this.openAwardInfoLayer(r.award2):h.openAd("能量战令",(function(e){if(1==e){a.award2=1;var n=m.getInstance().addPropArrByDesign(r.award2);t.openAwardGetLayer(n),t.initUI()}}))}},a.onClickBar=function(){},r}(v))||u);r._RF.pop()}}}));

System.register("chunks:///_virtual/eventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./msgac.ts"],(function(t){"use strict";var n,e,a,i;return{setters:[function(t){n=t.createClass},function(t){e=t.cclegacy},function(t){a=t.myLog},function(t){i=t.msgac}],execute:function(){e._RF.push({},"c2a1a1LsQRIE5uIjpvtQUe8","eventManager",void 0);var s=function(){function t(){this.acList={}}var e=t.prototype;return e.on=function(t,n,e){var a=this.acList[t];for(var i in a||(a=[],this.acList[t]=a),a){if(a[i].sender==e)return}var s={};s.cb=n,s.sender=e,a.push(s)},e.off=function(t,n,e){var a=this.acList[t];if(a){var i=[];for(var s in a){var r=a[s];r.cb==n&&r.sender==e||i.push(r)}this.acList[t]=i}},e.offWithSender=function(t){for(var n in this.acList){var e=this.acList[n],a=[];for(var i in e){var s=e[i];s.sender!=t&&a.push(s)}this.acList[n]=a}},e.send=function(t,n){var e=this.acList[t];if(e){var s=!0;if(n&&n.notMyLog&&(s=!1),t==i.joystick&&(s=!1),s){var r=i.ac2KeyObj[t];a.i(r,n)}try{for(var c in e){var o=e[c],u=o.cb,v=o.sender,f={ac:t,data:n};u.call(v,f)}}catch(e){a.e("eventManager send error:"+e.message,t,n,e)}}},n(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}();s._instance=void 0;t("eventManager",s.instance);e._RF.pop()}}}));

System.register("chunks:///_virtual/feiBiao.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var i,e,n,o,r,a,c;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,o=t.UITransform,r=t.UIOpacity,a=t.tween,c=t.Component}],execute:function(){var s;e._RF.push({},"93580dXRklK6LDsaqgFZDJp","feiBiao",void 0);var h=n.ccclass;n.property,t("feiBiao",h("feiBiao")(s=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).hint=void 0,i}return i(e,t),e.prototype.init=function(t){var i=this;this.hint=t;var e=this.hint.bodyNode.getComponent(o);e.width=this.hint.extraObj.width,e.height=this.hint.extraObj.height;var n=this.getComponent(r);n.opacity=255,a(n).to(.3,{opacity:0}).call((function(){i.hint.recycleSelf()})).start()},e}(c))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/FileUtils.ts",["cc"],(function(e){"use strict";var t,i;return{setters:[function(e){t=e.cclegacy,i=e.sys}],execute:function(){var n;t._RF.push({},"85132CQcl5K4IQopku+kAoz","FileUtils",void 0),function(e){e[e.DATA_URL=0]="DATA_URL",e[e.TEXT=1]="TEXT",e[e.BINARY=2]="BINARY",e[e.ARRAYBUFFER=3]="ARRAYBUFFER"}(n||(n={}));e("FileUtils",function(){function e(){}return e.openLocalFile=function(e,t){var i=document.getElementById("file_input");i||((i=document.createElement("input")).id="file_input",i.setAttribute("id","file_input"),i.setAttribute("type","file"),i.setAttribute("class","fileToUpload"),i.style.opacity="0",i.style.position="absolute",i.setAttribute("left","-999px"),document.body.appendChild(i)),e=e||".*",i.setAttribute("accept",e),i.onchange=function(e){var n=i.files;if(n&&n.length>0){var a=n[0];t&&t(a)}},i.click()},e.readLocalFile=function(e,t,i){var a=new FileReader;switch(a.onload=function(e){i&&(a.readyState==FileReader.DONE?i(a.result):i(null))},t){case n.DATA_URL:a.readAsDataURL(e);break;case n.TEXT:a.readAsText(e);break;case n.BINARY:a.readAsBinaryString(e);break;case n.ARRAYBUFFER:a.readAsArrayBuffer(e)}},e.saveForBrowser=function(e,t){if(i.isBrowser){console.log("浏览器");var n=new Blob([e],{type:"text/plain;charset=utf-8"}),a=document.createElement("a");a.download=t,a.innerHTML="Download File",null!=window.webkitURL?a.href=window.webkitURL.createObjectURL(n):(a.href=window.URL.createObjectURL(n),a.style.display="none",document.body.appendChild(a)),a.click()}},e.saveDataForNative=function(e,t,n){if(void 0===n&&(n="wb"),i.isNative){var a=window.myjsb;if(a)return a.MyFileUtils.getInstance().writeDataToFile(e,n,t)}return!1},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/GameCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./msgac.ts","./eventManager.ts"],(function(t){"use strict";var o,i,e,n,s,c,h,r,a,d;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,e=t._decorator,n=t.find,s=t.Node,c=t.Vec3,h=t.Component},function(t){r=t.cocosUtil},function(t){a=t.msgac},function(t){d=t.eventManager}],execute:function(){var u;i._RF.push({},"1e325KYY1ZPsLTs0SuYv9z+","GameCtrl",void 0);var l=e.ccclass;e.property,t("GameCtrl",l("GameCtrl")(u=function(t){function i(){for(var o,i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return(o=t.call.apply(t,[this].concat(e))||this).joystickNode=void 0,o.blockNode=void 0,o.radius=70,o.orignPosition=void 0,o}o(i,t);var e=i.prototype;return e.onLoad=function(){this.joystickNode=n("joystick",this.node),this.blockNode=n("block",this.joystickNode),this.orignPosition=this.joystickNode.getPosition().clone()},e.start=function(){this.node.on(s.EventType.TOUCH_START,this.touchStart,this),this.node.on(s.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(s.EventType.TOUCH_END,this.touchEnd,this),this.node.on(s.EventType.TOUCH_CANCEL,this.touchCancel,this)},e.touchStart=function(t){var o=t.getUILocation(),i=new c(o.x,o.y,0);i=r.convertToNodeSpace(this.joystickNode,i),this.joystickNode.setPosition(i),this.blockNode.setPosition(0,0),this.sendTouchEvent("start",t)},e.touchMove=function(t){var o=t.getUILocation(),i=new c(o.x,o.y,0);(i=r.convertToNodeSpace(this.blockNode,i)).length()>this.radius&&i.normalize().multiplyScalar(this.radius),this.blockNode.setPosition(i),this.sendTouchEvent("move",t,i)},e.touchEnd=function(t){this.joystickNode.setPosition(this.orignPosition),this.blockNode.setPosition(0,0),this.sendTouchEvent("end",t)},e.touchCancel=function(t){this.joystickNode.setPosition(this.orignPosition),this.blockNode.setPosition(0,0),this.sendTouchEvent("end",t)},e.sendTouchEvent=function(t,o,i){i&&(i=i.normalize().clone());var e={type:t,event:o,pos:i};d.send(a.joystick,e)},i}(h))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/GameLaunch.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./conf.ts","./CronCtr.ts","./ServerCtr.ts","./tyqAdManager.ts","./cocosUtil.ts","./BaseLayer.ts","./constants.ts","./msgac.ts","./audioManager.ts","./eventManager.ts","./layerManager.ts","./localStorageManager.ts","./playerModel.ts","./utilTools.ts"],(function(e){"use strict";var t,n,o,i,s,a,r,c,u,l,g,d,h,f,p,v,y,m,C,b,L,N,D,S,M,E;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator,i=e.find,s=e.AudioSource,a=e.director,r=e.Node,c=e.assetManager,u=e.macro},function(e){l=e.myLog},function(e){g=e.GNetCmd,d=e.GNetConst,h=e.GLoginState},function(e){f=e.default},function(e){p=e.default},function(e){v=e.tyqAdManager},function(e){y=e.cocosUtil},function(e){m=e.BaseLayer},function(e){C=e.constants},function(e){b=e.msgac},function(e){L=e.audioManager},function(e){N=e.eventManager},function(e){D=e.layerManager},function(e){S=e.localStorageManager},function(e){M=e.playerModel},function(e){E=e.utilTools}],execute:function(){var G;n._RF.push({},"0ca88Ac39FHk6N+9LN2sjMi","GameLaunch",void 0);var k=o.ccclass;o.property,e("GameLaunch",k("GameLaunch")(G=function(e){function n(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(t=e.call.apply(e,[this].concat(o))||this).debugCount=0,t.debugTimer=void 0,t.isCounting=void 0,t}t(n,e);var o=n.prototype;return o.onLoad=function(){var t=this;e.prototype.onLoad.call(this),M.isInDevelopmentEnvironment()&&(l.isOpen=!0),y.init(),b.init(),e.prototype.onLoad.call(this),E.getCurGameVersion().then((function(e){var n=t.getNodeByPath("btnTest/Label");t.setString(n,e)})).catch((function(e){console.error(e)}));var n=i("layer1",this.node),o=i("layerHint",this.node),r=i("layerDebugLog",this.node);D.init(n,o,r),L.setMusicAudioSource(this.getNodeByPath("audio/music").getComponent(s)),L.setEffectAudioSource(this.getNodeByPath("audio/effect").getComponent(s));var c=C.layers.LoadingLayer;this.getNodeByPath(c).addComponent(c);var u=C.layers.NoticeLayer;i(u,o).addComponent(u),l.i("========启动参数：",v.getEnterUrlQuery()),a.on(g.GetFriendVal.toString(),this.onMessageEvent,this),a.on(g.ReqWxSession.toString(),this.onMessageEvent,this),a.on(g.GetRegionData.toString(),this.onMessageEvent,this)},o.onEnable=function(){e.prototype.onEnable.call(this),this.addEventArr([b.openLayer,b.showNotice])},o.onDisable=function(){e.prototype.onDisable.call(this)},o.start=function(){i("Canvas").on(r.EventType.TOUCH_START,(function(e){N.send(b.globalTouchStart,e)}))},o.onMessageEvent=function(e){if(console.log("处理服务端发送的消息:",e),e.status!=d.ResSuccess)return console.error("服务端响应失败~!"),p.GetInstance().isLogin=!1,f.getInstance().isPutEnable=!1,void(p.GetInstance().loginState=h.loginWithAccount);var t=p.GetInstance();switch(e.cmd){case g.GetFriendVal:M.shareObj.friendNum=e.friendCnt;var n=JSON.parse(e.friendData);M.shareObj.friendAdNum=n.videoCalCnt,M.shareObj.friendPassNum=n.friendPassCnt;break;case g.ReqWxSession:t.token=e.token,t.regionDataList=e.regionDataList,e.nickName&&""!=e.nickName&&(t.nickName=e.nickName),p.GetInstance().reqRegionData(),e.wxRes&&e.wxRes.openid&&(S.openId=e.wxRes.openid),e.uid&&(S.uid=e.uid);break;case g.GetRegionData:t.token=e.token,t.isLogin=!0,p.GetInstance().serverDataVersion=e.dataVersion,e.dataVersionFlag==d.ServerIsNew&&(p.GetInstance().serverData=JSON.parse(e.jsonData)),t.loginState=h.loginWithAccount,f.getInstance().isPutEnable=!1,console.log("获得服务端数据!",p.GetInstance().serverData),t.uid=e.uid,t.regionId=e.regionId}},o.openLayerRet=function(e){this.openLayer(C.layers[e.name],e)},o.showNoticeRet=function(e){this.createNotice(e)},o.refreshDebugPannel=function(){i("layerDebugLog",this.node).active=M.isOpenDev||M.isInDevelopmentEnvironment()},o.onClickBtnTest=function(e){l.i(c.assets),console.log("onClickDebugOpenBtn 按下了"+this.debugCount),this.isCounting?(this.debugCount++,this.debugCount>=10&&(M.isOpenDev=!M.isInDevelopmentEnvironment(),N.send(b.refreshDebugPannel),this.resetCounter())):(this.isCounting=!0,this.debugCount=1,this.schedule(this.checkCount,1,u.REPEAT_FOREVER,0))},o.checkCount=function(e){this.debugTimer+=e,this.debugTimer>=10&&this.resetCounter()},o.resetCounter=function(){this.unschedule(this.checkCount),this.isCounting=!1,this.debugCount=0,this.debugTimer=0},o.onClickBtnHintClose=function(){this.hideHintLayer()},n}(m))||G);n._RF.pop()}}}));

System.register("chunks:///_virtual/GameMemoryStorage.ts",["cc"],(function(t){"use strict";var e,r;return{setters:[function(t){e=t.cclegacy,r=t._decorator}],execute:function(){var n,o;e._RF.push({},"55b2ffzgpVPZ4Ld/QLrvdot","GameMemoryStorage",void 0);var c=r.ccclass;r.property,t("default",c(((o=function(){function t(){}return t.getItem=function(t){return localStorage.getItem(t)},t.setItem=function(t,e){localStorage.setItem(t,this.encrypt(e))},t.removeItem=function(t){localStorage.removeItem(t)},t.len=function(){return Object.keys(this.memory).length},t.keys=function(){var t=[];for(var e in this.memory)t.push(e);return t},t.encrypt=function(t){return t},t.decrypt=function(t){return t},t}()).memory={},o.publicKey="JmksO12Ldl60Lsk",o.isEncrypt=!1,n=o))||n);e._RF.pop()}}}));

System.register("chunks:///_virtual/gameStorage.ts",["./rollupPluginModLoBabelHelpers.js","cc","./conf.ts","./GameMemoryStorage.ts"],(function(e){"use strict";var t,r,n,a,i,o,s,l;return{setters:[function(e){t=e.inheritsLoose,r=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){a=e.cclegacy,i=e._decorator,o=e.Component},function(e){s=e.GNetConst},function(e){l=e.default}],execute:function(){var g,c;a._RF.push({},"d28a9LZiYhKeJA2ODlbTLd0","gameStorage",void 0);var u=i.ccclass;i.property,e("GameStorage",u("GameStorage")(((c=function(e){function a(){return e.apply(this,arguments)||this}return t(a,e),a.Key=function(e){return this.GameKey+"_"+e},a.GetRawKey=function(e){return e.replace(a.GameKey+"_","")},a.getStorage=function(){return l},a.getInt=function(e,t){void 0===t&&(t=0);var r=this.getStorage().getItem(this.Key(e));return null!==r&&""!==r?Number(r):t},a.setInt=function(e,t){e=this.Key(e),this.getStorage().setItem(e,t+"")},a.setIntMemory=function(e,t){e=this.Key(e),this.getStorage().setItem(e,t+"")},a.getBoolean=function(e,t){void 0===t&&(t=!1);var r=this.getStorage().getItem(this.Key(e));return null!==r&&""!==r?1==Number(r):t},a.setBoolean=function(e,t){e=this.Key(e);var r=t?1:0;this.getStorage().setItem(e,r+"")},a.setBooleanMemory=function(e,t){e=this.Key(e);var r=t?1:0;this.getStorage().setItem(e,r+"")},a.getString=function(e,t){void 0===t&&(t="");var r=this.getStorage().getItem(this.Key(e));return null!==r&&""!==r?r:t},a.getStringDisk=function(e,t){void 0===t&&(t="");var r=localStorage.getItem(this.Key(e));return null!==r&&""!==r?r:t},a.getIntDisk=function(e,t){void 0===t&&(t="");var r=localStorage.getItem(this.Key(e));return null!==r&&""!==r?Number(r):t},a.setStringDisk=function(e,t){localStorage.setItem(this.Key(e),t)},a.setStringMemory=function(e,t){e=this.Key(e),this.getStorage().setItem(e,t),localStorage.setItem(e,t)},a.setString=function(e,t){e=this.Key(e),this.getStorage().setItem(e,t),a.GameKey},a.getObject=function(e,t){void 0===t&&(t=null);var r=this.getStorage().getItem(this.Key(e));if(null!==r&&""!==r)try{return JSON.parse(r)||t}catch(e){return t}return t},a.setObject=function(e,t){e=this.Key(e);var r=JSON.stringify(t);this.getStorage().setItem(e,r)},a.sendObject=function(e,t){e=this.Key(e);JSON.stringify(t)},a.setObjectMemory=function(e,t){e=this.Key(e);var r=JSON.stringify(t);this.getStorage().setItem(e,r)},a.removeItem=function(e){e=this.Key(e),this.getStorage().removeItem(e)},a.clear=function(){for(var e=[],t=0;t<localStorage.length;t++){var r=localStorage.key(t);r.indexOf(this.GameKey)>=0&&-1==r.indexOf("login")&&-1==r.indexOf("zzdl")&&e.push(r)}for(var n=this.getStorage().keys(),a=0;a<n.length;a++){var i=n[a];-1==i.indexOf("login")&&-1==i.indexOf("zzdl")&&e.push(i)}for(var o=0;o<e.length;o++){var s=e[o];this.getStorage().removeItem(s)}},a.clearByKey=function(e){for(var t=[],r=0;r<localStorage.length;r++){var n=localStorage.key(r);-1!=n.indexOf(e)&&t.push(n)}for(var a=0;a<t.length;a++){var i=t[a];this.getStorage().removeItem(i)}},a.getStringArrayByKey=function(e){for(var t=[],r=[],n=this.getStorage().keys(),a=0;a<n.length;a++){var i=n[a];if(-1!=i.indexOf(e)){var o=this.getStorage().getItem(i);t.push(o),r.push(i)}}return{keys:r,values:t}},a.getObjectArrayByKey=function(e){for(var t=[],r=this.getStorage().keys(),n=0;n<r.length;n++){var a=r[n];if(-1!=a.indexOf(e)){var i=this.getStorage().getItem(a),o=null;if(null!==i&&""!==i)try{o=JSON.parse(i)||null}catch(e){o=null}o&&t.push(o)}}return t},a.getAll=function(e){void 0===e&&(e=!1);for(var t={},r=0;r<localStorage.length;r++){var n=localStorage.key(r);if(-1==n.indexOf("login"))if(e){var i=n;t[n.replace("zzdl",a.GameKey)]=localStorage.getItem(i)}else{if(-1!=n.indexOf("zzdl"))continue;t[n]=localStorage.getItem(n)}}if(e){var o={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var l=t[s];switch(s){case a.GameKey+"_sect_xtbls":for(var g=JSON.parse(l),c=0;c<g.length;c++){var u=g[c],f={id:u.id,star:u.star,debris:u.debris};o[a.GameKey+"_SectXtbl_"+u.id]=JSON.stringify(f)}break;case a.GameKey+"_pack_equips":for(var h=JSON.parse(l),y=0;y<h.length;y++){var v=h[y],S={id:v.id,index:v.index,level:v.level,star:v.star,partner:v.partner,score:v.score,skill_skr:v.skill_skr,skill_skr_attr:v.skill_skr_attr,skill_star:v.skill_star,skill_star_attr:v.skill_star_attr};o[a.GameKey+"pack_equip_"+v.index]=JSON.stringify(S)}break;default:localStorage.setItem(s,l)}}for(var m in delete t.zzdl_sect_xtbls,delete t.zzdl_pack_equips,o){var d=o[m];t[m]=d}}return t},a.setAll=function(){var e=r(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t)this.getStorage().setItem(r,t[r]);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a}(o)).GameKey=s.SaveHead,g=c))||g);a._RF.pop()}}}));

System.register("chunks:///_virtual/GParam.ts",["cc","./MapWrap.ts"],(function(t){"use strict";var n,e;return{setters:[function(t){n=t.cclegacy},function(t){e=t.MapWrap}],execute:function(){n._RF.push({},"10abfD21F5JKaWJ0jnuKCjx","GParam",void 0);t("default",function(){function t(t){this.arguments=new e,this._onlyArgument=void 0,this._onlyArgument=t}var n=t.prototype;return n.push=function(t,n){t&&this.arguments.set(t,n)},n.get=function(t){return t?this.arguments.get(t):this._onlyArgument},n.clear=function(){this.arguments.clear()},n.toList=function(){return 0==this.arguments.size?null:this.arguments.values()},n.toString=function(){for(var t=this.arguments.keys(),n="",e=0;e<t.length;e++)n+=t[e]+"="+this.get(t[e])+"/t";return n},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/GuessGameLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./constants.ts","./designManager.ts","./eventManager.ts","./UserData.ts","./BaseUILayer.ts"],(function(e){"use strict";var t,i,s,r,n,a,o,l,u,c,h,p,f,y,m,g,b,d,S;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,s=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,o=e.Node,l=e.Label,u=e.SpriteFrame,c=e.instantiate,h=e.tween,p=e.v3,f=e.Sprite},function(e){y=e.tyqSDK},function(e){m=e.constants},function(e){g=e.designManager},function(e){b=e.eventManager},function(e){d=e.UserData},function(e){S=e.BaseUILayer}],execute:function(){var G,v,_,L,B,N,w,C,z,D,I,R,M,U,F,P,T,k,A,x,q,E,K,j,H;n._RF.push({},"109e3kYaCtJkr3flGDsZSB5","GuessGameLayer",void 0);var J=a.ccclass,W=a.property;e("GuessGameLayer",(G=J("GuessGameLayer"),v=W({type:o}),_=W(o),L=W(o),B=W(o),N=W(o),w=W(o),C=W(l),z=W({type:o}),D=W(u),I=W(o),R=W(o),G((F=t((U=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return t=e.call.apply(e,[this].concat(n))||this,s(t,"btnClose",F,r(t)),s(t,"armNodeGuess",P,r(t)),s(t,"selectBetNode",T,r(t)),s(t,"itemLayer",k,r(t)),s(t,"selectGuessNode",A,r(t)),s(t,"guessLayer",x,r(t)),s(t,"tipLabel",q,r(t)),s(t,"btnlayer",E,r(t)),s(t,"guessSprite",K,r(t)),s(t,"items",j,r(t)),s(t,"guessItems",H,r(t)),t._curSelectGuess=-1,t._curSelectBet=-1,t._index=0,t._dtTime=0,t._isStartRun=!1,t}i(t,e);var n=t.prototype;return n.onLoad=function(){},n.onEnable=function(){this.addTopUILayer("TopUILayer"),this.fitNodeWidget(this.btnlayer,30)},n.onDisable=function(){e.prototype.onDisable.call(this),b.off("initGuess",this.initGuess,this)},n.onDestroy=function(){e.prototype.onDestroy.call(this)},n.start=function(){b.on("initGuess",this.initGuess,this);var e=g.config.stone1;console.log("stone1 = ",e);for(var t=0;t<6;t++)e[t]&&this.items[t]&&(this.items[t].getChildByName("numLab").getComponent(l).string=""+e[t][1])},n.closeBless=function(){this.closeLayer()},n.initGuess=function(){this.selectBetNode.removeAllChildren(),this.armNodeGuess.active=!1;var e=this.selectGuessNode.getChildByName("selectGuess");if(e&&e.removeFromParent(),this._index=0,this._dtTime=0,this._isStartRun=!1,this._curSelectGuess=-1,this.itemLayer.active=!0,this.guessLayer.active=!0,this.tipLabel.node.active=!0,this.tipLabel.string="默认上次选择金额，可重新选择",this._curSelectBet>-1)for(var t=0;t<6;t++)this.items[t]&&(this.items[t].getChildByName("gou").active=this._curSelectBet==t)},n.onSelectBet=function(e,t){if(this._curSelectBet==t&&this.selectBetNode.children.length>0){this.selectBetNode.removeAllChildren(),this._curSelectBet=-1,this.itemLayer.active=!0;for(var i=0;i<6;i++)this.items[i]&&(this.items[i].getChildByName("gou").active=this._curSelectBet==i);this.tipLabel.string="请选择下注金额"}else{this._curSelectBet=t,console.log("select bet = ",t);var s=c(this.items[this._curSelectBet]);s.getChildByName("gou").active=!1,this.selectBetNode.addChild(s),h(s).to(.5,{position:p(0,-30,0)}).start(),this.tipLabel.string="请猜拳",this.itemLayer.active=!1}},n.onSelectBtn=function(e,t){if(!(this._curSelectGuess>=0))if(this._curSelectBet<0)this.toast("请先下注");else{var i=g.config.stone1[this._curSelectBet],s={Id:i[0],Num:i[1]};d.getInstance().checkUseProp(s)?(this._curSelectGuess=parseInt(t+""),this._isStartRun=!0,this.tipLabel.node.active=!1,this.guessLayer.active=!1):this.toast("资源不足")}},n.openResult=function(){var e=Math.floor(3*Math.random()),t=["石头","剪刀","布"];console.log("我方：",t[this._curSelectGuess]),console.log("敌方：",t[e]),this.armNodeGuess.getChildByName("icon").getComponent(f).spriteFrame=this.guessSprite[e];var i=g.config.stoneDraw,s=1;s=this._curSelectGuess-e==-1||this._curSelectGuess-e==2?i[0]:this._curSelectGuess==e?i[1]:i[2];var r=g.config.stone1[this._curSelectBet],n={Id:r[0],Num:r[1]*s};d.getInstance().getRewardProp([n]),this.openLayer(m.layers.GuessResultLayer,{propArr:[n],myGuess:this._curSelectGuess,otherGuess:e}),this.initGuess()},n.update=function(e){this._isStartRun&&(this.openLayer(m.layers.GuessResultLayer,{myGuess:this._curSelectGuess,selectBet:this._curSelectBet}),this._isStartRun=!1,y.eventSendCustomEvent("参与猜拳"))},t}(S)).prototype,"btnClose",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(U.prototype,"armNodeGuess",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(U.prototype,"selectBetNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(U.prototype,"itemLayer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(U.prototype,"selectGuessNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(U.prototype,"guessLayer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(U.prototype,"tipLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(U.prototype,"btnlayer",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(U.prototype,"guessSprite",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=t(U.prototype,"items",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=t(U.prototype,"guessItems",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=U))||M));n._RF.pop()}}}));

System.register("chunks:///_virtual/GuessResultLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./designManager.ts","./eventManager.ts","./UserData.ts","./RewardLayer.ts"],(function(e){"use strict";var t,i,s,r,n,o,a,u,l,c,p,d,h,m,g,f,y,b,N;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,s=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){n=e.cclegacy,o=e._decorator,a=e.Node,u=e.Sprite,l=e.sp,c=e.SpriteFrame,p=e.v3,d=e.tween,h=e.Label},function(e){m=e.sdkManager},function(e){g=e.constants},function(e){f=e.designManager},function(e){y=e.eventManager},function(e){b=e.UserData},function(e){N=e.RewardLayer}],execute:function(){var w,S,_,v,G,R,C,B,I,D,z,F,L,M,k,x,T,q,P,V,A,U,Y,j,E;n._RF.push({},"d47f185DCpGq4YQ2fvT43RX","GuessResultLayer",void 0);var H=o.ccclass,Q=o.property;e("GuessResultLayer",(w=H("GuessResultLayer"),S=Q({type:a}),_=Q(u),v=Q(u),G=Q(l.Skeleton),R=Q({type:a}),C=Q({type:a}),B=Q({type:a}),I=Q(c),D=Q(c),z=Q(a),F=Q(a),w((k=t((M=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return t=e.call.apply(e,[this].concat(n))||this,s(t,"btnClose",k,r(t)),s(t,"guessItem2",x,r(t)),s(t,"guessItem1",T,r(t)),s(t,"spk",q,r(t)),s(t,"btnNode",P,r(t)),s(t,"resultNode",V,r(t)),s(t,"rewardNode",A,r(t)),s(t,"guessSprite",U,r(t)),s(t,"guessNameSprite",Y,r(t)),t._curSelectGuess=-1,t._curSelectBet=void 0,t._propItem=null,t._index=0,t._dtTime=0,t._isStartRun=!1,s(t,"armNodeGuess",j,r(t)),s(t,"selfNodeGuess",E,r(t)),t}i(t,e);var n=t.prototype;return n.onLoad=function(){},n.onEnable=function(){},n.onDisable=function(){e.prototype.onDisable.call(this)},n.onDestroy=function(){e.prototype.onDestroy.call(this)},n.start=function(){var e=this.layerData.myGuess;this._curSelectBet=this.layerData.selectBet,this.guessItem1.spriteFrame=this.guessSprite[parseInt(e)],this.selfNodeGuess.getChildByName("cloth1").getComponent(u).spriteFrame=this.guessNameSprite[parseInt(e)],this._curSelectGuess=this.layerData.myGuess,this.selfNodeGuess.position=p(-380,0,0),this.armNodeGuess.position=p(380,0,0);var t=this;d(this.selfNodeGuess).to(.2,{position:p(-190,0,0)}).call((function(){t._isStartRun=!0})).start(),d(this.armNodeGuess).to(.2,{position:p(190,0,0)}).start(),this.resultNode.active=!1,this.rewardNode.active=!1,this.btnNode.active=!1},n.closeBless=function(){y.send("initGuess"),this.closeLayer()},n.update=function(e){this._isStartRun&&(this._dtTime+=e,this._dtTime>.1&&(this._dtTime=0,this.armNodeGuess.getChildByName("icon").getComponent(u).spriteFrame=this.guessSprite[this._index%3],this.armNodeGuess.getChildByName("cloth1").getComponent(u).spriteFrame=this.guessNameSprite[this._index%3],this._index++,this._index>20&&(this._isStartRun=!1,this.openResult())))},n.openResult=function(){var e=Math.floor(3*Math.random()),t=["石头","剪刀","布"];console.log("我方：",t[this._curSelectGuess]),console.log("敌方：",t[e]),this.armNodeGuess.getChildByName("icon").getComponent(u).spriteFrame=this.guessSprite[e],this.armNodeGuess.getChildByName("cloth1").getComponent(u).spriteFrame=this.guessNameSprite[e];var i=f.config.stoneDraw,s=1;this.resultNode.active=!0,this.resultNode.position=p(0,550,0),d(this.resultNode).to(.2,{position:p(0,480,0)}).start();var r=this.resultNode.getChildByName("result1");r.position=p(0,150,0);var n=this;d(r).to(.2,{position:p(0,33,0)}).call((function(){n.btnNode.active=!0})).start(),this._curSelectGuess-e==-1||this._curSelectGuess-e==2?(console.log(" ---- win"),s=i[0],this.setSpriteFrame2(r,"activityRes/result1",null,g.bundles.wwqVec),this.showYanhua()):this._curSelectGuess==e?(console.log(" ---- 平局"),s=i[1],this.setSpriteFrame2(r,"activityRes/result2",null,g.bundles.wwqVec)):(this.setSpriteFrame2(r,"activityRes/result3",null,g.bundles.wwqVec),console.log(" ---- lose"),s=i[2]);var o=f.config.stone1[this._curSelectBet],a={Id:o[0],Num:o[1]*s},l=f.getRowById(g.tableName.prop,o[0]);this.setSpriteFrame2(this.rewardNode.getChildByName("icon"),"prop/"+l.icon),this.rewardNode.active=!0,this.rewardNode.getChildByName("numLab").getComponent(h).string=o[1]*s+"",b.getInstance().getRewardProp([a]),this._propItem=[a]},n.doubleGet=function(){var e=this;m.openAd("猜拳双倍奖励",(function(t){1==t&&(e._propItem&&b.getInstance().getRewardProp(e._propItem),e.closeBless())}))},t}(N)).prototype,"btnClose",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(M.prototype,"guessItem2",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(M.prototype,"guessItem1",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(M.prototype,"spk",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(M.prototype,"btnNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(M.prototype,"resultNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(M.prototype,"rewardNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(M.prototype,"guessSprite",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Y=t(M.prototype,"guessNameSprite",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=t(M.prototype,"armNodeGuess",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(M.prototype,"selfNodeGuess",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=M))||L));n._RF.pop()}}}));

System.register("chunks:///_virtual/H5AdSdk4399.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){"use strict";var e,o,t;return{setters:[function(n){e=n.createClass},function(n){o=n.cclegacy,t=n.assetManager}],execute:function(){o._RF.push({},"6ae05hgNhdP2qwhrqgKJeMz","H5AdSdk4399",void 0),n("H5AdSdk4399",function(){function n(){}var o=n.prototype;return o.showRewardedAd=function(n){if(window.h5api){return console.log("开始播放 h5api"),void window.h5api.playAd((function(e){console.log("代码:"+e.code+",消息:"+e.message),1e4===e.code?console.log("开始播放"):10001===e.code?(console.log("播放结束"),n&&n(1)):(console.log("广告异常"),n&&n(0))}))}},o.checkDownUrl=function(){if(window.h5api){!function(){t.transformPipeline.append((function(n,e){for(var o=n.output=n.input,t=0;t<o.length;t++){var i=o[t];if(i.url){var r=i.url.split(".");if(r.length>=2&&"cconb"==r[r.length-1]){i.url="";for(var c=0;c<r.length-1;c++){var l=r[c];i.url+=l+"."}i.url+="_cconb.dbbin"}if(r.length>=2&&"bin"==r[r.length-1]){i.url="";for(var u=0;u<r.length-1;u++){var a=r[u];i.url+=a+"."}i.url+="dbbin"}}}return null}));var n=t.downloader._downloaders,e=n[".dbbin"];t.downloader.register("dbbin",(function(o,t,i){o.includes("_cconb")?n[".cconb"]():e()}))}()}},e(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}())._instance=void 0,o._RF.pop()}}}));

System.register("chunks:///_virtual/HandLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./msgac.ts","./BaseLayer.ts","./constants.ts"],(function(t){"use strict";var n,o,e,a,r,s;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator},function(t){a=t.msgac},function(t){r=t.BaseLayer},function(t){s=t.constants}],execute:function(){var c;o._RF.push({},"2a4c8xwp8pKy4PtBA/7pPD5","HandLayer",void 0);var i=e.ccclass;e.property,t("HandLayer",i("HandLayer")(c=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var e=o.prototype;return e.onLoad=function(){t.prototype.onLoad.call(this)},e.onEnable=function(){t.prototype.onEnable.call(this),this.addEventArr([a.globalTouchStart])},e.onDisable=function(){t.prototype.onDisable.call(this)},e.onDestroy=function(){t.prototype.onDestroy.call(this)},e.initUI=function(){this.node.getChildByName("info").localize("info",s.layers.HandLayer)},e.globalTouchStartRet=function(t){this.closeLayer(),this.layerCb&&this.layerCb()},e.processEvent=function(t,n){},e.onButtonClick=function(t,n){},o}(r))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/HeroLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./tyqSDK.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./RedPointLogicMgr.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(t){"use strict";var e,i,o,n,r,a,l,s,p,c,u,h,g,f,y,d,b,L,m,w,P,I,S,k;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,l=t.Node,s=t.Prefab,p=t.sp,c=t.Label,u=t.instantiate},function(t){h=t.myLog},function(t){g=t.tyqSDK},function(t){f=t.constants},function(t){y=t.msgac},function(t){d=t.audioManager},function(t){b=t.designManager},function(t){L=t.eventManager},function(t){m=t.RedPointLogicMgr,w=t.RPointMask,P=t.RedpointPos},function(t){I=t.UserData},function(t){S=t.PropItemPrefab},function(t){k=t.BaseUILayer}],execute:function(){var v,C,B,N,D,z,R,_,V,H,M,E,T,W,q,U,x,A,F,J,K,j,O;r._RF.push({},"26adcAfOJ5CCJMDw2soV+18","HeroLayer",void 0);var G=a.ccclass,Q=a.property;t("HeroLayer",(v=G("HeroLayer"),C=Q({type:l,tooltip:"道具列表容器"}),B=Q({type:s,tooltip:"道具节点"}),N=Q({type:l,tooltip:"道具列表View"}),D=Q({type:l,tooltip:"道具列表View"}),z=Q({type:l,tooltip:"穿戴装备"}),R=Q({type:l,tooltip:"穿戴装备"}),_=Q({type:l,tooltip:"攻击力"}),V=Q({type:l,tooltip:"生命值"}),H=Q({type:l,tooltip:"排序按钮"}),M=Q({type:p.Skeleton,tooltip:"角色spine"}),v((W=e((T=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,o(e,"propLayer",W,n(e)),o(e,"rewardItem",q,n(e)),o(e,"propView",U,n(e)),o(e,"scrollView",x,n(e)),o(e,"propNodeLeft",A,n(e)),o(e,"propNodeRight",F,n(e)),o(e,"attackLabel",J,n(e)),o(e,"lifeLabel",K,n(e)),o(e,"sortbtn",j,n(e)),o(e,"heroSk",O,n(e)),e._propNodeList=[],e._isSort=!1,e.cloLabel=void 0,e.atkIcon=void 0,e.hpIcon=void 0,e.myEquip=void 0,e.btnSort=void 0,e.btnUpgrade=void 0,e}i(e,t);var r=e.prototype;return r.onLoad=function(){this.fitScrollView(this.propView,320,600);for(var t=0;t<this.propNodeLeft.children.length;t++)this._propNodeList.push(this.propNodeLeft.children[t]);for(var e=0;e<this.propNodeRight.children.length;e++)this._propNodeList.push(this.propNodeRight.children[e])},r.onEnable=function(){t.prototype.onEnable.call(this),L.on(y.wearDrop,this.updateProp,this),L.on(y.updateDropData,this.updateProp,this)},r.onDisable=function(){t.prototype.onDisable.call(this),L.off(y.wearDrop,this.updateProp,this),L.off(y.updateDropData,this.updateProp,this)},r.onDestroy=function(){t.prototype.onDestroy.call(this)},r.start=function(){this.initList(),this.initWearDrop(),this.attackLabel.getComponent(c).string=I.getInstance().attack+"",this.lifeLabel.getComponent(c).string=I.getInstance().life+"",m.ins().setRPointView(this.node.getChildByName("btnBless"),null,I.getInstance().checkPropCanBless()),m.ins().on(this.node,[{mask:[w.RPM_BlessProp],subPath:"btnBless"}]),g.eventSendCustomEvent("进入装备界面"),this.sortbtn.getChildByName("Label").localize("btnSort",f.layers.HeroLayer),this.node.getChildByPath("herobg/k/Label").localize("myEquip",f.layers.HeroLayer),this.node.getChildByPath("herobg/btnSkin/cloLabel").localize("btnSkin",f.layers.HeroLayer),this.node.getChildByPath("herobg/lifebg/hp").localizeImg(),this.node.getChildByPath("herobg/attckbg/hp").localizeImg(),this.node.getChildByPath("btnBless/Label").localize("btnBless",f.layers.HeroLayer),this.heroSk.setSkin(I.getInstance().getHeroSkin())},r.updateProp=function(){this.initList(),this.initWearDrop(),this.attackLabel.getComponent(c).string=I.getInstance().attack+"",this.lifeLabel.getComponent(c).string=I.getInstance().life+""},r.initWearDrop=function(){var t=I.getInstance().wearProp;h.i("propdata = ",t);for(var e=0;e<t.length&&e<this._propNodeList.length;e++){var i=this._propNodeList[e].getChildByName("PropItem");null==i&&(i=u(this.rewardItem),this._propNodeList[e].addChild(i),i.name="PropItem"),i.getComponent(S).setView(t[e],e+1,S.Type_HideNum|S.Type_UnWear),i.getComponent(S).setScale(130)}},r.initList=function(){if(this._isSort){var t=this.getPropList();t.sort((function(t,e){var i=b.getRowById(f.tableName.prop,t);return b.getRowById(f.tableName.prop,e).quality-i.quality})),this.scrollViewSetData(this.scrollView,t,this.initItem)}else{var e=this.getPropList();e.sort((function(t,e){var i=b.getRowById(f.tableName.prop,t),o=b.getRowById(f.tableName.prop,e);return i.wearIndex-o.wearIndex})),this.scrollViewSetData(this.scrollView,e,this.initItem)}},r.initItem=function(t,e,i){t.getComponent(S).setView(e,1,S.Type_HideNum|S.Type_ToWear),t.getComponent(S).setScale(120),m.ins().setRPointView(t,null,I.getInstance().checkThisPropBestToWear(e),null,P.right)},r.updateRedPoint=function(){this.propLayer.children.forEach((function(t){m.ins().setRPointView(t,null,I.getInstance().checkThisPropBestToWear(t.getComponent(S).propId))}))},r.getPropList=function(){var t=I.getInstance().getPropSort(),e=[];return t.forEach((function(t){var i=1==t.iswear?t.num-1:t.num,o=b.getRowById(f.tableName.prop,t.id);if(8==o.type||11==o.type)for(var n=0;n<i;n++)e.push(t.id)})),e},r.propSort=function(){d.playEffect("btnClick"),this._isSort?(this.sortbtn.getChildByName("Label").localize("btnSort",f.layers.HeroLayer),this._isSort=!1):(this.sortbtn.getChildByName("Label").localize("btnCancelSort",f.layers.HeroLayer),this._isSort=!0),this.initList()},r.openBless=function(){d.playEffect("btnClick"),this.openLayer(f.layers.BlessLayer)},r.onClickBtnSkin=function(){var t=this;d.playEffect("btnClick"),this.openLayer(f.layers.SkinChangeLayer,(function(){t.heroSk.setSkin(I.getInstance().getHeroSkin())}))},e}(k)).prototype,"propLayer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(T.prototype,"rewardItem",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(T.prototype,"propView",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(T.prototype,"scrollView",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(T.prototype,"propNodeLeft",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(T.prototype,"propNodeRight",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(T.prototype,"attackLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(T.prototype,"lifeLabel",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(T.prototype,"sortbtn",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(T.prototype,"heroSk",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=T))||E));r._RF.pop()}}}));

System.register("chunks:///_virtual/Hint.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./AnimationCtrl.ts"],(function(t){"use strict";var i,o,n,e,s,c,r,h,a;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,e=t.find,s=t.Tween,c=t.Component},function(t){r=t.cocosUtil},function(t){h=t.mapModel},function(t){a=t.AnimationCtrl}],execute:function(){var l;o._RF.push({},"d7328lgUsxDaYvB3Zr0hgZx","Hint",void 0);var d=n.ccclass;n.property,t("HintNames",{targetPos:"targetPos",targetPos2:"targetPos2",targetPos3:"targetPos3",hit1:"hit1",hit2:"hit2",hit3:"hit3",hit4:"hit4",hit5:"hit5",hit6:"hit6",hit7:"hit7",boom1:"boom1",feiBiao:"feiBiao",blockArrow:"blockArrow",comeShine:"comeShine"}),t("Hint",d("Hint")(l=function(t){function o(){for(var i,o=arguments.length,n=new Array(o),e=0;e<o;e++)n[e]=arguments[e];return(i=t.call.apply(t,[this].concat(n))||this).bodyNode=void 0,i.hintUtil=void 0,i.extraObj=void 0,i}i(o,t);var n=o.prototype;return n.init=function(t,i,o,n){var c=this;void 0===o&&(o=0),this.bodyNode=e("body",this.node),this.extraObj=n,this.unscheduleAllCallbacks(),s.stopAllByTarget(this.node);var l=r.convertToNodeSpace(this.node,i);this.node.setPosition(l),this.node.angle=o,r.addComponentOnce(e("body",this.node),a).playAnimation("ani",!1,(function(){h.hintSystem.recycleHintNode(c.node)}));try{this.hintUtil=r.addComponentOnce(this,t),this.hintUtil.unscheduleAllCallbacks(),this.hintUtil.init(this)}catch(t){}},n.recycleSelf=function(){h.hintSystem.recycleHintNode(this.node)},o}(c))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/HintSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./resManager.ts","./BaseLayer.ts","./NodePoolUtil.ts","./Hint.ts"],(function(t){"use strict";var e,n,i,a,o,r,s,c,y,u,l,f,h,d;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,a=t.find,o=t.Node,r=t.UITransform,s=t.Prefab},function(t){c=t.cocosUtil},function(t){y=t.constants},function(t){u=t.resManager},function(t){l=t.BaseLayer},function(t){f=t.NodePoolUtil},function(t){h=t.HintNames,d=t.Hint}],execute:function(){var m;n._RF.push({},"e5def4jLXtEnZXDiJCC8BFw","HintSystem",void 0);var p=i.ccclass;i.property,t("HintSystem",p("HintSystem")(m=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))||this).nameLayerObj={},e.namePrefabObj={},e.hintLayer=void 0,e.hintLayer2=void 0,e}e(n,t);var i=n.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this),this.hintLayer=this.node,this.hintLayer2=a("hintLayer2",this.node.parent)},i.onEnable=function(){t.prototype.onEnable.call(this)},i.onDestroy=function(){t.prototype.onDestroy.call(this)},i.getHintLayerNameById=function(t){return t+"Layer"},i.getHintLayerByName=function(t){var e=this.nameLayerObj[t];if(!e){switch((e=new o(this.getHintLayerNameById(t))).addComponent(r),e.setPosition(0,0),t){case h.targetPos:case h.targetPos2:case h.targetPos3:case h.feiBiao:case h.blockArrow:case h.comeShine:e.parent=this.hintLayer2;break;default:e.parent=this.hintLayer}this.nameLayerObj[t]=e,e.addComponent(f).init(this.namePrefabObj[t])}return e},i.addHint=function(t,e,n,i){var a=this;void 0===n&&(n=0);var o=this.getHintLayerByName(t).getComponent(f),r=function(){if(o.node.activeInHierarchy){var a=o.getNode();c.addComponentOnce(a,d).init(t,e,n,i)}};this.namePrefabObj[t]?r():u.loadAsset(y.bundles.hint,t,s,null,(function(e,n){c.isValid(a)&&(a.namePrefabObj[t]=n,o.init(n),r())}))},i.recycleHintNode=function(t){this.getHintLayerByName(t.name).getComponent(f).recycleNode(t)},n}(l))||m);n._RF.pop()}}}));

System.register("chunks:///_virtual/HomeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./ServerCtr.ts","./tyqAdManager.ts","./tyqSDK.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./RedPointLogicMgr.ts","./resManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts","./ShineColor.ts","./BaseUILayer.ts","./HeroLayer.ts","./MainLayer.ts","./TopUILayer.ts","./TowerLayer.ts"],(function(e){"use strict";var t,a,n,o,r,s,i,l,y,h,c,g,d,u,L,p,b,m,f,P,v,M,w,B,N,D,C,k,R,I,S,_,H,E;return{setters:[function(e){t=e.inheritsLoose},function(e){a=e.cclegacy,n=e._decorator,o=e.Sprite,r=e.EventHandler,s=e.Button,i=e.tween,l=e.v3,y=e.Prefab,h=e.instantiate,c=e.find},function(e){g=e.myLog},function(e){d=e.default},function(e){u=e.tyqAdManager},function(e){L=e.tyqSDK,p=e.ChannelFlag},function(e){b=e.constants},function(e){m=e.msgac},function(e){f=e.audioManager},function(e){P=e.designManager},function(e){v=e.eventManager},function(e){M=e.RedPointLogicMgr,w=e.RPointMask},function(e){B=e.resManager},function(e){N=e.mapModel},function(e){D=e.playerModel},function(e){C=e.UserData},function(e){k=e.BaseLayer},function(e){R=e.ShineColor},function(e){I=e.BaseUILayer},function(e){S=e.HeroLayer},function(e){_=e.MainLayer},function(e){H=e.TopUILayer},function(e){E=e.TowerLayer}],execute:function(){var T;a._RF.push({},"be74cBlU0tDKKhGwwM56Gmm","HomeLayer",void 0);var A=n.ccclass;n.property,e("HomeLayer",A("HomeLayer")(T=function(e){function a(){for(var t,a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).toggles=[],t.togglesLock=[!1,!1,!1,!1,!1],t._PageLayer=[b.layers.TowerLayer,"HeroLayer","MainLayer","ShopLayer",b.layers.EnergyLayer],t.jumpLayerData=void 0,t.tabMainRedPointNode=void 0,t.tabEnergyRedPointNode=void 0,t.btn1Label=void 0,t.btn2Label=void 0,t.btn3Label=void 0,t.btn4Label=void 0,t.btn5Label=void 0,t}t(a,e);var n=a.prototype;return n.onLoad=function(){this.chooseDesignResolution(),this.btn1Label=this.getNodeByPath("Layout/ui_btn1/Label"),this.btn2Label=this.getNodeByPath("Layout/ui_btn2/Label"),this.btn3Label=this.getNodeByPath("Layout/ui_btn3/Label"),this.btn4Label=this.getNodeByPath("Layout/ui_btn4/Label"),this.btn5Label=this.getNodeByPath("Layout/ui_btn5/Label"),this.tabMainRedPointNode=this.getNodeByPath("Layout/ui_btn3/redPoint"),this.tabEnergyRedPointNode=this.getNodeByPath("Layout/ui_btn5/redPoint"),1==L.getSwitchValue("tyq_HeroLayer_open")?(this.togglesLock[1]=!1,M.ins().on(this.node,[{mask:[w.RPM_PropWear,w.RPM_BlessProp],subPath:"Layout/ui_btn2"}])):this.togglesLock[1]=!0,L.channel!=p.WECHAT_JJWS&&(this.togglesLock[1]=!1),d.GetInstance().reqGetFriendVal(),this.schedule((function(){d.GetInstance().reqGetFriendVal()}),300),g.i("进游戏的url参数：",u.getEnterUrlQuery());var e=u.getEnterUrlQuery();e&&e.uid&&(d.GetInstance().reqSetFriendCode(e.uid),L.eventSendCustomEvent("参与分享活动成功进来的玩家"))},n.onEnable=function(){if(e.prototype.onEnable.call(this),this.addEventArr([m.homeHideMenu,m.mapEnter,m.jumpLayer]),C.getInstance().mapHand){if(D.hasEnergyAward()?this.setPage(4):this.setPage(2),C.getInstance().mapData&&this.openLayer(b.layers.BackMapLayer,null,(function(e){e&&N.enterMapWithMapId(e)})),f.playMusic(b.audioNames.home),this.layerData.isWin&&this.layerData.floor>0){C.getInstance().addTowerMapFloor(this.layerData.mapId);var t={};t.layerName=b.layers.TowerFloorLayer,t.mapId=this.layerData.mapId,v.send(m.jumpLayer,t);var a=P.getRowById(b.tableName.towerFloor,this.layerData.floor),n=C.getInstance().addPropNum(a.propId,a.propNum);this.openAwardGetLayer([n])}C.getInstance().getPatrolState()<=0&&(this.openLayer(b.layers.PatrolLayer),M.ins().setRPointView(this.getNodeByPath("Map/btnPortal"),null,!1))}else N.enterMapWithMapId(1)},n.refreshLocalization=function(){var e,t,a,n,o;null==(e=this.btn1Label)||e.localize("btn1",b.layers.HomeLayer),null==(t=this.btn2Label)||t.localize("btn2",b.layers.HomeLayer),null==(a=this.btn3Label)||a.localize("btn3",b.layers.HomeLayer),null==(n=this.btn4Label)||n.localize("btn4",b.layers.HomeLayer),null==(o=this.btn5Label)||o.localize("btn5",b.layers.HomeLayer)},n.refreshRedPoint=function(){D.hasLetterAward()||D.hasDaySignAward()||D.hasDayTaskAward()||D.hasVipAward()?this.tabMainRedPointNode.active=!0:this.tabMainRedPointNode.active=!1,this.tabEnergyRedPointNode.active=D.hasEnergyAward()},n.onDisable=function(){e.prototype.onDisable.call(this)},n.onDestroy=function(){e.prototype.onDestroy.call(this)},n.initUI=function(){for(var e=0;e<5;e++){this.toggles[e]=this.getNodeByPath("Layout/ui_btn"+(e+1)),this.toggles[e].getChildByName("icon").getComponent(o).grayscale=this.togglesLock[e];var t=new r;t.component="HomeLayer",t.target=this.node,t.customEventData=e+"",t.handler="selectPage",this.toggles[e].getComponent(s)||(this.toggles[e].addComponent(s).clickEvents=[t])}},n.start=function(){},n.selectPage=function(e,t){console.log("event =",t),this.setPage(parseInt(t)),f.playEffect("btnClick")},n.setPage=function(e){var t=this;if(this.togglesLock[e])this.createNotice("还未解锁");else{this.getNodeByPath("TopUILayer").active=3!=e,2==e&&v.send(m.commonResRefresh);for(var a=0;a<5;a++)a!=e?(this.setSpriteFrame2(this.toggles[a],"homeLayer/ui_xk",null,b.bundles.wwqVec),i(this.toggles[a].getChildByName("icon")).to(.15,{scale:l(.6,.6,1)}).start(),this.toggles[a].getChildByName("Label").active=!1):(this.setSpriteFrame2(this.toggles[a],"homeLayer/ui_hdmb",null,b.bundles.wwqVec),i(this.toggles[a].getChildByName("icon")).to(.15,{scale:l(1,1,1)}).start(),this.toggles[a].getChildByName("Label").active=!0);var n=this.getNodeByPath("ui");""!=this._PageLayer[e]&&B.loadAsset(b.bundles.layer,this._PageLayer[e],y,null,(function(e,a){if(e)g.e("LayerManager.openLayer error:"+e.message,"MainLayer",e);else{n.removeAllChildren();var o=h(a);if(n.addChild(o),t.jumpLayerData){switch(o&&o.getComponent(I)&&(o.getComponent(I).layerData=t.jumpLayerData),t.jumpLayerData.layerName){case"PatrolLayer":o.getComponent(_).onClickBtnPartol();break;case"BlessLayer":o.getComponent(S).openBless();break;case b.layers.TowerFloorLayer:o.getComponent(E).openTowerFloorLayer(t.jumpLayerData.mapId);break;case b.layers.DaySignLayer:o.getComponent(_).onClickBtnDaySign()}delete t.jumpLayerData}}}))}},n.jumpLayerRet=function(e){switch(this.jumpLayerData=e,e.layerName){case"ShopLayer":this.setPage(3);break;case"MainLayer":case"PatrolLayer":case b.layers.DaySignLayer:this.setPage(2);break;case"BlessLayer":this.setPage(1);break;case"RewardItemLayer":this.setPage(2),c("TopUILayer",this.node).getComponent(H).showRewardItem(null,2);break;case b.layers.RewardSkinLayer:this.setPage(2),this.openLayer(b.layers.RewardSkinLayer);break;case b.layers.DaySignLayer:this.setPage(2),this.openLayer(b.layers.DaySignLayer);break;case b.layers.TowerFloorLayer:this.setPage(0)}},n.mapEnterRet=function(e){this.openLayer(b.layers.TransLayer,e,N.loadMapRes.bind(N))},n.homeHideMenuRet=function(e){e.hide?this.getNodeByPath("Layout").active=!1:this.getNodeByPath("Layout").active=!0},n.onClickBtnHit=function(){var e=this.getNodeByPath("monster"),t=e.getComponent(R);t||(t=e.addComponent(R)),t.startShine(b.materials.shineColorSpine)},a}(k))||T);a._RF.pop()}}}));

System.register("chunks:///_virtual/http.ts",["cc"],(function(t){"use strict";var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"c064dJ3gUJMUrDuaXXLfsGc","http",void 0),t("default",function(){function t(){this.xhr=null}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.httpPost=function(t,n,e,s){var c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState&&c.status>=200&&c.status<300){var t=c.responseText,n=JSON.parse(t);e(n)}else e(-1)},c.open("POST",t,!0),c.timeout=8e3,c.send(JSON.stringify(n)),c.onerror=function(t){console.log(t),s&&s(t)}},t}())._instance=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/ItemLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RenderChildBatch.ts"],(function(t){"use strict";var e,i,r,n,h,a,d,s;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){r=t.cclegacy,n=t._decorator,h=t.sys,a=t.instantiate,d=t.Component},function(t){s=t.RenderChildBatch}],execute:function(){var I;r._RF.push({},"d4942V0aRFFFp6T4OnZGReu","ItemLayer",void 0);var m=n.ccclass;n.property,t("ItemLayer",m("ItemLayer")(I=function(t){function r(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))||this).itemUI=void 0,e.itemUIFreeArr=void 0,e.itemUIArr=void 0,e.idItemUIObj={},e.layerJS=void 0,e.callback=void 0,e.renderChildBatch=null,e.isFrameLoad=!1,e.dataArr=[],e}e(r,t);var n=r.prototype;return n.onLoad=function(){this.itemUI=this.node.children[0],this.itemUI.active=!1,this.hideAllItems(),this.addRenderChildBatch()},n.addRenderChildBatch=function(){h.isNative||(this.renderChildBatch=this.getComponent(s),this.renderChildBatch||(this.renderChildBatch=this.addComponent(s)))},n.hideAllItems=function(){var t=this.node.children;this.itemUIFreeArr=[],this.itemUIArr=[],this.idItemUIObj={};for(var e,r=i(t);!(e=r()).done;){var n=e.value;n.active=!1,this.itemUIFreeArr.push(n)}},n.initUI=function(t,e,i){if(this.layerJS=t,this.callback=i,this.hideAllItems(),this.itemUIArr=[],this.idItemUIObj={},this.isFrameLoad)this.dataArr=e,this.frameAddItem();else for(var r in e){var n=e[r];this.addItem(n)}},n.setFrameLoad=function(t){this.isFrameLoad=t},n.frameAddItem=function(){var t=this;this.scheduleOnce((function(){if(t.dataArr&&!(t.dataArr.length<=0)){var e=t.dataArr.shift();t.addItem(e),t.frameAddItem()}}))},n.addItem=function(t,e){var i=this.itemUIFreeArr.shift();i||((i=a(this.itemUI)).parent=this.node),i.active=!0,i.item=t;var r=this.itemUIArr.length;return i.index=r,"object"==typeof t&&t&&null!=t.id&&(this.idItemUIObj[t.id]=i),e?e(i,t,r):this.callback&&this.callback(i,t,r),this.layerJS&&this.layerJS.addButtonListener&&this.layerJS.addButtonListener(i),this.itemUIArr.push(i),this.renderChildBatch&&this.renderChildBatch.addRootItemNode(i),i},n.getItemUIById=function(t){return null==t?null:this.idItemUIObj[t]},n.getItemUIByIndex=function(t){var e=null;return this.forShowItemUI((function(i,r){if(i.index==t)return e=i,!0})),e},n.loadAndRefreshItemUIByItem=function(t,e){t&&null!=t.id&&(this.getItemUIById(t.id)?this.refreshItemUIByItem(t):this.addItem(t,e))},n.refreshItemUIByItem=function(t){if(t&&null!=t.id){var e=this.getItemUIById(t.id);e&&(e.item=t,this.refreshItemUIByItemUI(e))}},n.refreshItemUIByItemUI=function(t){var e=t.item;this.callback&&this.callback(t,e,t.index)},n.refreshItemUIById=function(t){var e=this.getItemUIById(t);e&&this.refreshItemUIByItem(e.item)},n.removeItemUIByIndex=function(t){if(!(t<0||t>=this.itemUIArr.length)){for(var e=null,i=0;i<this.itemUIArr.length;i++){var r=this.itemUIArr[i];if(r.active&&r.index==t){e=r;break}}this.removeItemUIByItemUI(e)}},n.removeItemUIById=function(t){if(null!=t){var e=this.idItemUIObj[t];this.removeItemUIByItemUI(e)}},n.removeItemUIByItemUI=function(t){if(t){t.active=!1,-1==this.itemUIFreeArr.indexOf(t)&&(t.index=-1,this.itemUIFreeArr.push(t));var e=t.item,i=this.itemUIArr.indexOf(t);if(-1!=i){this.itemUIArr.splice(i,1);for(var r=i;r<this.itemUIArr.length;r++)this.itemUIArr[r].index=r}"object"==typeof e&&e&&null!=e.id&&delete this.idItemUIObj[e.id],this.renderChildBatch&&this.renderChildBatch.removeRootItemNode(t)}},n.forShowItemUI=function(t){if(t)for(var e,r=i(this.itemUIArr);!(e=r()).done;){var n=e.value;if(t(n,n.item))break}},n.refreshUI=function(){if(this.callback)for(var t,e=i(this.itemUIArr);!(t=e()).done;){var r=t.value;this.callback(r,r.item,r.index)}},r}(d))||I);r._RF.pop()}}}));

System.register("chunks:///_virtual/layerManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./cocosUtil.ts","./constants.ts","./resManager.ts"],(function(e){"use strict";var a,r,t,n,y,s,l,o,i,L;return{setters:[function(e){a=e.createForOfIteratorHelperLoose,r=e.createClass},function(e){t=e.cclegacy,n=e.Prefab,y=e.find,s=e.Label},function(e){l=e.myLog},function(e){o=e.cocosUtil},function(e){i=e.constants},function(e){L=e.resManager}],execute:function(){t._RF.push({},"e4377T2MsZIL5G+/fK/7cUt","layerManager",void 0);var p=function(){function e(){this.layer1=void 0,this.layerHint=void 0,this.layerDebugLog=void 0,this.openingLayerMap=new Map,this.openedLayerMap=new Map,this.layerNameIdArrMap=new Map,this.layerId=0}var t=e.prototype;return t.loadCommonLayers=function(e,r){var t=[i.layers.HomeLayer,i.layers.MainLayer,i.layers.MapLayer,i.layers.MapFightLayer,i.layers.SkillSelectLayer,i.layers.PauseLayer,i.layers.EnergyLayer,i.layers.TransLayer,i.layers.HandLayer,i.layers.PatrolLayer,i.layers.PatrolFastLayer,i.layers.RewardLayer];L.loadAssetByPathArr(i.bundles.layer,t,n,e,(function(e){for(var y,s=a(e);!(y=s()).done;){y.value.addRef()}r&&(r(e),new Promise((function(){t=[i.layers.LuckyDrawLayer,i.layers.LevelLayer,i.layers.ChapterLayer,i.layers.SettlementLayer,i.layers.BackHomeLayer,i.layers.BackLifeLayer,i.layers.BackMapLayer,i.layers.BoxMonsterLayer,i.layers.TowerLayer,i.layers.TowerFloorLayer,i.layers.TowerRoleLayer,i.layers.DayTaskLayer,i.layers.DaySignLayer,i.layers.LetterLayer,i.layers.SkinChangeLayer,i.layers.PropInfoLayer2,i.layers.AwardInfoLayer,i.layers.VipLayer,i.layers.ShareLayer,i.layers.MsgBoxLayer,i.layers.BuyLifeLayer,i.layers.PropInfoLayer,i.layers.BlessLayer,i.layers.BlessResultLayer,i.layers.MoreGameLayer,i.layers.HeroLayer,i.layers.RewardItemLayer,i.layers.ShopLayer,i.layers.SettingLayer,i.layers.GuessGameLayer,i.layers.GuessResultLayer,i.layers.PyramidDrawLayer,i.layers.RewardSkinLayer,i.layers.RewardRedBoxLayer],L.loadAssetByPathArr(i.bundles.layer,t,n,null,(function(e){for(var r,t=a(e);!(r=t()).done;){r.value.addRef()}}))})))}))},t.getPopLayerParentNode=function(){return this.layer1},t.init=function(e,a,r){this.layer1=e,this.layerHint=a,this.layerDebugLog=r,this.openingLayerMap=new Map,this.openedLayerMap=new Map,this.layerNameIdArrMap=new Map,this.layerId=0},t.createNotice=function(e){var a=y(i.layers.NoticeLayer,this.layerHint);a&&a.getComponent(i.layers.NoticeLayer).createNotice(e)},t.setDebugLog=function(e){var a=y("Label",this.layerDebugLog).getComponent(s);a&&(a.string=e)},t.addLayerNameId=function(e,a){var r=this.layerNameIdArrMap.get(e);r||(r=[],this.layerNameIdArrMap.set(e,r)),r.push(a)},t.removeLayerNameId=function(e,a){var r=this.layerNameIdArrMap.get(e);if(r&&r.length>0){var t=r.indexOf(a);-1!=t&&r.splice(t,1)}},t.openSingleLayer=function(e,a,r,t){a||(a={});var n=this.layerNameIdArrMap.get(e);if(!n||n.length<=0)this.openLayer(e,a,r,t);else{var y=n[0],s=this.openedLayerMap.get(y);if(s)return s.layerData=a,s.layerCb=r,s.onLoad(),s.onEnable(),void(t&&t(s));var l=this.openingLayerMap.get(y);l&&(l.layerName=e,l.obj=a,l.cb=r,l.openSuccessCb=t)}},t.openLayer=function(e,a,r,t){var y=this;a||(a={}),this.layerId++;var s=this.layerId,p={};p.layerName=e,p.obj=a,p.cb=r,p.openSuccessCb=t,this.openingLayerMap.set(s,p),this.addLayerNameId(e,s);var c=i.bundles.layer,d=e;L.loadAsset(c,d,n,null,(function(r,t){if(r)l.e("LayerManager.openLayer error:"+r.message,e,r);else if(p=y.openingLayerMap.get(s)){var n=o.instantiate(t),i=n.getComponent(e)||n.addComponent(e);L.loadAssetConfigArr(i.preLoadAssetConfigArr,!1,null,(function(){i.layerData=p.obj,i.layerCb=p.cb,i.layerName=p.layerName,i.layerId=s,y.openingLayerMap.delete(s),y.openedLayerMap.set(s,i),n.parent=y.layer1,l.i("openLayer "+e,a),p.openSuccessCb&&p.openSuccessCb(i,t)}))}}))},t.closeLayer=function(e){if("string"==typeof e){var a=this.layerNameIdArrMap.get(e);if(!a||a.length<=0)return;e=a[a.length-1]}var r=this.openedLayerMap.get(e);r&&(r.node.destroy(),this.openedLayerMap.delete(e),this.removeLayerNameId(r.layerName,e));var t=this.openingLayerMap.get(e);t&&(this.openingLayerMap.delete(e),this.removeLayerNameId(t.layerName,e))},t.isShowingLayer=function(e){var a=this.layerNameIdArrMap.get(e);return!(!a||a.length<=0)},r(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();p._instance=void 0;e("layerManager",p.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/LetterLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./playerModel.ts","./UserData.ts","./BaseLayer.ts","./eventManager.ts","./msgac.ts","./constants.ts","./localization.ts"],(function(t){"use strict";var e,n,a,o,r,i,s,c,l,u,h;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,a=t._decorator,o=t.find},function(t){r=t.playerModel},function(t){i=t.UserData},function(t){s=t.BaseLayer},function(t){c=t.eventManager},function(t){l=t.msgac},function(t){u=t.constants},function(t){h=t.localizeManager}],execute:function(){var y;n._RF.push({},"a8c03DE/+JHxo1+olxbZkMD","LetterLayer",void 0);var f=a.ccclass;a.property,t("LetterLayer",f("LetterLayer")(y=function(t){function n(){for(var e,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))||this).awardArr=[[101,1e4],[801,200]],e}e(n,t);var a=n.prototype;return a.onLoad=function(){t.prototype.onLoad.call(this),this.isShowBannerAd=!0},a.onEnable=function(){t.prototype.onEnable.call(this)},a.onDisable=function(){t.prototype.onDisable.call(this)},a.onDestroy=function(){t.prototype.onDestroy.call(this)},a.initUI=function(){this.setItemLayer(this.getNodeByPath("ui/awardLayer/itemLayer"),this.awardArr,this.refreshPropItem.bind(this)),r.isLetterAward?this.getNodeByPath("ui/btnGet").active=!1:(this.getNodeByPath("ui/btnGet/text").localize("get",u.catName.common),this.getNodeByPath("ui/btnGet").active=!0)},a.refreshPropItem=function(t,e){this.setPropItem(e[0],o("icon",t),e[1],o("bg",t),o("num",t));var n=o("get",t);n.getChildByName("icon").localizeImg(),r.isLetterAward?n.active=!0:n.active=!1},a.processEvent=function(t,e){},a.onButtonClick=function(t,e){},a.onClickBtnGet=function(){if(r.isLetterAward)this.createNotice(h._localize(null,"hasGet",u.catName.common));else{r.isLetterAward=1;var t=i.getInstance().addPropArrByDesign(this.awardArr);this.openAwardGetLayer(t),this.initUI(),c.send(l.refreshRedPoint)}},a.onClickBg=function(){this.closeLayer()},n}(s))||y);n._RF.pop()}}}));

System.register("chunks:///_virtual/LevelLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./constants.ts","./audioManager.ts","./designManager.ts","./UserData.ts","./BaseUILayer.ts","./localization.ts"],(function(e){"use strict";var t,a,n,i,o,r,l,c,s,p,u,m,g,y,f,d,b,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,r=e._decorator,l=e.Node,c=e.Label,s=e.PageView,p=e.instantiate,u=e.Sprite},function(e){m=e.myLog},function(e){g=e.constants},function(e){y=e.audioManager},function(e){f=e.designManager},function(e){d=e.UserData},function(e){b=e.BaseUILayer},function(e){h=e.localizeManager}],execute:function(){var L,v,C,I,w,P,_,z,N,B,D,M,k,H,T;o._RF.push({},"f7b2f8wUMtDD4XQTFEkH0tV","LevelLayer",void 0);var E=r.ccclass,S=r.property;e("LevelLayer",(L=E("LevelLayer"),v=S({type:l,tooltip:"地图名字"}),C=S({type:l,tooltip:"地图节点"}),I=S({type:l,tooltip:"pageView"}),w=S({type:l,tooltip:"选择按钮"}),P=S({type:c,tooltip:"地图详情"}),_=S({type:s,tooltip:"地图"}),L((B=t((N=function(e){function t(){for(var t,a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,n(t,"mapName",B,i(t)),n(t,"mapItem",D,i(t)),n(t,"pageContent",M,i(t)),n(t,"selectBtn",k,i(t)),n(t,"mapInfo",H,i(t)),n(t,"mapPage",T,i(t)),t._curPageId=0,t._curOpenLevel=1,t}a(t,e);var o=t.prototype;return o.onLoad=function(){var e=this,t=f.getRowsByType(g.tableName.map,g.mapTypes.main);m.i("----- LevelLayer",t),this._curOpenLevel=d.getInstance().openLevel,t.forEach((function(a,n){var i=p(e.mapItem);e.pageContent.addChild(i);var o=i.getChildByName("icon"),r=(t[n].id-1)%2+1;e.setSpriteFrame2(o,"homeLayer/ui_map"+r,null,g.bundles.wwqVec),t[n].id<=e._curOpenLevel?(o.getComponent(u).color=g.colors.white.parseColor(),i.getChildByName("lock").active=!1):(o.getComponent(u).color=g.colors.yin.parseColor(),i.getChildByName("lock").active=!0)}))},o.start=function(){this.selectBtn.getChildByName("Label").localize("btnChoose",g.catName.common);var e=d.getInstance().getCurMap()-1;this.mapPage.scrollToPage(e),this.setPage(e)},o.setPage=function(e){var t=f.getTable(g.tableName.map);this.mapName.getComponent(c).string=t[e].id+"."+h._localize(null,"name"+t[e].id,g.catName.mapSystem),this.mapInfo.node.localize("info"+t[e].id,g.catName.mapSystem),console.log("mapData[index].id=",t[e].id),this._curPageId=t[e].id,this.selectBtn.active=t[e].id<=this._curOpenLevel},o.scrowPage=function(e){m.i("event ",e),this.setPage(e._curPageIdx)},o.onEnable=function(){},o.onDisable=function(){},o.onDestroy=function(){},o.chooseMap=function(){d.getInstance().setCurMap(this._curPageId),this.openLayer(g.layers.HomeLayer),this.closeLayer(),y.playEffect("btnClick")},o.backHome=function(){y.playEffect("btnClick"),m.i("backHome"),this.openLayer(g.layers.HomeLayer),this.closeLayer()},t}(b)).prototype,"mapName",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(N.prototype,"mapItem",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(N.prototype,"pageContent",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(N.prototype,"selectBtn",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(N.prototype,"mapInfo",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(N.prototype,"mapPage",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=N))||z));o._RF.pop()}}}));

System.register("chunks:///_virtual/LoadingLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./conf.ts","./CronCtr.ts","./ServerCtr.ts","./tyqSDK.ts","./constants.ts","./designManager.ts","./layerManager.ts","./resManager.ts","./playerModel.ts","./BaseLayer.ts","./localization.ts","./UserData.ts"],(function(e){"use strict";var t,r,n,s,o,i,a,l,g,c,d,u,h,p,f,y,m,L,P;return{setters:[function(e){t=e.inheritsLoose,r=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy,s=e._decorator,o=e.ProgressBar,i=e.Sprite},function(e){a=e.sdkManager},function(e){l=e.GLoginState},null,function(e){g=e.default},function(e){c=e.tyqSDK,d=e.ChannelFlag},function(e){u=e.constants},function(e){h=e.designManager},function(e){p=e.layerManager},function(e){f=e.resManager},function(e){y=e.playerModel},function(e){m=e.BaseLayer},function(e){L=e.localizeManager},function(e){P=e.UserData}],execute:function(){var b;n._RF.push({},"bf333MQLIJKFoSmNUD9RvOw","LoadingLayer",void 0);var v=s.ccclass;s.property,e("LoadingLayer",v("LoadingLayer")(b=function(e){function n(){for(var t,r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(t=e.call.apply(e,[this].concat(n))||this).progressBar=void 0,t.progress=0,t.percentNode=void 0,t.flagNode=void 0,t.progressLength=428,t.startGap=-202,t.designResProgress=0,t.designResPercent=.5,t.bundleArrProgress=0,t.bundleArrPercent=.5,t.bundleLoadingTime=-1,t.bundleLoadingMaxTime=6,t.layerProgress=0,t.layerPercent=1,t.spriteFrameArr=[],t.isLogined=!1,t}t(n,e);var s=n.prototype;return s.onLoad=function(){e.prototype.onLoad.call(this),this.percentNode=this.getNodeByPath("ui/progressBar/percent"),this.setString(this.percentNode,"0%"),this.progressBar=this.getNodeByPath("ui/progressBar").getComponent(o),this.setProgressBar(this.progressBar,this.progress),this.flagNode=this.getNodeByPath("ui/progressBar/flag");var t=this.flagNode.getPosition();t.x=this.startGap,this.flagNode.setPosition(t),this.screenAdapterBG(this.getNodeByPath("bg")),this.collectAllSpriteFrame(this.node),c.initGame(),a.initSDK(),c.channel==d.WECHAT_JJWS&&(u.gameName="jjws");for(var n,s=this.getNodeByPath("ui/logo").children,i=r(s);!(n=i()).done;){n.value.active=!1}g.GetInstance().loginState=l.loginWithoutAccount},s.onClickLoginBtn=function(){},s.onEnable=function(){var t=this;e.prototype.onEnable.call(this),this.loadDesignRes((function(){t.loadLocalizationConfig(),t.loadBundles((function(){var e=t.getNodeByPath("ui/logo");e.localizeImg(),e.active=!0,t.getNodeByPath("ui/jiazaizhong").localizeImg(),P.getInstance().$localization&&"zh_CN"==P.getInstance().$localization&&(t.getNodeByPath("ui/hint").active=!0),t.loadCommonLayerRes()}))})),c.eventSendCustomEvent("进入加载页","玩家人数")},s.onDisable=function(){e.prototype.onDisable.call(this)},s.onDestroy=function(){e.prototype.onDestroy.call(this),this.releaseAllSpriteFrame()},s.collectAllSpriteFrame=function(e){var t=e.getComponent(i);t&&t.spriteFrame&&this.spriteFrameArr.push(t.spriteFrame);for(var r=e.children,n=0;n<r.length;n++){var s=r[n];this.collectAllSpriteFrame(s)}},s.releaseAllSpriteFrame=function(){for(var e=0;e<this.spriteFrameArr.length;e++){this.spriteFrameArr[e].decRef()}this.spriteFrameArr=[]},s.loadDesignRes=function(e){var t=this;h.loadAllDesignTable((function(e){t.designResProgress=e}),(function(){t.designResProgress=1,e&&e()}))},s.loadBundles=function(e){var t=this;this.bundleLoadingTime=0;var r=[u.bundles.common,u.bundles.hint,u.bundles.icon,u.bundles.layer,u.bundles.monster,u.bundles.prefab,u.bundles.spine,u.bundles.ui,u.bundles.bullet,u.bundles.wwqVec,u.bundles.loading];f.loadBundleArr(r,(function(e){t.bundleArrProgress=e}),(function(){t.bundleArrProgress=1,e&&e()}))},s.loadCommonLayerRes=function(){var e=this;console.log("loadCommonLayerRes begin time:"+Date.now()),p.loadCommonLayers((function(t){e.layerProgress=t}),(function(){e.layerProgress=1,console.log("loadCommonLayerRes end time:"+Date.now())}))},s.loadLocalizationConfig=function(){L.initLocalization()},s.openHomeLayer=function(){this.closeLayer(),this.openLayer(u.layers.HomeLayer),c.eventSendCustomEvent("进入游戏主界面","玩家人数")},s.onButtonClick=function(e,t){},s.update=function(e){if(this.progressBar){if(this.bundleLoadingTime>=0){this.bundleLoadingTime+=e;var t=this.bundleLoadingTime/this.bundleLoadingMaxTime;t>1&&(t=1),t>this.bundleArrProgress&&(this.bundleArrProgress=t),this.bundleArrProgress>=1&&(this.bundleArrProgress=1)}var r;if(r=this.designResProgress>=1&&this.bundleArrProgress>=1?this.layerProgress*this.layerPercent:this.bundleArrProgress*this.bundleArrPercent+this.designResProgress*this.designResPercent,(r=Math.ceil(1e4*r)/1e4)>this.progressBar.progress){this.setProgressBar(this.progressBar,r),this.setString(this.percentNode,Math.ceil(100*r)+"%");var n=this.flagNode.getPosition();n.x=r*this.progressLength+this.startGap,this.flagNode.setPosition(n)}if(r>=1&&this.designResProgress>=1){if(g.GetInstance().loginState==l.noYet)return;this.progressBar=void 0,y.init(),this.openHomeLayer()}}},n}(m))||b);n._RF.pop()}}}));

System.register("chunks:///_virtual/localization.ts",["./rollupPluginModLoBabelHelpers.js","cc","./designManager.ts","./UserData.ts","./constants.ts","./resManager.ts","./cocosUtil.ts","./myLog.ts"],(function(t){"use strict";var n,e,i,a,o,s,l,r,c,h,u,f,y,_,g,p,d;return{setters:[function(t){n=t.createForOfIteratorHelperLoose,e=t.createClass},function(t){i=t.cclegacy,a=t.Node,o=t.Label,s=t.RichText,l=t.EditBox,r=t.Sprite,c=t.sp,h=t.assetManager,u=t.Font},function(t){f=t.designManager},function(t){y=t.UserData},function(t){_=t.constants},function(t){g=t.resManager},function(t){p=t.cocosUtil},function(t){d=t.myLog}],execute:function(){i._RF.push({},"8c58dt64lRJQ68CxHoPVz/C","localization",void 0),a.prototype.localize=function(t,n){return z._localize(this,t,n)},a.prototype.localizeName=function(t,n){return z._localize(this,"name"+t,n)},a.prototype.localizeInfo=function(t,n){return z._localize(this,"info"+t,n)},a.prototype.localizeImg=function(t,n,e){return z._localize(this,n,e,t)},a.prototype.localizeAnim=function(t,n){return z._localize(this,t,n)},a.prototype.localizeFormat=function(t){return z._localizeFormat(this,t)};var m=t("Localization",function(){function t(){this._langIndex={},this._myFonts=null,this.node2ResInfo={},this.node2FontSize={},this._localization={}}var i=t.prototype;return i.initLocalization=function(){var t=this,n=f.getTable(_.tableName.localization);for(var e in n){var i=n[e];if(1!=i.id){this._localization[i.type]||(this._localization[i.type]={}),this._localization[i.type][i.cat]||(this._localization[i.type][i.cat]={});var a=i.text||i.res;for(var o in a)this._localization[i.type][i.cat][i.key]||(this._localization[i.type][i.cat][i.key]={}),this._localization[i.type][i.cat][i.key+"_parsed"]||(this._localization[i.type][i.cat][i.key+"_parsed"]={}),this._localization[i.type][i.cat][i.key][o]=a[o],this._localization[i.type][i.cat][i.key+"_parsed"][o]=this.loc_parse_string(a[o])}else this._localization.lang=i.text}for(var s in f.getAllTables())if(s.startsWith("loc_")){var l=s.substring(4),r=f.getTable(s);for(var c in r){var h=r[c];h.cat||(h.cat=l),this._localization[h.type]||(this._localization[h.type]={}),this._localization[h.type][h.cat]||(this._localization[h.type][h.cat]={});var p=h.text||h.res;for(var d in p)this._localization[h.type][h.cat][h.key]||(this._localization[h.type][h.cat][h.key]={}),this._localization[h.type][h.cat][h.key+"_parsed"]||(this._localization[h.type][h.cat][h.key+"_parsed"]={}),this._localization[h.type][h.cat][h.key][d]=p[d],this._localization[h.type][h.cat][h.key+"_parsed"][d]=this.loc_parse_string(p[d])}}for(var m=this._localization.lang,z=0,F=0,R=Object.keys(m);F<R.length;F++){var I=R[F];z++,this._langIndex[I]=z}if(!this._myFonts){this._myFonts={};var v=function(n){var e=f.getTable(_.tableName.font),i=null;for(var a in e){var o=e[a];if(o.key==n){i=o.font,t._myFonts[n]||(t._myFonts[n]={}),t._myFonts[n].scale=o.scale;break}}i&&"system"!==i&&g.loadAsset(_.bundles.common,"font/"+i,u,null,(function(e,i){if(t._myFonts[n]||(t._myFonts[n]={}),e)return console.log("Failed to load font:",e),void(t._myFonts[n].font=null);t._myFonts[n].font=i}))};for(var S in this._langIndex)v(S)}var k="en";if(!y.getInstance().$localization){var b=navigator.language;for(var H in this._localization.lang)if(this._localization.lang.hasOwnProperty(H)&&(b.replace("-","_")==H||b+"_CN"==H)){k=H;break}y.getInstance().$localization=k}},i.set_language=function(t){for(var n in this._langIndex)if(t==this._langIndex[n]-1){y.getInstance().$localization=n;break}},i._localizeFormat=function(t,n){var e=t.getComponent(o),i=t.getComponent(s),a=t.getComponent(l);return e||i||a?(e&&(this.node2FontSize[t.getPathInHierarchy()]||(this.node2FontSize[t.getPathInHierarchy()]=e.fontSize),this._myFonts[n]?e.font=this._myFonts[n].font:e.useSystemFont=!0,e.fontSize=this.node2FontSize[t.getPathInHierarchy()]*(this._myFonts[n].scale?this._myFonts[n].scale:1)),i&&(this.node2FontSize[t.getPathInHierarchy()]||(this.node2FontSize[t.getPathInHierarchy()]=e.fontSize),this._myFonts[n]?i.font=this._myFonts[n].font:i.useSystemFont=!0,i.fontSize=this.node2FontSize[t.getPathInHierarchy()]*(this._myFonts[n].scale?this._myFonts[n].scale:1)),""):"ERROR"},i._localize=function(t,e,i,a){var u="ERROR",f=y.getInstance().$localization,_=this._localization,m=null,z=null,F=null,R=null,I=null;if(e&&"object"!=typeof e)i&&_.misc[i]&&(u=_.misc[i][e]&&_.misc[i][e][f]||"ERROR");else if(e&&"object"==typeof e){var v=_.parsed[e.cat][e.key]&&_.parsed[e.cat][e.key][f]||null;if(v&&v.includes("%"))u=v.format.apply(v,e.vars);else{var S=_.parsed[e.cat][e.key]&&_.parsed[e.cat][e.key+"_parsed"][f]||null;if(S){for(var k,b=n(S);!(k=b()).done;){var H=k.value;u="",H.strings.forEach((function(t){u+="number"==typeof t?e.vars[t-1]:"string"==typeof t?t:"ERROR"}))}""===u&&(u="ERROR")}}}if(!t)return u;if(m=t.getComponent(o),z=t.getComponent(s),F=t.getComponent(l),R=t.getComponent(r),I=t.getComponent(c.Skeleton),!(m||z||F||R||I))return u;if("ERROR"!=u&&""!=u||R||I){if(m&&(this.node2FontSize[t.getPathInHierarchy()]||(this.node2FontSize[t.getPathInHierarchy()]=m.fontSize),m.string=u,this._myFonts[f].font?m.font=this._myFonts[f].font:m.useSystemFont=!0,m.fontSize=this.node2FontSize[t.getPathInHierarchy()]*(this._myFonts[f].scale?this._myFonts[f].scale:1)),z&&(this.node2FontSize[t.getPathInHierarchy()]||(this.node2FontSize[t.getPathInHierarchy()]=z.fontSize),z.string=u,this._myFonts[f].font?z.font=this._myFonts[f].font:z.useSystemFont=!0,z.fontSize=this.node2FontSize[t.getPathInHierarchy()]*(this._myFonts[f].scale?this._myFonts[f].scale:1)),F&&(F.string=u),R){if(!this.node2ResInfo[t.getPathInHierarchy()]){var P=null,x=null,O=h.bundles.find((function(t,n){var e=t.getAssetInfo(R.spriteFrame._uuid);return!(!e||!e.path)&&(d.i("-----------uuid:"+R.spriteFrame._uuid),d.i("--------bdinfo:"+JSON.stringify(e)),P=e.path,d.i("---------respath:"+P),P=P.substring(0,P.lastIndexOf("/spriteFrame")),d.i("---------mid respath:"+P),x=n,!0)}));P||(u="ERROR"),P&&P.includes("_@@")&&(P=P.split("_@@")[0],d.i("---------final respath:"+P)),O&&P&&x&&(this.node2ResInfo[t.getPathInHierarchy()]={},this.node2ResInfo[t.getPathInHierarchy()].bundle=O,this.node2ResInfo[t.getPathInHierarchy()].respath=P,this.node2ResInfo[t.getPathInHierarchy()].bundleName=x)}var E=!1;if("ERROR"!=u&&""!=u&&(a||this.node2ResInfo[t.getPathInHierarchy()]&&(a=this.node2ResInfo[t.getPathInHierarchy()].bundleName),a&&g.loadSpriteFrame(a,u,(function(n,o){if(n)return u="ERROR",void d.e("loadSpriteFrame err: item--\x3e"+(null==t?void 0:t.getPathInHierarchy())+", args--\x3e"+e+", misc_cat--\x3e"+i+", bundle--\x3e"+a);p.isValid(t)&&p.isValid(R)?(R.spriteFrame=o,E=!0):u="ERROR"}))),!E){if(!this.node2ResInfo[t.getPathInHierarchy()])return"ERROR";a=this.node2ResInfo[t.getPathInHierarchy()].bundleName,u=this.node2ResInfo[t.getPathInHierarchy()].respath+"_@@"+f}g.loadSpriteFrame(a,u,(function(n,o){if(n)return u="ERROR",void d.e("loadSpriteFrame err: item--\x3e"+(null==t?void 0:t.getPathInHierarchy())+", args--\x3e"+e+", misc_cat--\x3e"+i+", bundle--\x3e"+a);p.isValid(t)&&p.isValid(R)?(R.spriteFrame=o,E=!0):u="ERROR"}))}if(I)try{"ERROR"!=u&&""!=u?I.setSkin(u):I.setSkin(f)}catch(t){d.e(t),u="ERROR"}}return u},i.loc_parse_string=function(t){for(var n=[],e={},i=null,a=null,o=null,s=null,l=null,r=null,c=[],h=1,u=0;u<t.length;u++){var f=t.charAt(u);if("{"===f?(c[0]&&n.push({strings:c,control:e||{}}),c=[],h=1,e={},i=!0,a=null,o=null,s=null,l=null,r=null):i&&":"!==f&&"}"!==f&&!s?a=(a||"")+f:i&&":"===f?s=!0:i&&","!==f&&"}"!==f&&s?o=(o||"")+f:!i||","!==f&&"}"!==f?i||"#"===f||l?i||"#"!==f||l?!i&&"#"===f&&l?(l=null,r&&(c[h-1]=r,h++,r=null)):!i&&l&&(r=(r||null)+Number(f)):(l=!0,c[h-1]&&h++):c[h-1]=(c[h-1]||"")+(e.X?f.replace(/\s+/g,""):f):(s=null,a&&(e[a]=o),a=null,o=null,"}"===f&&(i=null)),u===t.length-1)return c[0]&&n.push({strings:c,control:e||{}}),n}return n},e(t,[{key:"langIndex",get:function(){return this._langIndex},set:function(t){this._langIndex=t}},{key:"myFonts",get:function(){return this._langIndex},set:function(t){this._langIndex=t}},{key:"localization",get:function(){return this._localization},set:function(t){this._localization=t}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}());m._instance=void 0;var z=t("localizeManager",m.instance);i._RF.pop()}}}));

System.register("chunks:///_virtual/localStorageManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./constants.ts"],(function(e){"use strict";var t,n,a,o,i;return{setters:[function(e){t=e.createClass},function(e){n=e.cclegacy,a=e.sys},function(e){o=e.myLog},function(e){i=e.constants}],execute:function(){n._RF.push({},"843feR3HERCO4ZE2g+iR7sM","localStorageManager",void 0);var s=function(){function e(){this.uidKey=i.gameName+"_uid",this.openIdKey=i.gameName+"_openId"}var n=e.prototype;return n.getKey=function(){return i.gameName?i.gameName+"_gameData":"gameData"},n.getGameData=function(){var e=this.getKey(),t=a.localStorage.getItem(e);return t?t=JSON.parse(t):{}},n.setGameData=function(e){var t=this.getKey();a.localStorage.setItem(t,JSON.stringify(e))},t(e,[{key:"uid",get:function(){return a.localStorage.getItem(this.uidKey)},set:function(e){a.localStorage.setItem(this.uidKey,e+""),o.i("保存uid:"+e)}},{key:"openId",get:function(){return a.localStorage.getItem(this.openIdKey)},set:function(e){a.localStorage.setItem(this.openIdKey,e+""),o.i("保存openId："+e)}}],[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();s._instance=void 0;e("localStorageManager",s.instance);n._RF.pop()}}}));

System.register("chunks:///_virtual/localText.ts",["cc"],(function(t){"use strict";var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"6baf2njhytK9KIt5/ZohKS5","localText",void 0);t("localText",{clickGameStart:"点击游戏开始",adAwardHint:"完整观看视频获得奖励",noRewardAd:"暂无广告可观看，请稍后再试",noAd:"需要接入激励视频广告",defaultError:"发生错误 st:%d",lackItemHint:"缺少 %s",itemGet:"获得 %sx%d",timeCd:"%s后回来",cd:"不要太频繁哦，请稍后再来",propGet:"获得%d个%s",lv:"等级",maxLv:"已满级",point:"点",energyTimeHint:"持续时间：%d天%d小时",ci:"次",daySignHasGet:"今日已签到",daySignOutdate:"签到时间已过",daySignNoLeave:"没有需要补签的",dayIndex:"第%d天",daySignFinalAwardHint:"签到7天后，才能领取",hasGet:"已领取",get:"领取",notHas:"还未获得",equipSuccess:"穿戴成功",full:"已达上限",wei:"位",ge:"个",notGet:"不可领取，目前数量为%d",weaponEquipAdd:"提升%d%武器装备的攻击力",coinGetHint:"获得%d金币",lackDiamond:"钻石不足"});e._RF.pop()}}}));

System.register("chunks:///_virtual/LuckyDrawLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./localText.ts","./msgac.ts","./designManager.ts","./mapModel.ts","./AnimationCtrl.ts","./BaseLayer.ts","./localization.ts"],(function(t){"use strict";var e,i,n,a,o,r,s,c,h,l,u,m,d,y,p,v,f,N,g,I,S,L,A,w;return{setters:[function(t){e=t.inheritsLoose,i=t.asyncToGenerator,n=t.regeneratorRuntime},function(t){a=t.cclegacy,o=t._decorator,r=t.find,s=t.tween,c=t.UIOpacity,h=t.v3,l=t.macro,u=t.sp,m=t.Label,d=t.Tween,y=t.UITransform},function(t){p=t.cocosUtil},function(t){v=t.utilTools},function(t){f=t.constants},function(t){N=t.localText},function(t){g=t.msgac},function(t){I=t.designManager},function(t){S=t.mapModel},function(t){L=t.AnimationCtrl},function(t){A=t.BaseLayer},function(t){w=t.localizeManager}],execute:function(){var b;a._RF.push({},"9a419rDrwhAl6a5INizAZcz","LuckyDrawLayer",void 0);var B=o.ccclass;o.property,t("LuckyDrawLayer",B("LuckyDrawLayer")(b=function(t){function a(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).uiNode=void 0,e.itemLayer=void 0,e.circleNodeNum=16,e.choseNum=0,e.choseArr=[],e.starShineArr=[],e.starShineIndex=0,e.showChoseIndex=0,e.showChoseItemUI=void 0,e.startCircle=!1,e.circleEnd=!1,e.btnStart=void 0,e.hintNode=void 0,e.coinLayer=void 0,e.coinNumNode=void 0,e.coinNum=0,e.resultUILayer=void 0,e.resultBgNode=void 0,e.resultItemLayer=void 0,e.resultItemNode=void 0,e.resultBtnSure=void 0,e.pdNode=void 0,e.fireNode=void 0,e}e(a,t);var o=a.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this),this.uiNode=this.getNodeByPath("ui"),this.btnStart=this.getNodeByPath("ui/btnStart"),this.hintNode=this.getNodeByPath("ui/hint"),this.itemLayer=this.getNodeByPath("ui/itemLayer");var e=this.itemLayer.children[0];e.parent=null;for(var i=[{x:0,y:100},{x:100,y:0},{x:0,y:-100},{x:-100,y:0}],n=e,a=0;a<i.length;a++)for(var o=i[a],r=1;r<=4;r++){var s=p.instantiate(e);s.parent=this.itemLayer;var c=n.getPosition();c.x+=o.x,c.y+=o.y,s.position=c,n=s}this.coinLayer=this.getNodeByPath("ui/coinLayer"),this.coinNumNode=this.getNodeByPath("ui/coinLayer/num"),this.pdNode=this.getNodeByPath("pd"),this.fireNode=this.getNodeByPath("fire"),this.resultUILayer=this.getNodeByPath("resultUi"),this.resultBgNode=this.getNodeByPath("resultUi/resultBg"),this.resultItemLayer=this.getNodeByPath("resultUi/itemLayer"),this.resultItemNode=this.resultItemLayer.children[0],this.resultItemNode.parent=null,this.resultBtnSure=this.getNodeByPath("resultUi/btnSure"),this.isShowBannerAd=!0},o.onEnable=function(){t.prototype.onEnable.call(this),this.addEventArr([g.mapLeave])},o.onDisable=function(){t.prototype.onDisable.call(this),this.removeEventArr([g.mapLeave])},o.initUI=function(){var t=this;this.node.getChildByPath("ui/title/Label").localize("title",f.layers.LuckyDrawLayer),this.btnStart.getChildByName("ui_text_go_on").localizeImg(),this.hintNode.localize("hint",f.layers.LuckyDrawLayer),this.resultBtnSure.getChildByName("text").localizeImg(),this.resultUILayer.active=!1,this.pdNode.active=!1,this.fireNode.active=!1,this.hintNode.active=!1,this.setString(this.coinNumNode,this.coinNum),this.initItemArr(),this.btnStart.active=!1,p.tweenScaleIn(this.uiNode,.3,(function(){t.btnStart.active=!0,p.tweenScaleIn(t.btnStart)}))},o.initItemArr=function(){var t=this,e=[];this.choseArr=[],this.choseNum=Math.random()>.5?3:5;var i=[],n=[];for(v.forArr(S.weaponSystem.weaponArr,(function(t){var e={};e.name=f.tableName.weapon,e.info=t;var a=I.getRowById(e.name,t.id);if(a.lv==f.design.maxLv-1){var o=v.copyObj(e);return o.info.id++,void n.push(o)}for(var r=a.lv;r<f.design.maxLv;){var s=v.copyObj(e);i.push(s),r++}})),v.forArr(S.skillSystem.skillArr,(function(t){var e={};e.name=f.tableName.skill,e.info=t;var a=I.getRowById(e.name,t.id);if(S.skillSystem.canBreakthrough(a.type)&&a.lv==f.design.maxLv-1){var o=v.copyObj(e);return o.info.id++,void n.push(o)}for(var r=a.lv;r<f.design.maxLv;){var s=v.copyObj(e);i.push(s),r++}})),v.forArr(S.skillSystem.skill2Arr,(function(t){var e={};e.name=f.tableName.skill2,e.info=t;var a=I.getRowById(e.name,t.id);if(a.lv==f.design.maxLv-1){var o=v.copyObj(e);return o.info.id++,void n.push(o)}for(var r=a.lv;r<f.design.maxLv;){var s=v.copyObj(e);i.push(s),r++}})),e=e.concat(n);n.length>this.choseNum;)v.getRandomItemByArr(n,!0);for(this.choseArr=this.choseArr.concat(n);i.length<this.circleNodeNum-e.length;){var a={};a.name=f.tableName.prop,a.id=f.propIds.coin,a.num=Math.floor(100*Math.random())+1,i.push(a)}for(;this.choseArr.length<this.choseNum;){var o=v.getRandomItemByArr(i,!0);if(!o)break;this.choseArr.push(o),e.push(o)}for(;e.length<this.circleNodeNum;){var s=v.getRandomItemByArr(i,!0);if(!s)break;e.push(s)}e=v.randomArr(e,!0),this.choseArr=v.randomArr(this.choseArr,!0),v.forArr(this.itemLayer.children,(function(i,n){var a=e[n],o=t.getRowByItem(a);a.uiIndex=n,i.item=a,t.setSpriteFrame(r("icon",i),o.icon),r("shine",i).active=!1,r("star",i).active=!1,r("chose",i).active=!1,i.active=!1,t.scheduleOnce((function(){i.active=!0,p.tweenScaleIn(i)}),.2+.2*Math.random())}))},o.getRowByItem=function(t){var e=null;switch(t.name){case f.tableName.weapon:case f.tableName.skill:case f.tableName.skill2:e=I.getRowById(t.name,t.info.id);break;case f.tableName.prop:e=I.getRowById(t.name,t.id)}return e},o.getCatNameByItem=function(t){var e=null;switch(t.name){case f.tableName.weapon:case f.tableName.skill:case f.tableName.skill2:e=f.catName[t.name+"System"];break;case f.tableName.prop:e=f.catName.propSystem}return e},o.startAnimation=function(){var t=this;v.waterfall([function(e,i){t.circleShineAnimation((function(){i()}))},function(e,i){t.circleShineAnimation((function(){i()}))},function(e,i){t.totalShineAnimation((function(){t.hintNode.active=!0,s(t.hintNode.getComponent(c)).delay(.5).to(.5,{opacity:0}).to(.5,{opacity:255}).union().repeatForever().start(),i()}))},function(e,i){t.choseNumAnimation((function(){i()}))},function(e,i){t.unscheduleAllCallbacks(),t.pdNode.active=!0,t.startCircle=!0,s(t.coinLayer).to(.2,{scale:h(1.1,1.1,1)}).to(.2,{scale:h(1,1,1)}).union().repeatForever().start(),t.schedule((function(){t.startCircle&&!t.circleEnd&&(t.coinNum+=2,t.setString(t.coinNumNode,t.coinNum))}),.02,l.REPEAT_FOREVER),t.startShineStarCircle()}]);var e=[h(-100,200,0),h(0,-100,0),h(150,-250,0),h(300,-500,0),h(100,-450,0)];p.schedule(this,(function(){if(!(e.length<=0)){var i=Math.random()>.5?"huang":"lan",n=.8+.2*Math.random(),a=v.getRandomItemByArr(e,!0),o=p.instantiate(t.fireNode);o.parent=t.fireNode.parent,o.active=!0,o.position=a,o.scale=h(n,n,1),o.getComponent(u.Skeleton).setSkin(i),p.addComponentOnce(o,L).playAnimationOnce("animation",(function(){o.parent=null}))}}),1.5,l.REPEAT_FOREVER,0,!0)},o.startShineStarCircle=function(){var t=this.itemLayer.children,e=5;this.starShineArr=[],this.starShineIndex=e+this.choseNum-1,this.showChoseIndex=0,this.showChoseItemUI=null;for(var i=0;i<this.choseNum;i++){var n=t[e];e++,this.initStarShineItemUI(n),this.starShineArr.push(n)}this.schedule(this.addNextStarShine,.05,l.REPEAT_FOREVER),this.scheduleOnce(this.startShowChoseItem,3+2*Math.random())},o.startShowChoseItem=function(){var t=this.choseArr[this.showChoseIndex];t&&(this.showChoseItemUI=this.itemLayer.children[t.uiIndex],this.showChoseIndex++)},o.initStarShineItemUI=function(t){var e=r("shine",t).getComponent(c);e.node.active=!0,e.opacity=255;var i=r("star",t);i.angle=360*Math.random();var n=p.addComponentOnce(i,L);n.getComponent(c).opacity=255,n.node.active=!0,n.playAnimation("3",!1,(function(){n.node.active=!1}))},o.addNextStarShine=function(t){var e=this,i=this.itemLayer.children;this.starShineIndex++,this.starShineIndex>=this.circleNodeNum&&(this.starShineIndex=0);var n=i[this.starShineIndex];if(this.showChoseItemUI==n){this.showChoseItemUI=null,this.unschedule(this.addNextStarShine),r("chose",n).active=!0;var a=r("star",n);return a.active=!0,a.angle=0,a.getComponent(c).opacity=255,p.addComponentOnce(a,L).playAnimation("2",!1,(function(){a.active=!1})),void s(n).to(.2,{scale:h(1.5,1.5,1)}).to(.2,{scale:h(1,1,1)}).call((function(){e.showChoseIndex>=e.choseArr.length?e.showChoseResult():(e.schedule(e.addNextStarShine,.05,l.REPEAT_FOREVER),e.startShowChoseItem())})).start()}this.initStarShineItemUI(n),this.starShineArr.push(n);var o=this.starShineArr.shift(),u=r("shine",o);s(u.getComponent(c)).to(6*t,{opacity:0}).start()},o.playerAddItem=function(t){var e=this.getRowByItem(t);switch(t.name){case f.tableName.weapon:S.weaponSystem.addWeapon(e.type),t.info=v.copyObj(S.weaponSystem.getWeaponInfoByType(e.type));break;case f.tableName.skill:S.skillSystem.addSkill(e.type),t.info=v.copyObj(S.skillSystem.getSkillInfoByType(e.type));break;case f.tableName.skill2:S.skillSystem.addSkill2(e.type),t.info=v.copyObj(S.skillSystem.getSkill2InfoByType(e.type));break;case f.tableName.prop:S.propSystem.getProp(t.id,t.num)}},o.showChoseResult=function(){var t=i(n().mark((function t(){var e,i,a,o,c,l=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.unscheduleAllCallbacks(),this.circleEnd=!0,S.propSystem.getProp(f.propIds.coin,this.coinNum),this.itemLayer.children.forEach((function(t){r("shine",t).active=!1,r("star",t).active=!1})),this.resultUILayer.active=!0,this.resultBtnSure.active=!1,this.resultItemLayer.removeAllChildren(),t.next=9,p.tweenFadeIn(this.resultBgNode,.5);case 9:for(e=this.resultItemNode.getComponent(y),i=e.height,20,a=this.itemLayer.children,o=function(t){var e=l.choseArr[t];l.playerAddItem(e),l.scheduleOnce((function(){var n=a[e.uiIndex],o=p.convertToWorldSpace(n);(n=p.instantiate(n)).parent=l.resultItemLayer,n.position=p.convertToNodeSpace(n,o);var c=h(0,0,0);c.y=.5*-i-(i+20)*t,s(n).to(.2,{position:c}).to(.1,{scale:h(.3,.3,1)}).call((function(){var i=p.instantiate(l.resultItemNode);i.parent=l.resultItemLayer,i.position=c,l.refreshResultItemUI(i,e);var n=r("shine",i);n.active=!0,p.tweenScaleIn2(i,.2,(function(){p.tweenFadeOut(n,.6),t==l.choseArr.length-1&&(l.resultBtnSure.active=!0,p.tweenScaleIn2(l.resultBtnSure))}))})).start()}),.3*t)},c=0;c<this.choseArr.length;c++)o(c);case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.refreshResultItemUI=function(t,e){var i=this.getRowByItem(e);this.setSpriteFrame(r("icon",t),i.icon),r("name",t).localizeName(i.id,this.getCatNameByItem(e));i.info;e.name==f.tableName.prop&&N.coinGetHint.format(e.num),e.name==f.tableName.prop?r("info",t).getComponent(m).string=w._localize(null,"info"+i.id,this.getCatNameByItem(e))+" x"+e.num:r("info",t).localizeInfo(i.id,this.getCatNameByItem(e));var n=r("starLayer",t);e.name!=f.tableName.prop?(n.active=!0,this.setNumItemLayer(n,f.design.maxLv,(function(t,e){var n=r("icon",t),a=r("icon2",t),o=r("yin",t);i.lv>=e?(n.active=!0,a.active=!1,o.active=!1,i.lv>=f.design.maxLv&&(n.active=!1,a.active=!0)):(n.active=!1,o.active=!0)}))):n.active=!1},o.choseNumAnimation=function(t){for(var e=this,i=this.itemLayer.children,n=5,a=[],o=function(o){var h=i[n];a.push(h),n++,e.scheduleOnce((function(){var i=r("shine",h).getComponent(c);i.node.active=!0,i.opacity=0,s(i).to(.1,{opacity:255}).delay(.15).to(.1,{opacity:0}).union().repeatForever().start(),o==e.choseNum-1&&e.scheduleOnce((function(){v.forArr(a,(function(t){r("shine",t).active=!1,d.stopAllByTarget(r("shine",t).getComponent(c))})),t()}),.35)}),.35*o)},h=0;h<this.choseNum;h++)o(h)},o.totalShineAnimation=function(t){v.forArr(this.itemLayer.children,(function(e,i){var n=r("shine",e).getComponent(c);n.node.active=!0,n.opacity=0,s(n).to(.3,{opacity:255}).to(.3,{opacity:0}).union().repeat(3).call((function(){0==i&&t()})).start()}))},o.circleShineAnimation=function(t){for(var e=this,i=this.itemLayer.children,n=0,a=.1,o=function(o){var h=i[o],l=.05*n,u=r("shine",h);u.active=!0;var m=u.getComponent(c);if(m.opacity=0,e.scheduleOnce((function(){s(m).to(a,{opacity:255}).delay(.5).to(a,{opacity:0}).call((function(){5==o&&t()})).start()}),l),13!=o&&5!=o){var d=i[(26-o)%e.circleNodeNum],y=r("shine",d);y.active=!0;var p=y.getComponent(c);p.opacity=0,e.scheduleOnce((function(){s(p).to(a,{opacity:255}).delay(.5).to(a,{opacity:0}).start()}),l)}n++},h=13;h>=5;h--)o(h)},o.mapLeaveRet=function(){this.closeLayer()},o.processEvent=function(t,e){},o.onClickBtnStart=function(){this.btnStart.active=!1,this.startAnimation()},o.onButtonClick=function(t,e){},o.onClickBg=function(){if(this.hintNode.active){this.hintNode.active=!1,this.circleEnd=!0;var t=300;this.choseNum>=3&&(t=450),t+=100*Math.random(),(t=Math.floor(t))<=this.coinNum&&(t+=50*Math.random(),t=Math.floor(t)),this.coinNum=t,this.setString(this.coinNumNode,this.coinNum),this.showChoseResult()}},o.closeLayer=function(){t.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},o.onClickBtnSure=function(){this.closeLayer()},a}(A))||b);a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./SingleInstance.ts","./debugLogMgr.ts","./myLog.ts","./redPointManager.ts","./GameLaunch.ts","./AnimationCtrl.ts","./AnimationTrack.ts","./BaseLayer.ts","./BtnLayer.ts","./ItemLayer.ts","./NodePoolUtil.ts","./NoticeLayer.ts","./ProgressCtrl.ts","./RenderChildBatch.ts","./ScrollViewUtil.ts","./GameCtrl.ts","./Player.ts","./PropItemPrefab.ts","./Bullet.ts","./Bullet1011.ts","./Bullet1021.ts","./Bullet1031.ts","./Bullet1041.ts","./Bullet1042.ts","./Bullet1051.ts","./Bullet1052.ts","./Bullet1061.ts","./Bullet1071.ts","./Bullet1081.ts","./Bullet1091.ts","./Bullet1101.ts","./Bullet1102.ts","./Bullet1103.ts","./Bullet1111.ts","./Bullet12.ts","./Bullet13.ts","./Bullet14.ts","./Bullet17.ts","./Bullet18.ts","./Bullet19.ts","./Bullet20.ts","./Bullet21.ts","./Bullet22.ts","./Bullet4.ts","./Bullet5.ts","./Bullet6.ts","./Bullet8.ts","./Bullet9.ts","./bullet10170.ts","./bullet10180.ts","./bullet10190.ts","./bullet10200.ts","./bullet1112.ts","./bullet16.ts","./Hint.ts","./TargetPos.ts","./blockArrow.ts","./comeShine.ts","./feiBiao.ts","./targetPos2.ts","./targetPos3.ts","./Monster.ts","./Monster12.ts","./Monster13.ts","./Monster21.ts","./Monster22.ts","./Monster23.ts","./Monster3.ts","./Monster4.ts","./Monster5.ts","./Monster6.ts","./Monster9.ts","./Prop.ts","./Prop1001.ts","./Prop1002.ts","./Prop101.ts","./Prop201.ts","./Prop701.ts","./Skill.ts","./Skill1.ts","./Skill10.ts","./Skill11.ts","./Skill2.ts","./Skill3.ts","./Skill4.ts","./Skill5.ts","./Skill6.ts","./Skill7.ts","./Skill8.ts","./Skill9.ts","./Weapon.ts","./Weapon1.ts","./Weapon2.ts","./Weapon3.ts","./Weapon4.ts","./Weapon5.ts","./Weapon6.ts","./Weapon7.ts","./Weapon8.ts","./AAModelLayer.ts","./AwardInfoLayer.ts","./BackHomeLayer.ts","./BackLifeLayer.ts","./BackMaplLayer.ts","./BaseUILayer.ts","./BlessLayer.ts","./BlessResultLayer.ts","./BoxMonsterLayer.ts","./BuyLifeLayer.ts","./ChapterLayer.ts","./DaySignLayer.ts","./DayTaskLayer.ts","./DialogEffect.ts","./EnergyLayer.ts","./GuessGameLayer.ts","./GuessResultLayer.ts","./HandLayer.ts","./HeroLayer.ts","./HomeLayer.ts","./LetterLayer.ts","./LevelLayer.ts","./LoadingLayer.ts","./LuckyDrawLayer.ts","./MainLayer.ts","./MapLayer.ts","./MoreGameLayer.ts","./MsgBoxLayer.ts","./PatrolFastLayer.ts","./PatrolLayer.ts","./PauseLayer.ts","./PropInfoLayer.ts","./PropInfoLayer2.ts","./PyramidDrawLayer.ts","./RewardItemLayer.ts","./RewardLayer.ts","./RewardRedBoxLayer.ts","./RewardSkinLayer.ts","./SettingLayer.ts","./SettlementLayer.ts","./ShareLayer.ts","./ShopLayer.ts","./SkillSelectLayer.ts","./SkinChangeLayer.ts","./TopUILayer.ts","./TowerFloorLayer.ts","./TowerLayer.ts","./TowerRoleLayer.ts","./TransLayer.ts","./VipLayer.ts","./ShineColor.ts","./BulletSystem.ts","./HintSystem.ts","./MapSystem.ts","./MonsterSystem.ts","./NumSystem.ts","./PropSystem.ts","./SkillSystem.ts","./WeaponSystem.ts","./constants.ts","./localText.ts","./msgac.ts","./BoxColliderUtil.ts","./MotionStreakAssemblerUtil.ts","./MotionStreakUtil.ts","./PhysicsWorld.ts","./GParam.ts","./MapWrap.ts","./RedPointLogicMgr.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./layerManager.ts","./localStorageManager.ts","./resManager.ts","./UserData.ts","./devModel.ts","./mapModel.ts","./playerModel.ts","./physicsGroup.ts","./serverMsg.ts","./localization.ts","./sdkManager.ts","./H5AdSdk4399.ts","./beHaviorComponent.ts","./TyqBaseLayer.ts","./TyqMoreGameLayer.ts","./tyqLayerManager.ts","./tyqResManager.ts","./tyqConstants.ts","./CronCtr.ts","./GameMemoryStorage.ts","./ServerCtr.ts","./TimeCtr.ts","./conf.ts","./gameStorage.ts","./http.ts","./md5.ts","./wmsocket.ts","./Vivo.ts","./WXCustomAd.ts","./wechat.ts","./tyqAdManager.ts","./tyqSDK.ts","./tyqSDKConfig.ts","./weHttp.ts","./weNetworkMgr.ts","./CountTimeUtil.ts","./FileUtils.ts","./cocosUtil.ts","./utilTools.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./tyqAdManager.ts","./tyqSDK.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./RedPointLogicMgr.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts","./TopUILayer.ts","./localization.ts"],(function(e){"use strict";var t,a,n,i,o,s,l,r,c,h,y,p,b,g,d,L,u,f,v,k,m,C,P,B,M,N,S,R,z,D,T,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,l=e.Node,r=e.Sprite,c=e.Label,h=e.EditBox,y=e.VideoPlayer,p=e.v3,b=e.view,g=e.Vec3,d=e.tween,L=e.sp},function(e){u=e.myLog},function(e){f=e.tyqAdManager,v=e.Channel},function(e){k=e.tyqSDK,m=e.ChannelFlag},function(e){C=e.utilTools},function(e){P=e.constants},function(e){B=e.audioManager},function(e){M=e.designManager},function(e){N=e.RedPointLogicMgr},function(e){S=e.mapModel},function(e){R=e.playerModel},function(e){z=e.UserData},function(e){D=e.BaseLayer},function(e){T=e.TopUILayer},function(e){I=e.localizeManager}],execute:function(){var w,x,_,E,q,G,V;o._RF.push({},"b39d7yGzFVCnJAyJAjPMHKR","MainLayer",void 0);var A=s.ccclass,F=s.property;e("MainLayer",(w=A("MainLayer"),x=F({type:l}),_=F({type:l}),w((G=t((q=function(e){function t(){for(var t,a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))||this).toggles=[],t.togglesLock=[!0,!1,!1,!1,!0],n(t,"btnRedBox",G,i(t)),n(t,"handNode",V,i(t)),t.emailRedPointNode=void 0,t.daySignRedPointNode=void 0,t.dayTaskRedPointNode=void 0,t.vipRedPointNode=void 0,t.duihuanBg=void 0,t.chapterBoxRedPointNode=void 0,t.btnShare=void 0,t.videoPlayer=void 0,t.shurukuang=void 0,t.btnRedBoxLabel=void 0,t.btnShareLabel=void 0,t.map_nameLabel=void 0,t.btnDaySignLabel=void 0,t.btnPyramidLabel=void 0,t.btnDayTaskLabel=void 0,t.btnGuessLabel=void 0,t.btnPortalLabel=void 0,t.btnSkinChangeLabel=void 0,t.btnSkinLabel=void 0,t.btnEquipComposeLabel=void 0,t.btnVipLabel=void 0,t.zjbxwzLabel=void 0,t.btnGo_ksyxLabel=void 0,t.timeLabel=void 0,t}a(t,e);var o=t.prototype;return o.onLoad=function(){this.emailRedPointNode=this.getNodeByPath("btnLetter/redPoint"),this.daySignRedPointNode=this.getNodeByPath("btnsLeft/btnDaySign/redPoint"),this.dayTaskRedPointNode=this.getNodeByPath("btnsLeft/btnDayTask/redPoint"),this.vipRedPointNode=this.getNodeByPath("btnsRight/btnVip/redPoint"),this.chapterBoxRedPointNode=this.getNodeByPath("Map/btnChapter/redPoint"),this.btnShare=this.getNodeByPath("btnsRight/btnShare"),this.btnRedBoxLabel=this.getNodeByPath("hongb/Label"),this.btnShareLabel=this.getNodeByPath("btnsRight/btnShare/Label"),this.map_nameLabel=this.getNodeByPath("Map/map_nameLabel"),this.btnDaySignLabel=this.getNodeByPath("btnsLeft/btnDaySign/Label"),this.btnPyramidLabel=this.getNodeByPath("btnsLeft/btnPyramid/Label"),this.btnDayTaskLabel=this.getNodeByPath("btnsLeft/btnDayTask/Label"),this.btnGuessLabel=this.getNodeByPath("btnsLeft/btnGuess/Label"),this.btnPortalLabel=this.getNodeByPath("btnsLeft/btnPortal/Label"),this.btnSkinChangeLabel=this.getNodeByPath("btnsRight/btnSkinChange/Label"),this.btnSkinLabel=this.getNodeByPath("btnsRight/btnSkin/Label"),this.btnEquipComposeLabel=this.getNodeByPath("btnsRight/btnEquipCompose/Label"),this.btnVipLabel=this.getNodeByPath("btnsRight/btnVip/Label"),this.zjbxwzLabel=this.getNodeByPath("Map/btnChapter/Label"),this.btnGo_ksyxLabel=this.getNodeByPath("btnGo/ksyx_label"),this.timeLabel=this.getNodeByPath("Map/timeLabel"),this.btnPyramidLabel&&z.getInstance().roleLv<M.config.qingdianLock&&(this.btnPyramidLabel.parent.getComponent(r).color=P.colors.yin.parseColor(),this.btnPyramidLabel.getComponent(c).color=P.colors.yin.parseColor()),this.btnDayTaskLabel&&z.getInstance().roleLv<M.config.taksLock&&(this.btnDayTaskLabel.getComponent(c).color=P.colors.yin.parseColor(),this.btnDayTaskLabel.parent.getComponent(r).color=P.colors.yin.parseColor()),this.btnGuessLabel&&z.getInstance().roleLv<M.config.caiquanLock&&(this.btnGuessLabel.getComponent(c).color=P.colors.yin.parseColor(),this.btnGuessLabel.parent.getComponent(r).color=P.colors.yin.parseColor())},o.onClickBtnDuihuan=function(){this.duihuanBg.active=!0,this.duihuanBg.getChildByName("tishilabel").active=!1},o.onClickBtnCloseTuihuan=function(){this.duihuanBg.active=!1},o.onClickBtnTuihuan=function(){var e=this.duihuanBg.getChildByName("tishilabel");e.active=!1;var t=this.shurukuang.getComponent(h).string.split("_");if(t.length>1)if("tyq"==t[0]){var a;a="https://oss.game.xmtyq.com/game/video_wxgame/bpxt/tyq_"+t[1]+".mp4?token=6d4ae1582d1f97a26ccf250d29313750",e.active=!1,this.videoPlayer.getComponent(y).remoteURL=a,this.videoPlayer.active=!0}else e.active=!0;else e.active=!0},o.onEnable=function(){e.prototype.onEnable.call(this),k.channel!=m.WECHAT_JJWS&&k.channel!=m.WECHAT_MRTGD||f.getChannel()==v.OPPO_MINI_GAME?this.btnShare.active=!1:this.btnShare.active=!0},o.onDisable=function(){e.prototype.onDisable.call(this)},o.onDestroy=function(){e.prototype.onDestroy.call(this)},o.refreshRedPoint=function(){this.emailRedPointNode.active=R.hasLetterAward(),this.daySignRedPointNode.active=R.hasDaySignAward(),this.dayTaskRedPointNode.active=z.getInstance().roleLv>=M.config.taksLock&&R.hasDayTaskAward(),this.vipRedPointNode.active=R.hasVipAward(),this.chapterBoxRedPointNode.active=R.hasChapterBoxAward()},o.refreshLocalization=function(){var e,t,a,n,i,o,s,l,r,h,y,p,b;null==(e=this.btnRedBoxLabel)||e.localize("redBox",P.layers.MainLayer),null==(t=this.btnShareLabel)||t.localize("share",P.layers.MainLayer),this.map_nameLabel.getComponent(c).string=z.getInstance().getCurMap()+"."+I._localize(null,"name"+z.getInstance().getCurMap(),P.catName.mapSystem),null==(a=this.btnDaySignLabel)||a.localize("sign",P.layers.MainLayer),null==(n=this.btnPyramidLabel)||n.localize("pyramid",P.layers.MainLayer),null==(i=this.btnDayTaskLabel)||i.localize("dayTask",P.layers.MainLayer),null==(o=this.btnGuessLabel)||o.localize("guess",P.layers.MainLayer),null==(s=this.btnPortalLabel)||s.localize("portal",P.layers.MainLayer),null==(l=this.btnSkinChangeLabel)||l.localize("skinChange",P.layers.MainLayer),null==(r=this.btnSkinLabel)||r.localize("skin",P.layers.MainLayer),null==(h=this.btnEquipComposeLabel)||h.localize("equipCompose",P.layers.MainLayer),null==(y=this.btnVipLabel)||y.localize("vip",P.layers.MainLayer),null==(p=this.zjbxwzLabel)||p.localize("awardBox",P.layers.MainLayer),null==(b=this.btnGo_ksyxLabel)||b.localize("startGame",P.layers.MainLayer);var g=z.getInstance().getLevelData(z.getInstance().getCurMap());this.timeLabel.localize({cat:P.layers.MainLayer,key:"timeLabel",vars:[C.getTimeStrChinese(1e3*g.Time)]})},o.start=function(){var e=this.getNodeByPath("btnSet"),t=this.getNodeByPath("btnLetter"),a=this.node.parent.parent.getChildByName("TopUILayer");e.position.y>a.position.y-84&&(e.position=p(e.position.x,a.position.y-84,e.position.z),t.position=p(t.position.x,a.position.y-84,t.position.z));var n=b.getVisibleSize();if(n.width/n.height>=.5){var i=this.getNodeByPath("btnGo");i.position=new g(i.position.x,-360,i.position.z);var o=this.getNodeByPath("Map");o.position=new g(o.position.x,30,o.position.z)}if(z.getInstance()._isShowOpenLevel&&z.getInstance().getCurMap()>1){z.getInstance()._isShowOpenLevel=!1,this.initMapLevel(z.getInstance().getCurMap()-1,!1);var s=this.getNodeByPath("Map/role");s.active=!1,d(s).delay(1).call((function(){s.active=!0})).start();var l=this;d(this.getNodeByPath("Map/btnMap")).delay(.35).to(.35,{scale:p(0,0,0)}).call((function(){l.initMapLevel(z.getInstance().getCurMap(),!0)})).to(.2,{scale:p(1,1,1)}).start()}else this.initMapLevel(z.getInstance().getCurMap(),!0);for(var r=[],c=M.getRowsByType(P.tableName.CNTM,1),h=0;h<c.length;h++){var y=c[h].award[0];r.push(y[0])}z.getInstance().isHaveProp(r)?this.btnRedBox.removeFromParent():d(this.btnRedBox).to(3,{position:p(180,220,0)}).to(3,{position:p(-180,120,0)}).to(3,{position:p(180,20,0)}).to(3,{position:p(-180,-90,0)}).to(3,{position:p(180,80,0)}).to(3,{position:p(-180,-80,0)}).to(3,{position:p(180,20,0)}).to(3,{position:p(-180,120,0)}).to(3,{position:p(180,220,0)}).to(3,{position:p(-180,350,0)}).union().repeatForever().start(),N.ins().setRPointView(this.getNodeByPath("Map/btnPortal"),null,z.getInstance().getPatrolState()<=0)},o.initMapLevel=function(e,t){var a=M.getTable(P.tableName.map);this.setSpriteFrame2(this.getNodeByPath("Map/map_name"),"homeLayer/map_name"+a[e-1].id,null,P.bundles.wwqVec);var n=(a[e-1].id-1)%2+1;this.setSpriteFrame2(this.getNodeByPath("Map/btnMap/icon"),"homeLayer/ui_map"+n,null,P.bundles.wwqVec),this.getNodeByPath("btnGo/Label").getComponent(c).string="X"+a[e-1].energy;var i=z.getInstance().getLevelData(z.getInstance().getCurMap());this.timeLabel.localize({cat:P.layers.MainLayer,key:"timeLabel",vars:[C.getTimeStrChinese(1e3*i.Time)]});var o=this.getNodeByPath("Map/role");if(t){d(o).stop();var s="skin1";3!=e&&4!=e||(s="skin2"),1==e||3==e?(o.getComponent(L.Skeleton).setSkin(s),d(o).set({scale:p(1.5,1.5,0)}).to(2.5,{position:p(-138,-48,0)}).set({scale:p(-1.5,1.5,0)}).to(2.5,{position:p(90,-48,0)}).to(.8,{position:p(90,0,0)}).to(.8,{position:p(130,0,0)}).set({scale:p(1.5,1.5,0)}).to(.5,{position:p(90,0,0)}).to(.8,{position:p(90,-48,0)}).union().repeatForever().start()):2==e||4==e?(this.setSpineData2(o,P.bundles.monster,"monster22/ncg",(function(){o.getComponent(L.Skeleton).animation="walk",o.getComponent(L.Skeleton).loop=!0,o.getComponent(L.Skeleton).setSkin(s)})),d(o).set({scale:p(1.5,1.5,0)}).to(2.5,{position:p(-138,-48,0)}).set({scale:p(-1.5,1.5,0)}).to(2.5,{position:p(90,-48,0)}).union().repeatForever().start()):o.active=!1}this.handNode.active=!1;var l=z.getInstance().getCurMap()-1;z.getInstance().power>=a[l].energy&&(this.handNode.active=!0)},o.onClickBtnGo=function(){B.playEffect("btnClick");var e=z.getInstance().getCurMap()-1,t=M.getTable(P.tableName.map);z.getInstance().power<t[e].energy?this.createNotice("体力不足"):(z.getInstance().usePower(0-t[e].energy),this.node.parent.parent.getChildByName("TopUILayer").getComponent(T).showUseAnimal(1,0-t[e].energy),R.addDayTaskNum(7,t[e].energy),S.enterMapWithMapId(z.getInstance().getCurMap()))},o.onClickBtnMap=function(){u.i("btnMap"),B.playEffect("btnClick"),this.closeLayer(),this.openLayer(P.layers.LevelLayer)},o.onClickBtnChapter=function(){B.playEffect("btnClick"),u.i("btnMap"),this.closeLayer(),this.openLayer(P.layers.ChapterLayer,{chapter:11})},o.onClickBtnPartol=function(){B.playEffect("btnClick"),this.openLayer(P.layers.PatrolLayer),N.ins().setRPointView(this.getNodeByPath("Map/btnPortal"),null,!1)},o.onClickBtnSet=function(){B.playEffect("btnClick"),this.openLayer(P.layers.SettingLayer)},o.onClickBtnDayTask=function(){B.playEffect("btnClick"),z.getInstance().roleLv<M.config.taksLock?this.createNotice(I._localize(null,{cat:P.layers.MainLayer,key:"unlockHint",vars:[M.config.taksLock]})):this.openLayer(P.layers.DayTaskLayer)},o.onClickBtnDaySign=function(){B.playEffect("btnClick"),this.openLayer(P.layers.DaySignLayer)},o.onClickBtnGuess=function(){B.playEffect("btnClick"),z.getInstance().roleLv<M.config.caiquanLock?this.createNotice(I._localize(null,{cat:P.layers.MainLayer,key:"unlockHint",vars:[M.config.caiquanLock]})):this.openLayer(P.layers.GuessGameLayer)},o.onClickBtnPyramid=function(){B.playEffect("btnClick"),z.getInstance().roleLv<M.config.qingdianLock?this.createNotice(I._localize(null,{cat:P.layers.MainLayer,key:"unlockHint",vars:[M.config.qingdianLock]})):this.openLayer(P.layers.PyramidDrawLayer)},o.onClickOpenLayer=function(e,t){B.playEffect("btnClick"),this.openLayer(t)},o.onClickBtnLetter=function(){B.playEffect("btnClick"),this.openLayer(P.layers.LetterLayer)},o.onClickBtnEquipCompose=function(){B.playEffect("btnClick"),this.openLayer(P.layers.BlessLayer)},o.onClickBtnSkinChange=function(){B.playEffect("btnClick"),this.openLayer(P.layers.SkinChangeLayer)},o.onClickBtnVip=function(){B.playEffect("btnClick"),this.openLayer(P.layers.VipLayer)},o.onClickBtnShare=function(){B.playEffect("btnClick"),this.openLayer(P.layers.ShareLayer),k.eventSendCustomEvent("参与活动分享")},t}(D)).prototype,"btnRedBox",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(q.prototype,"handNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=q))||E));o._RF.pop()}}}));

System.register("chunks:///_virtual/MapLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./sdkManager.ts","./tyqSDK.ts","./cocosUtil.ts","./utilTools.ts","./constants.ts","./localText.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./serverMsg.ts","./BaseLayer.ts","./GameCtrl.ts","./Player.ts","./ShineColor.ts","./BulletSystem.ts","./HintSystem.ts","./MapSystem.ts","./MonsterSystem.ts","./NumSystem.ts","./PropSystem.ts","./SkillSystem.ts","./WeaponSystem.ts"],(function(e){"use strict";var t,i,s,a,o,n,l,r,h,p,m,u,d,c,y,g,v,k,f,S,B,N,L,b,P,C,D,x,H,M,A,R,I,F;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,s=e._decorator,a=e.find,o=e.ProgressBar,n=e.Tween,l=e.v3,r=e.tween},function(e){h=e.myLog},function(e){p=e.sdkManager},function(e){m=e.tyqSDK},function(e){u=e.cocosUtil},function(e){d=e.utilTools},function(e){c=e.constants},function(e){y=e.localText},function(e){g=e.msgac},function(e){v=e.audioManager},function(e){k=e.designManager},function(e){f=e.mapModel},function(e){S=e.playerModel},function(e){B=e.UserData},function(e){N=e.serverMsg},function(e){L=e.BaseLayer},function(e){b=e.GameCtrl},function(e){P=e.Player},function(e){C=e.ShineColor},function(e){D=e.BulletSystem},function(e){x=e.HintSystem},function(e){H=e.MapSystem},function(e){M=e.MonsterSystem},function(e){A=e.NumSystem},function(e){R=e.PropSystem},function(e){I=e.SkillSystem},function(e){F=e.WeaponSystem}],execute:function(){var w;i._RF.push({},"a41fcFlOgVCb4AMEKDOJ9z2","MapLayer",void 0);var E=s.ccclass;s.property,e("MapLayer",E("MapLayer")(w=function(e){function i(){for(var t,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return(t=e.call.apply(e,[this].concat(s))||this).fightCapNode=void 0,t.mapSystem=void 0,t.player=void 0,t.gameCtrl=void 0,t.timeNode=void 0,t.expProgress=void 0,t.expLvNode=void 0,t.expBarColorArr=["#00FF00","#00C2FF","#FF00D6","#FF2900"],t.expBarColorIndex=0,t.expBarShineColor=void 0,t.expLvUpCount=0,t.coinNumNode=void 0,t.coinIconNode=void 0,t.diamondNumNode=void 0,t.killMonsterNumNode=void 0,t.bossHpLayer=void 0,t.bossDamProgressBar=void 0,t.bossHpProgress=void 0,t.skillBombIcon=void 0,t.skillBombAd=void 0,t.skillBombNum=void 0,t.skillBombCd=void 0,t.btnSkillHeal=void 0,t.skillHealIcon=void 0,t.skillHealAd=void 0,t.skillHealNum=void 0,t.skillHealCd=void 0,t.skillMagnetAd=void 0,t.skillMagnetNum=void 0,t.skillLifeAd=void 0,t.skillLifeNum=void 0,t.monsterNumNode=void 0,t.showNumNode=void 0,t.playerPosNode=void 0,t.expNumNode=void 0,t}t(i,e);var s=i.prototype;return s.onLoad=function(){e.prototype.onLoad.call(this),this.chooseDesignResolution(),this.getNodeByPath("bg").active=!1,this.getNodeByPath("ui/btns").active=S.isRecordAd||S.isInDevelopmentEnvironment(),this.getNodeByPath("ui/skillBtns").active=S.isRecordAd||S.isInDevelopmentEnvironment(),this.fightCapNode=this.getNodeByPath("fightCap"),this.fightCapNode.active=!1,this.gameCtrl=this.getNodeByPath("gameCtrl").addComponent(b),this.mapSystem=f.mapFightLayer.addComponent(H);var t=a("map",f.mapFightLayer);this.player=a("player",t).addComponent(P);var i=a("monsterLayer",t).addComponent(M),s=a("bulletLayer",t).addComponent(D),n=a("numLayer",t).addComponent(A),l=a("player/skillLayer",t).addComponent(I),r=a("player/weaponLayer",t).addComponent(F),h=a("hintLayer",t).addComponent(x),p=a("propLayer",t).addComponent(R);f.setCompoments(this,this.player,this.mapSystem,i,s,n,r,l,h,p),this.coinIconNode=this.getNodeByPath("ui/top/coinLayer/icon"),this.coinNumNode=this.getNodeByPath("ui/top/coinLayer/num"),this.diamondNumNode=this.getNodeByPath("ui/top/diamondLayer/num"),this.killMonsterNumNode=this.getNodeByPath("ui/top/monsterLayer/num"),this.expProgress=this.getNodeByPath("ui/expProgress"),this.expLvNode=this.getNodeByPath("ui/expProgress/lv"),this.expBarShineColor=this.getNodeByPath("ui/expProgress/bar").addComponent(C),this.bossHpLayer=this.getNodeByPath("ui/bossHpLayer"),this.bossDamProgressBar=this.getNodeByPath("ui/bossHpLayer/damProgress").getComponent(o),this.bossHpProgress=this.getNodeByPath("ui/bossHpLayer/hpProgress"),this.bossHpLayer.active=!1,this.skillBombIcon=this.getNodeByPath("ui/skillBtns/btnSkillBomb/icon"),this.skillBombAd=this.getNodeByPath("ui/skillBtns/btnSkillBomb/icon/ad"),this.skillBombNum=this.getNodeByPath("ui/skillBtns/btnSkillBomb/icon/num"),this.skillBombCd=this.getNodeByPath("ui/skillBtns/btnSkillBomb/cd"),this.btnSkillHeal=this.getNodeByPath("ui/skillBtns/btnSkillHeal"),this.skillHealIcon=this.getNodeByPath("ui/skillBtns/btnSkillHeal/icon"),this.skillHealAd=this.getNodeByPath("ui/skillBtns/btnSkillHeal/icon/ad"),this.skillHealNum=this.getNodeByPath("ui/skillBtns/btnSkillHeal/icon/num"),this.skillHealCd=this.getNodeByPath("ui/skillBtns/btnSkillHeal/cd"),this.skillMagnetAd=this.getNodeByPath("ui/skillBtns/btnSkillMagnet/icon/ad"),this.skillMagnetNum=this.getNodeByPath("ui/skillBtns/btnSkillMagnet/icon/num"),this.skillLifeAd=this.getNodeByPath("ui/skillBtns/btnSkillLife/icon/ad"),this.skillLifeNum=this.getNodeByPath("ui/skillBtns/btnSkillLife/icon/num"),this.timeNode=this.getNodeByPath("ui/top/time"),this.getNodeByPath("ui/infoDev").active=S.isInDevelopmentEnvironment(),this.monsterNumNode=this.getNodeByPath("ui/infoDev/monsterNum"),this.showNumNode=this.getNodeByPath("ui/infoDev/showNum"),this.playerPosNode=this.getNodeByPath("ui/infoDev/playerPos"),this.expNumNode=this.getNodeByPath("ui/infoDev/expNum");var m=B.getInstance().mapData;m?this.loadSaveMapData(m):(f.player.initData(this.layerData),f.weaponSystem.initData(this.layerData)),this.openUpdateSecond=!0,v.playMusic(c.audioNames.map),this.schedule(this.popBuyLifeLayer,this.getPopBuyLifeTime())},s.onEnable=function(){e.prototype.onEnable.call(this),this.addEventArr([g.mapLeave,g.saveDataBefore,g.commonResRefresh,g.mapRefreshSkill])},s.onDisable=function(){e.prototype.onDisable.call(this)},s.onDestroy=function(){e.prototype.onDestroy.call(this)},s.start=function(){var e=this;B.getInstance().mapHand||(B.getInstance().mapHand=1,this.scheduleOnce((function(){e.popLayer(c.layers.HandLayer)}))),m.eventSendCustomEvent("进入战斗场景","玩家人数"),m.eventLevelStart(f.mapId)},s.initUI=function(){this.refreshExpLayer(),this.refreshBossHpLayer(),this.refreshResLayer(),this.refreshSkillLayer()},s.popBuyLifeLayer=function(){B.getInstance().baoshi,k.config.backLifeDiamond},s.getPopBuyLifeTime=function(){return 180},s.refreshSkillLayer=function(){this.skillBombAd.active=!1,this.skillBombNum.active=!1,S.skillBombNum>0?(this.skillBombNum.active=!0,this.setString(this.skillBombNum,S.skillBombNum)):this.skillBombAd.active=!0,this.skillHealAd.active=!1,this.skillHealNum.active=!1,S.skillHealNum>0?(this.skillHealNum.active=!0,this.setString(this.skillHealNum,S.skillHealNum)):this.skillHealAd.active=!0,this.skillMagnetAd.active=!1,this.skillMagnetNum.active=!1,S.skillMagnetNum>0?(this.skillMagnetNum.active=!0,this.setString(this.skillMagnetNum,S.skillMagnetNum)):this.skillMagnetAd.active=!0,this.skillLifeAd.active=!1,this.skillLifeNum.active=!1,S.skillLifeNum>0?(this.skillLifeNum.active=!0,this.setString(this.skillLifeNum,S.skillLifeNum)):this.skillLifeAd.active=!0},s.mapRefreshSkillRet=function(){this.refreshSkillLayer()},s.updateSecond=function(){f.player.hp/f.player.hpMax<.25&&f.player.hp>0&&!f.healAdCount&&(f.healAdCount++,h.i("==========血量小于0.25强弹广告治疗"),p.openAd("血量小于0.25强弹广告治疗",(function(e){1==e&&f.player.useSkillHeal(.25)}))),f.player.hp/f.player.hpMax<.5&&!this.btnSkillHeal.isBreath&&(this.btnSkillHeal.isBreath=!0,u.tweenBreath(this.btnSkillHeal)),f.player.hp/f.player.hpMax>.5&&this.btnSkillHeal.isBreath&&(this.btnSkillHeal.isBreath=!1,n.stopAllByTarget(this.btnSkillHeal),this.btnSkillHeal.scale=l(1,1,1))},s.refreshBossHpLayer=function(){var e=f.monsterSystem.bossMonster;e?(this.setProgressBar(this.bossHpProgress,e.hp/e.hpMax),this.bossHpLayer.active||(this.bossHpLayer.active=!0,n.stopAllByTarget(this.bossDamProgressBar),this.bossDamProgressBar.progress=this.bossHpProgress.getComponent(o).progress)):this.bossHpLayer.active=!1},s.bossSubHp=function(e){var t=this.bossHpProgress.getComponent(o).progress;this.bossDamProgressBar.progress=t,f.mapLayer.refreshBossHpLayer();var i=this.bossHpProgress.getComponent(o).progress;n.stopAllByTarget(this.bossDamProgressBar),r(this.bossDamProgressBar).to(.5,{progress:i},{easing:"quadOut"}).start()},s.refreshResLayer=function(){this.setString(this.coinNumNode,f.coinNum),this.setString(this.diamondNumNode,B.getInstance().baoshi),this.setString(this.killMonsterNumNode,f.killMonsterNum)},s.refreshExpLayer=function(){var e=k.getRowById(c.tableName.expLv,f.expLv);if(e){var t=e.exp,i=f.expNum;if(f.expLv>1){var s=k.getRowById(c.tableName.expLv,f.expLv-1);t=e.exp-s.exp,i=f.expNum-s.exp}this.setProgressBar(this.expProgress,i/t),this.setString(this.expLvNode,f.expLv),this.expBarShineColor.startShine(c.materials.shineColor,null,.2),f.expNum>=e.exp&&f.player.hp>0&&(this.expLvUpCount++,f.expLv++,f.expLv%k.config.check==0&&f.skillAllNum++,this.expBarColorIndex++,this.expBarColorIndex>=this.expBarColorArr.length&&(this.expBarColorIndex=0),u.setRenderableColor(a("bar",this.expProgress),this.expBarColorArr[this.expBarColorIndex]),this.refreshExpLayer(),this.unschedule(this.onSkillSelect),this.scheduleOnce(this.onSkillSelect,.5),f.player.addHpPercent(k.config.upgradeAddHpPercent))}},s.onSkillSelect=function(){var e=this;if(!(this.expLvUpCount<=0)){if(f.player.hp>0&&!S.isRecordAd){this.expProgress.active=!1;var t={};t.lvCount=this.expLvUpCount,this.popLayer(c.layers.SkillSelectLayer,t,(function(){e.expProgress.active=!0}))}f.player.hp>0&&(this.expLvUpCount=0)}},s.popLayer=function(e,t,i){var s=this;this.isShowingLayer(e)||(this.gameFightPause(),this.openLayer(e,t,(function(){s.gameFightResume(),i&&i()})))},s.refreshTimeNode=function(){var e=d.getTimeStr(1e3*f.time,!0);this.setString(this.timeNode,e)},s.gameFightPause=function(){this.mapSystem.fightPause()},s.gameFightResume=function(){this.mapSystem.fightResume()},s.mapLeaveRet=function(e){B.getInstance().mapData=null,this.closeLayer(),this.openLayer(c.layers.HomeLayer,e)},s.commonResRefreshRet=function(e){this.refreshResLayer()},s.loadSaveMapData=function(e){f.loadSaveData(e.mapModel),f.mapSystem.loadSaveData(e.mapData),f.propSystem.loadSaveData(e.propData),f.weaponSystem.loadSaveData(e.weaponData),f.skillSystem.loadSaveData(e.skillData),f.player.loadSaveData(e.player),f.monsterSystem.loadSaveData(e.monsterData)},s.saveDataBeforeRet=function(e){if(!(f.player.hp<=0)){f.propSystem.saveDataBefore();var t={};t.mapModel=f.getSaveData(),t.mapData=f.mapSystem.getSaveData(),t.propData=f.propSystem.getSaveData(),t.weaponData=f.weaponSystem.getSaveData(),t.skillData=f.skillSystem.getSaveData(),t.player=f.player.getSaveData(),t.monsterData=f.monsterSystem.getSaveData(),B.getInstance().mapData=t}},s.onClickBtnSkillBomb=function(){var e=this;if(!(f.mapSystem.skillBombCd>0))return S.skillBombNum>0?(f.mapSystem.useSkillBomb(),void this.refreshSkillLayer()):void p.openAd("主动技能-炸弹",(function(t){if(1==t){var i=d.getFloatValue(1,3,!0);S.skillBombNum+=i,e.refreshSkillLayer()}}));this.createNotice(y.cd)},s.onClickBtnSkillHeal=function(){var e=this;if(!(f.mapSystem.skillHealCd>0))return S.skillHealNum>0?(f.mapSystem.useSkillHeal(),void this.refreshSkillLayer()):void p.openAd("主动技能-治疗",(function(t){1==t&&(S.skillHealNum+=4,e.refreshSkillLayer())}));this.createNotice(y.cd)},s.onClickBtnSkillMagnet=function(){var e=this;if(S.skillMagnetNum>0)return f.mapSystem.useSkillMagnet(),void this.refreshSkillLayer();p.openAd("主动技能-磁铁",(function(t){1==t&&(S.skillMagnetNum++,e.refreshSkillLayer())}))},s.onClickBtnSkillLife=function(){var e=this;S.skillLifeNum>0||p.openAd("主动技能-自动复活",(function(t){1==t&&(S.skillLifeNum++,e.refreshSkillLayer())}))},s.onClickBtnPause=function(e){this.popLayer(c.layers.PauseLayer)},s.onClickBtnClose=function(e){N.send(g.mapLeave)},s.onClickBtnSkillSelectLayer=function(){this.popLayer(c.layers.SkillSelectLayer)},s.onClickBtnResume=function(){this.gameFightResume()},s.onClickBtnBoss=function(){f.time<300?f.time=295:f.time<600&&f.time>305?f.time=595:f.time>605&&(f.time=895)},s.onClickBtnLuckyDraw=function(){this.popLayer(c.layers.BoxMonsterLayer)},s.onClickBtnAccountClear=function(){B.getInstance().clearAccountData()},s.onClickBtnMonsterAdd=function(){this.monsterAddFlag||(this.monsterAddFlag=0),this.monsterAddFlag++},s.refreshDebugPannel=function(){this.getNodeByPath("ui/btns").active=S.isRecordAd||S.isInDevelopmentEnvironment(),this.getNodeByPath("ui/skillBtns").active=S.isRecordAd||S.isInDevelopmentEnvironment()},i}(L))||w);i._RF.pop()}}}));

System.register("chunks:///_virtual/mapModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./designManager.ts","./resManager.ts","./serverMsg.ts","./playerModel.ts","./UserData.ts","./Hint.ts"],(function(e){"use strict";var t,i,a,o,s,n,r,l,h,p,u,m,c,d,f,v,g,y,b;return{setters:[function(e){t=e.createClass},function(e){i=e.cclegacy,a=e.view,o=e.screen,s=e.find,n=e.Camera,r=e.Prefab,l=e.UITransform,h=e.SpriteFrame},function(e){p=e.cocosUtil},function(e){u=e.utilTools},function(e){m=e.constants},function(e){c=e.msgac},function(e){d=e.designManager},function(e){f=e.resManager},function(e){v=e.serverMsg},function(e){g=e.playerModel},function(e){y=e.UserData},function(e){b=e.HintNames}],execute:function(){i._RF.push({},"fac70kABNtOmop0VyXqqBln","mapModel",void 0);var A=function(){function e(){this.visibleHalfSize=void 0,this.mapFightLayer=void 0,this.mapFightCamera=void 0,this.cameraOrthoHeight=void 0,this.mapLayer=void 0,this.player=void 0,this.mapSystem=void 0,this.monsterSystem=void 0,this.bulletSystem=void 0,this.numSystem=void 0,this.skillSystem=void 0,this.weaponSystem=void 0,this.hintSystem=void 0,this.propSystem=void 0,this.mapId=void 0,this.floor=void 0,this.time=void 0,this.expPool=void 0,this.expTypeRow=void 0,this.expNum=void 0,this.expLv=void 0,this.equipIdArr=[],this.coinNum=void 0,this.killMonsterNum=void 0,this.mapLevelArr=void 0,this.mapLevelType=void 0,this.mapLevelArr_Backup=[],this.skillAllNum=void 0,this.monsterPrefabObj={},this.bulletPrefabObj={},this.dataRadius=void 0,this.destroyRadius=void 0,this.healAdCount=0}var i=e.prototype;return i.initData=function(e,t){var i=a.getVisibleSize();a.getDesignResolutionSize(),o.windowSize,a.getResolutionPolicy();this.visibleHalfSize={width:.5*i.width,height:.5*i.height},this.dataRadius=.6*i.height,this.destroyRadius=1.5*i.height,this.mapFightCamera=s("CanvasMapFight/Camera").getComponent(n),this.cameraOrthoHeight=this.mapFightCamera.orthoHeight},i.getSaveData=function(){var e={};return e.mapId=this.mapId,e.floor=this.floor,e.time=this.time,e.expPool=this.expPool,e.expTypeRow=this.expTypeRow,e.expNum=this.expNum,e.expLv=this.expLv,e.coinNum=this.coinNum,e.killMonsterNum=this.killMonsterNum,e.mapLevelArr=this.mapLevelArr,e.mapLevelArr_Backup=this.mapLevelArr_Backup,e.skillAllNum=this.skillAllNum,e.equipIdArr=this.equipIdArr,e.healAdCount=this.healAdCount,e},i.loadSaveData=function(e){this.mapId=e.mapId,this.floor=e.floor,this.time=e.time,this.expPool=e.expPool,this.expTypeRow=e.expTypeRow,this.expNum=e.expNum,this.expLv=e.expLv,this.coinNum=e.coinNum,this.killMonsterNum=e.killMonsterNum,this.mapLevelArr=e.mapLevelArr,this.mapLevelArr_Backup=e.mapLevelArr_Backup,this.skillAllNum=e.skillAllNum,this.equipIdArr=e.equipIdArr,this.healAdCount=e.healAdCount},i.enterMapWithMapId=function(e,t){void 0===t&&(t=0);var i={};i.mapId=e,i.floor=t;var a=d.getRowById(m.tableName.map,e);if(a.type==m.mapTypes.main)if(i.hp=y.getInstance().life,i.atk=y.getInstance().attack,y.getInstance().wearProp[0]>0){var o=d.getRowById(m.tableName.prop,y.getInstance().wearProp[0]);o&&11==o.type?i.weaponId=o.weaponid:i.weaponId=0}else i.weaponId=0;else if(a.type==m.mapTypes.tower){var s=y.getInstance().getTowerRoleProInfo(!0);i.hp=s.hp,i.atk=s.atk;var n=d.getRowById(m.tableName.prop,y.getInstance().$towerWeaponId);i.weaponId=n.weaponid}v.send(c.mapEnter,i)},i.loadMapFightLayer=function(){var e=this;return new Promise((function(t){e.mapFightLayer?t():f.loadAsset(m.bundles.layer,m.layers.MapFightLayer,r,(function(){}),(function(i,a){e.mapFightLayer=p.instantiate(a),e.mapFightLayer.parent=s("CanvasMapFight"),t()}))}))},i.setCompoments=function(e,t,i,a,o,s,n,r,l,h){this.mapLayer=e,this.player=t,this.mapSystem=i,this.monsterSystem=a,this.bulletSystem=o,this.numSystem=s,this.weaponSystem=n,this.skillSystem=r,this.hintSystem=l,this.propSystem=h},i.isInScreenVisible=function(e){if(!e||!e.parent)return!1;var t=p.convertToWorldSpace(e),i=p.convertToWorldSpace(this.player.node),a=e.getComponent(l),o=a.width+a.height;return Math.abs(t.x-i.x)<=this.visibleHalfSize.width+o+150&&Math.abs(t.y-i.y)<=this.visibleHalfSize.height+o},i.mapEnter=function(e){if(console.log("mapEnter---------"),this.mapId)e.st=2;else{this.mapFightCamera.orthoHeight=this.cameraOrthoHeight;var t=e.mapId;this.mapId=t,this.floor=e.floor;var i=d.getRowById(m.tableName.map,t);this.time=0,this.expPool=0,this.expTypeRow=d.getRowById(m.tableName.expType,100*i.expType+1),this.expNum=0,this.expLv=1,this.coinNum=0,this.killMonsterNum=0,this.healAdCount=0,this.skillAllNum=0,this.equipIdArr=[],g.skillBombNum=1,g.skillHealNum=1,g.skillMagnetNum=0,g.skillLifeNum=0,this.mapLevelArr_Backup=[],this.createMapLevelArr(),e.st=1}},i.createMapLevelArr=function(){var e=this;if(this.mapLevelArr=[],this.mapLevelArr_Backup&&this.mapLevelArr_Backup.length>0)return this.mapLevelArr=u.copyObj(this.mapLevelArr_Backup),void(this.mapLevelArr_Backup=[]);this.mapLevelType=this.mapId;var t=d.getRowsByType(m.tableName.level,this.mapLevelType);(!t||t.length<1)&&(this.mapLevelType=9999,t=d.getRowsByType(m.tableName.level,this.mapLevelType)),t.forEach((function(t){if(!(t.startTime<=w.time)){var i={};i.id=t.id,i.row=t,i.timeCount=0,i.createCount=0,e.mapLevelArr.push(i)}}))},i.mapLeave=function(e){this.mapId?(this.mapFightLayer.destroy(),this.mapFightLayer=null,this.mapId=0,this.floor=0,e.st=1):e.st=2},i.loadMapRes=function(e,t){var i=this;this.loadMonsterAndBulletRes((function(t){e(t)}),(function(){i.loadMapFightLayer().then((function(){t()}))}))},i.loadMonsterAndBulletRes=function(e,t){var i=this,a=1/3,o=0,s=0,n=0,l=function(){e(o*a+s*a+n*a)},p=function(){o+s+n==3&&t()};console.log("monster begin time:"+Date.now()),this.loadMonsterPrefabArr((function(e){o=e,l()}),(function(){o=1,p(),console.log("monster begin promise time:"+Date.now()),new Promise((function(){var e=[],t=[],a=d.getRowsByType(m.tableName.level,i.mapLevelType);u.forArr(a,(function(t){-1==e.indexOf(t.monsterId)&&e.push(t.monsterId)})),e.forEach((function(e){var i=d.getRowById(m.tableName.monster,e).prefab+"/monster";t.push(i)})),f.loadAssetByPathArr(m.bundles.monster,t,r,null,(function(e){e.forEach((function(e){var t=e.path.split("/")[0];i.monsterPrefabObj[t]=e}))}))})),console.log("monster end time:"+Date.now())})),console.log("Bullet begin time:"+Date.now()),this.loadBulletRes((function(e){s=e,l()}),(function(){s=1,p(),console.log("Bullet end time:"+Date.now())})),console.log("Other begin time:"+Date.now()),this.loadOtherRes((function(e){n=e,l()}),(function(){n=1,p(),console.log("Other begin Promise time:"+Date.now()),new Promise((function(){var e=d.getTable(m.tableName.prop),t=[],i=[];for(var a in e.forEach((function(e){var a=e;if(""!=a.icon){var o="prop/"+a.icon;if(11==a.type){var s=d.getRowById(m.tableName.weapon,a.weaponid);o="weapon/"+s.icon;var n=s.prefab;-1==t.indexOf(n)&&t.push(n)}""!=o&&-1==i.indexOf(o)&&i.push(o)}})),f.loadAssetByPathArr(m.bundles.icon,i,h,null,null),i=[],b)i.push(b[a]);f.loadAssetByPathArr(m.bundles.hint,i,r,null,null),f.loadAssetByPathArr(m.bundles.weapon,t,r,null,null)})),console.log("Other end time:"+Date.now())}))},i.loadOtherRes=function(e,t){var i=d.getRowById(m.tableName.map,this.mapId),a=["map/"+i.bg,"wall/"+i.wall+"_v","wall/"+i.wall+"_h"];f.loadAssetByPathArr(m.bundles.icon,a,h,e,t),console.log("Other end loadAssetByPathArr time:"+Date.now())},i.loadBulletRes=function(e,t){var i=this;this.bulletPrefabObj={};var a=d.getTable(m.tableName.bullet),o=d.getTable(m.tableName.skill),s=d.getTable(m.tableName.skill2),n=[],l=[],p=[];a.forEach((function(e){var t=e.prefab;""!=t&&-1==n.indexOf(t)&&n.push(t)})),o.forEach((function(e){var t=e.icon.split("|")[1];t&&""!=t&&-1==l.indexOf(t)&&l.push(t)})),s.forEach((function(e){var t=e.icon.split("|")[1];t&&""!=t&&-1==p.indexOf(t)&&p.push(t)})),f.loadAssetByPathArr(m.bundles.bullet,n,r,null,(function(e){e.forEach((function(e){i.bulletPrefabObj[e.name]=e})),f.loadAssetByPathArr(m.bundles.bullet,l,h,null,(function(){f.loadAssetByPathArr(m.bundles.icon,p,h,null,t)}))}))},i.loadMonsterPrefabArr=function(e,t){var i=this;this.monsterPrefabObj={};var a=[],o=[];[1,2,14].forEach((function(e){-1==a.indexOf(e)&&a.push(e)})),a.forEach((function(e){var t=d.getRowById(m.tableName.monster,e).prefab+"/monster";o.push(t)})),console.log("monster begin loadAssetByPathArr time:"+Date.now()),f.loadAssetByPathArr(m.bundles.monster,o,r,e,(function(e){e.forEach((function(e){var t=e.path.split("/")[0];i.monsterPrefabObj[t]=e})),t()}))},i.parseDesignPropArr=function(e){var t=[];return e.forEach((function(e){var i={Id:e[0],Num:e[1]};t.push(i)})),t},t(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();A._instance=void 0;var w=e("mapModel",A.instance);i._RF.pop()}}}));

System.register("chunks:///_virtual/MapSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./cocosUtil.ts","./utilTools.ts","./constants.ts","./PhysicsWorld.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./AnimationCtrl.ts","./BaseLayer.ts","./myLog.ts"],(function(t){"use strict";var e,o,i,a,n,s,r,l,p,h,m,d,c,g,y,u,f,w,v,C,b,N,x,P,S,B,L,k,T,I,M,A;return{setters:[function(t){e=t.inheritsLoose,o=t.asyncToGenerator,i=t.regeneratorRuntime},function(t){a=t.cclegacy,n=t._decorator,s=t.macro,r=t.Vec2,l=t.tween,p=t.view,h=t.Node,m=t.UITransform,d=t.BoxCollider2D,c=t.v3,g=t.UIOpacity,y=t.Tween,u=t.RenderTexture,f=t.find,w=t.director,v=t.SpriteFrame,C=t.Sprite},function(t){b=t.tyqSDK},function(t){N=t.cocosUtil},function(t){x=t.utilTools},function(t){P=t.constants},function(t){S=t.physicsWorld},function(t){B=t.designManager},function(t){L=t.mapModel},function(t){k=t.playerModel},function(t){T=t.UserData},function(t){I=t.AnimationCtrl},function(t){M=t.BaseLayer},function(t){A=t.myLog}],execute:function(){var R;a._RF.push({},"c2f8bkzNcBJiq/l+SnYqOo5","MapSystem",void 0);var H=n.ccclass;n.property,t("MapSystem",H("MapSystem")(R=function(t){function a(){for(var e,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))||this).mapFightBgLayer=void 0,e.staticNode=void 0,e.bombAnimationCtrl=void 0,e.warnAnimationCtrl=void 0,e.skillBombAniCtrl=void 0,e.bossPosHintAnimationCtrl=void 0,e.boxHintNode=void 0,e.boxArrowNode=void 0,e.mapRow=void 0,e.pauseVal=void 0,e.wallLayer=void 0,e.wallShineNode=void 0,e.wallTopNode=void 0,e.wallBottomNode=void 0,e.wallLeftNode=void 0,e.wallRightNode=void 0,e.wallTopVal=void 0,e.wallBottomVal=void 0,e.wallLeftVal=void 0,e.wallRightVal=void 0,e.wallCenterPos=void 0,e.stopTimeCount=void 0,e.expTimeCount=void 0,e.killMonsterCount=void 0,e.backlifeCount=0,e.skillBombCd=0,e.skillHealCd=0,e.nineForArr=[{x:-1,y:1},{x:0,y:1},{x:1,y:1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1}],e.vec3Obj={nodePos:c(0,0,0)},e}e(a,t);var n=a.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),this.mapFightBgLayer=this.getNodeByPath("map/bg"),this.wallLayer=this.getNodeByPath("map/wallLayer"),this.wallTopNode=this.getNodeByPath("map/wallLayer/top"),this.wallBottomNode=this.getNodeByPath("map/wallLayer/bottom"),this.wallLeftNode=this.getNodeByPath("map/wallLayer/left"),this.wallRightNode=this.getNodeByPath("map/wallLayer/right"),this.wallShineNode=this.getNodeByPath("map/wallLayer/shine"),this.wallLayer.active=!1,this.staticNode=this.getNodeByPath("static"),this.bombAnimationCtrl=this.getNodeByPath("static/bomb").addComponent(I),this.bombAnimationCtrl.node.active=!1,this.skillBombAniCtrl=this.getNodeByPath("static/skillBomb").addComponent(I),this.skillBombAniCtrl.node.active=!1,this.warnAnimationCtrl=this.getNodeByPath("static/warn").addComponent(I),this.warnAnimationCtrl.node.active=!1,this.screenAdapterBG(this.warnAnimationCtrl.node),this.bossPosHintAnimationCtrl=this.getNodeByPath("map/bossPosHint").addComponent(I),this.bossPosHintAnimationCtrl.node.active=!1,this.boxHintNode=this.getNodeByPath("static/boxHint"),this.boxHintNode.active=!1,this.boxArrowNode=this.getNodeByPath("static/boxHint/arrow"),N.tweenBreath(this.getNodeByPath("static/boxHint/icon"),.4,1.2),N.tweenBreath(this.getNodeByPath("static/boxHint/arrow/icon"),.2,1.2),this.mapRow=B.getRowById(P.tableName.map,L.mapId),this.expTimeCount=0,this.pauseVal=0,this.killMonsterCount=0,this.stopTimeCount=!1,this.schedule(this.refreshCamera,.5,s.REPEAT_FOREVER),this.schedule(this.updateLogic,.01,s.REPEAT_FOREVER)},n.onEnable=function(){t.prototype.onEnable.call(this)},n.start=function(){var t=this;this.scheduleOnce((function(){if(!T.getInstance().mapData){for(var e=0;e<20;e++){var o=N.getRectPos(L.player.node,400,700,600,1e3,!0);t.createExp(1,o,!0)}if(k.isInDevelopmentEnvironment()){var i=N.getLeavePos(L.player.node,0,400,!0);L.propSystem.addProp(P.propIds.coin,i),i=N.getLeavePos(L.player.node,0,600,!0),L.propSystem.addProp(P.propIds.coin,i)}}}),.5),this.refreshMapFightWindow()},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.initUI=function(){this.initMapFightBg(),this.initWallLayer()},n.initWallLayer=function(){var t="wall/"+this.mapRow.wall+"_h";this.setSpriteFrame2(this.wallTopNode,t),this.setSpriteFrame2(this.wallBottomNode,t),t="wall/"+this.mapRow.wall+"_v",this.setSpriteFrame2(this.wallLeftNode,t),this.setSpriteFrame2(this.wallRightNode,t)},n.initMapFightBg=function(){var t="map/"+this.mapRow.bg;this.setSpriteFrame2(this.mapFightBgLayer,t)},n.refreshMapFightWindow=function(){var t=L.player.node.getPosition();t.z=L.mapFightCamera.node.getPosition().z,L.mapFightCamera.node.setPosition(t)},n.refreshMapBgLayer=function(){var t=this,e=Math.floor((L.player.node.getPosition().x+512)/1024),o=Math.floor((L.player.node.getPosition().y+512)/1024);this.nineForArr.forEach((function(i,a){var n=t.mapFightBgLayer.children[a];if(n){var s=1024*(e+i.x),r=1024*(o+i.y);n.setPosition(s,r)}}))},n.getSaveData=function(){var t={};t.expTimeCount=this.expTimeCount,t.killMonsterCount=this.killMonsterCount,t.backlifeCount=this.backlifeCount,t.skillBombCd=this.skillBombCd,t.skillHealCd=this.skillHealCd,t.stopTimeCount=this.stopTimeCount,t.orthoHeight=L.mapFightCamera.orthoHeight;var e=null;return this.wallLayer.active&&((e={}).centerPos=this.wallCenterPos),t.wall=e,t},n.loadSaveData=function(t){if(this.expTimeCount=t.expTimeCount,this.killMonsterCount=t.killMonsterCount,this.backlifeCount=t.backlifeCount,this.skillBombCd=t.skillBombCd,this.skillHealCd=t.skillHealCd,this.stopTimeCount=t.stopTimeCount,L.mapFightCamera.orthoHeight=t.orthoHeight,t.wall){var e=t.wall;this.showWallLayer(e.centerPos)}},n.bossDead=function(){this.stopTimeCount=!1,L.mapSystem.hideWallLayer(),2==L.monsterSystem.bossMonster.isBoss?L.mapSystem.doSettlement(!0):L.createMapLevelArr(),L.monsterSystem.bossMonster=null,L.mapLayer.refreshBossHpLayer()},n.doSettlement=function(t){void 0===t&&(t=!1);var e=B.getRowById(P.tableName.map,L.mapId),o=[],i=L.coinNum+Math.floor(L.time/60*100)+Math.floor(L.killMonsterNum/5);for(var a in o.push({Id:P.propIds.coin,Num:i}),L.equipIdArr)o.push({Id:L.equipIdArr[a],Num:1});e.reward4&&(o=o.concat(L.parseDesignPropArr(e.reward4))),t&&e.reward5&&(o=o.concat(L.parseDesignPropArr(e.reward5))),x.sortArr(o,(function(t,e){var o=B.getRowById(P.tableName.prop,t.Id),i=B.getRowById(P.tableName.prop,e.Id);return o.quality<i.quality}));var n={},s=Math.floor(L.time);n.time=s;var r=T.getInstance().getLevelData(L.mapId);s>=r.Time&&(r.Time=s,T.getInstance().setLevelData(r),n.isBest=!0),n.bestTime=r.Time,T.getInstance().getRewardProp(o),n.isWin=t,n.award=o,L.mapLayer.popLayer(P.layers.SettlementLayer,n),b.eventLevelEnd(L.mapId,t),b.showInterstitialAd(),s>=900?b.eventSendCustomEvent("第"+L.mapId+"关-15分钟"):s>=600?b.eventSendCustomEvent("第"+L.mapId+"关-10分钟"):s>=300&&b.eventSendCustomEvent("第"+L.mapId+"关-5分钟")},n.getMinDisTargetNode=function(t){var e=999999,o=null;return L.monsterSystem.forVisibleMonster((function(i){if(i.node.activeInHierarchy){var a=i.distancePlayer;t&&(a=r.distance(t,i.node.position)),a<e&&(e=i.distancePlayer,o=i.node)}})),L.propSystem.forVisiblePropCollider((function(i){var a=i.node,n=a.getPosition();t||(t=L.player.node.position);var s=r.distance(t,n);s>e||(e=s,o=a)})),o},n.startWarning=function(t){var e=this;t&&(this.warnAnimationCtrl.node.active=!0,this.warnAnimationCtrl.playAnimation(t,!1,(function(){e.warnAnimationCtrl.node.active=!1,"11"==t&&e.cameraMove(L.cameraOrthoHeight+200)})))},n.cameraMove=function(t){t!=L.mapFightCamera.orthoHeight&&l(L.mapFightCamera).to(3,{orthoHeight:t}).start()},n.useSkillHeal=function(){k.skillHealNum--,L.player.useSkillHeal(.25)},n.useSkillMagnet=function(){k.skillMagnetNum--,L.propSystem.getProp(P.propIds.magnet)},n.useSkillBomb=function(){var t=o(i().mark((function t(){var e,o=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return k.skillBombNum--,this.skillBombAniCtrl.node.active=!0,this.skillBombAniCtrl.playAnimation("1",!1,(function(){o.skillBombAniCtrl.node.active=!1})),t.next=5,N.waitTimeAsync(this,.8);case 5:e=[],L.monsterSystem.forVisibleMonster((function(t){if(t.row.type==P.monsterTypes.common){var o=t.hp;t.waitHit=!0;var i={};i.monster=t,i.dam=o,e.push(i)}})),L.monsterSystem.batchHitMonster(e,e.length),L.bulletSystem.forVisibleMonsterBullet((function(t){t.recycleSelf()}));case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.bomb=function(){var t=this;this.bombAnimationCtrl.node.active=!0,this.bombAnimationCtrl.playAnimationOnce("bomb",(function(){t.bombAnimationCtrl.node.active=!1})),this.scheduleOnce((function(){var t=[];L.monsterSystem.forVisibleMonster((function(e){if(e.row.type==P.monsterTypes.common){var o=e.hp;e.waitHit=!0;var i={};i.monster=e,i.dam=o,t.push(i)}})),L.monsterSystem.batchHitMonster(t,t.length),L.bulletSystem.forVisibleMonsterBullet((function(t){t.recycleSelf()}))}),.2)},n.monsterDead=function(t,e){var o=B.getRowById(P.tableName.monster,t);if(x.isProb(o.expProb)){var i=x.getFloatValue(o.expMin,o.expMax,!0);this.createExp(i,e)}if(L.killMonsterNum++,L.mapLayer.refreshResLayer(),this.killMonsterCount++,this.killMonsterCount>=B.config.woodBoxKillNum){this.killMonsterCount-=B.config.woodBoxKillNum;var a=N.getAroundPos(L.player.node,300,2*p.getVisibleSize().height,!0),n=B.getTable(P.tableName.box1),s=[];for(var r in n){var l=n[r];0!=l.mapId&&l.mapId!=L.mapId||s.push(l)}var h=x.getRowByWeight(s),m=!1;if(h.propId!=P.propIds.addHpPercent&&L.player.hp<=.5*L.player.hpMax&&L.propSystem.getPropNums(P.propIds.addHpPercent)<2)for(var d=0;d<B.config.skillPropAddMult;d++){if(h.propId==P.propIds.addHpPercent){console.log("产生了一个回血道具，当前道具数量："+L.propSystem.getPropNums(P.propIds.addHpPercent)),m=!0;break}h=x.getRowByWeight(s)}if(!m&&h.propId!=P.propIds.bomb&&L.monsterSystem.aliveMonsterNum>=100&&L.propSystem.getPropNums(P.propIds.bomb)<2)for(var c=0;c<B.config.skillPropAddMult;c++){if(h.propId==P.propIds.bomb){console.log("产生了一个炸弹道具，当前道具数量："+L.propSystem.getPropNums(P.propIds.bomb)),m=!0;break}h=x.getRowByWeight(s)}if(!m&&h.propId!=P.propIds.magnet&&L.propSystem.getPropNums(P.propIds.exp)>=100&&L.propSystem.getPropNums(P.propIds.magnet)<2)for(var g=0;g<B.config.skillPropAddMult;g++){if(h.propId==P.propIds.magnet){console.log("产生了一个吸铁石道具，当前道具数量："+L.propSystem.getPropNums(P.propIds.magnet)),m=!0;break}h=x.getRowByWeight(s)}var y=x.getFloatValue(h.minNum,h.maxNum,!0),u={};u.num=y,u.propId=h.propId;var f=h.propId,w=B.getRowById(P.tableName.prop,f);8!=w.type&&11!=w.type||(f=P.propIds.equip),L.propSystem.addProp(f,a,u)}if(o.propProbArr)for(var v=0;v<o.propProbArr.length;v++){var C=o.propProbArr[v];if(x.isProb(C)){var b=o.propIdArr[v],S=o.propNumArr[v],T=N.getCircleDirectionArr(1)[0],I=e.clone().add(T.multiplyScalar(80)),M={};M.num=S,L.propSystem.addProp(b,I,M)}}switch(o.type){case P.monsterTypes.common:k.addDayTaskNum(4,1);break;case P.monsterTypes.elite:k.addDayTaskNum(5,1);break;case P.monsterTypes.boss:k.addDayTaskNum(6,1)}},n.createExp=function(t,e,o){if(void 0===o&&(o=!1),A.d("debug","log enter createExp"),!o){if(t>L.expPool&&(t=L.expPool),t<=0)return;L.expPool-=t}var i={};i.num=t,A.d("产生经验："+t),L.propSystem.addProp(P.propIds.exp,e,i)},n.addExp=function(t){L.expNum+=t,L.mapLayer.refreshExpLayer()},n.addCoin=function(t){L.coinNum+=t,L.mapLayer.refreshResLayer()},n.adjustInWall=function(t,e){if(void 0===e&&(e=0),this.wallLayer.active){var o=null,i=null;t instanceof h?(o=t.getComponent(m),i=t.getPosition(this.vec3Obj.nodePos)):i=t,i.x>=this.wallRightVal&&(i.x=this.wallRightVal),i.x<=this.wallLeftVal&&(i.x=this.wallLeftVal),i.y>=this.wallTopVal&&(i.y=this.wallTopVal),o&&(e=o.height),i.y<=this.wallBottomVal+.4*e&&(i.y=this.wallBottomVal+.4*e),t instanceof h&&(t.position=i)}},n.showWallLayer=function(t){var e=this;this.wallLayer.active=!0;var o=33,i=51,a=32,n=27;2==L.mapId&&(o=36,i=32,a=43,n=55);var s=Math.ceil(1200/o)*o,r=Math.ceil(1500/n)*n;t||((t=L.player.node.getPosition().clone()).y+=400),this.wallCenterPos=t;var p=this.wallTopNode;p.getComponent(m).width=s,p.getComponent(m).height=i,p.getComponent(d).size.width=s,p.getComponent(d).size.height=i;var h=c(t.x,t.y+.5*r,0);p.setPosition(h);var u=this.wallBottomNode;u.getComponent(m).width=p.getComponent(m).width,u.getComponent(m).height=p.getComponent(m).height,u.getComponent(d).size.width=p.getComponent(d).size.width,u.getComponent(d).size.height=p.getComponent(d).size.height,h=c(t.x,t.y-.5*r,0),u.setPosition(h);var f=this.wallLeftNode;f.getComponent(m).width=a,f.getComponent(m).height=r,f.getComponent(d).size.width=a,f.getComponent(d).size.height=r,h=c(t.x-.5*s+.5*a,t.y,0),f.setPosition(h);var w=this.wallRightNode;w.getComponent(m).width=f.getComponent(m).width,w.getComponent(m).height=f.getComponent(m).height,w.getComponent(d).size.width=f.getComponent(d).size.width,w.getComponent(d).size.height=f.getComponent(d).size.height,h=c(t.x+.5*s-.5*a,t.y,0),w.setPosition(h),this.refreshWallSideVal(),this.wallTopNode.getComponent(g).opacity=0,this.wallBottomNode.getComponent(g).opacity=0,this.wallLeftNode.getComponent(g).opacity=0,this.wallRightNode.getComponent(g).opacity=0,this.wallShineNode.active=!0,this.wallShineNode.position=c(t.x,t.y-15),this.wallShineNode.getComponent(m).width=.5*s+10,this.wallShineNode.getComponent(m).height=.5*r+10;var v=this.wallShineNode.getComponent(g);y.stopAllByTarget(v),l(v).to(.3,{opacity:255}).to(.3,{opacity:0}).union().repeat(3).call((function(){e.wallShineNode.active=!1,e.wallTopNode.getComponent(g).opacity=255,e.wallBottomNode.getComponent(g).opacity=255,e.wallLeftNode.getComponent(g).opacity=255,e.wallRightNode.getComponent(g).opacity=255})).start()},n.refreshWallSideVal=function(){this.wallTopVal=this.wallTopNode.position.y-20,this.wallBottomVal=this.wallBottomNode.position.y+30,this.wallLeftVal=this.wallLeftNode.position.x+20,this.wallRightVal=this.wallRightNode.position.x-20},n.hideWallLayer=function(){this.wallLayer.active=!1},n.fightPause=function(){if(this.pauseVal++,!(this.pauseVal>1)){var t=L.mapFightCamera,e=p.getVisibleSize().width,o=p.getVisibleSize().height,i=new u;i.reset({width:e,height:o}),f("Canvas/Camera").active=!1,t.targetTexture=i,w.root.frameMove(0),t.targetTexture=null,f("Canvas/Camera").active=!0;var a=new v;a.texture=i,L.mapLayer.fightCapNode.getComponent(C).spriteFrame=a,L.mapLayer.fightCapNode.active=!0,this.node.active=!1}},n.fightResume=function(){(this.pauseVal--,this.pauseVal>0)||(L.mapFightCamera.targetTexture=null,this.node.active=!0,L.mapLayer.fightCapNode.active=!1,L.player.stopMove())},n.updateLogic=function(t){if(!this.stopTimeCount)for(L.time+=t,this.expTimeCount+=t;this.expTimeCount>=1;)A.d("expTimeCount："+this.expTimeCount),this.expTimeCount--,L.expTypeRow&&(A.d("mapModel.expTypeRow--\x3etime:"+L.time+", startT:"+L.expTypeRow.startTime+", endT:"+L.expTypeRow.endTime),L.time>=L.expTypeRow.startTime&&L.time<=L.expTypeRow.endTime?(L.expPool+=L.expTypeRow.expSpeed,A.d("当前经验池---"+L.expPool)):L.expTypeRow=B.getRowById(P.tableName.expType,L.expTypeRow.id+1),this.setString(L.mapLayer.expNumNode,L.expPool));L.mapLayer.refreshTimeNode(),this.skillBombCd>0?this.skillBombCd-=t:this.skillBombCd=0,this.skillHealCd>0?this.skillHealCd-=t:this.skillHealCd=0,L.weaponSystem.updateLogic(t),L.monsterSystem.updateLogic(t),L.skillSystem.updateLogic(t),L.propSystem.updateLogic(t),L.bulletSystem.updateLogic(t)},n.updatePhysicsWorld=function(){S.step(L.mapFightLayer)},n.updateBoxHintLayer=function(t){var e=999999,o=null,i=L.player.node.position;if(L.propSystem.forAllPropById(P.propIds.box2,(function(t){var a=t.node,n=a.position,s=a.getComponent(m),l=.5*(s.width+s.height);if(!(Math.abs(n.x-i.x)<=L.visibleHalfSize.width+l&&Math.abs(n.y-i.y)<=L.visibleHalfSize.height+l)){var p=r.distance(n,i);p<e&&(e=p,o=t)}})),o){this.boxHintNode.active=!0;var a=o.node.getPosition().subtract(i),n=x.radianToAngle(Math.atan2(a.y,a.x));this.boxArrowNode.angle=n;var s=o.node.position,l=s.x-i.x,h=.5*p.getVisibleSize().width-80;l>h?l=h:l<-h&&(l=-h);var d=s.y-i.y,g=.5*p.getVisibleSize().height-80;d>g-320?d=g-320:d<-g&&(d=-g),this.boxHintNode.position=c(l,d)}else this.boxHintNode.active=!1},n.getSelectItemArr=function(){var t=[],e=!1;L.weaponSystem.weaponArr.length>=P.design.weaponNum&&(e=!0);for(var o=B.getLastRow(P.tableName.weapon),i=1;i<=o.type;i++){var a=L.weaponSystem.getWeaponInfoByType(i);if(a){if(B.getRowById(P.tableName.weapon,a.id).lv>=P.design.maxLv)continue}else if(e)continue;var n={};n.name=P.tableName.weapon,n.weight=1,n.type=i,n.info=a,t.push(n)}e=!1,L.skillSystem.skillArr.length>=P.design.skill1Num&&(e=!0),o=B.getLastRow(P.tableName.skill);for(var s=1;s<=o.type;s++){var r=L.skillSystem.getSkillInfoByType(s);if(r){var l=B.getRowById(P.tableName.skill,r.id);if(l.lv>=P.design.maxLv)continue;if(l.lv>=P.design.maxLv-1&&!L.skillSystem.canBreakthrough(l.type))continue}else if(e)continue;var p={};p.name=P.tableName.skill,p.weight=1,p.type=s,p.info=r,t.push(p)}e=!1,L.skillSystem.skill2Arr.length>=P.design.skill2Num&&(e=!0),o=B.getLastRow(P.tableName.skill2);for(var h=1;h<=o.type;h++){var m=L.skillSystem.getSkill2InfoByType(h);if(m){if(B.getRowById(P.tableName.skill2,m.id).lv>=P.design.maxLv)continue}else if(e)continue;var d={};d.name=P.tableName.skill2,d.weight=1,d.type=h,d.info=m,t.push(d)}for(t=x.getRowsByWeightAndNum(t,3);t.length<3;){var c={};c.name=P.tableName.prop,c.id=P.propIds.addHpPercent,t.push(c)}return t},n.refreshCamera=function(t){L.mapFightCamera.orthoHeight<=L.cameraOrthoHeight||L.mapFightCamera.orthoHeight--},n.update=function(t){this.updateBoxHintLayer(t)},n.lateUpdate=function(t){var e=L.player.node.getPosition(),o=this.mapFightBgLayer,i=o.getComponent(C).getMaterial(0),a=new r(e.x/1024,-e.y/1024);i.setProperty("tilingOffset",a),o.position=e},a}(M))||R);a._RF.pop()}}}));

System.register("chunks:///_virtual/MapWrap.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var s,e,i;return{setters:[function(t){s=t.createClass},function(t){e=t.cclegacy,i=t.js}],execute:function(){e._RF.push({},"4fbd1NgK1VKrJqal2BpBTty","MapWrap",void 0);t("MapWrap",function(){function t(t){if(this._objects=void 0,this._size=0,this._objects=i.createMap(!0),this._size=0,t)for(var s=0;s<t.length;s++)this.set(t[s][0],t[s][1])}var e=t.prototype;return e.clear=function(){this._objects=i.createMap(!0),this._size=0},e.has=function(t){return t in this._objects},e.set=function(t,s){this.has(t)||this._size++,this._objects[t]=s},e.get=function(t){return this.has(t)?this._objects[t]:null},e.delete=function(t){this.has(t)&&(delete this._objects[t],this._size--)},e.keys=function(){var t=Object.keys(this._objects);return t},e.values=function(){var t=this,s=this.keys(),e=[];return s.forEach((function(s){e.push(t.get(s))})),e},e.toArray=function(t){var s=this,e=[];return this.keys().forEach((function(i){e.push([t?parseInt(i):i,s.get(i)])})),e},e.forEach=function(t){for(var s=this.keys(),e=0;e<s.length;e++){var i=t(this._objects[s[e]],s[e]);if(i)return i}},e.rforEach=function(t){for(var s=this.keys(),e=s.length-1;e>=0;e--){var i=t(this._objects[s[e]],s[e]);if(i)return i}},s(t,[{key:"size",get:function(){return this._size},set:function(t){this._size=t}},{key:"objects",set:function(t){this._objects=t}}]),t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/md5.ts",["cc"],(function(r){"use strict";var n;return{setters:[function(r){n=r.cclegacy}],execute:function(){r("default",(function(r){function n(r){var n=(r>>>24).toString(16),t=(16777215&r).toString(16);return"00".substr(0,2-n.length)+n+"000000".substr(0,6-t.length)+t}function t(r,n,t){return r&n|~r&t}function e(r,n,t){return t&r|~t&n}function u(r,n,t){return r^n^t}function o(r,n,t){return n^(r|~t)}function c(r,n){return r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]}function f(r){for(var n=[],t=0;t<r.length;t++)if(r.charCodeAt(t)<=127)n.push(r.charCodeAt(t));else for(var e=encodeURIComponent(r.charAt(t)).substr(1).split("%"),u=0;u<e.length;u++)n.push(parseInt(e[u],16));return n}var i=null;if("string"==typeof r)i=f(r);else{if(r.constructor!=Array)return null;if(0===r.length)i=r;else if("string"==typeof r[0])i=function(r){for(var n=[],t=0;t<r.length;t++)n=n.concat(f(r[t]));return n}(r);else{if("number"!=typeof r[0])return null;i=r}}var s=i.length;i.push(128);var a=i.length%64;if(a>56){for(var l=0;l<64-a;l++)i.push(0);a=i.length%64}for(l=0;l<56-a;l++)i.push(0);i=i.concat(function(r){for(var n=[],t=0;t<8;t++)n.push(255&r),r>>>=8;return n}(8*s));var h=1732584193,v=4023233417,g=2562383102,p=271733878,b=0,d=0,y=0,m=0;function A(r,n){return 4294967295&r+n}var R=function(r,n,t,e){var u,o,c=m;m=y,y=d,d=A(d,(u=A(b,A(r,A(n,t))))<<(o=e)&4294967295|u>>>32-o),b=c};for(l=0;l<i.length/64;l++){b=h;var C=64*l;R(t(d=v,y=g,m=p),3614090360,c(i,C),7),R(t(d,y,m),3905402710,c(i,C+4),12),R(t(d,y,m),606105819,c(i,C+8),17),R(t(d,y,m),3250441966,c(i,C+12),22),R(t(d,y,m),4118548399,c(i,C+16),7),R(t(d,y,m),1200080426,c(i,C+20),12),R(t(d,y,m),2821735955,c(i,C+24),17),R(t(d,y,m),4249261313,c(i,C+28),22),R(t(d,y,m),1770035416,c(i,C+32),7),R(t(d,y,m),2336552879,c(i,C+36),12),R(t(d,y,m),4294925233,c(i,C+40),17),R(t(d,y,m),2304563134,c(i,C+44),22),R(t(d,y,m),1804603682,c(i,C+48),7),R(t(d,y,m),4254626195,c(i,C+52),12),R(t(d,y,m),2792965006,c(i,C+56),17),R(t(d,y,m),1236535329,c(i,C+60),22),R(e(d,y,m),4129170786,c(i,C+4),5),R(e(d,y,m),3225465664,c(i,C+24),9),R(e(d,y,m),643717713,c(i,C+44),14),R(e(d,y,m),3921069994,c(i,C),20),R(e(d,y,m),3593408605,c(i,C+20),5),R(e(d,y,m),38016083,c(i,C+40),9),R(e(d,y,m),3634488961,c(i,C+60),14),R(e(d,y,m),3889429448,c(i,C+16),20),R(e(d,y,m),568446438,c(i,C+36),5),R(e(d,y,m),3275163606,c(i,C+56),9),R(e(d,y,m),4107603335,c(i,C+12),14),R(e(d,y,m),1163531501,c(i,C+32),20),R(e(d,y,m),2850285829,c(i,C+52),5),R(e(d,y,m),4243563512,c(i,C+8),9),R(e(d,y,m),1735328473,c(i,C+28),14),R(e(d,y,m),2368359562,c(i,C+48),20),R(u(d,y,m),4294588738,c(i,C+20),4),R(u(d,y,m),2272392833,c(i,C+32),11),R(u(d,y,m),1839030562,c(i,C+44),16),R(u(d,y,m),4259657740,c(i,C+56),23),R(u(d,y,m),2763975236,c(i,C+4),4),R(u(d,y,m),1272893353,c(i,C+16),11),R(u(d,y,m),4139469664,c(i,C+28),16),R(u(d,y,m),3200236656,c(i,C+40),23),R(u(d,y,m),681279174,c(i,C+52),4),R(u(d,y,m),3936430074,c(i,C),11),R(u(d,y,m),3572445317,c(i,C+12),16),R(u(d,y,m),76029189,c(i,C+24),23),R(u(d,y,m),3654602809,c(i,C+36),4),R(u(d,y,m),3873151461,c(i,C+48),11),R(u(d,y,m),530742520,c(i,C+60),16),R(u(d,y,m),3299628645,c(i,C+8),23),R(o(d,y,m),4096336452,c(i,C),6),R(o(d,y,m),1126891415,c(i,C+28),10),R(o(d,y,m),2878612391,c(i,C+56),15),R(o(d,y,m),4237533241,c(i,C+20),21),R(o(d,y,m),1700485571,c(i,C+48),6),R(o(d,y,m),2399980690,c(i,C+12),10),R(o(d,y,m),4293915773,c(i,C+40),15),R(o(d,y,m),2240044497,c(i,C+4),21),R(o(d,y,m),1873313359,c(i,C+32),6),R(o(d,y,m),4264355552,c(i,C+60),10),R(o(d,y,m),2734768916,c(i,C+24),15),R(o(d,y,m),1309151649,c(i,C+52),21),R(o(d,y,m),4149444226,c(i,C+16),6),R(o(d,y,m),3174756917,c(i,C+44),10),R(o(d,y,m),718787259,c(i,C+8),15),R(o(d,y,m),3951481745,c(i,C+36),21),h=A(h,b),v=A(v,d),g=A(g,y),p=A(p,m)}return function(r,t,e,u){for(var o="",c=0,f=0,i=3;i>=0;i--)c=255&(f=arguments[i]),c<<=8,c|=255&(f>>>=8),c<<=8,c|=255&(f>>>=8),c<<=8,o+=n(c|=f>>>=8);return o}(p,g,v,h)})),n._RF.push({},"3249aWV0bVIlbczR66bh5KU","md5",void 0),n._RF.pop()}}}));

System.register("chunks:///_virtual/Monster.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./designManager.ts","./mapModel.ts","./physicsGroup.ts","./AnimationCtrl.ts","./ShineColor.ts"],(function(t){"use strict";var e,s,i,o,n,a,h,r,c,l,d,p,u,m,v,y,P,b,g,f,S,C,M;return{setters:[function(t){e=t.inheritsLoose},function(t){s=t.cclegacy,i=t._decorator,o=t.find,n=t.BoxCollider2D,a=t.ProgressBar,h=t.sp,r=t.v3,c=t.Tween,l=t.view,d=t.macro,p=t.Vec2,u=t.Vec3,m=t.PhysicsSystem2D,v=t.v2,y=t.Component},function(t){P=t.cocosUtil},function(t){b=t.constants},function(t){g=t.designManager},function(t){f=t.mapModel},function(t){S=t.physicsGroup},function(t){C=t.AnimationCtrl},function(t){M=t.ShineColor}],execute:function(){var k;s._RF.push({},"078f39vCbpFAImUpwpfNSnW","Monster",void 0);var O=i.ccclass;i.property,t("Monster",O("Monster")(k=function(t){function s(){for(var e,s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).id=void 0,e.hp=0,e.hpMax=void 0,e.atk=0,e.speed=0,e.speedCutPrecent=0,e.row=void 0,e.isBoss=0,e.isPauseMove=void 0,e.canFace=!0,e.distancePlayer=void 0,e.bodyNode=void 0,e.collider=void 0,e.hpProgress=void 0,e.isSpine=void 0,e.shineColor=void 0,e.animationCtrl=void 0,e.direction=void 0,e.touchPlayerTimeCount=0,e.targetDirection=void 0,e.vec3Obj={playerPos:r(0,0,0),nodePos:r(0,0,0),nodeScale:r(0,0,0),hpScale:r(0,0,0),bodyNodeScale:r(0,0,0),outVec3:r(0,0,0),vec3Temp:r(0,0,0)},e.raycastDis=0,e.sideRadian=0,e.waitHit=void 0,e.monsterUtil=void 0,e.tempMoveCount=0,e.hasNum=0,e.tempPos=void 0,e.isStop=!1,e}e(s,t);var i=s.prototype;return i.onLoad=function(){this.bodyNode=o("body",this.node),this.collider=this.node.getComponent(n);var t=o("hpProgress",this.node);t&&(this.hpProgress=t.getComponent(a)),this.bodyNode.getComponent(h.Skeleton)?this.isSpine=!0:this.isSpine=!1,this.shineColor=this.bodyNode.addComponent(M),this.animationCtrl=this.bodyNode.addComponent(C),this.vec3Obj.bodyNodeScale=this.bodyNode.getScale().clone()},i.onEnable=function(){},i.onDisable=function(){},i.onDestroy=function(){},i.setBodySkin=function(){var t=this.bodyNode.getComponent(h.Skeleton);if(t&&this.row.type==b.monsterTypes.boss){var e=1;3!=f.mapId&&4!=f.mapId||(e=2),t.setSkin("skin"+e)}},i.init=function(t){this.bodyNode||this.onLoad(),this.node.setScale(r(1,1,1)),this.unscheduleAllCallbacks(),c.stopAllByTarget(this.node),this.shineColor&&this.shineColor.removeShineColorMaterial(),this.tempMoveCount=0,this.hasNum=0,this.canFace=!0,this.isPauseMove=!1,this.distancePlayer=0,this.touchPlayerTimeCount=0,this.targetDirection=null,this.collider.enabled=!0,this.animationCtrl.playAnimation(b.animations.walk);var e=g.getRowById(b.tableName.monster,t);this.row=e,this.waitHit=!1,this.raycastDis=this.collider.size.width/2,this.sideRadian=Math.random()>.5?Math.PI/2:-Math.PI/2;var s=l.getVisibleSize(),i=P.getRectPos(f.player.node,s.width+100,s.height+100);if(this.node.position=i,this.id=t,this.atk=e.atk,this.hp=e.hp,this.speed=e.speed,this.speedCutPrecent=0,f.floor>0){var o=g.getRowById(b.tableName.towerFloor,f.floor),n=this.hp*(1+o.hp/100);this.hp=Math.ceil(n),this.atk=Math.ceil(this.atk*(1+o.atk/100))}if(e.type!=b.monsterTypes.boss){var a=g.getRowById(b.tableName.map,f.mapId),h=1;a&&a.atk>0&&(h=a.atk);var d=1;a&&a.hp>0&&(d=a.hp),this.atk=this.atk*h,this.hp=this.hp*d;for(var p=g.getTable(b.tableName.monsterTimeAdd),u=null,m=0;m<p.length;m++){var v=p[m];if(f.time<=v.time){u=v;break}}u||(u=g.getLastRow(b.tableName.monsterTimeAdd)),this.speed=Math.ceil(this.speed*u.speed),this.hp=Math.ceil(this.hp*u.hp),this.atk=Math.ceil(this.atk*u.atk)}this.hpMax=this.hp,this.isBoss=0,this.refreshHpLayer(),this.setBodySkin();try{var y="Monster"+t;switch(t){case 13:case 16:case 17:y="Monster13";break;case 12:case 18:y="Monster12";break;case 25:y="Monster4";break;case 26:y="Monster5";break;case 27:y="Monster6";break;case 28:y="Monster23";break;case 29:y="Monster22";break;case 30:y="Monster21"}var S=P.addComponentOnce(this,y);S.unscheduleAllCallbacks(),this.monsterUtil=S,S.init(this)}catch(t){}},i.getSaveData=function(){var t={};return t.id=this.id,t.hp=this.hp,t.atk=this.atk,t.pos=this.node.position,t.isBoss=this.isBoss,t},i.loadSaveData=function(t){this.hp=t.hp,this.atk=t.atk,this.node.position=t.pos,this.isBoss=t.isBoss,this.refreshHpLayer(),this.isBoss&&(f.monsterSystem.bossMonster=this,f.mapLayer.refreshBossHpLayer())},i.animationEndCallback=function(t){this.recycleSelf()},i.recycleSelf=function(){f.monsterSystem.recycleMonsterNode(this.node)},i.contactBeginPlayer=function(){this.touchPlayer(),this.unschedule(this.touchPlayer),this.schedule(this.touchPlayer,this.row.touchTime,d.REPEAT_FOREVER)},i.contactEndPlayer=function(){this.unschedule(this.touchPlayer)},i.touchPlayer=function(){this.touchPlayerTimeCount<this.row.touchTime||(this.touchPlayerTimeCount=0,f.player.hitWithDam(this.atk))},i.playerForceMove=function(t){var e=f.player.node.getPosition(),s=this.node.getPosition();e.subtract(s).negative(),p.angle(e,t)>.7*Math.PI||(e.normalize().multiplyScalar(t.length()),s.add(e),this.node.setPosition(s))},i.monsterForceMove=function(t,e){if(!this.isPauseMove){var s=t.node.getPosition(),i=this.node.getPosition();s.subtract(i).negative(),p.angle(s,e)>.7*Math.PI||(s.normalize().multiplyScalar(e.length()),i.add(s),this.node.setPosition(i))}},i.hitWithDam=function(t,e,s){var i=this;if(!(this.hp<=0||t<=0)){if(t+=f.player.atk,s&&s.speedCutPrecent&&s.speedCutDuration&&this.row.type==b.monsterTypes.common&&(this.unschedule(this.resetSpeedCutPrecent),this.speedCutPrecent=s.speedCutPrecent,this.scheduleOnce(this.resetSpeedCutPrecent,s.speedCutDuration)),this.bodyNode.scale=this.vec3Obj.bodyNodeScale,P.tweenHitScale(this.bodyNode,.05),this.shineColor&&this.row.type!=b.monsterTypes.boss){var o=b.materials.shineColor;this.isSpine&&(o=b.materials.shineColorSpine),this.shineColor.startShine(o,e)}this.hp-=t,this.hp<0&&(this.hp=0),this.refreshHpLayer(),this.isBoss&&f.mapLayer.bossSubHp(t),this.id==b.monsterIds.boxMonster&&f.propSystem.addProp(b.propIds.boxMonsterCoin,P.convertToWorldSpace(this.node)),this.hp<=0&&(f.mapSystem.monsterDead(this.id,P.convertToWorldSpace(this.node)),this.unschedule(this.touchPlayer),this.collider.enabled=!1,this.animationCtrl.playAnimation(b.animations.die,!1,(function(t){f.monsterSystem.monsterDead(i.id),i.animationEndCallback(t),i.monsterUtil&&i.monsterUtil.selfDead&&i.monsterUtil.selfDead()})),this.monsterUtil&&this.monsterUtil.unscheduleAllCallbacks());var n=null;t>=g.config.damColor2?n="#f56d0a":t>=g.config.damColor1&&(n="#e1b600"),f.numSystem.addNum(t,P.convertToWorldSpace(this.node),n)}},i.refreshHpLayer=function(){this.hpProgress&&(this.hpProgress.progress=this.hp/this.hpMax)},i.setDirection=function(t){this.direction=t.normalize()},i.getBulletDirection=function(){return this.node.getScale().x>0?r(-1,0,0):r(1,0,0)},i.getInfoPosition=function(t,e){var s=this.node.getPosition(),i=o("info",this.node);if(t>0&&(i=o("info"+t,this.node)),i){i.active=!1;var n=i.getPosition();this.node.scale.x<0&&(n.x=-n.x),s.x+=n.x,s.y+=n.y}return e&&(s=P.convertToWorldSpaceWithPos(this.node,s)),s},i.getMoveSpeed=function(){return this.speed*(1-this.speedCutPrecent)},i.resetSpeedCutPrecent=function(){this.speedCutPrecent=0},i.updateLogic=function(t){f.player.node.getPosition(this.vec3Obj.playerPos),this.node.getPosition(this.vec3Obj.nodePos);var e=null;e=this.monsterUtil&&this.monsterUtil.getDirection?this.monsterUtil.getDirection():this.vec3Obj.playerPos.subtract(this.vec3Obj.nodePos).normalize();for(var s=null,i=0;i<2;i++){var o=e;1==i&&(o=(o=u.rotateZ(this.vec3Obj.outVec3,e,u.ZERO,this.sideRadian)).normalize());var n=o.multiplyScalar(this.raycastDis);P.vec3CopyVal(this.vec3Obj.vec3Temp,this.vec3Obj.nodePos);var a=this.vec3Obj.vec3Temp.add(n);a=P.convertToWorldSpaceWithPos(this.node,a);for(var h=m.instance.testPoint(v(a.x,a.y)),r=!1,c=0;c<h.length;c++){var l=h[c];if(l!=this.collider&&l.node!=this.node&&l.group==S.MONSTER){r=!0,this.hasNum++,this.hasNum>10&&(r=!1,this.hasNum=0);break}}if(!r){s=o;break}}this.targetDirection=s,this.targetDirection&&(this.targetDirection=this.targetDirection.clone())},i.move=function(t){if(this.touchPlayerTimeCount+=t,!(this.hp<=0)){this.tempMoveCount++,this.tempMoveCount>=1e3?p.distance(this.node.getPosition(),this.tempPos)<=1&&(console.log("怪物停着没有动过！！！！"),this.isStop=!0):1==this.tempMoveCount&&(this.tempPos=this.node.getPosition()),f.player.node.getPosition(this.vec3Obj.playerPos),this.node.getPosition(this.vec3Obj.nodePos),this.distancePlayer=p.distance(this.vec3Obj.nodePos,this.vec3Obj.playerPos),f.player.hp>0&&this.canFace&&(this.node.getScale(this.vec3Obj.nodeScale),this.hpProgress&&this.hpProgress.node.getScale(this.vec3Obj.hpScale),this.vec3Obj.nodePos.x>=this.vec3Obj.playerPos.x?(this.vec3Obj.nodeScale.x=Math.abs(this.vec3Obj.nodeScale.x),this.hpProgress&&(this.vec3Obj.hpScale.x=1)):(this.vec3Obj.nodeScale.x=-Math.abs(this.vec3Obj.nodeScale.x),this.hpProgress&&(this.vec3Obj.hpScale.x=-1)),this.node.scale=this.vec3Obj.nodeScale,this.hpProgress&&(this.hpProgress.node.scale=this.vec3Obj.hpScale));var e=this.getMoveSpeed();if(!(e<=0||this.isPauseMove)&&(!this.monsterUtil||!this.monsterUtil.moveStop)&&!(this.monsterUtil&&this.monsterUtil.minDisPlayer>0&&this.distancePlayer<=this.monsterUtil.minDisPlayer)&&this.targetDirection){var s=e*t,i=this.targetDirection.normalize().multiplyScalar(s);this.direction=i,this.node.position=this.vec3Obj.nodePos.add(i),this.row.type==b.monsterTypes.boss&&f.mapSystem.adjustInWall(this.node)}}},s}(y))||k);s._RF.pop()}}}));

System.register("chunks:///_virtual/Monster12.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var o,n,e,s,i,r,c,l;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,s=t.v3,i=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){l=t.physicsGroup}],execute:function(){var u;n._RF.push({},"490d0bRnW5Pn43FXE128xBJ","Monster12",void 0);var a=e.ccclass;e.property,t("Monster12",a("Monster12")(u=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1012,o.outVec3=s(0,0,0),o}o(n,t);var e=n.prototype;return e.init=function(t){var o=this;this.monster=t,this.moveStop=!1,18==this.monster.id&&(this.bulletId=1016),this.scheduleOnce((function(){o.useSkill()}),1+4*Math.random())},e.startSkillLogic=function(){var t=this,o=3+2*Math.random();this.scheduleOnce((function(){t.useSkill()}),o)},e.useSkill=function(){if(!(this.monster.hp<=0)){var t=this.monster.getInfoPosition(),o=c.player.node.getPosition().subtract(t);t=r.convertToWorldSpaceWithPos(this.node,t),c.bulletSystem.addBullet(this.bulletId,l.MONSTER_BULLET,t,o),this.startSkillLogic()}},n}(i))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/Monster13.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var o,s,e,i,n,r,c,l;return{setters:[function(t){o=t.inheritsLoose},function(t){s=t.cclegacy,e=t._decorator,i=t.v3,n=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){l=t.physicsGroup}],execute:function(){var u;s._RF.push({},"a63cfrFt9BErbNZKvW8LFyP","Monster13",void 0);var a=e.ccclass;e.property,t("Monster13",a("Monster13")(u=function(t){function s(){for(var o,s=arguments.length,e=new Array(s),n=0;n<s;n++)e[n]=arguments[n];return(o=t.call.apply(t,[this].concat(e))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1013,o.outVec3=i(0,0,0),o}o(s,t);var e=s.prototype;return e.init=function(t){var o=this;this.monster=t,this.moveStop=!1,16==this.monster.id?this.bulletId=1014:17==this.monster.id&&(this.bulletId=1015),this.scheduleOnce((function(){o.useSkill()}),1+2*Math.random())},e.startSkillLogic=function(){var t=this,o=2+Math.random();this.scheduleOnce((function(){t.useSkill()}),o)},e.useSkill=function(){if(!(this.monster.hp<=0)){var t=this.monster.getInfoPosition(),o=c.player.node.getPosition().subtract(t);t=r.convertToWorldSpaceWithPos(this.node,t),c.bulletSystem.addBullet(this.bulletId,l.MONSTER_BULLET,t,o),this.startSkillLogic()}},s}(n))||u);s._RF.pop()}}}));

System.register("chunks:///_virtual/Monster21.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){"use strict";var o,e,i,n,s,r,l,a,c,h,d,u;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,n=t.find,s=t.BoxCollider2D,r=t.tween,l=t.Component},function(t){a=t.cocosUtil},function(t){c=t.utilTools},function(t){h=t.mapModel},function(t){d=t.physicsGroup},function(t){u=t.HintNames}],execute:function(){var m;e._RF.push({},"a9b34fAHwBDCLZD4fzme57X","Monster21",void 0);var p=i.ccclass;i.property,t("Monster21",p("Monster21")(m=function(t){function e(){for(var o,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(o=t.call.apply(t,[this].concat(i))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1017,o.otherCollider1=void 0,o.otherCollider2=void 0,o.otherCollider3=void 0,o}o(e,t);var i=e.prototype;return i.init=function(t){this.monster=t,this.moveStop=!1,this.otherCollider1=n("collider1",this.node).getComponent(s),this.otherCollider2=n("collider2",this.node).getComponent(s),this.otherCollider3=n("collider3",this.node).getComponent(s),this.resetColliders(),this.startSkillLogic()},i.resetColliders=function(){this.otherCollider1.enabled=!1,this.otherCollider2.enabled=!1,this.otherCollider3.enabled=!1},i.startSkillLogic=function(){var t=this;this.scheduleOnce((function(){var o=[{id:2,weight:10},{id:3,weight:10}],e=t.getSkill1Tag();e>0&&o.push({id:1,weight:100,tag:e});var i=c.getRowByWeight(o);i?t["useSkill"+i.id](i):t.startSkillLogic()}),1.5+Math.random())},i.getSkill1Tag=function(){if(this.monster.distancePlayer>=560)return 0;var t=h.player.node.position.clone().subtract(this.node.position),o=a.vec2XAngle(t);return o>=345||o<=15||o>=165&&o<=195?1:o>=30&&o<=60||o>=120&&o<=150?2:o>=300&&o<=330||o>=210&&o<=240?3:0},i.useSkill1=function(t){var o=this;if(!(this.monster.hp<=0)){this.moveStop=!0,this.monster.canFace=!1;var e=this["otherCollider"+t.tag];e.enabled=!0,this.monster.animationCtrl.playAnimationOnce("attackHand"+t.tag,(function(){e.enabled=!1,o.monster.canFace=!0,o.moveStop=!1,o.startSkillLogic()}))}},i.useSkill2=function(){var t=this;if(!(this.monster.hp<=0)){var o=500+100*Math.random(),e={duration:1};e.monster=this.monster,e.dis=o,h.hintSystem.addHint(u.blockArrow,a.convertToWorldSpace(this.node),0,e),this.scheduleOnce((function(){t.moveStop=!0,t.monster.canFace=!1;var e=h.player.node.position.clone();e.subtract(t.node.position).normalize().multiplyScalar(o);var i=t.node.position.clone().add(e);r(t.node).to(1,{position:i},{easing:"smooth",onUpdate:function(){h.mapSystem.adjustInWall(t.node)}}).start(),t.monster.animationCtrl.playAnimationOnce("attack2",(function(){t.monster.canFace=!0,t.moveStop=!1,t.startSkillLogic()}))}),1)}},i.useSkill3=function(){var t=this;if(!(this.monster.hp<=0)){this.moveStop=!0,this.monster.canFace=!1;var o=this.monster.getBulletDirection();this.scheduleOnce((function(){for(var e=function(e){t.scheduleOnce((function(){var i=t.monster.getInfoPosition(e,!0);h.bulletSystem.addBullet(t.bulletId,d.MONSTER_BULLET,i,o)}),.2*e)},i=0;i<4;i++)e(i)}),.45),this.monster.animationCtrl.playAnimationOnce("attack3",(function(){t.moveStop=!1,t.monster.canFace=!0,t.startSkillLogic()}))}},e}(l))||m);e._RF.pop()}}}));

System.register("chunks:///_virtual/Monster22.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var o,e,i,n,l,s,r,c;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,n=t.Component},function(t){l=t.cocosUtil},function(t){s=t.utilTools},function(t){r=t.mapModel},function(t){c=t.physicsGroup}],execute:function(){var u;e._RF.push({},"04153lCIxRPN58SJlMutwJu","Monster22",void 0);var a=i.ccclass;i.property,t("Monster22",a("Monster22")(u=function(t){function e(){for(var o,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(o=t.call.apply(t,[this].concat(i))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1018,o.bulletId2=1019,o.bulletId3=1020,o}o(e,t);var i=e.prototype;return i.init=function(t){this.monster=t,this.moveStop=!1,this.startSkillLogic()},i.startSkillLogic=function(){var t=this;this.scheduleOnce((function(){var o=s.getRowByWeight([{id:1,weight:10},{id:2,weight:10}]);o?t["useSkill"+o.id]():t.startSkillLogic()}),1.5+Math.random())},i.useSkill1=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.canFace=!1,this.monster.animationCtrl.playAnimationOnce("attack1",(function(){t.monster.canFace=!0,t.moveStop=!1,t.startSkillLogic()})),this.scheduleOnce((function(){r.bulletSystem.addBullet(t.bulletId,c.MONSTER_BULLET,l.convertToWorldSpace(t.node))}),.5))},i.useSkill2=function(){var t=this;if(!(this.monster.hp<=0)){var o=l.getCircleDirectionArr(8);s.forArr(o,(function(o){r.bulletSystem.addBullet(t.bulletId2,c.MONSTER_BULLET,l.convertToWorldSpace(t.node),o,t.bulletId3)})),this.startSkillLogic()}},i.selfDead=function(){r.bulletSystem.addBullet(this.bulletId3,c.MONSTER_BULLET,l.convertToWorldSpace(this.node),null,2)},e}(n))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/Monster23.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./Hint.ts"],(function(t){"use strict";var o,i,e,n,s,l,r,c,a;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,e=t._decorator,n=t.BoxCollider2D,s=t.Component},function(t){l=t.cocosUtil},function(t){r=t.utilTools},function(t){c=t.mapModel},function(t){a=t.HintNames}],execute:function(){var h;i._RF.push({},"5cf27RV66tLlKtXXvh9WZ1E","Monster23",void 0);var d=e.ccclass;e.property,t("Monster23",d("Monster23")(h=function(t){function i(){for(var o,i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return(o=t.call.apply(t,[this].concat(e))||this).monster=void 0,o.moveStop=void 0,o.otherCollider=void 0,o.isFollow=void 0,o.monsterId=14,o}o(i,t);var e=i.prototype;return e.init=function(t){this.monster=t,this.moveStop=!1,this.isFollow=!1,this.otherCollider=this.getComponents(n)[1],this.resetCollider(),this.startSkillLogic()},e.resetCollider=function(){this.otherCollider.enabled=!1},e.startSkillLogic=function(){var t=this;this.scheduleOnce((function(){var o=r.getRowByWeight([{id:1,weight:10},{id:2,weight:10}]);o?t["useSkill"+o.id]():t.startSkillLogic()}),1.5+Math.random())},e.useSkill1=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.canFace=!1,this.isFollow=!0,this.monster.collider.enabled=!1,this.scheduleOnce((function(){t.isFollow=!1}),1),this.scheduleOnce((function(){t.otherCollider.enabled=!0,t.monster.collider.enabled=!0}),1.5),this.monster.animationCtrl.playAnimationOnce("attack1",(function(){t.monster.canFace=!0,t.moveStop=!1,t.resetCollider(),t.startSkillLogic()})))},e.useSkill2=function(){var t=this;if(!(this.monster.hp<=0)){for(var o=0;o<3;o++)this.scheduleOnce((function(){var o=l.getAroundPos(t.node,150+50*Math.random(),300);c.mapSystem.adjustInWall(o,160);var i=l.convertToWorldSpaceWithPos(t.node,o),e={};e.monsterId=t.monsterId,c.hintSystem.addHint(a.targetPos3,i,0,e)}),.6*o);this.startSkillLogic()}},e.update=function(t){this.isFollow&&(this.node.position=c.player.node.getPosition())},i}(s))||h);i._RF.pop()}}}));

System.register("chunks:///_virtual/Monster3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var o,e,n,s,i,r,c,l;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,s=t.v3,i=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){l=t.physicsGroup}],execute:function(){var u;e._RF.push({},"44611e5u/BGl7Id3LZROzRs","Monster3",void 0);var a=n.ccclass;n.property,t("Monster3",a("Monster3")(u=function(t){function e(){for(var o,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(o=t.call.apply(t,[this].concat(n))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1001,o.outVec3=s(0,0,0),o}o(e,t);var n=e.prototype;return n.init=function(t){var o=this;this.monster=t,this.moveStop=!1,this.scheduleOnce((function(){o.useSkill()}),1+5*Math.random())},n.startSkillLogic=function(){var t=this,o=4+2*Math.random();this.scheduleOnce((function(){t.useSkill()}),o)},n.useSkill=function(){if(!(this.monster.hp<=0)){var t=this.monster.getInfoPosition(),o=c.player.node.getPosition().subtract(t);t=r.convertToWorldSpaceWithPos(this.node,t),c.bulletSystem.addBullet(this.bulletId,l.MONSTER_BULLET,t,o),this.startSkillLogic()}},e}(i))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/Monster4.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var e,o,n,i,l,s,r,u,c;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,i=t.Vec3,l=t.v3,s=t.Component},function(t){r=t.utilTools},function(t){u=t.mapModel},function(t){c=t.physicsGroup}],execute:function(){var a;o._RF.push({},"5e9e085vcxPeYkzY2qlwIgU","Monster4",void 0);var h=n.ccclass;n.property,t("Monster4",h("Monster4")(a=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).monster=void 0,e.moveStop=void 0,e.bulletId1=1002,e.bulletId2=1003,e.minDisPlayer=300,e.outVec3=l(0,0,0),e}e(o,t);var n=o.prototype;return n.init=function(t){this.monster=t,this.moveStop=!1,this.startSkillLogic()},n.startSkillLogic=function(){var t=this;this.scheduleOnce((function(){var e=Math.random();e<.4?t.useSkill1():e<.7?t.useSkill1(3):t.useSkill2()}),2)},n.useSkill2=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.animationCtrl.playAnimationOnce("attack",(function(){t.startSkillLogic(),t.moveStop=!1})),this.scheduleOnce((function(){var e=t.monster.getInfoPosition(0,!0),o=t.monster.getBulletDirection();u.bulletSystem.addBullet(t.bulletId2,c.MONSTER_BULLET,e,o)}),.5))},n.useSkill1=function(t){var e=this;void 0===t&&(t=1),this.monster.hp<=0||(this.monster.animationCtrl.playAnimationOnce("attack",(function(){e.startSkillLogic()})),this.scheduleOnce((function(){var o=e.monster.getInfoPosition(0,!0),n=e.monster.getBulletDirection();if(u.bulletSystem.addBullet(e.bulletId1,c.MONSTER_BULLET,o,n),3==t){var l=r.angleToRadian(50),s=i.rotateZ(e.outVec3,n,i.ZERO,l);u.bulletSystem.addBullet(e.bulletId1,c.MONSTER_BULLET,o,s);var a=i.rotateZ(e.outVec3,n,i.ZERO,-l);u.bulletSystem.addBullet(e.bulletId1,c.MONSTER_BULLET,o,a)}}),.5))},o}(s))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/Monster5.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var o,e,i,n,r,s,l,a,c,h,d;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,n=t.BoxCollider2D,r=t.tween,s=t.Component},function(t){l=t.cocosUtil},function(t){a=t.utilTools},function(t){c=t.constants},function(t){h=t.mapModel},function(t){d=t.physicsGroup}],execute:function(){var u;e._RF.push({},"90aa12+8vBIH4eHQiBCHUgL","Monster5",void 0);var m=i.ccclass;i.property,t("Monster5",m("Monster5")(u=function(t){function e(){for(var o,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(o=t.call.apply(t,[this].concat(i))||this).monster=void 0,o.moveStop=void 0,o.otherCollider1=void 0,o.otherCollider2=void 0,o.bulletId=1004,o.otherColliderOffset=void 0,o.otherColliderSize=void 0,o}o(e,t);var i=e.prototype;return i.init=function(t){this.monster=t,this.moveStop=!1,this.otherCollider1=t.getComponents(n)[1],this.otherCollider2=t.getComponents(n)[2],this.resetOtherCollider(),this.startSkillLogic()},i.resetOtherCollider=function(){this.otherCollider1.enabled=!0,this.otherCollider2.enabled=!1},i.startSkillLogic=function(){var t=this,o=2+2*Math.random();this.scheduleOnce((function(){t.monster.hp<=0||(Math.random()<.6?t.attackWithSkill1():t.attackWithSkill2())}),o)},i.attackWithSkill1=function(){var t=this;this.otherCollider1.enabled=!1,this.otherCollider2.enabled=!0,this.monster.animationCtrl.playAnimation("attack1",!0);var o=this.monster.speed;this.monster.speed+=2*o,this.scheduleOnce((function(){t.resetOtherCollider(),t.monster.animationCtrl.playAnimation(c.animations.walk,!0),t.monster.speed=o,t.startSkillLogic()}),3)},i.attackWithSkill2=function(){var t=this;this.monster.animationCtrl.playAnimationOnce("attack2",(function(){t.startSkillLogic()}));var o=this.monster.node.getPosition(),e=h.player.node.getPosition().subtract(o).normalize();e.multiplyScalar(200),o.add(e),r(this.monster.node).to(.5,{position:o},{easing:"quadOut"}).start(),this.scheduleOnce((function(){var o=t.monster.getInfoPosition(),e=l.getCircleDirectionArr(10);o=l.convertToWorldSpaceWithPos(t.monster.node,o),a.forArr(e,(function(e){h.bulletSystem.addBullet(t.bulletId,d.MONSTER_BULLET,o,e)}))}),.5)},e}(s))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/Monster6.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var o,i,e,n,s,l,r,a,c,u,h;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,e=t._decorator,n=t.BoxCollider2D,s=t.macro,l=t.v3,r=t.Component},function(t){a=t.cocosUtil},function(t){c=t.utilTools},function(t){u=t.mapModel},function(t){h=t.physicsGroup}],execute:function(){var m;i._RF.push({},"d1277cfcSVMebPwJHxH+Lod","Monster6",void 0);var d=e.ccclass;e.property,t("Monster6",d("Monster6")(m=function(t){function i(){for(var o,i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return(o=t.call.apply(t,[this].concat(e))||this).monster=void 0,o.moveStop=void 0,o.bulletId1=1006,o.bulletId2=1007,o.bulletId3=1009,o.numCount=0,o.otherCollider1=void 0,o.outVec3=l(0,0,0),o}o(i,t);var e=i.prototype;return e.init=function(t){this.monster=t,this.moveStop=!1,this.otherCollider1=t.getComponents(n)[1],this.otherCollider1.enabled=!1,this.startSkillLogic()},e.getDirection=function(){var t=this.monster.node.getPosition(),o=u.player.node.getPosition();return t.x<o.x?o.x-=150:o.x+=150,o.subtract(t).normalize(),o},e.startSkillLogic=function(){var t=this,o=1+Math.random();this.scheduleOnce((function(){var o=[{id:3,weight:10},{id:4,weight:20}];t.monster.distancePlayer<=260&&o.push({id:1,weight:20}),t.monster.distancePlayer<=460&&o.push({id:2,weight:10});var i=c.getRowByWeight(o);t["useSkill"+i.id]()}),o)},e.useSkill4=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.animationCtrl.playAnimation("attack4",!0),this.numCount=0,this.schedule((function(){t.numCount++;for(var o=t.monster.getInfoPosition(3,!0),i=a.getCircleDirectionArr(6,150),e=0;e<1;e++){var n=Math.floor(Math.random()*i.length),s=u.player.node.getPosition().add(i[n]);i.splice(n,1),u.bulletSystem.addBullet(t.bulletId3,h.MONSTER_BULLET,o,null,s)}t.numCount>=3&&(t.moveStop=!1,t.monster.animationCtrl.playAnimation("walk",!0),t.unscheduleAllCallbacks(),t.startSkillLogic())}),2,s.REPEAT_FOREVER,0))},e.useSkill3=function(){var t=this;if(!(this.monster.hp<=0)){this.moveStop=!0,this.monster.animationCtrl.playAnimationOnce("attack3",(function(){t.moveStop=!1,t.startSkillLogic()}));var o=this.monster.getInfoPosition(2,!0);u.bulletSystem.addBullet(this.bulletId2,h.MONSTER_BULLET,o,null)}},e.useSkill2=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.canFace=!1,this.monster.animationCtrl.playAnimationOnce("attack2",(function(){t.moveStop=!1,t.monster.canFace=!0,t.startSkillLogic()})),this.scheduleOnce((function(){var o=t.monster.getInfoPosition(0,!0);u.bulletSystem.addBullet(t.bulletId1,h.MONSTER_BULLET,o)}),1))},e.useSkill1=function(){var t=this;this.monster.hp<=0||(this.moveStop=!0,this.monster.animationCtrl.playAnimationOnce("attack1",(function(){t.moveStop=!1,t.otherCollider1.enabled=!1,t.startSkillLogic()})),this.scheduleOnce((function(){t.otherCollider1.enabled=!0}),.05))},i}(r))||m);i._RF.pop()}}}));

System.register("chunks:///_virtual/Monster9.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var o,e,n,s,i,r,c,l;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,s=t.v3,i=t.Component},function(t){r=t.cocosUtil},function(t){c=t.mapModel},function(t){l=t.physicsGroup}],execute:function(){var u;e._RF.push({},"b228bANq/1HwZcJHQi6DMzs","Monster9",void 0);var a=n.ccclass;n.property,t("Monster9",a("Monster9")(u=function(t){function e(){for(var o,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(o=t.call.apply(t,[this].concat(n))||this).monster=void 0,o.moveStop=void 0,o.bulletId=1011,o.outVec3=s(0,0,0),o}o(e,t);var n=e.prototype;return n.init=function(t){var o=this;this.monster=t,this.moveStop=!1,this.scheduleOnce((function(){o.useSkill()}),1+3*Math.random())},n.startSkillLogic=function(){var t=this,o=3+1*Math.random();this.scheduleOnce((function(){t.useSkill()}),o)},n.useSkill=function(){if(!(this.monster.hp<=0)){var t=this.monster.getInfoPosition(),o=c.player.node.getPosition().subtract(t);t=r.convertToWorldSpaceWithPos(this.node,t),c.bulletSystem.addBullet(this.bulletId,l.MONSTER_BULLET,t,o),this.startSkillLogic()}},e}(i))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./BaseLayer.ts","./NodePoolUtil.ts","./Monster.ts"],(function(e){"use strict";var t,o,r,n,s,i,a,c,m,u,f,l,d,h,p,y,v;return{setters:[function(e){t=e.inheritsLoose,o=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){n=e.cclegacy,s=e._decorator,i=e.macro,a=e.Node,c=e.UITransform},function(e){m=e.cocosUtil},function(e){u=e.utilTools},function(e){f=e.constants},function(e){l=e.designManager},function(e){d=e.mapModel},function(e){h=e.playerModel},function(e){p=e.BaseLayer},function(e){y=e.NodePoolUtil},function(e){v=e.Monster}],execute:function(){var M;n._RF.push({},"91a8cbgectOgIg5lZnN8xP/","MonsterSystem",void 0);var b=s.ccclass;s.property,e("MonsterSystem",b("MonsterSystem")(M=function(e){function n(){for(var t,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this).idMonsterLayerObj={},t.monsterCreateArr=[],t.bossMonster=void 0,t.bossCreateInfo=void 0,t.monsterNum=0,t.showMonsterNum=0,t.aliveMonsterNum=0,t}t(n,e);var s=n.prototype;return s.onLoad=function(){e.prototype.onLoad.call(this),this.schedule(this.refreshMonsterShow,.5,i.REPEAT_FOREVER),this.schedule(this.createMonsterLogic,.1,i.REPEAT_FOREVER)},s.onEnable=function(){e.prototype.onEnable.call(this)},s.getSaveData=function(){var e={arr:[]};return e.bossCreateInfo=this.bossCreateInfo,this.forAliveMonster((function(t){var o=t.getSaveData();e.arr.push(o)})),e},s.loadSaveData=function(e){var t=this;u.forArr(e.arr,(function(e){t.createMonster(e.id).loadSaveData(e)})),this.bossCreateInfo=e.bossCreateInfo,this.bossCreateInfo&&this.createMonsterWithInfo(this.bossCreateInfo.id,this.bossCreateInfo.isBoss,this.bossCreateInfo.warn)},s.refreshMonsterShow=function(e){var t=1,o=3,r=1,n=0,s=0,i=[];this.forAliveMonster((function(e,a){s++;var c=l.getRowById(f.tableName.monster,e.id);e.distancePlayer<d.dataRadius||!c.isData?(n++,!a.active&&o>0&&(a.active=!0,o--)):e.distancePlayer<d.destroyRadius?a.active&&r>0&&(r--,a.active=!1):c.type==f.monsterTypes.common&&t>0&&(t--,i.push(a))})),u.forArr(i,(function(e){e.getComponent(v).recycleSelf(),s--})),this.setString(d.mapLayer.showNumNode,n),this.showMonsterNum=n,this.aliveMonsterNum=s},s.updateMapLevel=function(e){var t=this,o=[];u.forArr(d.mapLevelArr,(function(r){if(r.row.maxNum>0&&r.createCount>=r.row.maxNum)o.push(r.id);else if(r.row.endTime>0&&d.time>r.row.endTime+.5)o.push(r.id);else if(r.row.warn&&!r.hasWarn&&d.time>=r.row.startTime&&!r.row.isBoss&&(r.hasWarn=!0,d.mapSystem.startWarning(r.row.warn)),!(d.time<r.row.startTime)){r.timeCount+=e;var n=u.getFloatValue(r.row.createNum[0],r.row.createNum[1],!0);if(r.timeCount>=r.row.createTime||0==r.createCount){0!=r.createCount&&(r.timeCount-=r.row.createTime),r.timeCount<0&&console.log("stop...");for(var s=0;s<n;s++){if(r.createCount++,r.row.isBoss)return t.createMonsterWithInfo(r.row.monsterId,r.row.isBoss,r.row.warn),!0;t.monsterCreateArr.push({monsterId:r.row.monsterId,isBoss:r.row.isBoss})}if(h.isRecordAd&&d.mapLayer.monsterAddFlag>0)for(var i=0;i<d.mapLayer.monsterAddFlag;i++)t.monsterCreateArr.push({monsterId:r.row.monsterId,isBoss:r.row.isBoss})}}}));var r=[];u.forArr(d.mapLevelArr,(function(e){-1==o.indexOf(e.id)&&r.push(e)})),d.mapLevelArr=r},s.createMonsterLogic=function(e){if(h.isRecordAd||!(this.showMonsterNum>=200))for(var t=Math.ceil(this.monsterCreateArr.length/10),o=0;o<t;o++){var r=this.monsterCreateArr.shift();if(!r)return;this.createMonsterWithInfo(r.monsterId,r.isBoss)}},s.getMonsterLayerNameById=function(e){return"monsterLayer"+e},s.getMonsterLayerById=function(e){var t=this.idMonsterLayerObj[e];if(!t){(t=new a(this.getMonsterLayerNameById(e))).addComponent(c),t.setPosition(0,0),t.parent=this.node,this.idMonsterLayerObj[e]=t;var o=l.getRowById(f.tableName.monster,e);t.addComponent(y).init(d.monsterPrefabObj[o.prefab])}return t},s.createMonster=function(e,t){try{var o=this.getMonsterLayerById(e).getComponent(y).getNode(),r=m.addComponentOnce(o,v);return r.init(e),t&&(r.node.position=m.convertToNodeSpace(r.node,t)),this.monsterNum++,this.setString(d.mapLayer.monsterNumNode,this.monsterNum),r}catch(e){console.error(e)}},s.createMonsterWithInfo=function(){var e=o(r().mark((function e(t,o,n){var s,i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=12;break}if(d.mapSystem.stopTimeCount=!0,d.mapLevelArr.length>0&&(d.mapLevelArr_Backup=[],d.mapLevelArr_Backup=u.copyObj(d.mapLevelArr)),d.mapLevelArr=[],this.monsterCreateArr=[],this.bossCreateInfo={id:t,isBoss:o,warn:n},!(this.getMonsterNumByType(f.monsterTypes.elite)>0)){e.next=8;break}return e.abrupt("return");case 8:return d.mapSystem.startWarning(n),e.next=11,m.waitTimeAsync(this,2);case 11:this.bossCreateInfo=void 0;case 12:return s=this.createMonster(t),o&&(s.isBoss=o,(i=d.player.node.getPosition()).y+=400,s.node.position=i,s.monsterUtil.moveStop=!0,s.canFace=!1,s.node.parent.active=!1,s.collider.enabled=!1,this.scheduleOnce((function(){s.node.parent.active=!0,m.tweenScaleIn(s.node,.5,(function(){s.monsterUtil.moveStop=!1,s.canFace=!0,s.collider.enabled=!0}))}),.8),d.mapSystem.bossPosHintAnimationCtrl.node.active=!0,d.mapSystem.bossPosHintAnimationCtrl.node.position=i,d.mapSystem.bossPosHintAnimationCtrl.playAnimation("aa",!1,(function(){d.mapSystem.bossPosHintAnimationCtrl.node.active=!1})),a=[],this.forAliveMonster((function(e){if(e.row.type==f.monsterTypes.common){e.waitHit=!0;var t={};t.monster=e,a.push(t)}})),this.batchHitMonster(a,a.length),d.bulletSystem.forVisibleMonsterBullet((function(e){e.recycleSelf()})),d.mapSystem.showWallLayer(),this.bossMonster=s,d.mapLayer.refreshBossHpLayer()),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this)})));return function(t,o,r){return e.apply(this,arguments)}}(),s.getMonsterNumByType=function(e){void 0===e&&(e=0);var t=0;return this.forAliveMonster((function(o){e?o.row.type==e&&t++:t++})),t},s.monsterDead=function(e){var t=l.getRowById(f.tableName.monster,e);t.type==f.monsterTypes.boss&&d.mapSystem.bossDead(),e==f.monsterIds.boxMonster&&d.mapLayer.popLayer(f.layers.BoxMonsterLayer),t.type==f.monsterTypes.elite&&this.bossCreateInfo&&this.createMonsterWithInfo(this.bossCreateInfo.id,this.bossCreateInfo.isBoss,this.bossCreateInfo.warn)},s.batchHitMonster=function(e,t){var o=this;void 0===t&&(t=2);!function r(){for(var n=0;n<t;n++){var s=e.shift();if(!s)return;var i=s.monster;if(i.waitHit){var a=i.hp;s.dam&&(a=s.dam),i.hitWithDam(a),i.waitHit=!1}}o.scheduleOnce((function(){r()}))}()},s.recycleMonsterNode=function(e){var t=e.getComponent(v);t.hp=0;var o=t.id;this.getMonsterLayerById(o).getComponent(y).recycleNode(e)},s.forVisibleMonster=function(e){u.forArr(this.node.children,(function(t){u.forArr(t.children,(function(t){if(t.active&&d.isInScreenVisible(t)){var o=t.getComponent(v);o.hp<=0||e(o)}}))}))},s.forAliveMonster=function(e){u.forArr(this.node.children,(function(t){u.forArr(t.children,(function(t){var o=t.getComponent(v);o.hp<=0||e(o,t)}))}))},s.updateLogic=function(e){this.updateMapLevel(e),this.forAliveMonster((function(t){t.updateLogic(e)}))},s.update=function(e){this.forAliveMonster((function(t){t.move(e)}))},n}(p))||M);n._RF.pop()}}}));

System.register("chunks:///_virtual/MoreGameLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./msgac.ts","./audioManager.ts","./serverMsg.ts","./BaseUILayer.ts"],(function(e){"use strict";var t,o,n,i,r,a,s,c,u,l,f,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,s=e.Node},function(e){c=e.tyqSDK},function(e){u=e.msgac},function(e){l=e.audioManager},function(e){f=e.serverMsg},function(e){p=e.BaseUILayer}],execute:function(){var y,d,h,m,b,g,v,C,I;r._RF.push({},"388bfp8gIJJB4UpVIPXh61e","MoreGameLayer",void 0);var L=a.ccclass,M=a.property;e("MoreGameLayer",(y=L("MoreGameLayer"),d=M({type:s}),h=M({type:s}),m=M({type:s}),y((v=t((g=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"btnClose",v,i(t)),n(t,"audioIconOpen",C,i(t)),n(t,"audioIconClose",I,i(t)),t}o(t,e);var r=t.prototype;return r.onLoad=function(){this.node.getChildByName("icon").localizeImg()},r.onEnable=function(){},r.onDisable=function(){e.prototype.onDisable.call(this),this.refreshAudioLayer()},r.onDestroy=function(){e.prototype.onDestroy.call(this),c.hideCustomRectCenterAd()},r.start=function(){var e=this;c.showCustomRectCenterAd((function(){e.closeBless()}))},r.closeBless=function(){this.closeLayer()},r.refreshAudioLayer=function(){l.musicVolume>0?(this.audioIconOpen.active=!0,this.audioIconClose.active=!1):(this.audioIconOpen.active=!1,this.audioIconClose.active=!0)},r.onClickBtnHome=function(){c.hideCustomRectCenterAd(),f.send(u.mapLeave)},r.onClickBtnAudio=function(){l.musicVolume>0?(l.setMusicVolume(0),l.setEffectVolume(0)):(l.setMusicVolume(1),l.setEffectVolume(1)),this.refreshAudioLayer()},t}(p)).prototype,"btnClose",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(g.prototype,"audioIconOpen",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(g.prototype,"audioIconClose",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=g))||b));r._RF.pop()}}}));

System.register("chunks:///_virtual/MotionStreakAssemblerUtil.ts",["cc","./cocosUtil.ts","./MotionStreakUtil.ts"],(function(t){"use strict";var e,r,a,n,i,o;return{setters:[function(t){e=t.cclegacy,r=t.Vec2,a=t.v3,n=t.Color},function(t){i=t.cocosUtil},function(t){o=t.MotionStreakUtil}],execute:function(){e._RF.push({},"56d1c1YouZLQJ6kjxlzyHMV","MotionStreakAssemblerUtil",void 0);new r;var s,u=new r,c=new r;function f(t,e){return t.x=-e.y,t.y=e.x,t}var l=t("MotionStreakAssemblerUtil",{createData:function(t){var e=t.requestRenderData();return e.dataLength=4,e.resize(16,42),e},tmpVec3:a(0,0,0),update:function(t,e){var a,n=t.stroke/2,s=t.node,l=s.getPosition().x,d=s.getPosition().y,v=t.points;if(v.length>1){var x=v[0],p=x.point.x-l,y=x.point.y-d;p*p+y*y<t.minSeg&&(a=x)}a||(a=new o.Point,v.unshift(a)),a.setPoint(l,d),a.time=t.fadeTime+e;var h,m=0;if(!(v.length<2)){var D=t.renderData;this.updateRenderDataCache(t,D);var g=t.color,k=g.r,b=g.g,S=g.b,A=g.a,V=v[1];V.distance=r.subtract(c,a.point,V.point).length(),c.normalize(),V.setDir(c.x,c.y),a.setDir(c.x,c.y),D.dataLength=2*v.length;for(var M=D.data,U=t.fadeTime,C=!1,P=v.length-1;P>=0;P--){var R=v[P],z=R.point,w=R.dir;if(R.time-=e,R.time<0)v.splice(P,1);else{var T=R.time/U,W=v[P-1];if(!C){if(!W){v.splice(P,1);continue}z.x=W.point.x-w.x*T,z.y=W.point.y-w.y*T}C=!0,f(u,w);var _=(T*A<<24>>>0)+(S<<16)+(b<<8)+k,B=m,O=z.x+u.x*n,L=z.y+u.y*n;this.tmpVec3.x=O,this.tmpVec3.y=L;var F=i.convertToWorldSpaceWithPos(s,this.tmpVec3);M[B].x=F.x,M[B].y=F.y,M[B].u=1,M[B].v=T,M[B].color._val=_,B+=1,O=z.x-u.x*n,L=z.y-u.y*n,this.tmpVec3.x=O,this.tmpVec3.y=L,F=i.convertToWorldSpaceWithPos(s,this.tmpVec3),M[B].x=F.x,M[B].y=F.y,M[B].u=0,M[B].v=T,M[B].color._val=_,m+=2}}h=m<=2?0:3*(m-2),D.resize(m,h)}},updateWorldVertexAllData:function(t){for(var e=t.renderData,r=e.floatStride,a=e.data,i=e.chunk.vb,o=0;o<a.length;o++){var s=o*r;i[s+0]=a[o].x,i[s+1]=a[o].y,i[s+2]=a[o].z,i[s+3]=a[o].u,i[s+4]=a[o].v,n.toArray(i,a[o].color,s+5)}},createQuadIndices:function(t,e){var r=t.renderData.chunk.meshBuffer.indexOffset;s=null,s=new Uint16Array(e);for(var a=0,n=e;a<n;a+=2){var i=0+a;s[r++]=i,s[r++]=i+2,s[r++]=i+1,s[r++]=i+1,s[r++]=i+2,s[r++]=i+3}},updateRenderDataCache:function(t,e){e.passDirty&&e.updatePass(t),e.nodeDirty&&e.updateNode(t),e.textureDirty&&t.texture&&(e.updateTexture(t.texture),e.material=t.getRenderMaterial(0)),e.hashDirty&&e.updateHash()},updateRenderData:function(t){},updateColor:function(t){},fillBuffers:function(t,e){for(var r=t.renderData,a=r.chunk,i=r.data,o=r.vertexCount,s=r.indexCount,u=a.vb,c=0,f=0;f<o;f++){var l=i[f];u[c++]=l.x,u[c++]=l.y,u[c++]=l.z,u[c++]=l.u,u[c++]=l.v,n.toArray(u,l.color,c),c+=4}a.bufferId;for(var d=a.vertexOffset,v=a.meshBuffer,x=a.meshBuffer.iData,p=v.indexOffset,y=0,h=s;y<h;y+=2){var m=d+y;x[p++]=m,x[p++]=m+2,x[p++]=m+1,x[p++]=m+1,x[p++]=m+2,x[p++]=m+3}v.indexOffset+=r.indexCount,v.setDirty()}}),d=t("MotionStreakAssemblerManager",{getAssembler:function(t){return l}});o.Assembler=d,e._RF.pop()}}}));

System.register("chunks:///_virtual/MotionStreakUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,i,r,n,s,a,o,l,u,c;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized,s=t.createClass},function(t){a=t.cclegacy,o=t._decorator,l=t.Texture2D,u=t.UIRenderer,c=t.Vec2}],execute:function(){var h,p,f,b,d,m,_,y,g,D;a._RF.push({},"bd481rJ0FVFF62OVb/xaLFl","MotionStreakUtil",void 0);var x=o.ccclass,v=o.property,k=function(){function t(t,e){this.point=new c,this.dir=new c,this.distance=0,this.time=0,t&&this.point.set(t),e&&this.dir.set(e)}var e=t.prototype;return e.setPoint=function(t,e){this.point.x=t,this.point.y=e},e.setDir=function(t,e){this.dir.x=t,this.dir.y=e},t}();t("MotionStreakUtil",(h=x("MotionStreakUtil"),p=v(l),h(((D=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return e=t.call.apply(t,[this].concat(s))||this,r(e,"fadeTime",d,n(e)),r(e,"minSeg",m,n(e)),r(e,"stroke",_,n(e)),r(e,"texture",y,n(e)),r(e,"fastMode",g,n(e)),e._points=[],e}i(e,t);var a=e.prototype;return a.onLoad=function(){this.texture},a.onEnable=function(){t.prototype.onEnable.call(this),this.reset()},a._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this._assembler=t),this.renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this.renderData.material=this.material,this._updateColor())},a.reset=function(){this._points.length=0,this.renderData&&this.renderData.clear()},a.lateUpdate=function(t){this._assembler&&this._assembler.update(this,t)},a._render=function(t){this.texture&&t.commitComp(this,this.renderData,this.texture,this._assembler,null)},s(e,[{key:"points",get:function(){return this._points}}]),e}(u)).Point=k,d=e((b=D).prototype,"fadeTime",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),m=e(b.prototype,"minSeg",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),_=e(b.prototype,"stroke",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),y=e(b.prototype,"texture",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=e(b.prototype,"fastMode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),f=b))||f));a._RF.pop()}}}));

System.register("chunks:///_virtual/msgac.ts",["cc"],(function(e){"use strict";var a;return{setters:[function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"8d1eemYIMJGs7d1DwDd8wBH","msgac",void 0);var r=e("msgac",{openLayer:101,showNotice:102,overDay:103,joystick:104,commonResRefresh:105,globalTouchStart:121,globalTouchMove:122,globalTouchEnd:123,jumpLayer:124,refreshRedPoint:125,refreshLocalization:126,refreshDebugPannel:127,refreshMapFightWindow:128,saveDataBefore:201,saveDataAfter:202,updateDropData:301,wearDrop:302,playerMsgStart:1e3,energyObjRefresh:1001,playerMsgEnd:1999,mapMsgStart:2e3,mapEnter:2001,mapLeave:2002,mapRefreshSkill:2003,mapMsgEnd:2999,redPointEvent:30001,homeHideMenu:30002,ac2KeyObj:{},init:function(){for(var e in r){var a=r[e];"number"==typeof a&&(r.ac2KeyObj[a]=e)}}});a._RF.pop()}}}));

System.register("chunks:///_virtual/MsgBoxLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts","./constants.ts"],(function(t){"use strict";var o,n,e,i,s;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator},function(t){i=t.BaseLayer},function(t){s=t.constants}],execute:function(){var a;n._RF.push({},"4fb1d7/p+xFCr60VCYR+/QB","MsgBoxLayer",void 0);var c=e.ccclass;e.property,t("MsgBoxLayer",c("MsgBoxLayer")(a=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var e=n.prototype;return e.onLoad=function(){t.prototype.onLoad.call(this)},e.onEnable=function(){t.prototype.onEnable.call(this)},e.onDisable=function(){t.prototype.onDisable.call(this)},e.onDestroy=function(){t.prototype.onDestroy.call(this)},e.initUI=function(){var t=this.layerData.hint;this.getNodeByPath("ui/title").localize("hint",s.catName.common),this.getNodeByPath("ui/btnClose/text").localize("close",s.catName.common),this.setString(this.getNodeByPath("ui/hint"),t)},e.processEvent=function(t,o){},e.onButtonClick=function(t,o){},n}(i))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/myLog.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){"use strict";var e,o;return{setters:[function(n){e=n.createClass},function(n){o=n.cclegacy}],execute:function(){o._RF.push({},"49bd1nqTqNChbAN3BXD0yoE","myLog",void 0);var r=function(){function n(){this.isOpen=!0}var o=n.prototype;return o.i=function(){if(this.isOpen){for(var n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];t.writeLog.apply(t,["info"].concat(e))}},o.d=function(){for(var n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];t.writeLog.apply(t,["debug"].concat(e))},o.w=function(){if(this.isOpen){for(var n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];t.writeLog.apply(t,["warn"].concat(e))}},o.e=function(){for(var n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];t.writeLog.apply(t,["error"].concat(e))},o.writeLog=function(n){for(var e,o=arguments.length,r=new Array(o>1?o-1:0),t=1;t<o;t++)r[t-1]=arguments[t];switch(r.unshift((new Date).toLocaleTimeString()),n){case"error":console.error.apply(console,r);break;case"warn":console.warn.apply(console,r);break;case"info":console.info.apply(console,r);break;case"debug":console.debug.apply(console,r);break;default:(e=console).log.apply(e,r)}},e(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}();r._instance=void 0;var t=n("myLog",r.instance);o._RF.pop()}}}));

System.register("chunks:///_virtual/NodePoolUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./cocosUtil.ts","./utilTools.ts"],(function(e){"use strict";var t,o,i,n,r,c,s,u;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,i=e._decorator,n=e.Prefab,r=e.Component},function(e){c=e.myLog},function(e){s=e.cocosUtil},function(e){u=e.utilTools}],execute:function(){var l;o._RF.push({},"84610XoI4JE3psEDQhJyjiP","NodePoolUtil",void 0);var d=i.ccclass;i.property,e("NodePoolUtil",d("NodePoolUtil")(l=function(e){function o(){for(var t,o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];return(t=e.call.apply(e,[this].concat(i))||this).itemNode=void 0,t.freeNodeArr=[],t.itemNodeArr=[],t}t(o,e);var i=o.prototype;return i.onLoad=function(){},i.init=function(e){e instanceof n&&(e=s.instantiate(e)),this.itemNode=e},i.getNode=function(){var e=this.freeNodeArr.shift();if(!e){if(!this.itemNode)return c.e(this.node),null;(e=s.instantiate(this.itemNode)).parent=this.node}return e.active||(e.active=!0),e.use=!0,e},i.recycleNode=function(e){this.itemNode||(this.itemNode=e),e.active=!1,-1==this.freeNodeArr.indexOf(e)&&this.freeNodeArr.push(e),e.use=!1},i.recycleAllNode=function(){var e=this;u.forArr(this.node.children,(function(t){e.recycleNode(t)}))},i.forEachUseNode=function(e){u.forArr(this.node.children,(function(t,o){t.use&&e(t,o)}))},o}(r))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/NoticeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,o,n,i,s,a,h,r,c,d,p;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,i=t.find,s=t.NodePool,a=t.instantiate,h=t.UITransform,r=t.Label,c=t.v3,d=t.UIOpacity,p=t.Component}],execute:function(){var m;o._RF.push({},"dc0e5fXhFFDZaZfHn86Ba++","NoticeLayer",void 0);var y=n.ccclass;n.property,t("NoticeLayer",y("NoticeLayer")(m=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).contentLayer=void 0,e.textPool=void 0,e.textItem=void 0,e.maxContentWidth=580,e.minContentWidth=150,e.contentBGAdd=150,e.orignHeight=0,e.spaceY=5,e.status={fadeIn:1,delay:2,fadeOut:3},e.speedY=300,e.speedOpacity=850,e.delayTime=1.5,e.moveDy=150,e.fadeOutNode=null,e}e(o,t);var n=o.prototype;return n.onLoad=function(){this.contentLayer=i("contentLayer",this.node),this.textItem=i("contentLayer/textItem",this.node),this.textPool=new s,this.textPool.put(this.textItem),this.textItem=a(this.textItem),this.orignHeight=i("content",this.textItem).getComponent(h).height},n.noticeShow=function(t){var e=this.textPool.get();e||(e=a(this.textItem)),e.active=!0;var o=i("content",e);o.getComponent(h).height=this.orignHeight,o.getComponent(r).overflow=r.Overflow.NONE,o.getComponent(r).string=t+"",o.getComponent(r).updateRenderData(!0);var n=o.getComponent(h).width;n>this.maxContentWidth?(o.getComponent(r).overflow=r.Overflow.SHRINK,o.getComponent(h).width=this.maxContentWidth,o.getComponent(h).height=2*this.orignHeight+10,n=this.maxContentWidth):n<this.minContentWidth&&(n=this.minContentWidth),e.getComponent(h).width=n+this.contentBGAdd,e.getComponent(h).height=o.getComponent(h).height+10,e.setPosition(0,-this.moveDy),e.moveY=this.moveDy,e.moveDy=0,e.setScale(c(1,1,1)),e.getComponent(d).opacity=0,e.status=this.status.fadeIn,e.parent=this.contentLayer},n.createNotice=function(t){this.noticeShow(t+"")},n.update=function(t){var e=this.contentLayer.children,o=[];for(var n in e){var i=e[n];switch(i.status){case this.status.fadeIn:var s=t*this.speedY;(a=i.getPosition()).y+=s,i.setPosition(a),i.moveDy+=s,(r=i.getComponent(d).opacity+this.speedOpacity*t)>255&&(r=255),i.getComponent(d).opacity=r,i.moveDy>=i.moveY&&(i.moveDy=0,i.getComponent(d).opacity=255,i.status=this.status.delay,i.time=0,i.delayTime=this.delayTime);break;case this.status.delay:i.delayTime-=t,i.delayTime<=0&&(i.delayTime=0,i.status=this.status.fadeOut);break;case this.status.fadeOut:if(this.fadeOutNode&&this.fadeOutNode!=i)break;this.fadeOutNode=i;var a,r;s=t*this.speedY;(a=i.getPosition()).y+=s,i.setPosition(a),(r=i.getComponent(d).opacity-this.speedOpacity*t)<0&&(r=0),i.getComponent(d).opacity=r,r<=0&&(o.push(i),this.fadeOutNode=null)}}for(var c in o){var p=o[c];p.parent=null,this.textPool.put(p)}if((e=this.contentLayer.children).length>=2)for(var m=e[e.length-1],y=e.length-2;y>=0;y--){var g=e[y],u=.5*(g.getComponent(h).height+m.getComponent(h).height)+this.spaceY;if(g.position.y-m.position.y<u){var l=g.getPosition();l.y=m.position.y+u,g.setPosition(l)}m=g}},o}(p))||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/NumSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./NodePoolUtil.ts"],(function(o){"use strict";var t,e,n,i,c,s,l,r,a,d,u,m;return{setters:[function(o){t=o.inheritsLoose},function(o){e=o.cclegacy,n=o._decorator,i=o.find,c=o.v3,s=o.UIOpacity,l=o.Label,r=o.Color,a=o.tween,d=o.Component},function(o){u=o.cocosUtil},function(o){m=o.NodePoolUtil}],execute:function(){var p;e._RF.push({},"0b3cf9KfFVL27ZleqxUIIbA","NumSystem",void 0);var h=n.ccclass;n.property,o("NumSystem",h("NumSystem")(p=function(o){function e(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=o.call.apply(o,[this].concat(n))||this).numNode=void 0,t.nodePoolUtil=void 0,t}t(e,o);var n=e.prototype;return n.onLoad=function(){this.numNode=i("num",this.node),this.nodePoolUtil=this.addComponent(m),this.nodePoolUtil.recycleNode(this.numNode)},n.addNum=function(o,t,e){var n=this,i=this.nodePoolUtil.getNode(),d=u.convertToNodeSpace(i,t),m=20*Math.random();m=Math.random()>.5?m:-m,d.x+=m,i.setPosition(d),i.setScale(c(1,1,1)),i.getComponent(s).opacity=255,i.getComponent(l).string=""+o,e||(e=r.WHITE),u.setRenderableColor(i,e);var p=20+10*Math.random();a(i).by(.3,{position:c(0,p,0),scale:c(.5,.5,0)}).by(.3,{scale:c(-.3,-.3,0)},{onUpdate:function(o,t){i.getComponent(s).opacity=255*(1-t)}}).call((function(){n.nodePoolUtil.recycleNode(i)})).start()},e}(d))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/PatrolFastLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./audioManager.ts","./designManager.ts","./playerModel.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./localization.ts"],(function(e){"use strict";var t,a,r,n,o,i,s,c,l,p,d,u,y,f,g,h,L,m,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,i=e._decorator,s=e.Prefab,c=e.Node,l=e.instantiate,p=e.find},function(e){d=e.sdkManager},function(e){u=e.constants},function(e){y=e.audioManager},function(e){f=e.designManager},function(e){g=e.playerModel},function(e){h=e.UserData},function(e){L=e.PropItemPrefab},function(e){m=e.BaseUILayer},function(e){w=e.localizeManager}],execute:function(){var P,b,I,k,v,_,z;o._RF.push({},"94dd2Eq0ipFdKO47fygl7FK","PatrolFastLayer",void 0);var A=i.ccclass,F=i.property;e("PatrolFastLayer",(P=A("PatrolFastLayer"),b=F({type:s}),I=F({type:c}),P((_=t((v=function(e){function t(){for(var t,a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o))||this,r(t,"propIten",_,n(t)),r(t,"addPropLayer",z,n(t)),t._rewardArr=[],t}a(t,e);var o=t.prototype;return o.onLoad=function(){e.prototype.onLoad.call(this)},o.start=function(){var e=h.getInstance().getPatrolRewardByTime(60*f.config.towerPressTime);this._rewardArr=e;for(var t=0;t<e.length&&t<2;t++){var a=e[t],r=l(this.propIten);r.getComponent(L).setView(a.Id,a.Num,L.Type_UnWear),r.getComponent(L).setScale(100),this.addPropLayer.addChild(r)}var n=l(this.propIten);n.getComponent(L).setView(0,0,L.Type_UnKnow),n.getComponent(L).setScale(100),this.addPropLayer.addChild(n),p("ui/bg/xunluotitle",this.node).localizeImg(),p("ui/btns/btnGoOn/Label",this.node).localize("getFree",u.catName.common),p("ui/bg/Label",this.node).localize({cat:u.layers.PatrolFastLayer,key:"hint",vars:[f.config.towerPressTime]})},o.onGetRewardTili=function(){y.playEffect("btnClick"),h.getInstance().power<f.config.quickEarn?this.toast(w._localize(null,"noStamina",u.catName.common)):(h.getInstance().usePower(0-f.config.quickEarn),h.getInstance().getRewardProp(this._rewardArr),g.addDayTaskNum(7,f.config.quickEarn),g.addDayTaskNum(8),this.openLayer(u.layers.RewardLayer,{propArr:this._rewardArr}),this.closeLayer())},o.onGetRewardVideo=function(){var e=this;y.playEffect("btnClick"),d.openAd("快速巡逻",(function(t){1==t&&(h.getInstance().getRewardProp(e._rewardArr),e.closeLayer(),e.openLayer(u.layers.RewardLayer,{propArr:e._rewardArr}),g.addDayTaskNum(8))}))},o.closeLayer=function(){y.playEffect("btnClick"),e.prototype.closeLayer.call(this)},t}(m)).prototype,"propIten",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(v.prototype,"addPropLayer",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=v))||k));o._RF.pop()}}}));

System.register("chunks:///_virtual/PatrolLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CountTimeUtil.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./RedPointLogicMgr.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(e){"use strict";var t,a,n,o,r,i,l,c,s,u,p,y,d,b,m,f,g,P,h,L,w,C,v,T;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,i=e._decorator,l=e.Node,c=e.Prefab,s=e.find,u=e.instantiate,p=e.tween,y=e.v3,d=e.sp,b=e.Button,m=e.Sprite},function(e){f=e.CountTimeUtil},function(e){g=e.utilTools},function(e){P=e.constants},function(e){h=e.audioManager},function(e){L=e.designManager},function(e){w=e.RedPointLogicMgr},function(e){C=e.UserData},function(e){v=e.PropItemPrefab},function(e){T=e.BaseUILayer}],execute:function(){var z,k,N,I,B,R,S,x,E,_,D,M,U,V,A,F,G,J,j,H,O;r._RF.push({},"e1aabDu4XBJPLTRY3gJflVk","PatrolLayer",void 0);var Q=i.ccclass,W=i.property;e("PatrolLayer",(z=Q("PatrolLayer"),k=W({type:l}),N=W({type:l}),I=W({type:l}),B=W({type:l}),R=W({type:l}),S=W({type:l}),x=W({type:c}),E=W({type:l}),_=W({type:l}),z((U=t((M=function(e){function t(){for(var t,a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,n(t,"btnPatrol",U,o(t)),n(t,"addCoinlabel",V,o(t)),n(t,"addExplabel",A,o(t)),n(t,"addPropLayer",F,o(t)),n(t,"maxPatrolTimelabel",G,o(t)),n(t,"curPatrolTimelabel",J,o(t)),n(t,"propIten",j,o(t)),n(t,"monster",H,o(t)),n(t,"handNode",O,o(t)),t._rewardArr=[],t}a(t,e);var r=t.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this),this.handNode.active=!1},r.start=function(){var e=this;this.initBtnPatrol(),s("ui/patline/info",this.node).localize("title",P.layers.PatrolLayer),s("ui/btnclose",this.node).localize("click2close",P.catName.common),s("ui/btns/btnGoOn/Label",this.node).localize("btnQuickEarningseds",P.layers.PatrolLayer),this.addCoinlabel.localize({cat:P.layers.PatrolLayer,key:"earnings",vars:[60*L.config.towerCoin]}),this.addExplabel.localize({cat:P.layers.PatrolLayer,key:"earnings",vars:[60*L.config.towerExp]}),this.curPatrolTimelabel.localize({cat:P.layers.PatrolLayer,key:"curPatrolTime",vars:[g.getTimeStrChinese(1e3*C.getInstance().getPatrolTime(),!1)]}),this.maxPatrolTimelabel.localize({cat:P.layers.PatrolLayer,key:"maxPatrolTime",vars:[L.config.towerTop/60]});var t=C.getInstance().getPatrolReward();this._rewardArr=t,t.forEach((function(t){var a=u(e.propIten);a.getComponent(v).setView(t.Id,t.Num,v.Type_UnWear),a.getComponent(v).setScale(100),e.addPropLayer.addChild(a)}));var a=this.monster;p(this.monster).show().set({position:y(222,-95,0)}).call((function(){a.getComponent(d.Skeleton).animation="walk",a.getComponent(d.Skeleton).loop=!0})).to(1,{position:y(50,-95,0)}).call((function(){a.getComponent(d.Skeleton).animation="die",a.getComponent(d.Skeleton).loop=!1})).delay(.3).hide().delay(.8).union().repeatForever().start()},r.initBtnPatrol=function(){var e=C.getInstance().getPatrolState();if(e>0){this.btnPatrol.getComponent(b).interactable=!1,this.btnPatrol.getComponent(m).grayscale=!0;var t=this;this.btnPatrol.getChildByName("Label").getComponent(f).setTime(e,(function(){t.btnPatrol.getComponent(b).interactable=!0,t.btnPatrol.getComponent(m).grayscale=!1,t.btnPatrol.getChildByName("Label").localize("get",P.catName.common)})),w.ins().setRPointView(this.btnPatrol,null,!1)}else w.ins().setRPointView(this.btnPatrol,null,!0),this.btnPatrol.getChildByName("Label").localize("get",P.catName.common),this.handNode.active=!0},r.onGetRewardNormal=function(){h.playEffect("btnClick"),this.handNode.active=!1,C.getInstance().getCurPatrolData(),this.showGetReward(this._rewardArr),this.initBtnPatrol(),this.curPatrolTimelabel.localize({cat:P.layers.PatrolLayer,key:"curPatrolTime",vars:[g.getTimeStrChinese(1e3*C.getInstance().getPatrolTime(),!1)]})},r.onGetRewardVideo=function(){h.playEffect("btnClick"),this.handNode.active||this.openLayer(P.layers.PatrolFastLayer)},r.closeLayer=function(){h.playEffect("btnClick"),this.handNode.active||e.prototype.closeLayer.call(this)},t}(T)).prototype,"btnPatrol",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(M.prototype,"addCoinlabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(M.prototype,"addExplabel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(M.prototype,"addPropLayer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(M.prototype,"maxPatrolTimelabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(M.prototype,"curPatrolTimelabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(M.prototype,"propIten",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(M.prototype,"monster",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(M.prototype,"handNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=M))||D));r._RF.pop()}}}));

System.register("chunks:///_virtual/PauseLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqAdManager.ts","./tyqSDK.ts","./tyqSDKConfig.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./UserData.ts","./BaseLayer.ts","./ItemLayer.ts"],(function(e){"use strict";var t,a,i,o,n,s,r,l,c,u,y,h,m,d,L,f;return{setters:[function(e){t=e.inheritsLoose},function(e){a=e.cclegacy,i=e._decorator,o=e.find},function(e){n=e.tyqAdManager,s=e.Channel},function(e){r=e.tyqSDK},function(e){l=e.tyqSDKConfig},function(e){c=e.constants},function(e){u=e.msgac},function(e){y=e.audioManager},function(e){h=e.designManager},function(e){m=e.mapModel},function(e){d=e.UserData},function(e){L=e.BaseLayer},function(e){f=e.ItemLayer}],execute:function(){var p;a._RF.push({},"5ccffM3vLNFzaO424mauG8D","PauseLayer",void 0);var v=i.ccclass;i.property,e("PauseLayer",v("PauseLayer")(p=function(e){function a(){for(var t,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).weaponItemLayer=void 0,t.skill1ItemLayer=void 0,t.skill2ItemLayer=void 0,t.audioIconOpen=void 0,t.audioIconClose=void 0,t}t(a,e);var i=a.prototype;return i.onLoad=function(){e.prototype.onLoad.call(this),this.weaponItemLayer=this.getNodeByPath("ui/weaponLayer/bg/itemLayer").addComponent(f),this.skill1ItemLayer=this.getNodeByPath("ui/skill1Layer/itemLayer").addComponent(f),this.skill2ItemLayer=this.getNodeByPath("ui/skill2Layer/itemLayer").addComponent(f),this.audioIconOpen=this.getNodeByPath("btnAudio/open"),this.audioIconClose=this.getNodeByPath("btnAudio/close")},i.onEnable=function(){e.prototype.onEnable.call(this),r.getSwitchValue(l.paramsKeys.tyq_more_game_level)>0&&r.getSwitchValue(l.paramsKeys.tyq_more_game_level)>d.getInstance().openLevel&&n.getChannel()==s.WECHAT&&this.openLayer(c.layers.MoreGameLayer),n.showDelayFullVideo(),this.addEventArr([u.mapLeave])},i.onDisable=function(){e.prototype.onDisable.call(this),this.removeEventArr([u.mapLeave])},i.onDestroy=function(){e.prototype.onDestroy.call(this)},i.initUI=function(){o("ui/title/text",this.node).localizeImg(),o("ui/weaponLayer/title/text",this.node).localize("weapon",c.layers.PauseLayer),o("ui/skill1Layer/title",this.node).localize("skill",c.layers.PauseLayer),o("ui/skill2Layer/title",this.node).localize("skill2",c.layers.PauseLayer),o("ui/btnGoOn/text",this.node).localizeImg(),this.refreshWeaponLayer(),this.refreshSkill1Layer(),this.refreshSkill2Layer(),this.refreshAudioLayer()},i.refreshAudioLayer=function(){y.musicVolume>0?(this.audioIconOpen.active=!0,this.audioIconClose.active=!1):(this.audioIconOpen.active=!1,this.audioIconClose.active=!0)},i.refreshSkill2Layer=function(){var e=this;this.setNumItemLayer(this.skill2ItemLayer.node,c.design.skill2Num,(function(t,a){e.refreshItem(t,a,c.tableName.skill2)}))},i.refreshSkill1Layer=function(){var e=this;this.setNumItemLayer(this.skill1ItemLayer.node,c.design.skill1Num,(function(t,a){e.refreshItem(t,a,c.tableName.skill)}))},i.refreshWeaponLayer=function(){var e=this;this.setNumItemLayer(this.weaponItemLayer.node,c.design.weaponNum,(function(t,a){e.refreshItem(t,a,c.tableName.weapon)}))},i.refreshItem=function(e,t,a){var i=null;switch(a){case c.tableName.weapon:i=m.weaponSystem.weaponArr[t-1];break;case c.tableName.skill:i=m.skillSystem.skillArr[t-1];break;case c.tableName.skill2:i=m.skillSystem.skill2Arr[t-1]}var n=o("icon",e),s=o("starLayer",e);if(!i)return n.active=!1,void(s.active=!1);n.active=!0,s.active=!0;var r=h.getRowById(a,i.id);this.setSpriteFrame(n,r.icon),this.setNumItemLayer(s,r.lv,(function(e){var t=o("icon",e),a=o("icon2",e);r.lv>=c.design.maxLv?(t.active=!1,a.active=!0):(t.active=!0,a.active=!1)}))},i.mapLeaveRet=function(e){this.closeLayer()},i.closeLayer=function(){e.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},i.onClickBtnGoOn=function(e){this.closeLayer()},i.onClickBtnHome=function(){this.openLayer(c.layers.BackHomeLayer)},i.onClickBtnAudio=function(){y.musicVolume>0?(y.setMusicVolume(0),y.setEffectVolume(0)):(y.setMusicVolume(1),y.setEffectVolume(1)),this.refreshAudioLayer()},a}(L))||p);a._RF.pop()}}}));

System.register("chunks:///_virtual/physicsGroup.ts",["cc"],(function(L){"use strict";var E;return{setters:[function(L){E=L.cclegacy}],execute:function(){var s;L("physicsGroup",void 0),E._RF.push({},"7abfb/MfGJL5r7iKar3kd+i","physicsGroup",void 0),function(L){L[L.DEFAULT=1]="DEFAULT",L[L.PLAYER=2]="PLAYER",L[L.MONSTER=4]="MONSTER",L[L.PLAYER_BULLET=8]="PLAYER_BULLET",L[L.MONSTER_BULLET=16]="MONSTER_BULLET",L[L.PROP=32]="PROP",L[L.WALL=64]="WALL",L[L.PLAYER_BULLET2=128]="PLAYER_BULLET2",L[L.SAFE_WALL=256]="SAFE_WALL"}(s||(s=L("physicsGroup",{}))),E._RF.pop()}}}));

System.register("chunks:///_virtual/PhysicsWorld.ts",["cc","./utilTools.ts","./BoxColliderUtil.ts"],(function(o){"use strict";var r,t,i,e,l,n;return{setters:[function(o){r=o.cclegacy,t=o._decorator,i=o.PhysicsSystem2D,e=o.Intersection2D},function(o){l=o.utilTools},function(o){n=o.BoxColliderUtil}],execute:function(){r._RF.push({},"3f2ff/lDDdLSruB5HOM+uuJ","PhysicsWorld",void 0);t.ccclass,t.property;var c=function(){function o(){this.cellSize=100,this.colliderArr=void 0,this.posToColliderArr={}}o.getInstance=function(){return null==this._instance&&(this._instance=new o),this._instance};var r=o.prototype;return r.getPosKey=function(o,r){return o+"_"+r},r.forColliderRectKeyArr=function(o,r){for(var t=o.worldAabb,i=Math.floor(t.x/this.cellSize),e=Math.ceil((t.x+t.width)/this.cellSize),l=Math.floor(t.y/this.cellSize),n=Math.ceil((t.y+t.height)/this.cellSize),c=i;c<=e;c++)for(var s=l;s<=n;s++){r(this.getPosKey(c,s))}},r.addIntoPosToColliderArr=function(o){var r=this;this.forColliderRectKeyArr(o,(function(t){var i=r.posToColliderArr[t];i||(i=[],r.posToColliderArr[t]=i),i.push(o)}))},r.collectCollider=function(o){var r=this;if(o.active&&o.activeInHierarchy){var t=o.getComponents(n);l.forArr(t,(function(o){o.enabled&&(o.updateCollider(),r.colliderArr.push(o),r.addIntoPosToColliderArr(o))})),l.forArr(o.children,(function(o){r.collectCollider(o)}))}},r.step=function(o){var r=this;this.colliderArr=[],this.posToColliderArr={},this.collectCollider(o),l.forArr(this.colliderArr,(function(o){r.forColliderRectKeyArr(o,(function(t){var i=r.posToColliderArr[t];i&&l.forArr(i,(function(t){r.doIntersection(o,t)}))}))}))},r.doIntersection=function(o,r){if(o!=r&&o.node!=r.node){var t=i.instance.collisionMatrix;if(t[o.group]&r.group&&t[r.group]&o.group)e.polygonPolygon(o.worldPoints,r.worldPoints)?o.contactBegin(r):o.contactEnd(r)}},o}();c._instance=null;o("physicsWorld",c.getInstance());r._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./mapModel.ts","./playerModel.ts","./physicsGroup.ts","./AnimationCtrl.ts","./BaseLayer.ts","./ShineColor.ts","./Monster.ts"],(function(t){"use strict";var i,e,o,n,s,a,h,r,l,c,p,d,u,f,m,y,v,g,M,S,C;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,n=t.Collider2D,s=t.Contact2DType,a=t.Color,h=t.macro,r=t.v3},function(t){l=t.cocosUtil},function(t){c=t.utilTools},function(t){p=t.constants},function(t){d=t.msgac},function(t){u=t.designManager},function(t){f=t.eventManager},function(t){m=t.mapModel},function(t){y=t.playerModel},function(t){v=t.physicsGroup},function(t){g=t.AnimationCtrl},function(t){M=t.BaseLayer},function(t){S=t.ShineColor},function(t){C=t.Monster}],execute:function(){var A;e._RF.push({},"cf7c7EXLGBBJYgKGeHmF0f7","Player",void 0);var P=o.ccclass;o.property,t("Player",P("Player")(A=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).moveSpeed=350,i.hp=100,i.hpMax=100,i.hpMaxOrign=100,i.atk=0,i.bodyNode=void 0,i.effectAnimationCtrl=void 0,i.lightShine=!1,i.collider=void 0,i.animationCtrl=void 0,i.shineColor=void 0,i.hpProgress=void 0,i.movePos=void 0,i.outVec3=r(0,0,0),i.monsterArr=[],i.wallCollider=void 0,i}i(e,t);var o=e.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this),this.collider=this.getComponent(n),this.bodyNode=this.getNodeByPath("body"),this.hpProgress=this.getNodeByPath("hpProgress"),this.animationCtrl=this.bodyNode.addComponent(g),this.shineColor=this.bodyNode.addComponent(S),this.effectAnimationCtrl=this.getNodeByPath("body/effect").addComponent(g),this.effectAnimationCtrl.node.active=!1,this.collider.on(s.BEGIN_CONTACT,this.contactBegin,this),this.collider.on(s.END_CONTACT,this.contactEnd,this),this.moveSpeed=u.config.roleSpeed,this.setRoleSkin(this.bodyNode)},o.onEnable=function(){t.prototype.onEnable.call(this),this.addEventArr([d.joystick])},o.onDestroy=function(){},o.initData=function(t){this.hp=t.hp,this.hpMax=this.hp,this.hpMaxOrign=this.hp,this.atk=t.atk,this.initUI()},o.initUI=function(){this.collider.enabled=!0,this.refreshHpLayer()},o.getSaveData=function(){var t={};return t.moveSpeed=this.moveSpeed,t.hp=this.hp,t.hpMax=this.hpMax,t.hpMaxOrign=this.hpMaxOrign,t.atk=this.atk,t.pos=this.node.position,t},o.loadSaveData=function(t){this.moveSpeed=t.moveSpeed,this.hp=t.hp,this.hpMax=t.hpMax,this.hpMaxOrign=t.hpMaxOrign,this.atk=t.atk,this.node.position=t.pos,this.refreshHpLayer()},o.addHpMaxPercent=function(t){var i=this.hpMax,e=this.hpMaxOrign*(1+t),o=(e=Math.round(e))-i;this.hpMax=e,this.addHp(o)},o.addHpPercent=function(t){var i=this;this.effectAnimationCtrl.node.active=!0,this.effectAnimationCtrl.playAnimation("zhiliao",!1,(function(){i.effectAnimationCtrl.node.active=!1}));var e=this.hpMax*t;this.addHp(e)},o.addHp=function(t){this.hp<=0||(t=Math.ceil(t),this.hp+=t,t>0?m.numSystem.addNum(t,l.convertToWorldSpace(this.node),a.GREEN):m.numSystem.addNum(t,l.convertToWorldSpace(this.node),a.RED),this.hp>this.hpMax&&(this.hp=this.hpMax),this.hp<0&&(this.hp=0),this.refreshHpLayer())},o.refreshHpLayer=function(){this.setProgressBar(this.hpProgress,this.hp/this.hpMax)},o.useSkillHeal=function(t){this.addHpPercent(t)},o.backLife=function(){var t=this;this.hp=this.hpMax,this.animationCtrl.playAnimation(p.animations.walk,!0),this.effectAnimationCtrl.node.active=!0,this.effectAnimationCtrl.playAnimation("hudun",!0),this.lightShine=!0,this.scheduleOnce((function(){t.effectAnimationCtrl.node.active=!1,t.lightShine=!1}),3),this.refreshHpLayer(),m.mapLayer.gameFightResume(),m.mapLayer.onSkillSelect()},o.hitWithDam=function(t,i,e){if(!(t<=0||this.hp<=0)&&!this.lightShine&&(t*=1-m.skillSystem.getSkill2DamSubPercent(),t=Math.ceil(t),this.addHp(-t),this.shineColor.startShine(p.materials.shineColorSpine,i),this.hp<=0)){if(y.skillLifeNum>0)return y.skillLifeNum--,this.backLife(),void f.send(d.mapRefreshSkill);this.collider.enabled=!1,this.animationCtrl.playAnimation(p.animations.die,!1,(function(){m.mapLayer.popLayer(p.layers.BackLifeLayer)}))}},o.addMonster=function(t){if(0==t.tag){var i=t.getComponent(C);-1==this.monsterArr.indexOf(i)&&(i.isPauseMove=!0,this.monsterArr.push(i))}},o.removeMonster=function(t){if(0==t.tag){var i=t.getComponent(C),e=this.monsterArr.indexOf(i);-1!=e&&(i.isPauseMove=!1,this.monsterArr.splice(e,1))}},o.contactBegin=function(t,i){if(i.group==v.MONSTER){var e=i.getComponent(C);return e||(e=i.node.parent.getComponent(C)),this.addMonster(i),void e.contactBeginPlayer()}if(i.group==v.WALL)return this.touchWall(),this.unschedule(this.touchWall),this.wallCollider=i,void this.schedule(this.touchWall,.5,h.REPEAT_FOREVER,0)},o.contactEnd=function(t,i){if(l.isValid(i)){if(i.group==v.MONSTER){var e=i.getComponent(C);return e||(e=i.node.parent.getComponent(C)),this.removeMonster(i),void e.contactEndPlayer()}i.group!=v.WALL||this.wallCollider==i&&this.unschedule(this.touchWall)}},o.touchWall=function(){var t=.05*this.hpMax;t=Math.ceil(t),this.hitWithDam(t)},o.joystickRet=function(t){if("start"!=t.type)"move"!=t.type?"end"==t.type&&this.stopMove():this.movePos=t.pos;else{if(this.hp<=0)return;this.animationCtrl.playAnimation(p.animations.walk,!0)}},o.stopMove=function(){this.movePos=null,this.hp>0&&this.animationCtrl.playAnimation(p.animations.standBy,!0)},o.getMoveSpeed=function(){return this.moveSpeed*(1+m.skillSystem.getSkill2PlayerSpeedAddPercent())},o.move=function(t){if(this.movePos&&!(this.hp<=0)){var i=this.node.getPosition(this.outVec3),e=this.getMoveSpeed(),o=e*t,n=this.movePos.clone().multiplyScalar(o);i.add(n),console.debug("当前速度："+e+", 移动距离："+o+", movepos:"+n+", nowpos:"+i),this.node.setPosition(i),m.mapSystem.adjustInWall(this.node);var s=this.bodyNode.getScale();n.x>=0?this.bodyNode.setScale(-Math.abs(s.x),s.y):this.bodyNode.setScale(Math.abs(s.x),s.y),m.mapSystem.refreshMapFightWindow(),this.monsterArr.length>0&&c.forArr(this.monsterArr,(function(t){t.playerForceMove(n.clone())})),this.setString(m.mapLayer.playerPosNode,Math.floor(i.x)+","+Math.floor(i.y))}},o.update=function(t){this.move(t)},e}(M))||A);e._RF.pop()}}}));

System.register("chunks:///_virtual/playerModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./localStorageManager.ts","./mapModel.ts","./UserData.ts"],(function(e){"use strict";var t,a,i,s,n,r,l,d,u,o,h;return{setters:[function(e){t=e.createClass},function(e){a=e.cclegacy},function(e){i=e.utilTools},function(e){s=e.constants},function(e){n=e.msgac},function(e){r=e.audioManager},function(e){l=e.designManager},function(e){d=e.eventManager},function(e){u=e.localStorageManager},function(e){o=e.mapModel},function(e){h=e.UserData}],execute:function(){a._RF.push({},"49378vbq+FDaLOtxpJMRyYQ","playerModel",void 0);var m=function(){function e(){this.now=new Date,this.secondInterval=void 0,this.saveTime=void 0,this.skillFreeRefreshCount=0,this.isOpenDev=!1,this.isRecordAd=!1,this.dayTaskObj={},this.energyObj={},this.daySignObj={},this.vipObj={},this.shareObj={},this.isLetterAward=0,this.skillBombNum=1,this.skillHealNum=1,this.skillMagnetNum=0,this.skillLifeNum=0}var a=e.prototype;return a.init=function(){var e=new Date,t=h.getInstance().playerData;i.timeStrToDate(t),r.initData(t.audio),this.initData(t.player,e),o.initData(t.fight,e),this.openSecondInterval(),d.on(n.saveDataBefore,this.onSaveData,this)},a.initData=function(e,t){if(e||(e={}),e.saveTime?this.saveTime=e.saveTime:this.saveTime=t,e.skillFreeRefreshCount?this.skillFreeRefreshCount=e.skillFreeRefreshCount:this.skillFreeRefreshCount=0,e.dayTaskObj?this.dayTaskObj=e.dayTaskObj:this.dayTaskObj={awardFlagArr:[],taskObj:{}},e.energyObj?this.energyObj=e.energyObj:this.energyObj={num:0,awardObj:{}},this.energyObj.endTime||(this.energyObj.endTime=new Date(t.getTime()+7*s.times.day)),e.daySignObj)this.daySignObj=e.daySignObj;else{var a=new Date(t.getTime());a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),this.daySignObj={startTime:a,awardDayArr:[],finalAward:0}}e.isLetterAward?this.isLetterAward=e.isLetterAward:this.isLetterAward=0,e.vipObj?this.vipObj=e.vipObj:this.vipObj={vip:1,adNum:0,dayAward:0,onceObj:{}},e.shareObj?this.shareObj=e.shareObj:this.shareObj={dayNum:0,idAwardObj:{},friendNum:0,friendAdNum:0,friendPassNum:0},null==e.skillBombNum?this.skillBombNum=1:this.skillBombNum=e.skillBombNum,null==e.skillHealNum?this.skillHealNum=1:this.skillHealNum=e.skillHealNum,null==e.skillMagnetNum?this.skillMagnetNum=0:this.skillMagnetNum=e.skillMagnetNum,null==e.skillLifeNum?this.skillLifeNum=1:this.skillLifeNum=e.skillLifeNum,this.addDayTaskNum(1)},a.getSaveData=function(e){var t={};return t.saveTime=this.saveTime,t.skillFreeRefreshCount=this.skillFreeRefreshCount,t.dayTaskObj=this.dayTaskObj,t.energyObj=this.energyObj,t.daySignObj=this.daySignObj,t.isLetterAward=this.isLetterAward,t.vipObj=this.vipObj,t.shareObj=this.shareObj,t.skillBombNum=this.skillBombNum,t.skillHealNum=this.skillHealNum,t.skillMagnetNum=this.skillMagnetNum,t.skillLifeNum=this.skillLifeNum,t},a.onSaveData=function(){var e=new Date,t={};t.player=this.getSaveData(e),t.audio=r.getSaveData(e),h.getInstance().playerData=t},a.openSecondInterval=function(){this.secondInterval&&clearInterval(this.secondInterval),this.secondInterval=setInterval(this.updateSecond.bind(this),1e3),this.updateSecond()},a.updateSecond=function(){var e=new Date;this.now=e,i.overDay(this.saveTime,e)&&(this.saveTime=e,this.overDay(e),d.send(n.overDay)),e.getTime()>=this.energyObj.endTime&&(this.energyObj={num:0,awardObj:{},endTime:new Date(e.getTime()+7*s.times.day)},d.send(n.energyObjRefresh))},a.isInDevelopmentEnvironment=function(){return this.isOpenDev},a.overDay=function(e){this.skillFreeRefreshCount=0,this.dayTaskObj={awardFlagArr:[],taskObj:{}},this.vipObj.dayAward=0,this.shareObj.dayNum=0,h.getInstance().dayAct=0},a.clearGameData=function(){u.setGameData({}),this.init()},a.sendToUINotice=function(e){d.send(n.showNotice,e)},a.getTaskInfoById=function(e){var t=this.dayTaskObj.taskObj[e];return t||(t={num:0,getAward:0},this.dayTaskObj.taskObj[e]=t),t},a.addDayTaskNum=function(e,t){void 0===t&&(t=1);var a=this.getTaskInfoById(e);a.num+=t;var i=l.getRowById(s.tableName.dayTask,e);if(a.num>=i.needNum&&!a.getAward)switch(e){case 4:case 5:case 6:break;default:d.send(n.refreshRedPoint)}},a.getEnergyAwardInfoById=function(e){var t=this.energyObj.awardObj[e];return t||(t={},this.energyObj.awardObj[e]=t),t},a.hasLetterAward=function(){return!v.isLetterAward},a.hasDaySignAward=function(){var e=new Date,t=Math.floor((e.getTime()-v.daySignObj.startTime)/s.times.day);return!!l.getRowById(s.tableName.daySign,t+1)&&-1==v.daySignObj.awardDayArr.indexOf(t)},a.hasDayTaskAward=function(){var e=l.getTable(s.tableName.dayTask);for(var t in e){var a=e[t],i=v.getTaskInfoById(a.id);if(i.num>=a.needNum&&!i.getAward)return!0}return!1},a.hasEnergyAward=function(){var e=l.getTable(s.tableName.energyAward);for(var t in e){var a=e[t];if(h.getInstance().energy<a.num)break;if(!v.getEnergyAwardInfoById(a.id).award1)return!0}return!1},a.addVipAdNum=function(){this.vipObj.adNum++;var e=l.getRowById(s.tableName.vip,this.vipObj.vip);if(this.vipObj.adNum>=e.adNum&&l.getRowById(s.tableName.vip,this.vipObj.vip+1))return this.vipObj.vip++,this.vipObj.adNum=0,this.vipObj.dayAward=0,!0},a.hasVipAward=function(){return!this.vipObj.dayAward||!this.vipObj.onceObj[this.vipObj.vip]},a.hasChapterBoxAward=function(){for(var e=1;e<=h.getInstance().openLevel;e++)for(var t=h.getInstance().getLevelData(e),a=0;a<s.design.chapterBoxNum;a++)if(t.Time>=5*(a+1)*60&&0==t.ReceiveState[a])return!0;return!1},t(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();m._instance=void 0;var v=e("playerModel",m.instance);a._RF.pop()}}}));

System.register("chunks:///_virtual/ProgressCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var r,s,e,o,i;return{setters:[function(t){r=t.inheritsLoose},function(t){s=t.cclegacy,e=t._decorator,o=t.ProgressBar,i=t.Component}],execute:function(){var n;s._RF.push({},"70366vUiUVK84CeSgjAYxbQ","ProgressCtrl",void 0);var u=e.ccclass;e.property,t("ProgressCtrl",u("ProgressCtrl")(n=function(t){function s(){for(var r,s=arguments.length,e=new Array(s),o=0;o<s;o++)e[o]=arguments[o];return(r=t.call.apply(t,[this].concat(e))||this).progressBar=void 0,r.time=void 0,r.timeCount=void 0,r.endCb=void 0,r}r(s,t);var e=s.prototype;return e.onLoad=function(){this.progressBar=this.getComponent(o),this.progressBar||(this.progressBar=this.getComponentInChildren(o))},e.startLoadProgress=function(t,r){null==this.timeCount&&(this.time=t,this.endCb=r,this.timeCount=0)},e.update=function(t){if(null!=this.timeCount&&this.progressBar){this.timeCount+=t;var r=this.timeCount/this.time;this.progressBar.progress=r,r>=1&&(this.timeCount=void 0,this.endCb&&this.endCb())}},s}(i))||n);s._RF.pop()}}}));

System.register("chunks:///_virtual/Prop.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./mapModel.ts","./physicsGroup.ts","./AnimationCtrl.ts","./BaseLayer.ts"],(function(t){"use strict";var o,i,e,r,s,n,p,a,l,d,c,h,u,y,f;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,e=t._decorator,r=t.BoxCollider2D,s=t.find,n=t.Contact2DType,p=t.Vec2},function(t){a=t.cocosUtil},function(t){l=t.utilTools},function(t){d=t.constants},function(t){c=t.designManager},function(t){h=t.mapModel},function(t){u=t.physicsGroup},function(t){y=t.AnimationCtrl},function(t){f=t.BaseLayer}],execute:function(){var m;i._RF.push({},"b480cN5zOtEI7gfMoQqAALv","Prop",void 0);var v=e.ccclass;e.property,t("Prop",v("Prop")(m=function(t){function i(){for(var o,i=arguments.length,e=new Array(i),r=0;r<i;r++)e[r]=arguments[r];return(o=t.call.apply(t,[this].concat(e))||this).id=void 0,o.row=void 0,o.extraObj=void 0,o.bodyNode=void 0,o.aniNode=void 0,o.collider=void 0,o.animationCtrl=void 0,o.propUtil=void 0,o.isFollowPlayer=void 0,o.followSpeed=void 0,o}o(i,t);var e=i.prototype;return e.onLoad=function(){this.collider=this.getComponent(r),this.animationCtrl=this.addComponent(y),this.bodyNode=s("body",this.node),this.aniNode=s("ani",this.node),this.collider&&this.collider.on(n.BEGIN_CONTACT,this.contactBegin,this)},e.onEnable=function(){},e.init=function(t,o,i){this.bodyNode||this.onLoad(),this.id=t,this.row=c.getRowById(d.tableName.prop,t),this.extraObj=i,this.unscheduleAllCallbacks(),this.collider&&(this.collider.enabled=!0),this.isFollowPlayer=!1,this.followSpeed=-1e3;var e=a.convertToNodeSpace(this.node,o);this.node.setPosition(e),this.aniNode&&(this.aniNode.active=!0),this.setSpriteFrame(this.bodyNode,this.row.icon);try{this.propUtil=a.addComponentOnce(this,"Prop"+t),this.propUtil.unscheduleAllCallbacks(),this.propUtil.init(this)}catch(t){}},e.contactBegin=function(t,o){var i=this;if(o.group==u.PLAYER_BULLET&&this.id==d.propIds.box1){this.collider.enabled=!1,this.animationCtrl.playAnimationOnce("ani",(function(){i.recycleSelf()}));var e=c.getTable(d.tableName.box1),r=[];for(var s in e){var n=e[s];0!=n.mapId&&n.mapId!=h.mapId||r.push(n)}var p=l.getRowByWeight(r),y=!1;if(p.propId!=d.propIds.addHpPercent&&h.player.hp<=.5*h.player.hpMax&&h.propSystem.getPropNums(d.propIds.addHpPercent)<2)for(var f=0;f<c.config.skillPropAddMult;f++){if(p.propId==d.propIds.addHpPercent){y=!0;break}p=l.getRowByWeight(r)}if(!y&&p.propId!=d.propIds.bomb&&h.monsterSystem.aliveMonsterNum>=100&&h.propSystem.getPropNums(d.propIds.bomb)<2)for(var m=0;m<c.config.skillPropAddMult;m++){if(p.propId==d.propIds.bomb){y=!0;break}p=l.getRowByWeight(r)}if(!y&&p.propId!=d.propIds.magnet&&h.propSystem.getPropNums(d.propIds.exp)>=100&&h.propSystem.getPropNums(d.propIds.magnet)<2)for(var v=0;v<c.config.skillPropAddMult;v++){if(p.propId==d.propIds.magnet){y=!0;break}p=l.getRowByWeight(r)}var g=l.getFloatValue(p.minNum,p.maxNum,!0),P={};P.num=g,P.propId=p.propId;var b=p.propId,I=c.getRowById(d.tableName.prop,b);return 8!=I.type&&11!=I.type||(b=d.propIds.equip),void h.propSystem.addProp(b,a.convertToWorldSpace(this.node),P)}},e.contactPlayer=function(){this.propUtil&&this.propUtil.notContact||this.propUtil&&this.propUtil.autoGet||(this.node.active=!0,this.collider&&(this.collider.enabled=!1),this.isFollowPlayer=!0,this.aniNode&&(this.aniNode.active=!1),this.propUtil&&this.propUtil.contactStart&&this.propUtil.contactStart())},e.doDisPlayerGet=function(t){this.collider||t>100+h.skillSystem.getSkill2PropGetAddDis()||this.contactPlayer()},e.playerGetProp=function(){this.recycleSelf(),this.isFollowPlayer=!1;var t=1;this.extraObj&&this.extraObj.num>0&&(t=this.extraObj.num);var o=this.id;this.id==d.propIds.equip&&(o=this.extraObj.propId);var i={pos:a.convertToWorldSpaceWithPos(this.node,this.node.position)};h.propSystem.getProp(o,t,i)},e.recycleSelf=function(){h.propSystem.recyclePropNode(this.node)},e.update=function(t){if(this.isFollowPlayer){var o=h.player.node.getPosition(),i=this.node.getPosition();this.followSpeed+=50;var e=this.followSpeed*t,r=o.subtract(i).normalize().multiplyScalar(e);if(i.add(r),this.node.setPosition(i),e>0){var s=(o=h.player.node.getPosition()).subtract(i);if(l.radianToAngle(p.angle(r,s))>90)return void this.playerGetProp()}}},i}(f))||m);i._RF.pop()}}}));

System.register("chunks:///_virtual/Prop1001.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationTrack.ts"],(function(t){"use strict";var o,n,r,i,c,a;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,i=t.Component},function(t){c=t.cocosUtil},function(t){a=t.AnimationTrack}],execute:function(){var e;n._RF.push({},"7560dwr4i1A6LAme6E7aqDt","Prop1001",void 0);var s=r.ccclass;r.property,t("Prop1001",s("Prop1001")(e=function(t){function n(){for(var o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(o=t.call.apply(t,[this].concat(r))||this).prop=void 0,o.autoGet=!0,o.animationTrack=void 0,o}return o(n,t),n.prototype.init=function(t){var o=this;this.prop=t,this.animationTrack=c.addComponentOnce(this.node,a),this.animationTrack.startShowThrow((function(){o.prop.playerGetProp()}))},n}(i))||e);n._RF.pop()}}}));

System.register("chunks:///_virtual/Prop1002.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./designManager.ts"],(function(t){"use strict";var o,r,n,e,p,s;return{setters:[function(t){o=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,e=t.Component},function(t){p=t.constants},function(t){s=t.designManager}],execute:function(){var i;r._RF.push({},"2417aZWpORBWYRBYefZ1EuS","Prop1002",void 0);var c=n.ccclass;n.property,t("Prop1002",c("Prop1002")(i=function(t){function r(){for(var o,r=arguments.length,n=new Array(r),e=0;e<r;e++)n[e]=arguments[e];return(o=t.call.apply(t,[this].concat(n))||this).prop=void 0,o}return o(r,t),r.prototype.init=function(t){this.prop=t;var o=s.getRowById(p.tableName.prop,this.prop.extraObj.propId);this.prop.setSpriteFrame2(this.prop.bodyNode,"prop/"+o.icon)},r}(e))||i);r._RF.pop()}}}));

System.register("chunks:///_virtual/Prop101.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./utilTools.ts","./constants.ts","./designManager.ts"],(function(o){"use strict";var t,n,r,e,i,p,s,c;return{setters:[function(o){t=o.inheritsLoose},function(o){n=o.cclegacy,r=o._decorator,e=o.Component},function(o){i=o.myLog},function(o){p=o.utilTools},function(o){s=o.constants},function(o){c=o.designManager}],execute:function(){var u;n._RF.push({},"00c51R5Hj9Fm5HudkQ22u64","Prop101",void 0);var a=r.ccclass;r.property,o("Prop101",a("Prop101")(u=function(o){function n(){for(var t,n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];return(t=o.call.apply(o,[this].concat(r))||this).prop=void 0,t}return t(n,o),n.prototype.init=function(o){this.prop=o;var t=this.prop.extraObj.num,n=c.getRowsByType(s.tableName.prop,s.propTypes.coin),r=null;p.forArr(n,(function(o){if(t>=o.p1&&t<=o.p2)return r=o,!0})),r?this.prop.setSpriteFrame(this.prop.bodyNode,r.icon):i.e("coin num:"+t+" not in prop table")},n}(e))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/Prop201.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./utilTools.ts","./constants.ts","./designManager.ts"],(function(t){"use strict";var o,n,r,e,p,s,i,c,u;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,e=t.v3,p=t.Component},function(t){s=t.myLog},function(t){i=t.utilTools},function(t){c=t.constants},function(t){u=t.designManager}],execute:function(){var a;n._RF.push({},"589beHTgXtCGJjDX4C17557","Prop201",void 0);var l=r.ccclass;r.property,t("Prop201",l("Prop201")(a=function(t){function n(){for(var o,n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];return(o=t.call.apply(t,[this].concat(r))||this).prop=void 0,o}return o(n,t),n.prototype.init=function(t){this.prop=t;var o=this.prop.extraObj.num,n=u.getRowsByType(c.tableName.prop,c.propTypes.exp),r=null;if(i.forArr(n,(function(t){if(o>=t.p1&&o<=t.p2)return r=t,!0})),r){var p=.8*(r.p2-r.p1),a=1;o-r.p1>p&&(a=1.3),this.prop.bodyNode.setScale(e(a,a,1)),this.prop.setSpriteFrame(this.prop.bodyNode,r.icon)}else s.e("exp num:"+o+" not in prop table")},n}(p))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/Prop701.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./AnimationCtrl.ts"],(function(t){"use strict";var n,o,i,a,r,c,e,s,p;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,i=t._decorator,a=t.find,r=t.v3,c=t.Animation,e=t.Component},function(t){s=t.cocosUtil},function(t){p=t.AnimationCtrl}],execute:function(){var l;o._RF.push({},"7b3c0Dk5rJItYvaImNFjUUe","Prop701",void 0);var u=i.ccclass;i.property,t("Prop701",u("Prop701")(l=function(t){function o(){for(var n,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(n=t.call.apply(t,[this].concat(i))||this).prop=void 0,n.notContact=void 0,n.animationCtrl=void 0,n}n(o,t);var i=o.prototype;return i.init=function(t){var n=this;this.prop=t,this.notContact=!0,this.animationCtrl=s.addComponentOnce(a("ani",this.node),p),this.animationCtrl.node.active=!0,this.animationCtrl.playAnimationOnce("1",(function(){n.animationCtrl.playAnimation("2",!0),n.notContact=!1})),this.prop.bodyNode.scale=r(0,0,1),this.prop.bodyNode.getComponent(c).play("boxAni")},i.contactStart=function(){this.animationCtrl.node.active=!1},o}(e))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/PropInfoLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./localization.ts"],(function(t){"use strict";var e,i,o,r,n,a,l,s,p,u,c,f,b,m,h,y,g,d,N,_;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){n=t.cclegacy,a=t._decorator,l=t.Node,s=t.Label,p=t.RichText,u=t.find,c=t.Vec3,f=t.UITransform},function(t){b=t.constants},function(t){m=t.msgac},function(t){h=t.designManager},function(t){y=t.eventManager},function(t){g=t.UserData},function(t){d=t.PropItemPrefab},function(t){N=t.BaseUILayer},function(t){_=t.localizeManager}],execute:function(){var L,I,w,v,z,P,W,T,C,D,B,A,k,E,F,H,U,S,R,M,O,q,V,x,j,G,K;n._RF.push({},"0e500nZEB1BLK5g1Nf5CtGr","PropInfoLayer",void 0);var Z=a.ccclass,J=a.property;t("PropInfoLayer",(L=Z("PropInfoLayer"),I=J({type:l,tooltip:"道具节点"}),w=J({type:l,tooltip:"按钮"}),v=J({type:l,tooltip:"属性图标"}),z=J({type:s,tooltip:"属性"}),P=J({type:s,tooltip:"属性值"}),W=J({type:s,tooltip:"装备详情"}),T=J({type:s,tooltip:"装备名字"}),C=J({type:s,tooltip:"套装名字"}),D=J({type:p,tooltip:"3套属性"}),B=J({type:p,tooltip:"5套属性"}),A=J({type:s,tooltip:"套装数量"}),k=J({type:l,tooltip:"套装节点"}),L((H=e((F=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,o(e,"propItem",H,r(e)),o(e,"btnWear",U,r(e)),o(e,"attrIcon",S,r(e)),o(e,"attrlabel",R,r(e)),o(e,"attrNumLab",M,r(e)),o(e,"propInfoLab",O,r(e)),o(e,"propNameLab",q,r(e)),o(e,"suitNameLab",V,r(e)),o(e,"suitAttr3",x,r(e)),o(e,"suitAttr5",j,r(e)),o(e,"suitNum",G,r(e)),o(e,"suitNode",K,r(e)),e._propId=0,e._propFlag=0,e._weaponLv=0,e}i(e,t);var n=e.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),this._propId=this.layerData.propId,this._propFlag=this.layerData.flag,this._weaponLv=this.layerData.weaponLv,u("ui_d/ui_bt/Label",this.node).localize("title",b.layers.PropInfoLayer);var e=h.getRowById(b.tableName.prop,this._propId);if(e.atk>0){this.setSpriteFrame2(this.attrIcon,"heroLayer/ui_gj",null,b.bundles.wwqVec);var i=e.atk;this._weaponLv>0&&(i=g.getInstance().weaponOptLvEffect(i,this._weaponLv)),this.attrNumLab.string="+"+i,this.attrNumLab.color=b.colors.blue.parseColor(),this.attrlabel.string=_._localize(null,"atk",b.catName.common)}else e.hp>0&&(this.attrNumLab.string="+"+e.hp,this.setSpriteFrame2(this.attrIcon,"heroLayer/ui_sm",null,b.bundles.wwqVec),this.attrlabel.string=_._localize(null,"hp",b.catName.common),this.attrNumLab.color=b.colors.green.parseColor());this.propInfoLab.node.localizeInfo(e.id,b.catName.propSystem),this.propNameLab.node.localizeName(e.id,b.catName.propSystem),this.propItem.getComponent(d).setView(this._propId,0,d.Type_HideNum|d.Type_ShowType),this.btnWear.off(l.EventType.TOUCH_END,this.unWearProp,this),this.btnWear.off(l.EventType.TOUCH_END,this.wearProp,this),this._propFlag&d.Type_ToWear?(this.btnWear.getChildByName("Label").getComponent(s).string=_._localize(null,"equip",b.layers.PropInfoLayer),this.setSpriteFrame2(this.btnWear,"btnres/ui_yellow",null,b.bundles.common),this.btnWear.on(l.EventType.TOUCH_END,this.wearProp,this)):this._propFlag&d.Type_UnWear?(this.btnWear.getChildByName("Label").getComponent(s).string=_._localize(null,"unequip",b.layers.PropInfoLayer),this.btnWear.on(l.EventType.TOUCH_END,this.unWearProp,this),this.setSpriteFrame2(this.btnWear,"btnres/btn_purple",null,b.bundles.common)):this.btnWear.active=!1;var o=e.suit_id;if(o){this.suitNode.active=!0;var r=h.getRowById(b.tableName.suit,o);this.suitNameLab.node.localizeName(o,b.tableName.suit);var n=g.getInstance().getSuitNum(e);this.suitNum.string="("+n+"/5)";var a=function(t,e,i,o){return"<color="+(n>=t?e:i)+">"+o+"</color>"},p="";r.effectAtk_3>0&&(p+=a(3,"#ffffff","#4c5061",_._localize(null,"atk",b.catName.common))+a(3,"#1096fd","#4c5061"," +"+r.effectAtk_3+"%")),r.effectHP_3>0&&(""!=p&&(p+=" "),p+=a(3,"#ffffff","#4c5061",_._localize(null,"hp2",b.catName.common))+a(3,"#38ff38","#4c5061"," +"+r.effectHP_3+"%")),this.suitAttr3.string=p;var c="";r.effectAtk_5>0&&(c+=a(5,"#ffffff","#4c5061",_._localize(null,"atk",b.catName.common))+a(5,"#1096fd","#4c5061"," +"+r.effectAtk_5+"%")),r.effectHP_5>0&&(""!=c&&(c+=" "),c+=a(5,"#ffffff","#4c5061",_._localize(null,"hp2",b.catName.common))+a(5,"#38ff38","#4c5061"," +"+r.effectHP_5+"%")),this.suitAttr5.string=c}else this.suitNode.active=!1},n.start=function(){this.suitNum.node.position=new c(this.suitNameLab.node.position.x+this.suitNameLab.node.getComponent(f).width+10,this.suitNameLab.node.position.y,this.suitNameLab.node.position.z)},n.initBtnInfo=function(){},n.wearProp=function(){var t=h.getRowById(b.tableName.prop,this._propId);g.getInstance().setWearProp(t),y.send(m.wearDrop),this.onClose()},n.unWearProp=function(){var t=h.getRowById(b.tableName.prop,this._propId);g.getInstance().unWearProp(t),y.send(m.wearDrop),this.onClose()},n.onClose=function(){this.closeLayer()},e}(N)).prototype,"propItem",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(F.prototype,"btnWear",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=e(F.prototype,"attrIcon",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(F.prototype,"attrlabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(F.prototype,"attrNumLab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(F.prototype,"propInfoLab",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(F.prototype,"propNameLab",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(F.prototype,"suitNameLab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(F.prototype,"suitAttr3",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(F.prototype,"suitAttr5",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(F.prototype,"suitNum",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(F.prototype,"suitNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=F))||E));n._RF.pop()}}}));

System.register("chunks:///_virtual/PropInfoLayer2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./designManager.ts","./BaseLayer.ts"],(function(t){"use strict";var o,e,n,i,a,r,s;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,i=t.find},function(t){a=t.constants},function(t){r=t.designManager},function(t){s=t.BaseLayer}],execute:function(){var c;e._RF.push({},"a0b33/wThhFnLP+QJRzeEWB","PropInfoLayer2",void 0);var p=n.ccclass;n.property,t("PropInfoLayer2",p("PropInfoLayer2")(c=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this)},n.onEnable=function(){t.prototype.onEnable.call(this)},n.onDisable=function(){t.prototype.onDisable.call(this)},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.initUI=function(){var t=r.getRowById(a.tableName.prop,this.layerData.id);this.getNodeByPath("ui/info").localizeInfo(t.id,a.catName.propSystem),this.getNodeByPath("ui/name/text").localizeName(t.id,a.catName.propSystem),this.setPropItem(t.id,this.getNodeByPath("ui/propItem/icon"),0,this.getNodeByPath("ui/propItem/bg"));var o=this.getNodeByPath("ui/propItem/num");null!=this.layerData.num?(o.active=!0,this.setString(i("val",o),this.layerData.num)):o.active=!1},n.processEvent=function(t,o){},n.onButtonClick=function(t,o){},n.onClickBg=function(){this.closeLayer()},e}(s))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/PropItemPrefab.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./constants.ts","./audioManager.ts","./designManager.ts","./BaseUILayer.ts"],(function(e){"use strict";var t,n,i,o,r,p,a,s,c,l,u,y,h,g,d,b,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.createClass},function(e){p=e.cclegacy,a=e._decorator,s=e.Sprite,c=e.Node,l=e.Label,u=e.v3,y=e.UITransform},function(e){h=e.myLog},function(e){g=e.constants},function(e){d=e.audioManager},function(e){b=e.designManager},function(e){f=e.BaseUILayer}],execute:function(){var m,v,I,_,T,w,L,S,F,P,U,B,C,z;p._RF.push({},"b4670hainVGb5mnYowtXuj5","PropItemPrefab",void 0);var N=a.ccclass,D=a.property;e("PropItemPrefab",(m=N("PropItemPrefab"),v=D({type:s,tooltip:"图标"}),I=D({type:s,tooltip:"图标背景"}),_=D({type:c,tooltip:"灰色遮罩"}),T=D({type:s,tooltip:"图标背景"}),w=D({type:l,tooltip:"数量"}),m(((z=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),p=0;p<n;p++)r[p]=arguments[p];return t=e.call.apply(e,[this].concat(r))||this,i(t,"icon",F,o(t)),i(t,"bg",P,o(t)),i(t,"greybg",U,o(t)),i(t,"typeIcon",B,o(t)),i(t,"numLabel",C,o(t)),t._propId=0,t._propFlag=0,t}n(t,e);var p=t.prototype;return p.start=function(){},p.setView=function(e,n,i){void 0===i&&(i=0),this._propId=e;var o=b.getRowById(g.tableName.prop,e),r=this,p=function(e){r.setImageCustomSize(e,95)};if(this.node.off(c.EventType.TOUCH_END,this.openInfo,this),i&t.Type_UnKnow)return this.numLabel.string="x??",this.setSpriteFrame2(this.icon.node,"prop/prop_unknow",p,g.bundles.icon),this.greybg.active=!1,void(this.typeIcon.node.active=!1);if(!o)return this.setSpriteFrame2(this.bg.node,"heroLayer/propbg",null,g.bundles.wwqVec),this.setSpriteFrame2(this.icon.node,"prop/prop_seat_"+n,p,g.bundles.icon),this.numLabel.node.active=!1,this.greybg.active=!1,void(this.typeIcon.node.active=!1);var a="prop/"+o.icon;return 11==o.type&&(a="weapon/"+b.getRowById(g.tableName.weapon,o.weaponid).icon),this.setSpriteFrame2(this.bg.node,"prop/propbg"+o.quality,null,g.bundles.icon),this.setSpriteFrame2(this.typeIcon.node,"prop/propType"+o.quality,null,g.bundles.icon),this.setSpriteFrame2(this.icon.node,a,p,g.bundles.icon),i&t.Type_UnTouch||8!=o.type&&11!=o.type||this.node.on(c.EventType.TOUCH_END,this.openInfo,this),i&t.Type_OnlyIcon?(this.bg.node.active=!1,this.greybg.active=!1,this.typeIcon.node.active=!1,void(this.numLabel.node.active=!1)):i&t.Type_BigIcon?(this.greybg.active=!1,this.typeIcon.node.active=!1,this.bg.node.active=!1,this.node.scale=u(3,3,3),void(this.numLabel.node.active=!1)):(this.numLabel.string="X"+n,this._propFlag=i,i&t.Type_HideNum&&(this.numLabel.node.active=!1),i&t.Type_Grey?this.greybg.active=!0:this.greybg.active=!1,void(i&t.Type_ShowType?this.typeIcon.node.active=!0:this.typeIcon.node.active=!1))},p.openInfo=function(){h.i("点击装备"),d.playEffect("btnClick"),this.openLayer(g.layers.PropInfoLayer,{propId:this._propId,flag:this._propFlag})},p.setScale=function(e){var t=this.bg.getComponent(y).width,n=this.bg.getComponent(y).height,i=e/t;this.node.scale=u(i,i,1),this.node.getComponent(y).width=t*i,this.node.getComponent(y).height=n*i},p.changeBg=function(e,t){this.setSpriteFrame2(this.bg.node,e,null,t)},r(t,[{key:"propId",get:function(){return this._propId}}]),t}(f)).Type_HideNum=1,z.Type_UnWear=2,z.Type_ToWear=4,z.Type_Bless=8,z.Type_UnTouch=16,z.Type_Grey=32,z.Type_ShowType=64,z.Type_UnKnow=128,z.Type_BigIcon=256,z.Type_OnlyIcon=512,F=t((S=z).prototype,"icon",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(S.prototype,"bg",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(S.prototype,"greybg",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(S.prototype,"typeIcon",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(S.prototype,"numLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=S))||L));p._RF.pop()}}}));

System.register("chunks:///_virtual/PropSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./resManager.ts","./mapModel.ts","./UserData.ts","./BaseLayer.ts","./NodePoolUtil.ts","./Prop.ts","./myLog.ts"],(function(o){"use strict";var e,r,t,n,i,a,s,p,c,d,l,f,u,y,m,P,g,h;return{setters:[function(o){e=o.inheritsLoose},function(o){r=o.cclegacy,t=o._decorator,n=o.Node,i=o.UITransform,a=o.Prefab,s=o.Vec2},function(o){p=o.cocosUtil},function(o){c=o.utilTools},function(o){d=o.constants},function(o){l=o.designManager},function(o){f=o.resManager},function(o){u=o.mapModel},function(o){y=o.UserData},function(o){m=o.BaseLayer},function(o){P=o.NodePoolUtil},function(o){g=o.Prop},function(o){h=o.myLog}],execute:function(){var b;r._RF.push({},"da5bcFxzQ1DAoJmyXVA6IfZ","PropSystem",void 0);var v=t.ccclass;t.property,o("PropSystem",v("PropSystem")(b=function(o){function r(){for(var e,r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return(e=o.call.apply(o,[this].concat(t))||this).idPropLayerObj={},e.idPrefabObj={},e}e(r,o);var t=r.prototype;return t.onLoad=function(){o.prototype.onLoad.call(this)},t.onEnable=function(){o.prototype.onEnable.call(this)},t.onDestroy=function(){o.prototype.onDestroy.call(this)},t.getPropLayerNameById=function(o){return"propLayer"+o},t.getPropLayerById=function(o){var e=this.idPropLayerObj[o];e||((e=new n(this.getPropLayerNameById(o))).addComponent(i),e.setPosition(0,0),e.parent=this.node,this.idPropLayerObj[o]=e,e.addComponent(P).init(this.idPrefabObj[o]));return e},t.saveDataBefore=function(){c.forArr(this.node.children,(function(o){o.getComponent(P).forEachUseNode((function(o){var e=o.getComponent(g);e.id!=d.propIds.boxMonsterCoin||e.playerGetProp()}))}))},t.getSaveData=function(){var o={arr:[]};return c.forArr(this.node.children,(function(e){e.getComponent(P).forEachUseNode((function(e){var r=e.getComponent(g);if(r.id!=d.propIds.boxMonsterCoin){var t={};t.id=r.id,t.worldPos=p.convertToWorldSpace(e),t.extraObj=r.extraObj,o.arr.push(t)}else r.playerGetProp()}))})),o},t.loadSaveData=function(o){var e=this;c.forArr(o.arr,(function(o){e.addProp(o.id,o.worldPos,o.extraObj)}))},t.addProp=function(o,e,r){var t=this,n=this.getPropLayerById(o).getComponent(P),i=function(){var t=n.getNode();p.addComponentOnce(t,g).init(o,e,r),o==d.propIds.exp&&h.d("init exp, num:"+r.num+", pos:"+e)};if(this.idPrefabObj[o])i(),o==d.propIds.exp&&h.d("增加经验2:"+r.num);else{var s="prop"+o;f.loadAsset(d.bundles.prefab,"prop/"+s+"/"+s,a,null,(function(e,a){p.isValid(t)&&(t.idPrefabObj[o]=a,n.init(a),i(),o==d.propIds.exp&&h.d("增加经验1:"+r.num))}))}},t.getProp=function(o,e,r){if(void 0===e&&(e=1),!(u.player.hp<=0)){var t=l.getRowById(d.tableName.prop,o);switch(o){case d.propIds.exp:u.mapSystem.addExp(e+u.skillSystem.getSkill2AddExp());break;case d.propIds.coin:var n=u.skillSystem.getSkill2AddCoin();if(u.mapSystem.addCoin(e+n),r&&r.pos){var i=u.skillSystem.getSkillCompomentByType(11);if(i&&i.skillUtil){var a={pos:r.pos,num:e,addCoin:n};i.skillUtil.creatTower(a)}}break;case d.propIds.magnet:u.propSystem.forAllPropById(d.propIds.exp,(function(o){o.contactPlayer()}));break;case d.propIds.addHpPercent:u.player.addHpPercent(t.p1);break;case d.propIds.bomb:u.mapSystem.bomb();break;case d.propIds.box2:u.player.hp>0&&u.mapLayer.popLayer(d.layers.LuckyDrawLayer);break;case d.propIds.boxMonsterCoin:u.mapSystem.addCoin(1);break;case d.propIds.diamond:y.getInstance().useBaoShi(e,!0)}8!=t.type&&11!=t.type||u.equipIdArr.push(o)}},t.getPropNums=function(o){var e=0;return this.forAllPropById(o,(function(o){e++})),e},t.forAllPropById=function(o,e){this.getPropLayerById(o).getComponent(P).forEachUseNode((function(o){var r=o.getComponent(g);r.isFollowPlayer||e(r)}))},t.forVisiblePropCollider=function(o){c.forArr(this.node.children,(function(e){c.forArr(e.children,(function(e){if(e.active&&u.isInScreenVisible(e)){var r=e.getComponent(g);r.collider&&o(r)}}))}))},t.forVisiblePropContact=function(o){c.forArr(this.node.children,(function(e){c.forArr(e.children,(function(e){if(e.active&&u.isInScreenVisible(e)){var r=e.getComponent(g);r.collider||o(r)}}))}))},t.forAllPropContact=function(o){c.forArr(this.node.children,(function(e){c.forArr(e.children,(function(e){if(e.use){var r=e.getComponent(g);r.collider||o(r)}}))}))},t.recyclePropNode=function(o){var e=o.getComponent(g);this.getPropLayerById(e.id).getComponent(P).recycleNode(o)},t.updateLogic=function(o){for(var e in this.idPropLayerObj){this.getPropLayerById(parseFloat(e)).getComponent(P).forEachUseNode((function(o){var e=s.distance(o.getPosition(),u.player.node.getPosition()),r=o.getComponent(g);if(e<=u.dataRadius||r.propUtil&&r.propUtil.autoGet)return o.active=!0,void r.doDisPlayerGet(e);r.isFollowPlayer||(o.active=!1)}))}},r}(m))||b);r._RF.pop()}}}));

System.register("chunks:///_virtual/PyramidDrawLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./tyqSDK.ts","./constants.ts","./designManager.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(t){"use strict";var e,n,i,a,r,s,o,c,d,u,m,l,h,p,y,g,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,o=t.Node,c=t.Label,d=t.instantiate,u=t.v3},function(t){m=t.sdkManager},function(t){l=t.tyqSDK},function(t){h=t.constants},function(t){p=t.designManager},function(t){y=t.UserData},function(t){g=t.PropItemPrefab},function(t){f=t.BaseUILayer}],execute:function(){var I,w,D,_,b,v,x,L,T,S,$;r._RF.push({},"0be3fNof/RKgZVm96nTa8+r","PyramidDrawLayer",void 0);var R=s.ccclass,C=s.property;t("PyramidDrawLayer",(I=R("PyramidDrawLayer"),w=C({type:o}),D=C({type:o}),_=C({type:o}),b=C({type:c}),I((L=e((x=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"btnClose",L,a(e)),i(e,"propItem",T,a(e)),i(e,"itemLayer",S,a(e)),i(e,"coinLabel",$,a(e)),e.items=[],e._index=0,e._dtTime=0,e._isStartRun=!1,e._endIndex=0,e._drawItemArr=[],e._isDoubleDraw=!1,e}n(e,t);var r=e.prototype;return r.onLoad=function(){},r.onDisable=function(){t.prototype.onDisable.call(this)},r.onDestroy=function(){t.prototype.onDestroy.call(this)},r.start=function(){this.initItems()},r.closeBless=function(){this.closeLayer()},r.initItems=function(){for(var t=p.getRowsByType(h.tableName.CNTM,3),e=0;e<t.length;e++){this._drawItemArr.push(t[e].award);var n=d(this.propItem);this.itemLayer.getChildByName("node"+(e+1)).addChild(n),this.items[e]=n,n.position=u(0,0,0),n.getComponent(g).setView(t[e].award[0][0],t[e].award[0][1],g.Type_UnTouch),n.getComponent(g).setScale(109),n.getChildByName("xuanzhong").active=!1}this.initItemState()},r.initItemState=function(){for(var t=0;t<10&&t<this.items.length;t++){var e=this.items[t];e.getChildByName("grayMask").active=1==y.getInstance().$pyramidState[t],e.getChildByName("xuanzhong").active=!1}var n=p.config.jinzita;this.coinLabel.string=n[y.getInstance().$pyramidDrawTime]},r.update=function(t){if(this._isStartRun&&(this._dtTime+=t,this._dtTime>.1)){this._dtTime=0,this._index++;for(var e=0;e<10;e++)this.items[e].getChildByName("xuanzhong").active=!1;var n=this.getDrawIndex(this._index,this._index>=this._endIndex);if(this.items[n].getChildByName("xuanzhong").active=!0,this._index>=this._endIndex){this._isStartRun=!1;var i=this._drawItemArr[n][0],a={Id:i[0],Num:this._isDoubleDraw?2*i[1]:i[1]};y.getInstance().getRewardProp([a]),this.openLayer(h.layers.RewardLayer,{propArr:[a]}),y.getInstance().setPyramidState(n),y.getInstance().$pyramidDrawTime++,y.getInstance().$pyramidDrawTime>=10&&(y.getInstance().$pyramidDrawTime=0,y.getInstance().$pyramidState=[0,0,0,0,0,0,0,0,0,0]),this.initItemState()}}},r.getDrawIndex=function(t,e){if(9==y.getInstance().$pyramidDrawTime)return 0;for(var n=[],i=e?1:0;i<y.getInstance().$pyramidState.length;i++)0==y.getInstance().$pyramidState[i]&&n.push(i);return n[t%n.length]},r.startDraw=function(){if(!this._isStartRun){var t=p.config.jinzita;y.getInstance().checkAndUseBaoshi(t[y.getInstance().$pyramidDrawTime])?(l.eventSendCustomEvent("庆典消耗钻石——"+t[y.getInstance().$pyramidDrawTime]),this._isStartRun=!0,this._isDoubleDraw=!1,9==y.getInstance().$pyramidDrawTime?this._endIndex=10:this._endIndex=Math.floor(10*Math.random())+20-y.getInstance().$pyramidDrawTime,this._index=0):(this.toast("钻石不足"),this.openLayer(h.layers.RewardItemLayer,{propId:801,num:p.config.adDiamond}))}},r.doubleDraw=function(){var t=this;m.openAd("参与庆典",(function(e){if(1==e){if(t._isStartRun)return;t._isStartRun=!0,9==y.getInstance().$pyramidDrawTime?t._endIndex=10:t._endIndex=Math.floor(10*Math.random())+20-y.getInstance().$pyramidDrawTime,t._index=0}}))},e}(f)).prototype,"btnClose",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(x.prototype,"propItem",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=e(x.prototype,"itemLayer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=e(x.prototype,"coinLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=x))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/RedPointLogicMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./UserData.ts","./eventManager.ts","./GParam.ts","./MapWrap.ts","./resManager.ts"],(function(t){"use strict";var e,i,s,a,n,r,h,o,c,d,u,f,_,p;return{setters:[function(t){e=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,s=t.find,a=t.Prefab,n=t.instantiate,r=t.UITransform,h=t.v3},function(t){o=t.constants},function(t){c=t.msgac},function(t){d=t.UserData},function(t){u=t.eventManager},function(t){f=t.default},function(t){_=t.MapWrap},function(t){p=t.resManager}],execute:function(){t({RPointMask:void 0,RedpointPos:void 0}),i._RF.push({},"0faa7hvRx1OMqT4CCzxOcdG","RedPointLogicMgr",void 0);var l,g,k=/^[0-9]+.?[0-9]*$/,v=t("RED_POINT_NAME","red_point");t("RED_POINT_LABEL_NAME","label");!function(t){t[t.RPM_Client=300]="RPM_Client",t[t.RPM_PropWear=301]="RPM_PropWear",t[t.RPM_BlessProp=302]="RPM_BlessProp"}(l||(l=t("RPointMask",{}))),function(t){t[t.Main=0]="Main",t[t.right=1]="right"}(g||(g=t("RedpointPos",{})));t("INVALID_VALUE_ZERO",0);var P=t("INVALID_VALUE",-1);t("INVALID_STRING_VALUE","-1");t("RedPointLogicMgr",function(){function t(){this._redPointMask=void 0,this._waitSends=void 0,this._waitChecks=void 0,this._updateHandler=P,this._unlockMasks=void 0,this._targets=void 0,this._targetWraps=void 0,this._masks=void 0}t.ins=function(){return null==this._instance&&(this._instance=new t,this._instance.initGame()),this._instance};var i=t.prototype;return i.update=function(){this.updateCheck(),this.updateVisit(),this.checkState()},i.initGame=function(){this.initEvent(),this._redPointMask=new _,this._waitSends=[],this._waitChecks=[],this._unlockMasks=[],this._targets=new _,this._targetWraps=new _,this._masks=new _,this.stopUpdate();for(var t=0,e=Object.keys(l);t<e.length;t++){var i=e[t];k.test(i)&&this._waitChecks.push(parseInt(i))}this.checkState()},i.initEvent=function(){u.on(c.redPointEvent,this.onCMSGRPValueSetting,this)},i.updateState=function(){for(var t=0,e=Object.keys(l);t<e.length;t++){var i=e[t];if(k.test(i))this._waitChecks.indexOf(parseInt(i))===P&&this._waitChecks.push(parseInt(i))}this.checkState()},i.on=function(t,i){var s,a=this._targets.get(t.uuid);a||(a=[],this._targets.set(t.uuid,a),this._targetWraps.set(t.uuid,t)),(s=a).push.apply(s,i);for(var n,r=e(i);!(n=r()).done;){for(var h,o=n.value,c=!1,d=e(o.mask);!(h=d()).done;){var u=h.value,f=this._masks.get(u);f||(f=[],this._masks.set(u,f)),f.indexOf(t)==P&&f.push(t),c=c||this._redPointMask.get(u)}this.setRPointView(t,o.subPath,c,o.effectType,o.posType,o.cb)}},i.off=function(t){var i=this._targets.get(t.uuid);if(i){for(var s,a=e(i);!(s=a()).done;)for(var n,r=s.value,h=e(r.mask);!(n=h()).done;){var o=n.value,c=this._masks.get(o);if(c){var d=c.indexOf(t);d!=P&&c.splice(d,1),0==c.length&&this._masks.delete(o)}}this._targets.delete(t.uuid),this._targetWraps.delete(t.uuid)}},i.loginOut=function(){this.stopUpdate(),u.offWithSender(this),this._waitChecks=[],this._waitSends=[],this._targets.clear(),this._targetWraps.clear(),this._masks.clear()},i.sendValueSettingMsg=function(t,e,i){var s={mask:t,value:e,forceStop:i};this.onCMSGRPValueSetting(this,new f(s))},i.sendValuesSettingMsgs=function(t,e,i){for(var s=0;s<t.length;s++)this.sendValueSettingMsg(t[s],e,i)},i.timingCheck=function(){},i.onCMSGRPValueSetting=function(t,e){var i=e.get();if(1==i.value){var s=this._waitChecks.indexOf(i.mask);if(s!=P&&this._waitChecks.splice(s,1),this._redPointMask.get(i.mask))return;if(this._redPointMask.set(i.mask,i.value),this._waitSends.indexOf(i.mask)!=P)return;this._waitSends.push(i.mask)}else if(1==i.forceStop){var a=this._waitChecks.indexOf(i.mask);if(a!=P&&this._waitChecks.splice(a,1),this._redPointMask.set(i.mask,i.value),this._waitSends.indexOf(i.mask)!=P)return;this._waitSends.push(i.mask)}else this._waitChecks.indexOf(i.mask)==P&&this._waitChecks.push(i.mask);this.checkState()},i.startUpdate=function(){this._updateHandler==P&&(this._updateHandler=setInterval(this.update.bind(this),100))},i.stopUpdate=function(){P!=this._updateHandler&&(clearInterval(this._updateHandler),this._updateHandler=P)},i.checkState=function(){this._waitChecks.length>0||this._waitSends.length>0?this._updateHandler==P&&this.startUpdate():0==this._waitChecks.length&&0==this._waitSends.length&&this._updateHandler!=P&&this.stopUpdate()},i.updateCheck=function(){if(0!=this._waitChecks.length){var t=this._waitChecks.shift(),e=!0;if(e)switch(e=!1,t){case l.RPM_Client:break;case l.RPM_PropWear:e=d.getInstance().checkBestPropToWear();break;case l.RPM_BlessProp:e=d.getInstance().checkPropCanBless();break;default:e=!1}this._redPointMask.get(t)!=e&&(this._redPointMask.set(t,e),this._waitSends.indexOf(t)==P&&this._waitSends.push(t))}},i.updateVisit=function(){if(0!=this._waitSends.length){var t=this._waitSends.shift(),i=this._redPointMask.get(t),s=this._masks.get(t);if(s&&0!=s.length)for(var a,n=e(s);!(a=n()).done;){var r=a.value,h=this._targets.get(r.uuid);if(!h)return;for(var o,c=e(h);!(o=c()).done;){var d=o.value;if(d&&d.mask.indexOf(t)!=P)if(1==i)this.setRPointView(r,d.subPath,i,d.effectType,d.posType,d.cb);else{for(var u,f=!1,_=e(d.mask);!(u=_()).done;){var p=u.value;if(this._redPointMask.get(p)){f=!0;break}}this.setRPointView(r,d.subPath,f,d.effectType,d.posType,d.cb)}}}}},i.setRPointView=function(t,e,i,c,d,u){var f=t;if(e&&(f="string"==typeof e?s(e,t):e),f){var _=f.getChildByName(v);i?_?_.active=!0:(p.loadAsset(o.bundles.prefab,"redpoint/gth",a,(function(){}),(function(t,e){var i=n(e),s=f.getComponent(r)||f.addComponent(r);switch(d){case g.Main:i.position=h(s.width*(1-s.anchorX),s.height*(1-s.anchorY)-20,1);break;case g.right:i.position=h(s.width*(1-s.anchorX)-30,s.height*(1-s.anchorY)-0,1);break;default:i.position=h(s.width*(1-s.anchorX)-25,s.height*(1-s.anchorY)-10,1)}i.name=v,f.addChild(i)})),u&&u(f)):_&&(_.active=!1)}},i.getMaskRedpointState=function(t){for(var e=0;e<t.length;e++){var i=this._redPointMask.get(t[e]);if(i)return i}return!1},t}())._instance=null,i._RF.pop()}}}));

System.register("chunks:///_virtual/redPointManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./eventManager.ts","./SingleInstance.ts"],(function(e){"use strict";var t,n,r,i,a,s,o;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e.sys},function(e){i=e.constants},function(e){a=e.msgac},function(e){s=e.eventManager},function(e){o=e.SingleInstance}],execute:function(){n._RF.push({},"d76b4ECTxFBeJW28SdyuHMm","redPointManager",void 0);e("redPointManager",function(e){function n(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).key=i.gameName+"_redPoint",t}t(n,e);var o=n.prototype;return o.getRedPointByLayer=function(e){var t=r.localStorage.getItem(this.key),n=!1;t?t=JSON.parse(t):(t={},n=!0);var i=t[e];return i||(i={},t[e]=i,n=!0),n&&r.localStorage.setItem(this.key,JSON.stringify(t)),i},o.setRedPointByLayer=function(e,t){var n=r.localStorage.getItem(this.key);(n=n?JSON.parse(n):{})[e]=t,r.localStorage.setItem(this.key,JSON.stringify(n)),s.send(a.refreshRedPoint)},o.hasRedPointValue=function(e,t,n){var r=this.getRedPointByLayer(e);if(null!=n){if(Array.isArray(r[t]))if(-1!=r[t].indexOf(n))return!0;return!1}return Array.isArray(r[t])?r[t].length>0:!!r[t]},o.addRedPointValue=function(e,t,n){var r=this.getRedPointByLayer(e);n?(Array.isArray(r[t])||(r[t]=[]),-1==r[t].indexOf(n)&&(r[t].push(n),this.setRedPointByLayer(e,r))):(r[t]=1,this.setRedPointByLayer(e,r))},o.removeRedPointValue=function(e,t,n){var r=this.getRedPointByLayer(e),i=r[t];if(null!=n){if(Array.isArray(i)){var a=i.indexOf(n);if(-1!=a)return r[t].splice(a,1),this.setRedPointByLayer(e,r),!0}return!1}return!!i&&(delete r[t],this.setRedPointByLayer(e,r),!0)},o.clearRedPointLayer=function(e,t){var n=this.getRedPointByLayer(e);null==t?this.setRedPointByLayer(e,void 0):(delete n[t],this.setRedPointByLayer(e,n))},n}(o).getInstance());n._RF.pop()}}}));

System.register("chunks:///_virtual/RenderChildBatch.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts"],(function(e){"use strict";var r,t,n,i,o;return{setters:[function(e){r=e.inheritsLoose},function(e){t=e.cclegacy,n=e._decorator,i=e.UIRenderer},function(e){o=e.cocosUtil}],execute:function(){var a;t._RF.push({},"90cc8pku5RGPpMncsL+g+VD","RenderChildBatch",void 0);var d=n.ccclass;n.property,e("RenderChildBatch",d("RenderChildBatch")(a=function(e){function t(){for(var r,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(r=e.call.apply(e,[this].concat(n))||this).pathArr=[],r.path2RenderArr=new Map,r.rootNodeArr=[],r}r(t,e);var n=t.prototype;return n.addRootItemNode=function(e){-1==this.rootNodeArr.indexOf(e)&&(this.pauseRender(e,""),this.rootNodeArr.push(e))},n.pauseRender=function(e,r){var t=this;if(o.isValid(e)){var n=r+e.name,a=e.getComponent(i);if(a){-1==this.pathArr.indexOf(n)&&this.pathArr.push(n);var d=this.path2RenderArr.get(n);d||(d=[],this.path2RenderArr.set(n,d)),-1==d.indexOf(a)&&(a._realRender||(a._realRender=a._render,a._render=function(){}),d.push(a))}e.children.forEach((function(e){t.pauseRender(e,n+"/")}))}},n.removeRootItemNode=function(e){this.removeRender(e,"");var r=this.rootNodeArr.indexOf(e);r>=0&&this.rootNodeArr.splice(r,1)},n.removeRender=function(e,r){var t=this;if(o.isValid(e)){var n=r+e.name,a=this.path2RenderArr.get(n);if(a){var d=e.getComponent(i);if(d){d._realRender&&(d._render=d._realRender,delete d._realRender);var s=a.indexOf(d);-1!=s&&a.splice(s,1)}}e.children.forEach((function(e){t.removeRender(e,n+"/")}))}},n.updateAssembler=function(e){},n.postUpdateAssembler=function(e){var r=this;this.pathArr.forEach((function(t){var n=r.path2RenderArr.get(t),i=[];n.forEach((function(r){o.isValid(r)&&o.isValid(r.node)&&(i.push(r),r.node.activeInHierarchy&&r._renderFlag&&r._assembler&&r._realRender(e))})),r.path2RenderArr.set(t,i)}))},n.onDestroy=function(){var e=this;this.pathArr.forEach((function(r){e.path2RenderArr.get(r).forEach((function(e){o.isValid(e)&&e._realRender&&(e._render=e._realRender,delete e._realRender)}))})),this.path2RenderArr=void 0,this.pathArr=void 0,this.rootNodeArr=void 0},t}(i))||a);t._RF.pop()}}}));

System.register("chunks:///_virtual/resManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts"],(function(e){"use strict";var n,t,s,a,o,r,i;return{setters:[function(e){n=e.createClass},function(e){t=e.cclegacy,s=e.assetManager,a=e.SpriteFrame,o=e.sp,r=e.Texture2D},function(e){i=e.myLog}],execute:function(){t._RF.push({},"455cfmCB5pAb4qrTZDbg6Un","resManager",void 0);var u=function(){function e(){}var t=e.prototype;return t.loadAsset=function(e,n,t,o,u){t==a?n+="/spriteFrame":t==r&&(n+="/texture");var l=s.getBundle(e);if(l&&l.get(n,t))u&&u(null,l.get(n,t));else{var d=function(){l.load(n,t,(function(e,n){o&&o(e/n)}),(function(t,s){if(t)return i.e("ResManager.loadAsset error:"+t.message,"bundleName:"+e,"path:"+n,t),void(u&&u(t));u&&u(null,s)}))};l?d():s.loadBundle(e,(function(e,n){e?u&&u(e):(l=n,d())}))}},t.loadAssetByPathArr=function(e,n,t,s,a){var o=this,r=n.length;if(r<=0)a&&a([]);else for(var i=0,u=1/r,l=new Map,d=0,f=[],c=function(c){var h=n[c];o.loadAsset(e,h,t,(function(e){if(l.set(h,e),s){var n=0;l.forEach((function(e){n+=u*e})),n>=i&&(i=n,s(n))}}),(function(e,n){d++,!e&&n&&(n.path=h,f.push(n)),d>=r&&a&&a(f)}))},h=0;h<r;h++)c(h)},t.loadAssetByBundleDirs=function(e,n,t,s,a){var o=this,r=n.length;if(r<=0)a&&a([]);else for(var i=0,u=1/r,l=new Map,d=0,f=[],c=function(c){var h=n[c];o.loadAssetByBundleDir(e,h,t,(function(e){if(l.set(h,e),s){var n=0;l.forEach((function(){n+=u*e})),n>=i&&(i=n,s(n))}}),(function(e,n){d++,!e&&n&&(n.path=h,f.push(n)),d>=r&&a&&a(f)}))},h=0;h<r;h++)c(h)},t.loadAssetByBundleDir=function(e,n,t,a,o){var r=s.getBundle(e),u=function(){r.loadDir(n,t,(function(e,n,t){a&&a(e/n,t)}),(function(e,n){e&&i.e("ResManager.loadAssetByBundleDir loadDir error:"+e.message,e),o&&o(n)}))};r?u():s.loadBundle(e,(function(e,n){e?i.e("ResManager.loadAssetByBundleDir loadBundle error:"+e.message,e):(r=n,u())}))},t.loadBundleArr=function(e,n,t){var a=e.length;if(a<=0)t&&t();else for(var o=0,r=[],i=0;i<a;i++){var u=e[i];s.loadBundle(u,(function(e,s){o++,e||r.push(s),o>=a&&t&&t(r),n&&n(o/a)}))}},t.releaseAsset=function(e){s.releaseAsset(e)},t.loadAssetConfigArr=function(e,n,t,s){var a=this;void 0===n&&(n=!1);var o=0;if(e&&e.length>0&&(o=e.length),o<=0)s&&s();else{var r=0,i=[];!function u(){var l=e[r];l?a.loadAsset(l.bundle,l.path,l.type,null,(function(e,s){!e&&s&&(i.push(s),n&&s.addRef(),l.asset=s),r++,u(),t&&t(r/o)})):s&&s(i)}()}},t.loadSpriteFrame=function(e,n,t){this.loadAsset(e,n,a,null,(function(e,n){t&&t(e,n)}))},t.loadSpineData=function(e,n,t){this.loadAsset(e,n,o.SkeletonData,null,(function(e,n){t&&t(e,n)}))},n(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();u._instance=void 0;e("resManager",u.instance),e("ResLoader",function(){function e(){this.loadedAssetArr=[]}var n=e.prototype;return n.addAsset=function(e){e&&-1==this.loadedAssetArr.indexOf(e)&&(e.addRef(),this.loadedAssetArr.push(e))},n.releaseAllAsset=function(){this.loadedAssetArr.forEach((function(e){e.decRef()})),this.loadedAssetArr=[]},e}()),e("AssetConfig",(function(){this.bundle=void 0,this.path=void 0,this.type=void 0,this.asset=void 0}));t._RF.pop()}}}));

System.register("chunks:///_virtual/RewardItemLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./audioManager.ts","./designManager.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(e){"use strict";var t,n,a,o,r,i,s,c,l,p,u,y,f,d,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,i=e._decorator,s=e.Node,c=e.find},function(e){l=e.sdkManager},function(e){p=e.constants},function(e){u=e.audioManager},function(e){y=e.designManager},function(e){f=e.UserData},function(e){d=e.PropItemPrefab},function(e){m=e.BaseUILayer}],execute:function(){var b,h,g,I,L,D,w;r._RF.push({},"9da75dBS1FHWIYJMlL73pxg","RewardItemLayer",void 0);var R=i.ccclass,v=i.property;e("RewardItemLayer",(b=R("RewardItemLayer"),h=v({type:s}),g=v({type:s}),b((D=t((L=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,a(t,"btnClose",D,o(t)),a(t,"propItem",w,o(t)),t}n(t,e);var r=t.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this)},r.onEnable=function(){var e=this.layerData.propId,t=this.layerData.num;this.propItem.getComponent(d).setView(e,t,d.Type_UnTouch),c("ui/info",this.node).localize("title",p.layers.RewardItemLayer),c("ui/btns/btnGoOn/Label",this.node).localize("cancel",p.catName.common),c("ui/btns/btnExit/Label",this.node).localize("getFree",p.catName.common)},r.getRewardProp=function(){u.playEffect("btnClick");var e={Id:this.layerData.propId,Num:this.layerData.num},t=this,n=y.getRowById(p.tableName.prop,this.layerData.propId);l.openAd("获得道具"+n.name,(function(n){1==n&&(f.getInstance().getRewardProp([e]),t.closeLayer())}))},r.onDisable=function(){e.prototype.onDisable.call(this)},r.onDestroy=function(){e.prototype.onDestroy.call(this)},r.start=function(){},r.closeLayer=function(){u.playEffect("btnClick"),e.prototype.closeLayer.call(this)},t}(m)).prototype,"btnClose",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(L.prototype,"propItem",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=L))||I));r._RF.pop()}}}));

System.register("chunks:///_virtual/RewardLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./audioManager.ts","./AnimationCtrl.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./constants.ts"],(function(t){"use strict";var n,e,o,a,i,r,s,l,c,u,p,h,y,f,d,m,b,g,w,L,v;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){i=t.cclegacy,r=t._decorator,s=t.Prefab,l=t.Node,c=t.find,u=t.UITransform,p=t.instantiate,h=t.v3,y=t.sp,f=t.macro},function(t){d=t.cocosUtil},function(t){m=t.utilTools},function(t){b=t.audioManager},function(t){g=t.AnimationCtrl},function(t){w=t.PropItemPrefab},function(t){L=t.BaseUILayer},function(t){v=t.constants}],execute:function(){var I,R,C,D,P,A,z,E,M;i._RF.push({},"beb79qFxopP26nxiIZWSe0F","RewardLayer",void 0);var T=r.ccclass,S=r.property;t("RewardLayer",(I=T("RewardLayer"),R=S({type:s}),C=S({type:l}),D=S({type:l}),I((z=n((A=function(t){function n(){for(var n,e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return n=t.call.apply(t,[this].concat(i))||this,o(n,"propItem",z,a(n)),o(n,"listLayer",E,a(n)),o(n,"yanhua",M,a(n)),n}e(n,t);var i=n.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this),c("ui/btns/btnGoOn/Label",this.node).localize("btnSure",v.catName.common),c("ui/gongxihuode",this.node).localizeImg()},i.onEnable=function(){t.prototype.onEnable.call(this),this.showReward(),this.showYanhua()},i.showReward=function(){var t=this.layerData.propArr,n=this;this.layerData.notMoveAni||this.scheduleOnce((function(){n.showGetReward(t)}),.5),this.listLayer.getComponent(u).width=Math.min(135*t.length,675);for(var e=0;e<t.length;e++){var o=t[e],a=p(this.propItem);this.listLayer.addChild(a),a.getComponent(w).setView(o.Id,o.Num,w.Type_UnTouch),a.getComponent(w).setScale(120)}},i.showYanhua=function(){var t=this,n=[h(-100,200,0),h(0,-100,0),h(150,-250,0),h(300,-500,0),h(100,-450,0)];d.schedule(this,(function(){if(!(n.length<=0)){var e=Math.random()>.5?"huang":"lan",o=.8+.2*Math.random(),a=m.getRandomItemByArr(n,!0),i=d.instantiate(t.yanhua);i.parent=t.node,i.active=!0,i.position=a,i.scale=h(o,o,1),i.getComponent(y.Skeleton).setSkin(e),d.addComponentOnce(i,g).playAnimationOnce("animation",(function(){i.parent=null}))}}),1.5,f.REPEAT_FOREVER,0,!0)},i.onDisable=function(){t.prototype.onDisable.call(this)},i.onDestroy=function(){t.prototype.onDestroy.call(this)},i.start=function(){},i.closeLayer=function(){b.playEffect("btnClick"),t.prototype.closeLayer.call(this)},n}(L)).prototype,"propItem",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(A.prototype,"listLayer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(A.prototype,"yanhua",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=A))||P));i._RF.pop()}}}));

System.register("chunks:///_virtual/RewardRedBoxLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./designManager.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(e){"use strict";var t,n,r,i,o,a,s,l,p,c,u,d,y,f,g,h,m,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.Node,l=e.Prefab,p=e.instantiate,c=e.v3,u=e.Sprite,d=e.Button},function(e){y=e.sdkManager},function(e){f=e.constants},function(e){g=e.designManager},function(e){h=e.UserData},function(e){m=e.PropItemPrefab},function(e){b=e.BaseUILayer}],execute:function(){var v,L,w,B,R,C,P,I,D;o._RF.push({},"51b53hI06BLVL3P2aPng4a3","RewardRedBoxLayer",void 0);var N=a.ccclass,k=a.property;e("RewardRedBoxLayer",(v=N("RewardRedBoxLayer"),L=k(s),w=k(s),B=k({type:l}),v((P=t((C=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,r(t,"itemProp",P,i(t)),r(t,"proplayer",I,i(t)),r(t,"propItem",D,i(t)),t}n(t,e);var o=t.prototype;return o.onLoad=function(){},o.onDisable=function(){e.prototype.onDisable.call(this)},o.onDestroy=function(){e.prototype.onDestroy.call(this)},o.start=function(){this.initList(),this.itemProp.active=!1},o.initList=function(){var e=g.getRowsByType(f.tableName.CNTM,1);this.proplayer.removeAllChildren();for(var t=0;t<e.length;t++){var n=e[t].award[0],r=p(this.itemProp);r.position=c(0,0,0),r.active=!0,this.proplayer.addChild(r);var i=p(this.propItem);i.getComponent(m).setView(n[0],0,m.Type_UnTouch|m.Type_HideNum),i.getComponent(m).changeBg("activityRes/itembg",f.bundles.wwqVec),i.getComponent(m).setScale(99),r.addChild(i),i.position=c(0,-20,0),this.addButtonHander(r.getChildByName("btnGet"),this.node,"RewardRedBoxLayer","onClickVideoGet",n[0]),h.getInstance().isHaveProp(n[0])&&(r.getChildByName("btnGet").getComponent(u).grayscale=!0,r.getChildByName("btnGet").getComponent(d).interactable=!1)}},o.onClickVideoGet=function(e,t){console.log("onClickVideoGet = ",t);var n=this;y.openAd("领取皮肤",(function(e){if(1==e){var r={Id:t,Num:1};h.getInstance().getRewardProp([r]),n.openLayer(f.layers.RewardLayer,{propArr:[r]}),n.initList()}}))},t}(b)).prototype,"itemProp",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(C.prototype,"proplayer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(C.prototype,"propItem",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=C))||R));o._RF.pop()}}}));

System.register("chunks:///_virtual/RewardSkinLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./designManager.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts"],(function(e){"use strict";var t,n,i,r,o,a,s,p,l,c,u,d,y,f,g,h,m,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.Node,p=e.Prefab,l=e.instantiate,c=e.v3,u=e.Sprite,d=e.Button},function(e){y=e.sdkManager},function(e){f=e.constants},function(e){g=e.designManager},function(e){h=e.UserData},function(e){m=e.PropItemPrefab},function(e){b=e.BaseUILayer}],execute:function(){var v,w,L,C,P,k,I,R,B;o._RF.push({},"def02ocTp1NsYQk0XOZV5Fx","RewardSkinLayer",void 0);var D=a.ccclass,N=a.property;e("RewardSkinLayer",(v=D("RewardSkinLayer"),w=N(s),L=N(s),C=N({type:p}),v((I=t((k=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,i(t,"itemProp",I,r(t)),i(t,"proplayer",R,r(t)),i(t,"propItem",B,r(t)),t}n(t,e);var o=t.prototype;return o.onLoad=function(){},o.onDisable=function(){e.prototype.onDisable.call(this)},o.onDestroy=function(){e.prototype.onDestroy.call(this)},o.start=function(){this.initList(),this.itemProp.active=!1},o.initList=function(){this.proplayer.removeAllChildren();for(var e=g.getRowsByType(f.tableName.prop,17),t=0;t<e.length;t++){var n=e[t];if(2==n.p1){var i=l(this.itemProp);i.active=!0,i.position=c(0,0,0),this.proplayer.addChild(i);var r=l(this.propItem);r.getComponent(m).setView(n.id,0,m.Type_UnTouch|m.Type_HideNum),r.getComponent(m).changeBg("activityRes/itembg",f.bundles.wwqVec),r.getComponent(m).setScale(99),i.addChild(r),r.position=c(0,-20,0),this.addButtonHander(i.getChildByName("btnGet"),this.node,"RewardSkinLayer","onClickVideoGet",n.id),h.getInstance().isHaveProp(n.id)&&(i.getChildByName("btnGet").getComponent(u).grayscale=!0,i.getChildByName("btnGet").getComponent(d).interactable=!1)}}},o.onClickVideoGet=function(e,t){console.log("onClickVideoGet = ",t);var n=this;y.openAd("获取皮肤",(function(e){if(1==e){var i={Id:t,Num:1};h.getInstance().getRewardProp([i]),n.openLayer(f.layers.RewardLayer,{propArr:[i]}),n.initList()}}))},t}(b)).prototype,"itemProp",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(k.prototype,"proplayer",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(k.prototype,"propItem",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=k))||P));o._RF.pop()}}}));

System.register("chunks:///_virtual/ScrollViewUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./RenderChildBatch.ts"],(function(t){"use strict";var e,i,s,r,h,n,o,a,l,d,c,m,f,g,v,u,p;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){s=t.cclegacy,r=t._decorator,h=t.ScrollView,n=t.UITransform,o=t.Layout,a=t.find,l=t.sys,d=t.instantiate,c=t.isValid,m=t.game,f=t.v3,g=t.tween,v=t.Component},function(t){u=t.myLog},function(t){p=t.RenderChildBatch}],execute:function(){var I;s._RF.push({},"474e7yR1ohEFZ+vBo1l4dgO","ScrollViewUtil",void 0);var w=r.ccclass;r.property,t("ScrollViewUtil",w("ScrollViewUtil")(I=function(t){function s(){for(var e,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))||this).scrollView=void 0,e.vertical=!0,e.gapX=0,e.gapY=0,e.paddingLeft=0,e.paddingRight=0,e.paddingTop=0,e.paddingBottom=0,e.contentNode=void 0,e.contentTransform=void 0,e.viewNode=void 0,e.viewWidth=void 0,e.viewHeight=void 0,e.viewTransform=void 0,e.itemUI=void 0,e.itemUITransform=void 0,e.itemUIWidth=0,e.itemUIHeight=0,e.itemUIFreeArr=[],e.startPosX=0,e.startPosY=0,e.viewNum=0,e.changeNum=1,e.maxLines=1,e.frameUpdateArr=[],e.frameTime=Math.floor(1e3/(m.getFrameRate()+10)),e.itemArr=[],e.refreshItemFunc=void 0,e.itemTween=!1,e.setDataFlag=!1,e.startIndex=0,e.stopIndex=0,e.renderChildBatch=null,e}e(s,t);var r=s.prototype;return r.onLoad=function(){var t=this;this.scrollView=this.node.getComponent(h),this.contentNode=this.scrollView.content,this.itemUI=this.contentNode.children[0],this.itemUI||u.e("=============ScrollViewUtil itemUI is null:"+this.node.name),this.itemUITransform=this.itemUI.getComponent(n),this.itemUIWidth=this.itemUITransform.width,this.itemUIHeight=this.itemUITransform.height,this.vertical=this.scrollView.vertical;var e=this.contentNode.getComponent(o);this.gapX=e.spacingX,this.gapY=e.spacingY,this.paddingLeft=e.paddingLeft,this.paddingRight=e.paddingRight,this.paddingTop=e.paddingTop,this.paddingBottom=e.paddingBottom,e.enabled=!1,this.contentTransform=this.contentNode.getComponent(n);var i=this.contentTransform.width,s=this.contentTransform.height;this.viewNode=a("view",this.node),this.viewTransform=this.viewNode.getComponent(n),this.viewWidth=this.viewTransform.width,this.viewHeight=this.viewTransform.height,this.itemUIFreeArr=[],this.contentNode.children.forEach((function(e){e.active=!1,t.itemUIFreeArr.push(e)})),this.vertical?(this.viewTransform.anchorX=.5,this.viewTransform.anchorY=1,this.contentTransform.anchorX=.5,this.contentTransform.anchorY=1,this.viewNum=Math.ceil(this.viewHeight/(this.itemUIHeight+this.gapY))+1,this.changeNum=Math.floor((i+this.gapX-this.paddingLeft-this.paddingRight)/(this.itemUIWidth+this.gapX))):(this.viewTransform.anchorX=0,this.viewTransform.anchorY=.5,this.contentTransform.anchorX=0,this.contentTransform.anchorY=.5,this.viewNum=Math.ceil(this.viewWidth/(this.itemUIWidth+this.gapX))+1,this.changeNum=Math.floor((s+this.gapY-this.paddingTop-this.paddingBottom)/(this.itemUIHeight+this.gapY))),this.changeNum<1&&(this.changeNum=1),this.startPosX=this.itemUIWidth*this.itemUITransform.anchorX-this.contentTransform.width*this.contentTransform.anchorX+this.paddingLeft,this.startPosY=s*(1-this.contentTransform.anchorY)-this.itemUIHeight*(1-this.itemUITransform.anchorY)-this.paddingTop,this.node.on("scrolling",this.onScrolling,this),this.frameUpdateArr=[],this.addRenderChildBatch()},r.addRenderChildBatch=function(){l.isNative||this.renderChildBatch||(this.renderChildBatch=this.contentNode.addComponent(p))},r.onScrolling=function(){if(!(this.itemArr.length<=0)){var t=0;if(this.vertical){var e=this.contentNode.getPosition().y;e>this.contentTransform.height-this.viewHeight&&(e=this.contentTransform.height-this.viewHeight),e<0&&(e=0),t=Math.floor((e+this.gapY-this.paddingTop)/(this.itemUIHeight+this.gapY))}else{var i=this.contentNode.getPosition().x;i<this.viewWidth-this.contentTransform.width&&(i=this.viewWidth-this.contentTransform.width),i>0&&(i=0),i=Math.abs(i),t=Math.floor((i+this.gapX-this.paddingLeft)/(this.itemUIWidth+this.gapX))}t<0&&(t=0),t>this.maxLines-1&&(t=this.maxLines-1);var s=t+this.viewNum;s>this.maxLines-1&&(s=this.maxLines-1),t==this.startIndex&&s==this.stopIndex||(this.startIndex=t,this.stopIndex=s,this.renderItemArr())}},r.renderItemArr=function(){for(var t=null,e=this.startIndex*this.changeNum,i=0;i<e;i++)t=this.itemArr[i],this.recycleItem(t);for(var s=e=(this.stopIndex+1)*this.changeNum;s<this.itemArr.length;s++)t=this.itemArr[s],this.recycleItem(t);for(var r=this.startIndex;r<=this.stopIndex;r++)for(var h=r*this.changeNum,n=h+this.changeNum,o=h;o<n;o++)this.itemArr[o]&&((t=this.itemArr[o]).node||(t.needUpdate=!0,this.frameUpdateArr.push(t)));this.startFrameUpdate()},r.createNode=function(){var t=null;return(t=this.itemUIFreeArr.length>0?this.itemUIFreeArr.shift():d(this.itemUI)).parent=this.contentNode,this.renderChildBatch&&this.renderChildBatch.addRootItemNode(t),t},r.startFrameUpdate=function(){for(var t=this,e=(new Date).getTime(),i=function(){if(!t.frameUpdateArr||t.frameUpdateArr.length<=0)return t.setDataFlag=!1,"break";var i=t.frameUpdateArr.shift();if(!i.needUpdate)return"continue";if(i.node||(i.node=t.createNode()),i.node.active||(i.node.active=!0),i.node.setPosition(i.x,i.y),i.node.item=i.data,i.node.index=i.index,i.node.scale=f(1,1,1),i.node.showTween&&(i.node.showTween.stop(),i.node.showTween=void 0),t.refreshItemFunc(i.node,i.data,i.index),t.itemTween&&t.setDataFlag){i.node.setScale(0,0,1);var s=g(i.node).to(.2,{scale:f(1.2,1.2,1)}).to(.1,{scale:f(1,1,1)}).call((function(){i.node.showTween=void 0})).start();return i.node.showTween=s,t.scheduleOnce((function(){t.startFrameUpdate()}),.05),"break"}return(new Date).getTime()-e>=t.frameTime?(t.scheduleOnce(t.startFrameUpdate.bind(t)),"break"):void 0};;){var s=i();if("break"===s)break}},r.recycleItem=function(t){t.node&&c(t.node)&&(-1==this.itemUIFreeArr.indexOf(t.node)&&this.itemUIFreeArr.push(t.node),t.node.active=!1,t.node.showTween=void 0,t.node=null,t.needUpdate=void 0)},r.clearAllItems=function(){for(var t,e=i(this.itemArr);!(t=e()).done;){var s=t.value;this.recycleItem(s)}},r.initItem=function(t,e){return{node:null,data:t,index:e,x:0,y:0}},r.refreshItemIndex=function(t,e){t.index=e,t.node&&(t.node.index=e)},r.setData=function(t,e,i,s){if(void 0===i&&(i=!0),void 0===s&&(s=!1),this.scrollView){this.itemTween=s,this.setDataFlag=!0,this.frameUpdateArr=[],this.unscheduleAllCallbacks(),this.clearAllItems(),this.itemArr=[],t||(t=[]),this.refreshItemFunc=e;for(var r=0;r<t.length;r++){var h=t[r],n=this.initItem(h,r);this.itemArr.push(n)}this.maxLines=Math.ceil(this.itemArr.length/this.changeNum),this.maxLines<1&&(this.maxLines=1),this.refreshItemArr(0,i)}},r.layoutItemArr=function(t){if(!(this.itemArr.length<=0))for(var e=t;e<this.itemArr.length;e++){var i=Math.floor(e/this.changeNum),s=e%this.changeNum,r=this.itemArr[e];this.vertical?(r.x=this.startPosX+s*(this.itemUIWidth+this.gapX),r.y=this.startPosY-i*(this.itemUIHeight+this.gapY)):(r.x=this.startPosX+i*(this.itemUIWidth+this.gapX),r.y=this.startPosY-s*(this.itemUIHeight+this.gapY))}},r.resizeContentNode=function(){if(this.contentNode&&this.itemUI){if(this.itemArr.length<=0)return this.contentTransform.width=0,void(this.contentTransform.height=0);var t=this.itemArr[this.itemArr.length-1];if(this.vertical){var e=-t.y+this.itemUIHeight*this.itemUITransform.anchorY;this.contentTransform.height=e+this.paddingBottom}else{var i=t.x+this.itemUIWidth*(1-this.itemUITransform.anchorX);this.contentTransform.width=i+this.paddingRight}}},r.refreshItemArr=function(t,e){if(void 0===e&&(e=!0),this.scrollView){this.layoutItemArr(t),this.resizeContentNode(),this.startIndex=-1,this.stopIndex=-1,this.scrollView.stopAutoScroll();var i=this.scrollView.getMaxScrollOffset(),s=this.scrollView.getScrollOffset();if(this.vertical){var r=0;e||((r=this.contentNode.getPosition().y)>i.y&&(r=i.y),r<0&&(r=0)),s.y=r,this.scrollView.scrollToOffset(s,0)}else{var h=0;e||((h=Math.abs(this.contentNode.getPosition().x))>Math.abs(i.x)&&(h=Math.abs(i.x)),h<0&&(h=0)),s.x=h,this.scrollView.scrollToOffset(s,0)}this.onScrolling()}},r.refreshList=function(){var t=this;this.refreshItemFunc&&this.itemArr.forEach((function(e){e.node&&t.refreshItemFunc(e.node,e.data,e.index)}))},r.removeByIndex=function(t,e){if(void 0===e&&(e=!1),t<0||t>=this.itemArr.length)console.log("无效的index",t);else{var i=this.itemArr[t];if(i&&this.refreshItemFunc){this.itemArr.splice(t,1),this.recycleItem(i);for(var s=t;s<this.itemArr.length;s++){var r=this.itemArr[s];this.refreshItemIndex(r,s)}this.maxLines=Math.ceil(this.itemArr.length/this.changeNum),this.maxLines<1&&(this.maxLines=1),this.refreshItemArr(t,e)}}},r.refreshIndex=function(t,e){if(null==t||t<0||t>=this.itemArr.length)console.log("无效的index",t);else{var i=this.itemArr[t];i&&(null!=e&&(i.data=e),i.node&&(i.node.item=i.data,this.refreshItemFunc&&this.refreshItemFunc(i.node,i.data,t)))}},r.insertData=function(t,e,i){if(void 0===i&&(i=!1),e&&0!=e.length)if(t<0||t>this.itemArr.length)console.log("无效的index",t);else if(this.refreshItemFunc){for(var s=0;s<e.length;s++){var r=t+s,h=this.initItem(e[s],r);this.itemArr.splice(r,0,h)}for(var n=t+e.length;n<this.itemArr.length;n++){var o=this.itemArr[n];this.refreshItemIndex(o,n)}this.maxLines=Math.ceil(this.itemArr.length/this.changeNum),this.maxLines<1&&(this.maxLines=1),this.refreshItemArr(t,i)}else console.log("首次请调用setData方法");else console.log("没有要添加的数据")},r.pushData=function(t,e){void 0===e&&(e=!1),this.insertData(this.itemArr.length,t,e)},r.isScrollEnd=function(){var t=this.scrollView.getMaxScrollOffset(),e=this.scrollView.getScrollOffset();return Math.abs(t.x)-Math.abs(e.x)<=10&&Math.abs(t.y)-Math.abs(e.y)<=10},r.scrollToEnd=function(t){this.scrollView.stopAutoScroll(),(null==t||t<0)&&(t=.5),this.vertical?this.scrollView.scrollToBottom(t):this.scrollView.scrollToRight(t)},r.scrollToIndex=function(t,e){if((null==e||e<0)&&(e=0),!(t<0)){var i=this.itemArr[t];if(i){this.scrollView.stopAutoScroll();var s=this.scrollView.getMaxScrollOffset(),r=this.scrollView.getScrollOffset();if(this.vertical){var h=Math.abs(i.y)+this.itemUIHeight-this.viewHeight;h<0&&(h=0),h>s.y&&(h=s.y),r.y=h,this.scrollView.scrollToOffset(r,e)}else{var n=Math.abs(i.x)+this.itemUIWidth-this.viewWidth;n<0&&(n=0),n>Math.abs(s.x)&&(n=Math.abs(s.x)),r.x=n,this.scrollView.scrollToOffset(r,e)}this.onScrolling()}}},r.onDestroy=function(){this.itemUIFreeArr=[],this.itemArr=[],this.frameUpdateArr=[],this.refreshItemFunc=null,this.node.off("scrolling",this.onScrolling,this),this.unscheduleAllCallbacks()},s}(v))||I);s._RF.pop()}}}));

System.register("chunks:///_virtual/sdkManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./msgac.ts","./audioManager.ts","./eventManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./localization.ts","./H5AdSdk4399.ts","./CronCtr.ts","./tyqAdManager.ts","./tyqSDK.ts"],(function(n){"use strict";var e,t,a,o,c,s,i,r,u,d,l,m,f,g,h;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy},function(n){a=n.constants},function(n){o=n.msgac},function(n){c=n.audioManager},function(n){s=n.eventManager},function(n){i=n.mapModel},function(n){r=n.playerModel},function(n){u=n.UserData},function(n){d=n.localizeManager},function(n){l=n.H5AdSdk4399},function(n){m=n.default},function(n){f=n.tyqAdManager,g=n.Channel},function(n){h=n.tyqSDK}],execute:function(){t._RF.push({},"93823ORdqxLXK57adD53UST","sdkManager",void 0);var p=function(){function n(){}var t=n.prototype;return t.initSDK=function(){f.getChannel()==g.H5_4399&&l.instance.checkDownUrl()},t.openAd=function(n,e){var t=function(n){0==n?s.send(o.showNotice,d._localize(null,"adAwardHint",a.catName.common)):-1==n?s.send(o.showNotice,d._localize(null,"noRewardAd",a.catName.common)):2==n?s.send(o.showNotice,d._localize(null,"noAd",a.catName.common)):1!=n&&s.send(o.showNotice,d._localize(null,{key:"defaultError",cat:a.catName.common,vars:[n]})),e(n),1==n&&(r.addDayTaskNum(11),u.getInstance().$videoCalCnt++,m.getInstance().saveDataToCloud("videoCalCnt",u.getInstance().$videoCalCnt)),c.gameOnShow(!0)};r.isInDevelopmentEnvironment()||r.isRecordAd?t(1):f.getChannel()!=g.DEFAULT?(i.mapId>0&&i.mapSystem.fightPause(),f.getChannel()==g.H5_4399?l.instance.showRewardedAd((function(n){i.mapId>0&&i.mapSystem.fightResume(),t(n)})):h.showRewardedAd(n,(function(n){i.mapId>0&&i.mapSystem.fightResume(),t(n)}))):t(1)},t.getShareUid=function(){var n=f.getEnterUrlQuery();return n&&n.uid?n.uid:""},e(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}();p._instance=void 0;n("sdkManager",p.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/ServerCtr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./wechat.ts","./conf.ts","./gameStorage.ts","./wmsocket.ts"],(function(t){"use strict";var n,e,a,s,r,i,o,c,u,d,g,h;return{setters:[function(t){n=t.inheritsLoose,e=t.createClass},function(t){a=t.cclegacy,s=t._decorator,r=t.director,i=t.Component},function(t){o=t.Wechat},function(t){c=t.GLoginState,u=t.GNetCmd,d=t.GNetConst},function(t){g=t.GameStorage},function(t){h=t.WmSocket}],execute:function(){var l,v;a._RF.push({},"ab7d54qwyNKo5R4d+Nd8sTJ","ServerCtr",void 0);var f=t("ServerState",{Normal:"normal",New:"new",Hot:"hot",Maintain:"maintain"}),I=s.ccclass;s.property,t("default",I("ServerCtr")(((v=function(t){function a(){for(var n,e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return(n=t.call.apply(t,[this].concat(a))||this).serverId=1,n.account="",n.password="hsmnq2021",n.authCode="",n.token="",n.regionDataList=[],n.uid="",n.regionId="",n.nickName="测试账号",n.isLogin=!1,n.avatar="",n.loginState=c.noYet,n.serverDataVersion=0,n.serverData={},n.regionList={},n.serverList={},n}n(a,t),a.GetInstance=function(){return this.instance||(this.instance=new a,this.instance.InitServerCtr()),this.instance};var s=a.prototype;return s.InitServerCtr=function(){this.account=g.getStringDisk("login_account",""),this.password=g.getStringDisk("login_password",this.password),this.authCode=g.getStringDisk("login_authCode",this.authCode),this.serverId=parseInt(g.getStringDisk("login_serverId","")),r.on(u.GetInviteCode.toString(),this.onMessageEvent,this)},s.addDataVersion=function(t){void 0===t&&(t=1),g.setInt("dataVersion",g.getInt("dataVersion",0)+t)},s.CheckIsHaveAccount=function(){return!(!this.account||""==this.account)},s.CheckHaveDataById=function(t){for(var n=0;n<this.regionDataList.length;n++){if(this.regionDataList[n].regionId==t)return!0}return!1},s.UpdateRegions=function(t){for(var n in t){var e=t[n];this.regionList[n]=JSON.parse(e)}},s.UpdateServers=function(t){for(var n in t){var e=t[n];this.serverList[n]=JSON.parse(e)}},s.GetServerData=function(t){for(var n in this.serverList){var e=this.serverList[n];if(e.id==t)return e}return null},s.GetStateIcon=function(t){switch(t){case f.Normal:return;case f.New:return"fm_tb_xin";case f.Hot:return"fm_tb_bao";case f.Maintain:return"fm_tb_wei"}},s.GetLastNewServer=function(){var t=1;for(var n in this.serverList){var e=this.serverList[n],a=Number(e.id);a>t&&e.status!=f.Maintain&&(t=a)}return t},s.reqConnect=function(){h.getInstance().connect()},s.reqRegister=function(t,n){var e={cmd:u.UserRegister,lang:"zh",account:t,password:n};h.getInstance().send({data:e})},s.reqLogin=function(){var t={cmd:u.UserLogin,lang:"zh",account:this.account,password:this.password,nickName:this.nickName+this.account};h.getInstance().send({data:t})},s.reqLoginByAccount=function(t,n,e){var a={cmd:u.UserLogin,lang:"zh",account:t,password:n,authCode:e,nickName:this.nickName+this.account};h.getInstance().send({data:a})},s.reqRegionList=function(){var t={cmd:u.GetRegionList,lang:"zh",token:this.token};h.getInstance().send({data:t})},s.reqRegionData=function(){this.ServerId=1;var t={cmd:u.GetRegionData,lang:"zh",token:this.token,version:a.GetInstance().dataVersion,regionId:this.ServerId.toString()};console.log("发送服务端数据请求---11",t),h.getInstance().send({data:t})},s.reqSetFriendCode=function(t){if(a.GetInstance().loginState==c.loginWithAccount){var n={cmd:u.SetFriendCode,lang:"zh",token:this.token,InviteCode:t};console.log("发送服务端数据请求 -- 设置好友邀请码---11",n),h.getInstance().send({data:n})}},s.reqGetFriendVal=function(){if(a.GetInstance().loginState==c.loginWithAccount){var t={cmd:u.GetFriendVal,lang:"zh",token:this.token,keys:"friendPassCnt,videoCalCnt",rules:"total,total"};console.log("发送服务端数据请求 -- 获得好友功能相关数据---11",t),h.getInstance().send({data:t})}},s.onMessageEvent=function(t){t&&(console.log("处理分享的消息:",t),t.status!=d.ResSuccess)&&console.error("服务端响应失败~!")},s.reqCloudSaveManual=function(t,n){},s.wxLoginBegin=function(t){wx.login({success:function(t){console.warn("-----微信登录--",t);var n={cmd:u.ReqWxSession,lang:"zh",channel:"wx",jscode:t.code};console.warn("发送登录数据：",n),h.getInstance().send({data:n})},fail:function(n){var e="登录失败："+n.errMsg;t&&t(e)}})},s.wxLogin=function(){var t=this;o.getWxLoginResult((function(n,e){if(n)console.error("登录数据err：",e);else{console.log("登录数据info：",e),t.nickName=e.userInfo.nickName,t.avatar=e.userInfo.avatarUrl;var a={cmd:u.ReqWxSession,lang:"zh",channel:"wx",jscode:e.code,nickName:t.nickName};console.warn("发送登录数据：",a),h.getInstance().send({data:a})}}))},s.UnloadAvatarUrl=function(){var t={cmd:u.UploadAvatar,lang:"zh",token:this.token,avatar:this.avatar};h.getInstance().send({data:t})},e(a,[{key:"dataVersion",get:function(){return g.getInt("dataVersion",0)},set:function(t){t>this.dataVersion&&g.setInt("dataVersion",t)}},{key:"Account",get:function(){return this.account},set:function(t){this.account=t,g.setStringDisk("login_account",this.account)}},{key:"PassWord",get:function(){return this.password},set:function(t){this.password=t,g.setStringDisk("login_password",this.password)}},{key:"AuthCode",get:function(){return this.authCode},set:function(t){this.authCode=t,g.setStringDisk("login_authCode",this.authCode)}},{key:"ServerId",get:function(){return this.serverId},set:function(t){this.serverId=t,g.setStringDisk("login_serverId",this.serverId+"")}}]),a}(i)).instance=null,l=v))||l);a._RF.pop()}}}));

System.register("chunks:///_virtual/serverMsg.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./msgac.ts","./eventManager.ts","./mapModel.ts","./playerModel.ts"],(function(n){"use strict";var e,t,s,a,c,r,o;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy},function(n){s=n.myLog},function(n){a=n.msgac},function(n){c=n.eventManager},function(n){r=n.mapModel},function(n){o=n.playerModel}],execute:function(){t._RF.push({},"9acdeoqlPRAM5oguGl4n3Cp","serverMsg",void 0);var i=function(){function n(){}return n.prototype.send=function(n,e){var t=a.ac2KeyObj[n];e||(e={}),n>a.playerMsgStart&&n<a.playerMsgEnd&&o[t]&&o[t](e),n>a.mapMsgStart&&n<a.mapMsgEnd&&r[t]&&r[t](e),s.i(t+"Ret",e),e.notMyLog=!0,1==e.st&&c.send(n,e)},e(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}();i._instance=void 0;n("serverMsg",i.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/SettingLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./audioManager.ts","./BaseUILayer.ts","./UserData.ts","./localization.ts","./constants.ts","./eventManager.ts","./msgac.ts"],(function(e){"use strict";var t,n,o,i,l,a,s,c,r,g,u,h,f,m,y,p,d,C,L;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){l=e.cclegacy,a=e._decorator,s=e.Node,c=e.find,r=e.instantiate,g=e.Label,u=e.Toggle,h=e.ToggleContainer},function(e){f=e.audioManager},function(e){m=e.BaseUILayer},function(e){y=e.UserData},function(e){p=e.localizeManager},function(e){d=e.constants},function(e){C=e.eventManager},function(e){L=e.msgac}],execute:function(){var x,b,z,T,I,S,k,v,M;l._RF.push({},"b7756A5YIhNEI1iqg1Luk/T","SettingLayer",void 0);var D=a.ccclass,_=a.property;e("SettingLayer",(x=D("SettingLayer"),b=_({type:s}),z=_({type:s}),T=_({type:s}),x((k=t((S=function(e){function t(){for(var t,n=arguments.length,l=new Array(n),a=0;a<n;a++)l[a]=arguments[a];return t=e.call.apply(e,[this].concat(l))||this,o(t,"musicToggle",k,i(t)),o(t,"effectToggle",v,i(t)),o(t,"toggleContainer",M,i(t)),t.textMusic=null,t.textSound=null,t.textTitle=null,t.textClose=null,t.langItem=null,t}n(t,e);var l=t.prototype;return l.onLoad=function(){e.prototype.onLoad.call(this),this.textMusic=c("ui/bg/Layout/Label_music",this.node),this.textSound=c("ui/bg/Layout/Label_sound",this.node),this.textTitle=c("ui/info",this.node),this.textClose=c("ui/btns/btnGoOn/Label_close",this.node),this.langItem=this.toggleContainer.children[0];var t=p.localization.lang;for(var n in p.langIndex)if(n!=this.langItem.name){var o=r(this.langItem);o.parent=this.toggleContainer,o.setPosition(this.langItem.position.x,this.langItem.position.y+-60*p.langIndex[n]),o.active=!0,o.name=n;var i=o.getChildByName("text");i.getComponent(g).string=t[n],i.localizeFormat(n)}else this.langItem.getChildByName("text").localizeFormat(n);this.textMusic.localize("music",d.layers.SettingLayer),this.textSound.localize("sound",d.layers.SettingLayer),this.textTitle.localize("title",d.layers.SettingLayer),this.textClose.localize("close","common")},l.onDisable=function(){e.prototype.onDisable.call(this)},l.onDestroy=function(){e.prototype.onDestroy.call(this)},l.start=function(){var e=f.getMusiceVolume(),t=f.getEffectVolume(),n=y.getInstance().$localization;this.musicToggle.getComponent(u).isChecked=e>0,this.effectToggle.getComponent(u).isChecked=t>0,this.toggleContainer.getComponent(h).toggleItems[p.langIndex[n]-1].isChecked=!0},l.onMusicCheck=function(){console.log("onMusicCheck",this.musicToggle.getComponent(u).isChecked),f.setMusicVolume(this.musicToggle.getComponent(u).isChecked?1:0)},l.onSoundCheck=function(){console.log("onEffectCheck",this.effectToggle.getComponent(u).isChecked),f.setEffectVolume(this.effectToggle.getComponent(u).isChecked?1:0)},l.onSingleToggleCheck=function(e,t){t=this.toggleContainer.getComponent(h).toggleItems.indexOf(e),p.set_language(t),C.send(L.refreshLocalization),this.textMusic.localize("music",d.layers.SettingLayer),this.textSound.localize("sound",d.layers.SettingLayer),this.textTitle.localize("title",d.layers.SettingLayer),this.textClose.localize("close","common"),console.log("toggleContainer选择索引:"+t+",是否选中："+e.isChecked)},l.closeLayer=function(){e.prototype.closeLayer.call(this)},t}(m)).prototype,"musicToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(S.prototype,"effectToggle",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(S.prototype,"toggleContainer",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=S))||I));l._RF.pop()}}}));

System.register("chunks:///_virtual/SettlementLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./CronCtr.ts","./tyqAdManager.ts","./tyqSDK.ts","./tyqSDKConfig.ts","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./serverMsg.ts","./AnimationCtrl.ts","./BaseLayer.ts"],(function(e){"use strict";var t,i,n,a,o,s,l,r,c,d,m,u,h,y,f,N,p,b,g,v,w,S,C,D,L,B;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e._decorator,a=e.find,o=e.v3,s=e.tween,l=e.view,r=e.UITransform},function(e){c=e.sdkManager},function(e){d=e.default},function(e){m=e.tyqAdManager,u=e.Channel},function(e){h=e.tyqSDK},function(e){y=e.tyqSDKConfig},function(e){f=e.cocosUtil},function(e){N=e.utilTools},function(e){p=e.constants},function(e){b=e.msgac},function(e){g=e.audioManager},function(e){v=e.designManager},function(e){w=e.mapModel},function(e){S=e.playerModel},function(e){C=e.UserData},function(e){D=e.serverMsg},function(e){L=e.AnimationCtrl},function(e){B=e.BaseLayer}],execute:function(){var A;i._RF.push({},"7026fGphVxC+bSB7DKVEyWa","SettlementLayer",void 0);var I=n.ccclass;n.property,e("SettlementLayer",I("SettlementLayer")(A=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this).winAniCtrl=void 0,t.winMapNameNode=void 0,t.failAniCtrl=void 0,t.failMapNameNode=void 0,t.winTitleNode=void 0,t.timeNode=void 0,t.bestTimeNode=void 0,t.monsterNode=void 0,t.lineNode=void 0,t.itemLayerBg=void 0,t.itemLayerNode=void 0,t.btnDouble=void 0,t.btnDoublePos=void 0,t.btnSure=void 0,t.btnSurePos=void 0,t}t(i,e);var n=i.prototype;return n.onLoad=function(){e.prototype.onLoad.call(this),this.winAniCtrl=this.getNodeByPath("bg2/win").addComponent(L),this.winMapNameNode=this.getNodeByPath("bg2/win/mapName"),this.failAniCtrl=this.getNodeByPath("bg2/fail").addComponent(L),this.failMapNameNode=this.getNodeByPath("bg2/fail/mapName"),this.winTitleNode=this.getNodeByPath("ui/winTitle"),this.timeNode=this.getNodeByPath("ui/time"),this.bestTimeNode=this.getNodeByPath("ui/bestTime"),this.monsterNode=this.getNodeByPath("ui/monster"),this.lineNode=this.getNodeByPath("ui/line"),this.itemLayerBg=this.getNodeByPath("ui/itemLayer/bg"),this.itemLayerNode=this.getNodeByPath("ui/itemLayer/itemLayer"),this.btnDouble=this.getNodeByPath("ui/btns/btnDouble"),this.btnDoublePos=this.btnDouble.position.clone(),this.btnSure=this.getNodeByPath("ui/btns/btnSure"),this.btnSurePos=this.btnSure.position.clone(),this.isShowBannerAd=!0},n.onEnable=function(){e.prototype.onEnable.call(this),C.getInstance().mapData=null,this.layerData.isWin&&(g.playEffect(p.audioNames.win),C.getInstance().$friendPassCnt++,d.getInstance().saveDataToCloud("friendPassCnt",C.getInstance().$friendPassCnt))},n.onDisable=function(){e.prototype.onDisable.call(this)},n.onDestroy=function(){e.prototype.onDestroy.call(this)},n.initUI=function(){var e=this;a("info/name",this.bestTimeNode).localize("best",p.layers.SettlementLayer),this.lineNode.localizeImg(),this.btnSure.getChildByName("icon").localizeImg(),this.btnDouble.getChildByName("icon").localizeImg(),this.winTitleNode.getChildByName("text").localizeImg(),this.layerData.isWin&&S.addDayTaskNum(10),this.winAniCtrl.node.active=!1,this.winMapNameNode.active=!1,this.failAniCtrl.node.active=!1,this.failMapNameNode.active=!1,this.winTitleNode.active=!1,this.timeNode.active=!1,this.bestTimeNode.active=!1,this.monsterNode.active=!1,this.lineNode.active=!1,this.itemLayerBg.active=!1,this.itemLayerNode.active=!1,this.btnDouble.active=!1,this.btnSure.active=!1,N.waterfall([function(t,i){if(e.layerData.isWin)return e.winAniCtrl.node.active=!0,e.winAniCtrl.node.localizeAnim(),void e.winAniCtrl.playAnimation("a",!1,(function(){e.winAniCtrl.playAnimation("b",!0),i()}));e.failAniCtrl.node.active=!0,e.failAniCtrl.node.localizeAnim(),e.failAniCtrl.playAnimation("a",!1,(function(){e.failAniCtrl.playAnimation("b",!0),i()}))},function(t,i){var n=v.getRowById(p.tableName.map,w.mapId);if(e.layerData.isWin)return e.winMapNameNode.active=!0,a("text",e.winMapNameNode).localizeName(n.id,p.catName.mapSystem),void f.tweenScaleIn2(e.winMapNameNode,.2,(function(){i()}));e.failMapNameNode.active=!0,a("text",e.failMapNameNode).localizeName(n.id,p.catName.mapSystem),f.tweenScaleIn2(e.failMapNameNode,.2,(function(){i()}))},function(t,i){if(e.layerData.isWin)return e.winTitleNode.active=!0,void f.tweenScaleIn2(e.winTitleNode,.2,(function(){i()}));e.timeNode.active=!0,e.setString(a("time",e.timeNode),N.getTimeStr(1e3*e.layerData.time,!0));var n=a("new",e.timeNode);n.localize("new",p.layers.SettlementLayer),e.layerData.isBest?(n.active=!0,f.tweenBlink(n)):n.active=!1,f.tweenScaleIn2(e.timeNode,.2,(function(){e.bestTimeNode.active=!0,f.tweenScaleIn2(e.bestTimeNode,.2,(function(){e.setString(a("info/time",e.bestTimeNode),N.getTimeStr(1e3*e.layerData.bestTime,!0)),i()}))}))},function(t,i){e.monsterNode.active=!0,e.setString(a("info/num",e.monsterNode),w.killMonsterNum),f.tweenScaleIn2(e.monsterNode,.2,(function(){i()}))},function(t,i){e.lineNode.active=!0,f.tweenFadeIn(e.lineNode,.2,(function(){i()}))},function(t,i){e.itemLayerBg.active=!0,f.tweenFadeIn(e.itemLayerBg,.2,(function(){i()}))},function(t,i){e.itemLayerNode.active=!0,e.setItemLayer(e.itemLayerNode,e.layerData.award,e.refreshPropItem.bind(e));var n=e.itemLayerNode.children.length;N.forArr(e.itemLayerNode.children,(function(t,a){t.scale=o(0,0,0),e.scheduleOnce((function(){s(t).set({scale:o(2,2,1)}).to(.2,{scale:o(1,1,1)}).to(.05,{scale:o(1.1,1.1,1)}).to(.05,{scale:o(1,1)}).call((function(){a>=n-1&&i()})).start()}),.2*a)}))},function(t,i){e.btnDouble.active=!0;var n=e.btnDoublePos.clone();n.x+=.5*l.getVisibleSize().width+e.btnDouble.getComponent(r).width,e.btnDouble.position=n,e.btnSure.active=!0,(n=e.btnSurePos.clone()).x-=.5*l.getVisibleSize().width+e.btnSure.getComponent(r).width,e.btnSure.position=n,s(e.btnDouble).to(.5,{position:e.btnDoublePos}).start(),s(e.btnSure).to(.5,{position:e.btnSurePos}).start()}])},n.refreshPropItem=function(e,t){var i=v.getRowById(p.tableName.prop,t.Id);this.setSpriteFrame2(a("bg",e),"prop/propbg"+i.quality),this.setSpriteFrame2(a("icon",e),"prop/"+i.icon);var n=a("num",e);8==i.type||11==i.type?n.active=!1:(n.active=!0,this.setNumString(a("num/num",e),t.Num))},n.processEvent=function(e,t){},n.onButtonClick=function(e,t){},n.closeLayer=function(){e.prototype.closeLayer.call(this),this.layerCb&&this.layerCb();var t={};t.mapId=w.mapId,t.floor=w.floor,t.isWin=this.layerData.isWin,D.send(b.mapLeave,t),h.getSwitchValue(y.paramsKeys.tyq_more_game_level)>0&&h.getSwitchValue(y.paramsKeys.tyq_more_game_level)>C.getInstance().openLevel&&m.getChannel()==u.WECHAT&&this.openLayer(p.layers.MoreGameLayer)},n.onClickBtnSure=function(e){this.closeLayer()},n.onClickBtnDouble=function(){var e=this;c.openAd("结算奖励双倍",(function(t){1==t&&(C.getInstance().getRewardProp(e.layerData.award),e.closeLayer())}))},i}(B))||A);i._RF.pop()}}}));

System.register("chunks:///_virtual/ShareLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./conf.ts","./ServerCtr.ts","./tyqSDK.ts","./cocosUtil.ts","./constants.ts","./localText.ts","./designManager.ts","./localStorageManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts"],(function(e){"use strict";var t,a,n,r,i,s,o,c,h,d,u,f,l,y,v,b,m,g,p,L;return{setters:[function(e){t=e.inheritsLoose},function(e){a=e.cclegacy,n=e._decorator,r=e.find,i=e.director,s=e.UITransform,o=e.v3},function(e){c=e.myLog},function(e){h=e.GNetCmd,d=e.GNetConst},function(e){u=e.default},function(e){f=e.tyqSDK},function(e){l=e.cocosUtil},function(e){y=e.constants},function(e){v=e.localText},function(e){b=e.designManager},function(e){m=e.localStorageManager},function(e){g=e.playerModel},function(e){p=e.UserData},function(e){L=e.BaseLayer}],execute:function(){var w;a._RF.push({},"1a69bOacQpHYYT2KSFaEeC1","ShareLayer",void 0);var S=n.ccclass;n.property,e("ShareLayer",S("ShareLayer")(w=function(e){function a(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).tabLayer=void 0,t.tabArr=[{id:1,name:"邀请好友"},{id:2,name:"通关奖励"},{id:3,name:"视频好友"}],t.choseTabIndex=0,t}t(a,e);var n=a.prototype;return n.onLoad=function(){var t=this;e.prototype.onLoad.call(this);var a=this.getNodeByPath("ui/tabLayer");this.tabLayer=a;var n=a.children[0];l.instantiate(n).parent=a,l.instantiate(n).parent=a,a.children.forEach((function(e,a){var n=t.tabArr[a];t.setString(r("text",e),n.name),e.index=a})),this.refreshTabLayer(),u.GetInstance().reqGetFriendVal()},n.onEnable=function(){e.prototype.onEnable.call(this),i.on(h.GetFriendVal.toString(),this.onMessageEvent,this)},n.onDisable=function(){e.prototype.onDisable.call(this),i.on(h.GetFriendVal.toString(),this.onMessageEvent,this)},n.onDestroy=function(){e.prototype.onDestroy.call(this)},n.initUI=function(){this.refreshTopLayer(),this.refreshTabLayer(),this.refreshListLayer()},n.onMessageEvent=function(e){if(e.status==d.ResSuccess)switch(e.cmd){case h.GetFriendVal:this.initUI()}},n.refreshTopLayer=function(){var e=b.config.shareDayNum-g.shareObj.dayNum;e<0&&(e=0),this.setString(this.getNodeByPath("ui/top/hintLayer/day/num"),e),this.setString(this.getNodeByPath("ui/top/shareAwardItem/num/val"),"x"+b.config.shareDayDiamond)},n.refreshListLayer=function(){var e=b.getRowsByType(y.tableName.share,this.choseTabIndex+1);this.scrollViewSetData(this.getNodeByPath("ui/listbg/list"),e,this.refreshShareItem.bind(this))},n.refreshShareItem=function(e,t){var a=this;r("awardLayer",e).children.forEach((function(e,n){var i=t.award[n][0],s=t.award[n][1];a.setPropItem(i,r("icon",e),s,r("bg",e),r("num/val",e)),e.award=t.award[n]}));var n=r("infoLayer1",e),i=r("infoLayer2",e),s=r("infoLayer3",e);n.active=!1,i.active=!1,s.active=!1;var o=0;switch(this.choseTabIndex+1){case 1:o=g.shareObj.friendNum,n.active=!0,this.setString(r("textLayer/val",n),t.num+v.wei);break;case 2:o=g.shareObj.friendPassNum,i.active=!0,this.setString(r("textLayer/val",i),t.num+v.ci);break;case 3:o=g.shareObj.friendAdNum,s.active=!0,this.setString(r("textLayer/val",s),t.num+v.ge)}var c=r("btnGet",e),h=r("done",e);c.active=!1,h.active=!1,g.shareObj.idAwardObj[t.id]?h.active=!0:(c.active=!0,c.row=t,o>=t.num?l.setRenderableColor(c,y.colors.white,!0):l.setRenderableColor(c,y.colors.yin,!0))},n.refreshTabLayer=function(){var e=this;this.tabLayer.children.forEach((function(t,a){var n=r("normal",t),i=r("chose",t),c=r("text",t);n.active=!1,i.active=!1,e.choseTabIndex==a?(i.active=!0,t.getComponent(s).width=i.getComponent(s).width,c.scale=o(1.3,1.3,1)):(n.active=!0,t.getComponent(s).width=n.getComponent(s).width,c.scale=o(1,1,1))}))},n.processEvent=function(e,t){},n.onButtonClick=function(e,t){},n.onClickTabItem=function(e){this.choseTabIndex=e.index,this.initUI()},n.onClickBtnShare=function(){var e=this,t=m.uid;t||(t="");var a="uid="+t;c.i("开始分享："+a),f.share(a,(function(){if(c.i("分享结果回调"),b.config.shareDayNum-g.shareObj.dayNum>0){var t=p.getInstance().addPropNum(y.propIds.diamond,b.config.shareDayDiamond);g.shareObj.dayNum++,e.openAwardGetLayer([t]),e.refreshTopLayer()}}))},n.onClickBtnGet=function(e){var t=e.row;if(g.shareObj.idAwardObj[t.id])this.createNotice(v.hasGet);else{var a=0;switch(this.choseTabIndex+1){case 1:a=g.shareObj.friendNum;break;case 2:a=g.shareObj.friendPassNum;break;case 3:a=g.shareObj.friendAdNum}if(a<t.num)this.createNotice(v.notGet.format(a));else{g.shareObj.idAwardObj[t.id]=1;var n=p.getInstance().addPropArrByDesign(t.award);this.openAwardGetLayer(n),this.initUI()}}},a}(L))||w);a._RF.pop()}}}));

System.register("chunks:///_virtual/ShineColor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./resManager.ts"],(function(e){"use strict";var t,i,r,n,o,s,a,l,h,u;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,r=e._decorator,n=e.UIRenderer,o=e.sp,s=e.v4,a=e.Material,l=e.Component},function(e){h=e.constants},function(e){u=e.resManager}],execute:function(){var c;i._RF.push({},"51f17l4w0hAfKBU6Sgpl5Cc","ShineColor",void 0);var d=r.ccclass;r.property,e("ShineColor",d("ShineColor")(c=function(e){function i(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this).duration=.3,t._median=0,t._time=0,t.isSpine=!1,t.uiRenderer=void 0,t.orignMaterial=void 0,t.vColor=void 0,t}t(i,e);var r=i.prototype;return r.onLoad=function(){this.uiRenderer=this.node.getComponent(n),this.orignMaterial=this.uiRenderer.customMaterial,this.node.getComponent(o.Skeleton)&&(this.isSpine=!0)},r.setMaterialProperty=function(e){if(this.isSpine){var t=this.uiRenderer._materialCache;for(var i in t){var r=t[i];r.setProperty("u_rate",e),this.vColor&&r.setProperty("u_color",this.vColor)}}else{var n=this.uiRenderer.getMaterialInstance(0),o=n.passes[0].getHandle("u_rate");if(n.passes[0].setUniform(o,e),this.vColor){s(1,0,0,1);var a=n.passes[0].getHandle("u_color");n.passes[0].setUniform(a,this.vColor)}this.uiRenderer.setMaterialInstance(n,0)}},r.update=function(e){if(this._time>0){this._time-=e,this._time=this._time<0?0:this._time;var t=2*Math.abs(this._time-this._median)/this.duration;this.setMaterialProperty(t)}else this.removeShineColorMaterial()},r.removeShineColorMaterial=function(){try{this.uiRenderer.customMaterial=this.orignMaterial}catch(e){console.error(e)}this.isSpine&&(this.uiRenderer.enabled=!1,this.uiRenderer.enabled=!0)},r.startShine=function(e,t,i){var r=this;void 0===i&&(i=.1),this.duration=i,this._median=this.duration/2,this.vColor=t?s(t.r/255,t.g/255,t.b/255,t.a/255):s(1,1,1,1),u.loadAsset(h.bundles.common,e,a,null,(function(e,t){r._time=r.duration,r.uiRenderer.customMaterial=t,r.setMaterialProperty(1)}))},i}(l))||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/ShopLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./RedPointLogicMgr.ts","./UserData.ts","./PropItemPrefab.ts","./BaseUILayer.ts","./playerModel.ts","./localization.ts"],(function(e){"use strict";var t,i,n,a,o,r,h,l,s,g,c,p,m,u,d,y,b,f,C,w,S,v,I,B,N,_;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){o=e.cclegacy,r=e._decorator,h=e.Node,l=e.sp,s=e.Label,g=e.PageView,c=e.instantiate,p=e.v3,m=e.UITransform,u=e.Button},function(e){d=e.sdkManager},function(e){y=e.constants},function(e){b=e.msgac},function(e){f=e.audioManager},function(e){C=e.designManager},function(e){w=e.eventManager},function(e){S=e.RedPointLogicMgr},function(e){v=e.UserData},function(e){I=e.PropItemPrefab},function(e){B=e.BaseUILayer},function(e){N=e.playerModel},function(e){_=e.localizeManager}],execute:function(){var L,V,z,T,P,A,D,k,M,F,j,$,U,q,G,R,x,H,E,O,Z,J,K,Q,W,X,Y,ee,te;o._RF.push({},"f5fb7L1gGZDloukFZbgJ7r4","ShopLayer",void 0);var ie=r.ccclass,ne=r.property;e("ShopLayer",(L=ie("ShopLayer"),V=ne({type:h,tooltip:"道具节点"}),z=ne({type:h,tooltip:"宣传页"}),T=ne({type:l.Skeleton,tooltip:""}),P=ne({type:h}),A=ne({type:h}),D=ne({type:h}),k=ne({type:h}),M=ne({type:h}),F=ne({type:h}),j=ne({type:s}),$=ne({type:s}),U=ne({type:h}),q=ne({type:h}),L((x=t((R=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,n(t,"mangItem",x,a(t)),n(t,"pageView",H,a(t)),n(t,"mangheSpine",E,a(t)),n(t,"btnManghe",O,a(t)),n(t,"uiNode",Z,a(t)),n(t,"btnSure",J,a(t)),n(t,"propItem",K,a(t)),n(t,"btnVideo",Q,a(t)),n(t,"btnSingle",W,a(t)),n(t,"num1",X,a(t)),n(t,"num2",Y,a(t)),n(t,"layer1",ee,a(t)),n(t,"layer2",te,a(t)),t._mangheType=0,t._curState=0,t._isDrawIng=!1,t.gaojiProp=[],t._rewardArr=[],t}i(t,e);var o=t.prototype;return o.onLoad=function(){},o.onEnable=function(){this.mangItem.active=!1,this.num1.string=C.config.extra2-v.getInstance().$drawNormalNum+"",this.num2.string=C.config.extra1-v.getInstance().$drawGradeNum+"",S.ins().setRPointView(this.btnManghe,null,!0),this.setSpriteFrame2(this.btnManghe,"shopLayer/mangheNormal_@@"+v.getInstance().$localization,null,y.bundles.wwqVec),this.pageView.getComponent(g).scrollToPage(0,0),this._mangheType=0,this.mangheSpine.animation="purple1",this.mangheSpine.setSkin(v.getInstance().$localization),this.mangheSpine.timeScale=1,this.btnSure.active=!1;var e=this;this.mangheSpine.setCompleteListener((function(){e.animalFinish()}));for(var t=[10082,10113,10010],i=[10066,10155,10118],n=0;n<t.length;n++){var a=c(e.propItem);this.layer1.addChild(a),a.position=p(0,0,0),a.getComponent(I).setView(t[n],1,I.Type_UnTouch|I.Type_HideNum),a.getComponent(I).setScale(100)}for(var o=0;o<i.length;o++){var r=c(e.propItem);this.layer2.addChild(r),r.position=p(0,0,0),r.getComponent(I).setView(i[o],1,I.Type_UnTouch|I.Type_HideNum),r.getComponent(I).setScale(100)}this.onClickChangeManghe(),this.node.getChildByPath("shopbg/Node/btn2/Label-001").localize("btnOnce",y.layers.ShopLayer),this.node.getChildByPath("shopbg/Node/btn1/videoLabel").localize("btnTen",y.layers.ShopLayer),this.node.getChildByPath("shopbg/btnSure/Label").localize("btnClaim",y.layers.ShopLayer)},o.start=function(){console.log("layerData = ",this.layerData),this.initVideoBtn()},o.initVideoBtn=function(){if(this.layerData.taskGo&&v.getInstance().$freeDraw<C.config.taskDoge)return this.btnVideo.getChildByName("ui_video").active=!1,this.btnVideo.getChildByName("Layout").active=!1,void(this.btnVideo.getChildByName("videoLabel").position=p(-40,0,0));1==this._mangheType?(this.btnVideo.getChildByName("Layout").getChildByName("zsLabel").getComponent(s).string=C.config.tenCard+"",this.btnSingle.getChildByName("Layout").getChildByName("zsLabel").getComponent(s).string=C.config.onceCard+"",this.setSpriteFrame2(this.btnSingle.getChildByName("Layout").getChildByName("prop_zs"),"prop/prop_diamond2"),this.setSpriteFrame2(this.btnVideo.getChildByName("Layout").getChildByName("prop_zs"),"prop/prop_diamond2"),v.getInstance().baoshi>=C.config.tenCard?(this.btnVideo.getChildByName("videoLabel").position=p(-40,-10,0),this.btnVideo.getChildByName("ui_video").active=!1,this.btnVideo.getChildByName("Layout").active=!0):(this.btnVideo.getChildByName("videoLabel").position=p(-38,0,0),this.btnVideo.getChildByName("ui_video").active=!0,this.btnVideo.getChildByName("Layout").active=!1)):(this.btnVideo.getChildByName("Layout").getChildByName("zsLabel").getComponent(s).string=C.config.tenCard2+"",this.btnSingle.getChildByName("Layout").getChildByName("zsLabel").getComponent(s).string=C.config.onceCard2+"",this.setSpriteFrame2(this.btnSingle.getChildByName("Layout").getChildByName("prop_zs"),"prop/prop_coin1"),this.setSpriteFrame2(this.btnVideo.getChildByName("Layout").getChildByName("prop_zs"),"prop/prop_coin1"),v.getInstance().coin>=C.config.tenCard2?(this.btnVideo.getChildByName("videoLabel").position=p(-40,-10,0),this.btnVideo.getChildByName("ui_video").active=!1,this.btnVideo.getChildByName("Layout").active=!0):(this.btnVideo.getChildByName("videoLabel").position=p(-38,0,0),this.btnVideo.getChildByName("ui_video").active=!0,this.btnVideo.getChildByName("Layout").active=!1))},o.onOnceCard=function(){f.playEffect("btnClick"),this.mangItem.active=!1,this.mangItem.getChildByName("Layout").removeAllChildren();if(1==this._mangheType?v.getInstance().checkAndUseBaoshi(C.config.onceCard,!0):v.getInstance().cheackAndUseCoin(C.config.onceCard2,!0)){var e={hide:!0};w.send(b.homeHideMenu,e),this.showChouAnimale(),this.cancelButtonTouch(!1),this._isDrawIng=!0,this.gaojiProp=[],this._rewardArr=[];var t=v.getInstance().getDrawItem(this._mangheType),i=C.getRowById(y.tableName.prop,t.award[0]);i.quality>=4&&this.gaojiProp.push(i),this._rewardArr.push({Id:t.award[0],Num:1}),this.initVideoBtn()}else this.toast(1==this._mangheType?_._localize(null,"noDiamond",y.catName.common):_._localize(null,"noGold",y.catName.common))},o.onTenCard=function(){f.playEffect("btnClick"),this.mangItem.getChildByName("Layout").removeAllChildren(),this.mangItem.active=!1;var e=this;this.mangItem.getChildByName("Layout").getComponent(m).width=540,this.mangItem.getChildByName("Layout").getComponent(m).height=200;var t=function(){e.showChouAnimale();var t={hide:!0};e.cancelButtonTouch(!1),e._isDrawIng=!0,e.gaojiProp=[],e._rewardArr=[],w.send(b.homeHideMenu,t);for(var i=0;i<10;i++){var n=v.getInstance().getDrawItem(e._mangheType);if(n){var a=C.getRowById(y.tableName.prop,n.award[0]);a.quality>=4&&e.gaojiProp.push(a),e._rewardArr.push({Id:n.award[0],Num:1})}}e.initVideoBtn()},i=!1;this.layerData.taskGo&&v.getInstance().$freeDraw<C.config.taskDoge?(i=!0,v.getInstance().$freeDraw++):i=1==this._mangheType?v.getInstance().checkAndUseBaoshi(C.config.tenCard,!0):v.getInstance().cheackAndUseCoin(C.config.tenCard2,!0),i?t&&t():d.openAd(1==this._mangheType?"盲盒高级抽奖":"盲盒普通抽奖",(function(e){1==e&&t&&t()}))},o.onClickChangeManghe=function(){f.playEffect("btnClick"),0==this.pageView.getComponent(g).getCurrentPageIndex()?this.pageView.getComponent(g).scrollToPage(1,.2):this.pageView.getComponent(g).scrollToPage(0,.2),this.pageView.getChildByPath("view/content/page1").localizeImg(),this.pageView.getChildByPath("view/content/page2").localizeImg(),this.pageView.getChildByPath("view/content/page1/chou1").localizeImg(),this.pageView.getChildByPath("view/content/page2/chou2").localizeImg(),this.updatebtnState()},o.updatebtnState=function(){this._isDrawIng||(1==this.pageView.getComponent(g).getCurrentPageIndex()?(this._mangheType=1,this.setSpriteFrame2(this.btnManghe,"shopLayer/manggaoji_@@"+v.getInstance().$localization,null,y.bundles.wwqVec),this.mangheSpine.setAnimation(0,"qiehuan1",!1),this.mangheSpine.timeScale=1):(this.mangheSpine.setAnimation(0,"qiehuan2",!1),this.mangheSpine.timeScale=1,this._mangheType=0,this.setSpriteFrame2(this.btnManghe,"shopLayer/mangheNormal_@@"+v.getInstance().$localization,null,y.bundles.wwqVec)),this.initVideoBtn())},o.showChouAnimale=function(){var e="purple";1==this._mangheType&&(e="yellow"),this.mangheSpine.setAnimation(0,e+"2",!1),this.mangheSpine.timeScale=1,this._curState=2},o.animalFinish=function(){this._mangheType,this.mangheSpine.loop=!1,2==this._curState?(this.uiNode.active=!1,this.mangheSpine.timeScale=1,this.mangheSpine.setAnimation(0,"bai3",!1),this._curState=3):3==this._curState?(this.checkShowGaoji(),this.mangItem.active=!0):this._curState},o.checkShowGaoji=function(){if(this.gaojiProp.length>0){var e=this.gaojiProp.shift();if(e&&e.quality>=4){this.mangheSpine.setAnimation(0,4==e.quality?"purple4":"yellow4",!0),this.mangheSpine.setSkin(v.getInstance().$localization),this.mangheSpine.timeScale=1,this.mangItem.getChildByName("Layout").removeAllChildren();var t=c(this.propItem);return this.mangItem.getChildByName("Layout").getComponent(m).width=300,this.mangItem.getChildByName("Layout").getComponent(m).height=300,this.mangItem.getChildByName("Layout").addChild(t),t.getComponent(I).setView(e.id,1,I.Type_BigIcon),t.getComponent(I).setScale(300),this.btnSure.active=!0,void(this._curState=4)}}var i="purple";1==this._mangheType&&(i="yellow"),this.mangheSpine.setAnimation(0,i+"1",!1),this.mangheSpine.timeScale=1,this.mangItem.active=!1,this.mangItem.getChildByName("Layout").removeAllChildren(),v.getInstance().getRewardProp(this._rewardArr),this.openLayer(y.layers.RewardLayer,{propArr:this._rewardArr}),N.addDayTaskNum(3,this._rewardArr.length),this.drawFinish(),this._curState=5},o.onBtnClickSure=function(){f.playEffect("btnClick"),this.checkShowGaoji(),this.mangItem.active=!0},o.drawFinish=function(){this.num1.string=C.config.extra2-v.getInstance().$drawNormalNum+"",this.num2.string=C.config.extra1-v.getInstance().$drawGradeNum+"",this.uiNode.active=!0,this.btnSure.active=!1,this.mangItem.active=!1,w.send(b.homeHideMenu,{hide:!1});var e="purple";1==this._mangheType&&(e="yellow"),this._curState=0,this.mangheSpine.setAnimation(0,e+"1",!1),this.cancelButtonTouch(!0),this._isDrawIng=!1},o.cancelButtonTouch=function(e){this.btnSingle.getComponent(u).interactable=e,this.btnVideo.getComponent(u).interactable=e,this.btnManghe.getComponent(u).interactable=e},o.onDisable=function(){e.prototype.onDisable.call(this)},o.onDestroy=function(){e.prototype.onDestroy.call(this)},o.closeLayer=function(){e.prototype.closeLayer.call(this)},t}(B)).prototype,"mangItem",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(R.prototype,"pageView",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(R.prototype,"mangheSpine",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(R.prototype,"btnManghe",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(R.prototype,"uiNode",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(R.prototype,"btnSure",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(R.prototype,"propItem",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(R.prototype,"btnVideo",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(R.prototype,"btnSingle",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(R.prototype,"num1",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(R.prototype,"num2",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(R.prototype,"layer1",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(R.prototype,"layer2",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=R))||G));o._RF.pop()}}}));

System.register("chunks:///_virtual/SingleInstance.ts",["cc"],(function(n){"use strict";var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"385c2e7ZDBH5qgn7YCLSLIp","SingleInstance",void 0),n("SingleInstance",function(){function n(){}return n.getInstance=function(){return null==this.instance&&(this.instance=new this),this.instance},n}()).instance=null,t._RF.pop()}}}));

System.register("chunks:///_virtual/Skill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./designManager.ts","./mapModel.ts"],(function(t){"use strict";var i,n,l,e,s,o,r,c,a,u;return{setters:[function(t){i=t.inheritsLoose,n=t.asyncToGenerator,l=t.regeneratorRuntime},function(t){e=t.cclegacy,s=t._decorator,o=t.Component},function(t){r=t.cocosUtil},function(t){c=t.constants},function(t){a=t.designManager},function(t){u=t.mapModel}],execute:function(){var d;e._RF.push({},"dde34pvTzRH+5WvlfuMvxTK","Skill",void 0);var h=s.ccclass;s.property,t("Skill",h("Skill")(d=function(t){function e(){for(var i,n=arguments.length,l=new Array(n),e=0;e<n;e++)l[e]=arguments[e];return(i=t.call.apply(t,[this].concat(l))||this).info=void 0,i.id=void 0,i.row=void 0,i.skillUtil=void 0,i}i(e,t);var s=e.prototype;return s.onLoad=function(){},s.init=function(){var t=n(l().mark((function t(i){var n,e,s;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.info=i,n=i.id,this.id=n,this.unscheduleAllCallbacks(),e=a.getRowById(c.tableName.skill,n),this.row=e;try{(s=r.addComponentOnce(this,"Skill"+e.type)).unscheduleAllCallbacks(),this.skillUtil=s,s.init(this)}catch(t){}case 7:case"end":return t.stop()}}),t,this)})));return function(i){return t.apply(this,arguments)}}(),s.getDuration=function(){var t=this.row.duration;return t*=1+u.skillSystem.getSkill2DurationAddPercent()},s.getAtkCd=function(){var t=this.row.cd;return t*=1-u.skillSystem.getSkill2AtkCdSubPercent()},s.updateLogic=function(t){this.skillUtil&&this.skillUtil.updateLogic&&this.skillUtil.updateLogic(t)},s.onDestroy=function(){this.unscheduleAllCallbacks(),this.skillUtil&&this.skillUtil.unscheduleAllCallbacks()},e}(o))||d);e._RF.pop()}}}));

System.register("chunks:///_virtual/Skill1.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var i,n,l,s,u,o;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,l=t._decorator,s=t.Component},function(t){u=t.mapModel},function(t){o=t.physicsGroup}],execute:function(){var e;n._RF.push({},"830f6qSuddKTprK/5yh1tKg","Skill1",void 0);var r=l.ccclass;l.property,t("Skill1",r("Skill1")(e=function(t){function n(){for(var i,n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return(i=t.call.apply(t,[this].concat(l))||this).skill=void 0,i.num=0,i.timeCount=0,i}i(n,t);var l=n.prototype;return l.init=function(t){this.skill=t},l.subNum=function(){this.num--},l.updateLogic=function(t){this.timeCount+=t,this.num>=this.skill.row.num||this.timeCount<this.skill.getAtkCd()||(this.timeCount=0,this.num++,u.bulletSystem.addBullet(this.skill.row.bulletId,o.PLAYER_BULLET2,null,null,this))},n}(s))||e);n._RF.pop()}}}));

System.register("chunks:///_virtual/Skill10.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var i,o,l,s,n,e,r,u;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,l=t._decorator,s=t.Component},function(t){n=t.cocosUtil},function(t){e=t.audioManager},function(t){r=t.mapModel},function(t){u=t.physicsGroup}],execute:function(){var c;o._RF.push({},"2ec28RxfxxHDoN+BZbdSRbr","Skill10",void 0);var h=l.ccclass;l.property,t("Skill10",h("Skill10")(c=function(t){function o(){for(var i,o=arguments.length,l=new Array(o),s=0;s<o;s++)l[s]=arguments[s];return(i=t.call.apply(t,[this].concat(l))||this).skill=void 0,i.timeCount=0,i.isShoting=void 0,i.robotBullet=void 0,i}i(o,t);var l=o.prototype;return l.init=function(t){var i=this;this.skill=t,this.isShoting=!1,this.robotBullet=null;var o={endCb:function(t){n.isValid(i.node)?i.robotBullet=t:t.bullet.recycleSelf()},lv:this.skill.row.lv};r.bulletSystem.addBullet(this.skill.row.bulletId,u.PLAYER_BULLET,null,null,o)},l.forceDestroy=function(){n.isValid(this.robotBullet)&&this.robotBullet.bullet.recycleSelf()},l.startShoting=function(){var t=this,i=this.skill.getDuration();this.isShoting=!0,this.robotBullet.startShot(i),this.scheduleOnce((function(){t.isShoting=!1,t.timeCount=0}),i),e.playEffect(this.skill.row.audio)},l.updateLogic=function(t){this.robotBullet&&(this.timeCount+=t,this.timeCount<this.skill.getAtkCd()||this.isShoting||this.startShoting())},o}(s))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill11.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var i,l,o,e,n,s,r;return{setters:[function(t){i=t.inheritsLoose},function(t){l=t.cclegacy,o=t._decorator,e=t.Component},function(t){n=t.cocosUtil},function(t){s=t.mapModel},function(t){r=t.physicsGroup}],execute:function(){var c;l._RF.push({},"f7e20zKLwRO4oX50jVe8z9N","Skill11",void 0);var u=o.ccclass;o.property,t("Skill11",u("Skill11")(c=function(t){function l(){for(var i,l=arguments.length,o=new Array(l),e=0;e<l;e++)o[e]=arguments[e];return(i=t.call.apply(t,[this].concat(o))||this).skill=void 0,i.timeCount=0,i.num=0,i.towerBulletArr=void 0,i.extraObj=void 0,i}i(l,t);var o=l.prototype;return o.init=function(t){this.skill=t},o.subNum=function(){this.num--},o.creatTower=function(t){var i=this;if(t){var l=t.num+t.addCoin;t.addCoin>0&&(l*=t.addCoin);var o={endCb:function(t){n.isValid(i.node)||t.bullet.recycleSelf()},lv:this.skill.row.lv,atk:l*(1+s.skillSystem.getSkill2AtkAddPercent()),time:this.skill.getDuration(),atkCd:this.skill.getAtkCd(),invokeClass:this};s.bulletSystem.addBullet(this.skill.row.bulletId,r.PLAYER_BULLET2,t.pos,null,o)}},o.updateLogic=function(t){},l}(e))||c);l._RF.pop()}}}));

System.register("chunks:///_virtual/Skill2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts"],(function(i){"use strict";var t,s,o,l,n,e,r,u;return{setters:[function(i){t=i.inheritsLoose},function(i){s=i.cclegacy,o=i._decorator,l=i.Component},function(i){n=i.cocosUtil},function(i){e=i.utilTools},function(i){r=i.mapModel},function(i){u=i.physicsGroup}],execute:function(){var c;s._RF.push({},"cbd1f3j4KpGZ7/YK+g+k7hQ","Skill2",void 0);var h=o.ccclass;o.property,i("Skill2",h("Skill2")(c=function(i){function s(){for(var t,s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return(t=i.call.apply(i,[this].concat(o))||this).skill=void 0,t.isShowing=!1,t.timeCount=0,t.bulletArr=void 0,t}t(s,i);var o=s.prototype;return o.init=function(i){this.skill=i,this.bulletArr=[],this.isShowing=!1},o.showDisks=function(){var i=this,t=n.getCircleDirectionArr(this.skill.row.num,160);e.forArr(t,(function(t){var s={direction:t,endCb:function(t){n.isValid(i.node)?-1==i.bulletArr.indexOf(t)&&i.bulletArr.push(t):t.recycleSelf()}};r.bulletSystem.addBullet(i.skill.row.bulletId,u.PLAYER_BULLET2,null,null,s)}))},o.hideDisks=function(i){void 0===i&&(i=!1),this.bulletArr.forEach((function(t){n.isValid(t)&&t.bulletUtil.hide(i)}))},o.updateLogic=function(i){var t=this;this.isShowing||(this.timeCount+=i,this.timeCount<this.skill.getAtkCd()||(this.timeCount=0,this.isShowing=!0,this.scheduleOnce((function(){t.isShowing=!1,t.hideDisks()}),this.skill.getDuration()),this.showDisks()))},o.forceDestroy=function(){this.hideDisks(!0)},s}(l))||c);s._RF.pop()}}}));

System.register("chunks:///_virtual/Skill3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var i,o,n,e,s,l,u,r;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,e=t.Component},function(t){s=t.cocosUtil},function(t){l=t.audioManager},function(t){u=t.mapModel},function(t){r=t.physicsGroup}],execute:function(){var c;o._RF.push({},"93ff52gBgZOeqxxGLqzTtR0","Skill3",void 0);var a=n.ccclass;n.property,t("Skill3",a("Skill3")(c=function(t){function o(){for(var i,o=arguments.length,n=new Array(o),e=0;e<o;e++)n[e]=arguments[e];return(i=t.call.apply(t,[this].concat(n))||this).skill=void 0,i.num=0,i.timeCount=0,i}i(o,t);var n=o.prototype;return n.init=function(t){this.skill=t},n.subNum=function(){this.num--},n.updateLogic=function(t){if(this.timeCount+=t,!(this.num>=this.skill.row.num||this.timeCount<this.skill.getAtkCd())){var i=u.mapSystem.getMinDisTargetNode();if(i){this.timeCount=0,this.num++;var o=i.getPosition().subtract(u.player.node.getPosition());u.bulletSystem.addBullet(this.skill.row.bulletId,r.PLAYER_BULLET,s.convertToWorldSpace(u.player.node),o,this),l.playEffect(this.skill.row.audio)}}},o}(e))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill4.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./mapModel.ts","./physicsGroup.ts","./audioManager.ts"],(function(t){"use strict";var i,o,n,s,l,e,r,u,c;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,s=t.Component},function(t){l=t.cocosUtil},function(t){e=t.utilTools},function(t){r=t.mapModel},function(t){u=t.physicsGroup},function(t){c=t.audioManager}],execute:function(){var a;o._RF.push({},"7217e9uGeFO7pt9q5S+9EL8","Skill4",void 0);var h=n.ccclass;n.property,t("Skill4",h("Skill4")(a=function(t){function o(){for(var i,o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];return(i=t.call.apply(t,[this].concat(n))||this).skill=void 0,i.timeCount=0,i.isShowing=!1,i.moveDis=200,i}i(o,t);var n=o.prototype;return n.init=function(t){this.skill=t},n.throwFire=function(){var t=this,i=l.getCircleDirectionArr(this.skill.row.num);e.forArr(i,(function(i){var o={targetPos:r.player.node.getPosition().add(i.multiplyScalar(t.moveDis)),time:t.skill.getDuration()};r.bulletSystem.addBullet(t.skill.row.bulletId,u.PLAYER_BULLET,null,i,o)})),c.playEffect(this.skill.row.audio)},n.updateLogic=function(t){var i=this;this.isShowing||(this.timeCount+=t,this.timeCount<this.skill.getAtkCd()||(this.timeCount=0,this.isShowing=!0,this.scheduleOnce((function(){i.isShowing=!1}),this.skill.getDuration()),this.throwFire()))},o}(s))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill5.ts",["./rollupPluginModLoBabelHelpers.js","cc","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var i,o,e,n,l,s,r;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,n=t.Component},function(t){l=t.audioManager},function(t){s=t.mapModel},function(t){r=t.physicsGroup}],execute:function(){var u;o._RF.push({},"382170aGEJCa4mWodqatRyD","Skill5",void 0);var a=e.ccclass;e.property,t("Skill5",a("Skill5")(u=function(t){function o(){for(var i,o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];return(i=t.call.apply(t,[this].concat(e))||this).skill=void 0,i.timeCount=0,i}i(o,t);var e=o.prototype;return e.init=function(t){this.skill=t},e.updateLogic=function(t){if(this.timeCount+=t,!(this.timeCount<this.skill.getAtkCd())){var i=s.mapSystem.getMinDisTargetNode();if(i){this.timeCount=0;var o=i.getPosition().subtract(s.player.node.getPosition());s.bulletSystem.addBullet(this.skill.row.bulletId,r.PLAYER_BULLET2,null,o),l.playEffect(this.skill.row.audio)}}},o}(n))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill6.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./physicsGroup.ts","./audioManager.ts"],(function(t){"use strict";var i,n,o,s,l,e,u,r;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,s=t.Component},function(t){l=t.cocosUtil},function(t){e=t.mapModel},function(t){u=t.physicsGroup},function(t){r=t.audioManager}],execute:function(){var c;n._RF.push({},"a25caRHG6FLQY2ATbAvASZS","Skill6",void 0);var a=o.ccclass;o.property,t("Skill6",a("Skill6")(c=function(t){function n(){for(var i,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(i=t.call.apply(t,[this].concat(o))||this).skill=void 0,i.num=0,i.timeCount=0,i}i(n,t);var o=n.prototype;return o.init=function(t){this.skill=t},o.subNum=function(){this.num--},o.updateLogic=function(t){if(this.timeCount+=t,!(this.num>=this.skill.row.num||this.timeCount<this.skill.getAtkCd())){var i=l.getCircleDirectionArr(1)[0];this.timeCount=0,this.num++;var n={invokeClass:this,time:this.skill.getDuration()};e.bulletSystem.addBullet(this.skill.row.bulletId,u.PLAYER_BULLET2,null,i,n),r.playEffect(this.skill.row.audio)}},n}(s))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/Skill7.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts","./constants.ts"],(function(l){"use strict";var t,i,e,n,s,o,c,u,r;return{setters:[function(l){t=l.inheritsLoose},function(l){i=l.cclegacy,e=l._decorator,n=l.Component},function(l){s=l.cocosUtil},function(l){o=l.audioManager},function(l){c=l.mapModel},function(l){u=l.physicsGroup},function(l){r=l.constants}],execute:function(){var a;i._RF.push({},"1597abY9IlGx4z+0CUwmicQ","Skill7",void 0);var f=e.ccclass;e.property,l("Skill7",f("Skill7")(a=function(l){function i(){for(var t,i=arguments.length,e=new Array(i),n=0;n<i;n++)e[n]=arguments[n];return(t=l.call.apply(l,[this].concat(e))||this).skill=void 0,t.bulletUtil=void 0,t}t(i,l);var e=i.prototype;return e.init=function(l){var t=this;this.skill=l,this.bulletUtil=null;var i={lv:this.skill.row.lv,endCb:function(l){s.isValid(t.node)?t.bulletUtil=l:l.bullet.recycleSelf()}};i.lv==r.design.maxLv&&(i.speedCutPrecent=.5),c.bulletSystem.addBullet(this.skill.row.bulletId,u.PLAYER_BULLET,null,null,i),o.playEffect(this.skill.row.audio)},e.initBulletScale=function(){s.isValid(this.bulletUtil)&&this.bulletUtil.initScale()},e.forceDestroy=function(){s.isValid(this.bulletUtil)&&this.bulletUtil.bullet.recycleSelf()},i}(n))||a);i._RF.pop()}}}));

System.register("chunks:///_virtual/Skill8.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var i,o,e,n,l,s,r,a;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,n=t.Component},function(t){l=t.cocosUtil},function(t){s=t.audioManager},function(t){r=t.mapModel},function(t){a=t.physicsGroup}],execute:function(){var c;o._RF.push({},"4e67c7liWxNJYobtbo6ozbz","Skill8",void 0);var u=e.ccclass;e.property,t("Skill8",u("Skill8")(c=function(t){function o(){for(var i,o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];return(i=t.call.apply(t,[this].concat(e))||this).skill=void 0,i.timeCount=0,i}i(o,t);var e=o.prototype;return e.init=function(t){this.skill=t},e.updateLogic=function(t){var i=this;if(this.timeCount+=t,!(this.timeCount<this.skill.getAtkCd())){var o=[];if(r.monsterSystem.forVisibleMonster((function(t){var i=t.node.position,e=r.player.node.position;Math.abs(i.x-e.x)>r.visibleHalfSize.width-100||Math.abs(i.y-e.y)>r.visibleHalfSize.height-150||o.push(t)})),!(o.length<=0)){this.timeCount=0;for(var e=0;e<this.skill.row.num;e++)this.scheduleOnce((function(){if(!(o.length<=0)){var t=Math.floor(Math.random()*o.length),e=o[t];if(!(e.hp<=0)){var n=l.convertToWorldSpace(e.node);r.bulletSystem.addBullet(i.skill.row.bulletId,a.PLAYER_BULLET,n),s.playEffect(i.skill.row.audio)}}}),.3*e)}}},o}(n))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/Skill9.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var i,n,o,s,l,e,u,r;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,s=t.Component},function(t){l=t.cocosUtil},function(t){e=t.audioManager},function(t){u=t.mapModel},function(t){r=t.physicsGroup}],execute:function(){var c;n._RF.push({},"83a600LHRxHU6nY/tjbs/tt","Skill9",void 0);var a=o.ccclass;o.property,t("Skill9",a("Skill9")(c=function(t){function n(){for(var i,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(i=t.call.apply(t,[this].concat(o))||this).skill=void 0,i.num=0,i.timeCount=0,i}i(n,t);var o=n.prototype;return o.init=function(t){this.skill=t},o.subNum=function(){this.num--},o.updateLogic=function(t){if(this.timeCount+=t,!(this.num>=this.skill.row.num||this.timeCount<this.skill.getAtkCd())){this.timeCount=0,this.num++;var i=l.getCircleDirectionArr(1)[0],n={invokeClass:this,time:this.skill.getDuration()};u.bulletSystem.addBullet(this.skill.row.bulletId,r.PLAYER_BULLET,null,i,n),e.playEffect(this.skill.row.audio)}},n}(s))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/SkillSelectLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./sdkManager.ts","./tyqAdManager.ts","./cocosUtil.ts","./utilTools.ts","./constants.ts","./msgac.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./AnimationCtrl.ts","./BaseLayer.ts","./ItemLayer.ts"],(function(e){"use strict";var t,i,a,n,l,s,o,r,c,h,d,y,v,m,f,u,p,g,S,k,b,I;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,a=e._decorator,n=e.find,l=e.Color,s=e.Tween,o=e.UIOpacity,r=e.tween,c=e.v3},function(e){h=e.myLog},function(e){d=e.sdkManager},function(e){y=e.tyqAdManager},function(e){v=e.cocosUtil},function(e){m=e.utilTools},function(e){f=e.constants},function(e){u=e.msgac},function(e){p=e.designManager},function(e){g=e.mapModel},function(e){S=e.playerModel},function(e){k=e.AnimationCtrl},function(e){b=e.BaseLayer},function(e){I=e.ItemLayer}],execute:function(){var L;i._RF.push({},"9230fuNiqpEvJ8HMtcAJSj/","SkillSelectLayer",void 0);var N=a.ccclass;a.property,e("SkillSelectLayer",N("SkillSelectLayer")(L=function(e){function i(){for(var t,i=arguments.length,a=new Array(i),n=0;n<i;n++)a[n]=arguments[n];return(t=e.call.apply(e,[this].concat(a))||this).skill1ItemLayer=void 0,t.skill2ItemLayer=void 0,t.selectItemLayer=void 0,t.hasSelect=void 0,t.uiNode=void 0,t.btnRefresh=void 0,t.btnGetAll=void 0,t.textHint=void 0,t.allHint=void 0,t}t(i,e);var a=i.prototype;return a.onLoad=function(){e.prototype.onLoad.call(this),this.uiNode=this.getNodeByPath("ui"),this.skill1ItemLayer=this.getNodeByPath("ui/skillLayer1/itemLayer").addComponent(I),this.skill2ItemLayer=this.getNodeByPath("ui/skillLayer2/itemLayer").addComponent(I),this.selectItemLayer=this.getNodeByPath("ui/selectLayer").addComponent(I),this.btnRefresh=this.getNodeByPath("ui/btns/btnRefresh"),this.btnGetAll=this.getNodeByPath("ui/btns/btnGetAll"),this.textHint=this.getNodeByPath("ui/textHint"),this.allHint=this.getNodeByPath("ui/allHint"),this.isShowBannerAd=!0},a.onEnable=function(){e.prototype.onEnable.call(this),this.addEventArr([u.mapLeave]),y.showDelayFullVideo(),y.showDelayInterstitialAd()},a.onDisable=function(){e.prototype.onDisable.call(this),this.removeEventArr([u.mapLeave])},a.initUI=function(){this.getNodeByPath("ui/title/text").localizeImg(),this.getNodeByPath("ui/skillLayer1/bg").localizeImg(),this.getNodeByPath("ui/skillLayer2/bg").localizeImg(),this.getNodeByPath("ui/allHint").localizeImg(),this.getNodeByPath("ui/textHint/text").localizeImg(),this.getNodeByPath("ui/btns/btnRefresh/info/text").localizeImg(),this.getNodeByPath("ui/btns/btnRefresh/free").localize("refreshFree",f.layers.SkillSelectLayer),v.tweenScaleIn2(this.uiNode),this.hasSelect=!1,this.setString(this.getNodeByPath("expProgress/lv"),g.expLv),this.refreshSkillLayer(),this.refreshSelectLayer(),this.refreshInfoLayer()},a.refreshInfoLayer=function(){var e=this.layerData.lvCount;if(e||(e=1),g.skillAllNum>0&&(S.isRecordAd||S.isInDevelopmentEnvironment()))this.btnRefresh.active=!1,this.btnGetAll.active=!0,this.textHint.active=!1,this.allHint.active=!0;else{this.btnRefresh.active=!0,this.btnGetAll.active=!1,this.textHint.active=!0,this.allHint.active=!1;var t=this.getNodeByPath("ui/btns/btnRefresh/info"),i=this.getNodeByPath("ui/btns/btnRefresh/free");S.skillFreeRefreshCount>0?(t.active=!0,i.active=!1):(t.active=!1,i.active=!0)}},a.refreshSkillLayer=function(){this.setNumItemLayer(this.skill1ItemLayer.node,f.design.skillNum,this.refreshSkill1Item.bind(this)),this.setNumItemLayer(this.skill2ItemLayer.node,f.design.skill2Num,this.refreshSkill2Item.bind(this))},a.refreshWeaponItem=function(e,t){var i=g.weaponSystem.weaponArr[t-1],a=n("icon",e);if(i){a.active=!0;var l=p.getRowById(f.tableName.weapon,i.id);this.setSpriteFrame(a,l.icon)}else a.active=!1},a.refreshSkill2Item=function(e,t){var i=g.skillSystem.skill2Arr[t-1],a=n("icon",e);if(i){a.active=!0;var l=p.getRowById(f.tableName.skill2,i.id);this.setSpriteFrame(a,l.icon)}else a.active=!1},a.refreshSkill1Item=function(e,t){if(t<=f.design.weaponNum)this.refreshWeaponItem(e,t);else{var i=g.skillSystem.skillArr[t-f.design.weaponNum-1],a=n("icon",e);if(i){a.active=!0;var l=p.getRowById(f.tableName.skill,i.id);this.setSpriteFrame(a,l.icon)}else a.active=!1}},a.refreshSelectLayer=function(){var e=g.mapSystem.getSelectItemArr();this.selectItemLayer.initUI(this,e,this.refreshSelectItem.bind(this))},a.refreshSelectItem=function(e,t){v.setRenderableColor(e,l.WHITE,!0);var i=n("new",e),a=t.info;a?i.active=!1:(i.active=!0,s.stopAllByTarget(i),v.tweenBreath(i,.5,1.1));var d=null;switch(t.name){case f.tableName.weapon:case f.tableName.skill:case f.tableName.skill2:var y=p.getFirstIdByType(t.type);a&&(y=a.id+1),d=p.getRowById(t.name,y);break;case f.tableName.prop:d=p.getRowById(t.name,t.id)}d||h.e("row is undefined:",d,t),e.row=d,n("name",e).localizeName(d.id,t.name),this.setSpriteFrame(n("icon",e),d.icon),n("info",e).localizeInfo(d.id,t.name);var m=n("btnDoubleSelect",e);m.active=!1;var u=n("selectEffect",e);u.active=!1,v.addComponentOnce(u,k);var b=n("starLayer",e),I=n("bg",e),L=n("bg2",e);d.lv>=f.design.maxLv?(I.active=!1,L.active=!0):(I.active=!0,L.active=!1),t.name==f.tableName.prop?b.active=!1:(b.active=!0,this.setNumItemLayer(b,f.design.maxLv,(function(t,i){var a=t.getComponent(o);a.opacity=255,s.stopAllByTarget(a);var l=n("icon",t),r=n("icon2",t),c=n("yin",t);d.lv>=i?(c.active=!1,d.lv==f.design.maxLv?(l.active=!1,r.active=!0):(l.active=!0,r.active=!1),d.lv==i&&(v.tweenBlink(t,.3),e.starNode=t)):(c.active=!0,l.active=!1,r.active=!1)})),d.lv<=f.design.maxLv-1&&(S.isRecordAd||S.isInDevelopmentEnvironment())&&(m.active=!0));var N=n("comb",e);if(d.breakthrough){N.getChildByName("info").localize("breakthrough",f.layers.SkillSelectLayer),N.active=!0;var B=n("icon",N),A=0,w=g.skillSystem.getSkillInfoByType(d.breakthrough);w&&(A=w.id),0==A&&(A=p.getFirstIdByType(d.breakthrough));var C=p.getRowById(f.tableName.skill,A);this.setSpriteFrame(B,C.icon),s.stopAllByTarget(B),r(B).delay(1).to(.3,{scale:c(1.5,1.5,1)}).to(.15,{scale:c(1,1,1)}).union().repeatForever().start()}else N.active=!1},a.mapLeaveRet=function(){this.closeLayer()},a.processEvent=function(e,t){},a.onClickBtnRefresh=function(){var e=this;this.hasSelect||(S.skillFreeRefreshCount>0?d.openAd("3选1刷新",(function(t){1==t&&e.refreshSelectLayer()})):(S.skillFreeRefreshCount++,this.refreshSelectLayer(),this.refreshInfoLayer()))},a.onClickBtnGetAll=function(){var e=this;this.hasSelect||d.openAd("3选1欧皇附体",(function(t){if(1==t){g.skillAllNum--,e.hasSelect=!0;var i=[];e.selectItemLayer.node.children.forEach((function(e){i.push(e)}));!function t(){var a=i.shift();a?e.doSelectItem(a,!1,(function(){t()})):e.goNext()}()}}))},a.doSelectItem=function(e,t,i,a){var l=this;void 0===t&&(t=!0),void 0===a&&(a=!1);var s=e.starNode,o=e.item,h=e.row;m.waterfall([function(i,o){if(t&&m.forArr(l.selectItemLayer.node.children,(function(t){e!=t&&v.setRenderableColor(t,f.colors.yin,!0)})),s&&s.activeInHierarchy){var d=n("selectEffect",e);d.active=!0;var y=v.convertToNodeSpace(d,v.convertToWorldSpace(s));if(d.setPosition(y),d.getComponent(k).playAnimationOnce("2",(function(){d.active=!1})),s.scale=c(1,1,1),r(s).to(.1,{scale:c(1.5,1.5,1)}).delay(.15).to(.15,{scale:c(1,1,1)}).call((function(){o()})).start(),a){var u=n("starLayer",e).children[h.lv];if(u){var p=v.instantiate(d);p.parent=d.parent,y=v.convertToNodeSpace(p,v.convertToWorldSpace(u)),p.position=y,p.getComponent(k).playAnimationOnce("2",(function(){p.removeFromParent()})),u.scale=c(1,1,1),n("icon",u).active=!0,r(u).to(.1,{scale:c(1.5,1.5,1)}).delay(.15).to(.15,{scale:c(1,1,1)}).start()}}}else l.scheduleOnce((function(){o()}),.2)},function(e,t){switch(o.name){case f.tableName.weapon:g.weaponSystem.addWeapon(o.type),a&&g.weaponSystem.addWeapon(o.type);break;case f.tableName.skill:g.skillSystem.addSkill(o.type),a&&g.skillSystem.addSkill(o.type);break;case f.tableName.skill2:g.skillSystem.addSkill2(o.type),a&&g.skillSystem.addSkill2(o.type);break;case f.tableName.prop:g.propSystem.getProp(o.id)}t()},function(e,t){i&&i()}])},a.goNext=function(){this.layerData.lvCount--,this.layerData.lvCount>0?this.initUI():(this.closeLayer(),this.layerCb&&this.layerCb())},a.onClickSelectItem=function(e){var t=this;this.hasSelect||(this.hasSelect=!0,this.doSelectItem(e,!0,(function(){t.goNext()})))},a.onClickBtnDoubleSelect=function(e){var t=this;this.hasSelect||d.openAd("3选1连升两星",(function(i){if(1==i){t.hasSelect=!0;var a=e.parent.starNode;s.stopAllByTarget(a.getComponent(o)),a.getComponent(o).opacity=255,n("yin",a).active=!0,n("icon",a).active=!1,t.scheduleOnce((function(){n("yin",a).active=!1,n("icon",a).active=!0,t.doSelectItem(e.parent,!0,(function(){t.goNext()}),!0)}),.3)}}))},i}(b))||L);i._RF.pop()}}}));

System.register("chunks:///_virtual/SkillSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utilTools.ts","./constants.ts","./designManager.ts","./mapModel.ts","./BaseLayer.ts","./Skill.ts"],(function(t){"use strict";var e,l,i,r,n,o,s,a,d,u,c,k,p,f;return{setters:[function(t){e=t.inheritsLoose,l=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,r=t._decorator,n=t.find,o=t.Node,s=t.UITransform,a=t.macro},function(t){d=t.utilTools},function(t){u=t.constants},function(t){c=t.designManager},function(t){k=t.mapModel},function(t){p=t.BaseLayer},function(t){f=t.Skill}],execute:function(){var g;i._RF.push({},"a1c8eWHl3BPAKKbFdyYWh5P","SkillSystem",void 0);var h=r.ccclass;r.property,t("SkillSystem",h("SkillSystem")(g=function(t){function i(){for(var e,l=arguments.length,i=new Array(l),r=0;r<l;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).skillArr=[],e.skill2Arr=[],e.hasOpenScheculeAddHp=!1,e}e(i,t);var r=i.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.onEnable=function(){t.prototype.onEnable.call(this)},r.onDestroy=function(){t.prototype.onDestroy.call(this)},r.getSaveData=function(){var t={};return t.skillArr=this.skillArr,t.skill2Arr=this.skill2Arr,t},r.loadSaveData=function(t){var e=this;d.forArr(t.skillArr,(function(t){e.addSkill(0,t.id)})),d.forArr(t.skill2Arr,(function(t){e.addSkill2(0,t.id)}))},r.addSkill=function(t,e){void 0===e&&(e=0),e>0&&(t=c.getRowById(u.tableName.skill,e).type);var l=this.getSkillInfoByType(t);if(l){var i=c.getRowById(u.tableName.skill,l.id+1);if(!i||i.lv>u.design.maxLv)return;l.id++}else{if(this.skillArr.length>=u.design.skill1Num)return;(l={}).id=c.getFirstIdByType(t),this.skillArr.push(l)}e>0&&(l.id=e);var r=this.getSkillNodeNameByType(t),a=n(r,this.node);if(a){var d=a.getComponent(f).skillUtil;d&&d.forceDestroy&&d.forceDestroy(),a.destroy(),a.parent=null}(a=new o(r)).addComponent(s),a.parent=this.node;var k=a.addComponent(f);k.init(l),k.skillUtil&&(k.skillUtil.timeCount=k.row.cd)},r.getSkillInfoByType=function(t){for(var e in this.skillArr){var l=this.skillArr[e];if(c.getRowById(u.tableName.skill,l.id).type==t)return l}return null},r.getSkillNodeNameByType=function(t){return"skill"+t},r.getSkillCompomentByType=function(t){var e=this.getSkillNodeNameByType(t),l=n(e,this.node);return l?l.getComponent(f):null},r.getSkill2InfoByType=function(t){for(var e=0;e<this.skill2Arr.length;e++){var l=this.skill2Arr[e];if(t==c.getRowById(u.tableName.skill2,l.id).type)return l}return null},r.addSkill2=function(t,e){void 0===e&&(e=0),e>0&&(t=c.getRowById(u.tableName.skill2,e).type);var l=this.getSkill2InfoByType(t);if(l){var i=c.getRowById(u.tableName.skill2,l.id+1);if(!i||i.lv>u.design.maxLv)return;l.id++}else{if(this.skill2Arr.length>=u.design.skill2Num)return;(l={}).id=c.getFirstIdByType(t),this.skill2Arr.push(l)}e>0&&(l.id=e);var r=c.getRowById(u.tableName.skill2,l.id);switch(r.type){case 6:var n=this.getSkillCompomentByType(7);n&&n.skillUtil.initBulletScale();break;case 7:this.hasOpenScheculeAddHp||(this.hasOpenScheculeAddHp=!0,this.schedule(this.playerHpAdd,5,a.REPEAT_FOREVER));break;case 8:k.player.addHpMaxPercent(r.p1)}},r.playerHpAdd=function(){var t=this.getSkill2Val(7);k.player.addHpPercent(t)},r.getSkill2Val=function(t){var e=this.getSkill2InfoByType(t);return e?c.getRowById(u.tableName.skill2,e.id).p1:0},r.canBreakthrough=function(t){for(var e,i=l(this.skill2Arr);!(e=i()).done;){var r=e.value;if(c.getRowById(u.tableName.skill2,r.id).breakthrough==t)return!0}return!1},r.getSkill2AtkCdSubPercent=function(){return this.getSkill2Val(12)},r.getSkill2AtkAddPercent=function(){return this.getSkill2Val(11)},r.getSkill2PropGetAddDis=function(){return this.getSkill2Val(10)},r.getSkill2AddCoin=function(){return this.getSkill2Val(9)},r.getSkill2RangeAddScale=function(){return this.getSkill2Val(6)},r.getSkill2DamSubPercent=function(){return this.getSkill2Val(5)},r.getSkill2DurationAddPercent=function(){return this.getSkill2Val(4)},r.getSkill2AddExp=function(){return this.getSkill2Val(3)},r.getSkill2PlayerSpeedAddPercent=function(){return this.getSkill2Val(2)},r.getSkill2BulletSpeedAddPercent=function(){return this.getSkill2Val(1)},r.updateLogic=function(t){d.forArr(this.node.children,(function(e){e.getComponent(f).updateLogic(t)}))},i}(p))||g);i._RF.pop()}}}));

System.register("chunks:///_virtual/SkinChangeLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./localText.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./UserData.ts","./BaseLayer.ts"],(function(t){"use strict";var e,i,n,o,s,a,c,r,h,l,u;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.find},function(t){s=t.constants},function(t){a=t.localText},function(t){c=t.msgac},function(t){r=t.designManager},function(t){h=t.eventManager},function(t){l=t.UserData},function(t){u=t.BaseLayer}],execute:function(){var y;i._RF.push({},"e7394qEzFdEHZl4XKRyeiOh","SkinChangeLayer",void 0);var p=n.ccclass;n.property,t("SkinChangeLayer",p("SkinChangeLayer")(y=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).listResetPos=!0,e.btnEquip=void 0,e.btnGoGet=void 0,e.choseId=0,e}e(i,t);var n=i.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),this.btnEquip=this.getNodeByPath("ui/bottom/btns/btnEquip"),this.btnGoGet=this.getNodeByPath("ui/bottom/btns/btnGoGet"),this.choseId=l.getInstance().heroSkin},n.onEnable=function(){t.prototype.onEnable.call(this)},n.onDisable=function(){t.prototype.onDisable.call(this)},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.initUI=function(){this.getNodeByPath("ui/bottom/title").localize("myWardrobe",s.layers.SkinChangeLayer),this.getNodeByPath("ui/bottom/btns/btnEquip/text").localizeImg(),this.getNodeByPath("ui/bottom/btns/btnGoGet/text").localizeImg();var t=r.getRowsByType(s.tableName.prop,s.propTypes.skin);this.scrollViewSetData(this.getNodeByPath("ui/bottom/list"),t,this.refreshSkinItem.bind(this),this.listResetPos),this.listResetPos=!1,this.setRoleSkin(this.getNodeByPath("ui/top/body"),this.choseId);var e=this.choseId%2e3;this.setSpriteFrame2(this.getNodeByPath("ui/top/skin"),"skin/skin"+e,null,"ui"),this.btnEquip.active=!1,this.btnGoGet.active=!1,l.getInstance().getPropById(this.choseId)>0?this.btnEquip.active=!0:this.btnGoGet.active=!0},n.refreshSkinItem=function(t,e){this.setSpriteFrame2(o("icon",t),"prop/"+e.icon);var i=l.getInstance().getPropById(e.id),n=o("yin",t),s=o("chose",t);n.active=!(i>0),e.id==this.choseId?s.active=!0:s.active=!1},n.processEvent=function(t,e){},n.onButtonClick=function(t,e){},n.onClickSkinItem=function(t){var e=t.item;this.choseId=e.id,this.initUI()},n.closeLayer=function(){t.prototype.closeLayer.call(this),this.layerCb&&this.layerCb()},n.onClickBtnGoGet=function(){this.closeLayer();var t={layerName:s.layers.RewardSkinLayer};this.choseId%2e3==5&&(t.layerName=s.layers.DaySignLayer),h.send(c.jumpLayer,t)},n.onClickBtnEquip=function(){l.getInstance().getPropById(this.choseId)<=0?this.createNotice(a.notHas):(l.getInstance().heroSkin=this.choseId,this.createNotice(a.equipSuccess))},i}(u))||y);i._RF.pop()}}}));

System.register("chunks:///_virtual/TargetPos.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var o,e,i,n,r,c,a,s;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,n=t.find,r=t.UIOpacity,c=t.Tween,a=t.tween,s=t.Component}],execute:function(){var p;e._RF.push({},"fd808cYOr1C8a0AZJRh6bh6","TargetPos",void 0);var y=i.ccclass;i.property,t("targetPos",y("targetPos")(p=function(t){function e(){for(var o,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(o=t.call.apply(t,[this].concat(i))||this).hint=void 0,o.body2Opacity=void 0,o}return o(e,t),e.prototype.init=function(t){var o=this;this.hint=t,this.body2Opacity||(this.body2Opacity=n("body2",this.node).getComponent(r)),c.stopAllByTarget(this.body2Opacity),this.body2Opacity.opacity=80,a(this.body2Opacity).to(.2,{opacity:255}).to(.2,{opacity:80}).union().repeatForever().start();var e=this.hint.extraObj;this.scheduleOnce((function(){o.hint.recycleSelf()}),e)},e}(s))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/targetPos2.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var i,e,o,n,s,c,r,a,h;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,n=t.find,s=t.UIOpacity,c=t.Tween,r=t.tween,a=t.v3,h=t.Component}],execute:function(){var y;e._RF.push({},"9866dcdqCVBH7LK3VKub6sv","targetPos2",void 0);var p=o.ccclass;o.property,t("targetPos2",p("targetPos2")(y=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).hint=void 0,i.body2Opacity=void 0,i}return i(e,t),e.prototype.init=function(t){var i=this;this.hint=t,this.body2Opacity||(this.body2Opacity=n("body2",this.node).getComponent(s)),c.stopAllByTarget(this.body2Opacity),this.body2Opacity.opacity=0,r(this.body2Opacity).to(.5,{opacity:255}).start(),this.node.scale=a(1,1,1),r(this.node).to(.6,{scale:a(.2,.2,1)}).start(),this.hint.extraObj(this),this.scheduleOnce((function(){i.hint.recycleSelf()}),1)},e}(h))||y);e._RF.pop()}}}));

System.register("chunks:///_virtual/targetPos3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts"],(function(t){"use strict";var e,n,o,c,i,r,s,a,l,u;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,c=t.v3,i=t.tween,r=t.UITransform,s=t.Component},function(t){a=t.cocosUtil},function(t){l=t.mapModel},function(t){u=t.HintNames}],execute:function(){var h;n._RF.push({},"25c7f6OwVNBUpx/MCLFCtec","targetPos3",void 0);var p=o.ccclass;o.property,t("targetPos3",p("targetPos3")(h=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))||this).hint=void 0,e}return e(n,t),n.prototype.init=function(t){var e=this;this.hint=t,this.node.scale=c(4,4,1),i(this.node).to(.3,{scale:c(.9,.9,1)}).to(.1,{scale:c(1.1,1.1,1)}).to(.1,{scale:c(1,1,1)}).call((function(){e.hint.recycleSelf();var t=a.convertToWorldSpace(e.node);t.y+=.5*e.node.getComponent(r).height,l.hintSystem.addHint(u.comeShine,t,0,e.hint.extraObj)})).start()},n}(s))||h);n._RF.pop()}}}));

System.register("chunks:///_virtual/TimeCtr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts"],(function(e){"use strict";var t,r,n,i,s,u,a,c,o;return{setters:[function(e){t=e.inheritsLoose,r=e.createClass,n=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){s=e.cclegacy,u=e._decorator,a=e.director,c=e.Component},function(e){o=e.tyqSDK}],execute:function(){var l,h;s._RF.push({},"85380QApjBE/5nzVaMu0fyo","TimeCtr",void 0);var f=u.ccclass;u.property,e("default",f("TimeCtr")(((h=function(e){function s(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).urls=[o.getUrl().httpUrl+"/isAlive"],t.serverTime=0,t.diffServerTime=0,t.isRunServerTime=!1,t.loginTime="",t.curSystemDate=0,t}t(s,e),s.GetInstance=function(){return this.instance||(this.instance=new s,this.instance.InitTimeCtr()),this.instance};var u=s.prototype;return u.InitTimeCtr=function(){},u.UpdateServerTime=function(e){a.getScheduler().unschedule(this.updateTimer,this),this.serverTime=e,this.curSystemDate=e,a.getScheduler().schedule(this.updateTimer,this,1)},u.UpdateServerTimeByHeartbeat=function(e){this.serverTime=e,this.curSystemDate=e},u.ReInit=function(){a.getScheduler().unschedule(this.updateTimer,this)},u.updateTimer=function(){this.isRunServerTime=!0},u.RequestTime=function(){var e=n(i().mark((function e(t){var r,n,s,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.urls.length)){e.next=13;break}return n=this.urls[r],s=!1,u={},e.next=7,this.request(n).then((function(e){s=!0,u=e})).catch((function(e){s=!1,u=e}));case 7:if(!s){e.next=10;break}return t(u),e.abrupt("return");case 10:r++,e.next=1;break;case 13:t({result:!1});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.request=function(e){return new Promise((function(t,r){var n=new XMLHttpRequest;n.timeout=3e3,n.onreadystatechange=function(){if(console.log("statusText:",n.statusText),4===n.readyState&&n.status>=200&&n.status<300){var e=n.responseText;if(!e)return void console.log("http error",e);console.log("收到的消息:",e);var i=JSON.parse(e);if(i.serverTime){var s=Number(i.serverTime);t({result:!0,time:s})}else r({result:!1})}},n.ontimeout=function(e){r({result:!1})},n.onerror=function(e){r({result:!1})},n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/json"),n.send()}))},r(s,[{key:"ServerTime",get:function(){return 0!=this.serverTime?this.serverTime:Date.now()}},{key:"ServerDate",get:function(){if(0!=this.serverTime)return new Date(this.serverTime)}}]),s}(c)).instance=null,l=h))||l);s._RF.pop()}}}));

System.register("chunks:///_virtual/TopUILayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CountTimeUtil.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./UserData.ts","./BaseUILayer.ts"],(function(e){"use strict";var t,n,i,o,a,r,s,l,c,p,u,h,g,f,b,y,d,m,L,w,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,s=e.Label,l=e.Node,c=e.ProgressBar,p=e.view,u=e.Vec3,h=e.tween,g=e.v3},function(e){f=e.CountTimeUtil},function(e){b=e.constants},function(e){y=e.msgac},function(e){d=e.audioManager},function(e){m=e.designManager},function(e){L=e.eventManager},function(e){w=e.UserData},function(e){I=e.BaseUILayer}],execute:function(){var v,D,z,x,M,R,B,U,T,C,N,P,S,E,_,k,A,F,V;a._RF.push({},"dbf2aqp5zZNAYd/7F6SGaP7","TopUILayer",void 0);var j=r.ccclass,q=r.property;e("TopUILayer",(v=j("TopUILayer"),D=q({type:s,tooltip:"体力标签"}),z=q({type:s,tooltip:"宝石标签"}),x=q({type:s,tooltip:"金币标签"}),M=q({type:s,tooltip:"玩家等级"}),R=q({type:l,tooltip:"使用展示"}),B=q({type:c,tooltip:"经验进度条"}),U=q({type:s,tooltip:"体力时间"}),T=q({type:l}),v((P=t((N=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,i(t,"powerLabel",P,o(t)),i(t,"baoshiLabel",S,o(t)),i(t,"coinLabel",E,o(t)),i(t,"lvLabel",_,o(t)),i(t,"showNode",k,o(t)),i(t,"expBar",A,o(t)),i(t,"tiliLabel",F,o(t)),i(t,"clearBtn",V,o(t)),t}n(t,e);var a=t.prototype;return a.onLoad=function(){e.prototype.onLoad.call(this),this.initLayout()},a.onEnable=function(){L.on(y.commonResRefresh,this.updateData,this),this.clearBtn.active=!1},a.initLayout=function(){var e=p.getVisibleSize(),t=this.getScreenScale();e.height/e.width>2?this.node.position=new u(this.node.position.x,e.height/t/2-220,this.node.position.z):this.node.position=new u(this.node.position.x,e.height/t/2-160,this.node.position.z)},a.start=function(){this.updateData()},a.showUseAnimal=function(e,t){this.showNode.active=!0,this.showNode.getChildByName("numLabel").getComponent(s).string=""+t,h(this.showNode).show().set({position:g(-88,-9,0)}).to(.5,{position:g(-88,-39,0)}).hide().start(),this.updateData()},a.onDisable=function(){L.off(y.commonResRefresh,this.updateData,this)},a.onDestroy=function(){},a.updateData=function(){this.powerLabel.string=w.getInstance().power+"/"+m.config.energyMax,this.baoshiLabel.string=w.getInstance().baoshi+"",this.coinLabel.string=w.getInstance().coin+"",this.lvLabel.string=w.getInstance().roleLv+"",this.expBar.progress=Math.min(1,w.getInstance().roleExp/w.getInstance().getNextLevelExp()),this.tiliLabel.node.getComponent(f)&&this.tiliLabel.node.getComponent(f).setTime(w.getInstance().getCountTime(),(function(){w.getInstance().checkPowerTime(),L.send(y.commonResRefresh)})),w.getInstance().saveData()},a.clearData=function(){w.getInstance().remove()},a.showRewardItem=function(e,t){d.playEffect("btnClick"),1==t?w.getInstance().power<m.config.energyMax&&this.openLayer(b.layers.RewardItemLayer,{propId:105,num:Math.min(m.config.adenergy,m.config.energyMax-w.getInstance().power)}):2==t?this.openLayer(b.layers.RewardItemLayer,{propId:801,num:m.config.adDiamond}):3==t&&this.openLayer(b.layers.RewardItemLayer,{propId:104,num:m.config.adCoin})},t}(I)).prototype,"powerLabel",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(N.prototype,"baoshiLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(N.prototype,"coinLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(N.prototype,"lvLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(N.prototype,"showNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(N.prototype,"expBar",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(N.prototype,"tiliLabel",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(N.prototype,"clearBtn",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=N))||C));a._RF.pop()}}}));

System.register("chunks:///_virtual/TowerFloorLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./cocosUtil.ts","./constants.ts","./designManager.ts","./mapModel.ts","./UserData.ts","./AnimationCtrl.ts","./BaseLayer.ts"],(function(t){"use strict";var o,e,n,a,r,i,l,s,c,f,u,y,h;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,a=t.find},function(t){r=t.tyqSDK,i=t.ChannelFlag},function(t){l=t.cocosUtil},function(t){s=t.constants},function(t){c=t.designManager},function(t){f=t.mapModel},function(t){u=t.UserData},function(t){y=t.AnimationCtrl},function(t){h=t.BaseLayer}],execute:function(){var p;e._RF.push({},"4d212U2GFhJCIK5/tnFGhyY","TowerFloorLayer",void 0);var g=n.ccclass;n.property,t("TowerFloorLayer",g("TowerFloorLayer")(p=function(t){function e(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).floorLayer=void 0,o.floor=1,o}o(e,t);var n=e.prototype;return n.onLoad=function(){t.prototype.onLoad.call(this),this.floorLayer=this.getNodeByPath("ui/floorLayer"),1!=r.getSwitchValue("tyq_HeroLayer_open")&&(this.getNodeByPath("ui/btnRole").active=!1),r.channel!=i.WECHAT_JJWS&&(this.getNodeByPath("ui/btnRole").active=!0)},n.onEnable=function(){t.prototype.onEnable.call(this)},n.onDisable=function(){t.prototype.onDisable.call(this)},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.initUI=function(){var t=[],o=this.layerData.id,e=u.getInstance().getTowerMapInfo(o).floor;this.floor=e;for(var n=2;;){var a=e-n;if(--n<0)break;a<=0||t.push(a)}var r=c.getTable(s.tableName.towerFloor).length;for(n=e;t.length<=7&&(t.push(n),!(++n>r)););this.setItemLayer(this.floorLayer,t,this.refreshFloorItem.bind(this)),this.getNodeByPath("ui/btnRole/Label").localize("weaponConfig",s.layers.TowerFloorLayer)},n.refreshFloorItem=function(t,o){this.setString(a("floor",t),o);var e=l.addComponentOnce(a("spine",t),y),n=this.layerData.id,r=u.getInstance().getTowerMapInfo(n).floor;r==o?e.playAnimationOnce("a2",(function(){e.playAnimation("a3",!0)})):o>r?e.playAnimation("a1",!0):e.playAnimation("a4",!0)},n.processEvent=function(t,o){},n.onButtonClick=function(t,o){},n.onClickBtnRole=function(){this.openLayer(s.layers.TowerRoleLayer)},n.onClickFloorItem=function(t){var o=t.item,e=this.layerData.id;o==u.getInstance().getTowerMapInfo(e).floor&&(f.enterMapWithMapId(e,o),r.eventSendCustomEvent("参与无尽模式"))},e}(h))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/TowerLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constants.ts","./designManager.ts","./UserData.ts","./AnimationCtrl.ts","./BaseLayer.ts"],(function(t){"use strict";var n,a,e,o,i,r,s,d,c,h,p;return{setters:[function(t){n=t.inheritsLoose},function(t){a=t.cclegacy,e=t._decorator,o=t.find,i=t.ScrollView,r=t.Animation},function(t){s=t.constants},function(t){d=t.designManager},function(t){c=t.UserData},function(t){h=t.AnimationCtrl},function(t){p=t.BaseLayer}],execute:function(){var l;a._RF.push({},"2c1c4Tl1StISoHbTPrNaBuO","TowerLayer",void 0);var u=e.ccclass;e.property,t("TowerLayer",u("TowerLayer")(l=function(t){function a(){for(var n,a=arguments.length,e=new Array(a),o=0;o<a;o++)e[o]=arguments[o];return(n=t.call.apply(t,[this].concat(e))||this).qianShouNode=void 0,n.dianJvNode=void 0,n.xieZiNode=void 0,n.nianChouNode=void 0,n.paoDangRenNode=void 0,n.btnsLayer=void 0,n}n(a,t);var e=a.prototype;return e.onLoad=function(){this.layerName=s.layers.TowerLayer,t.prototype.onLoad.call(this),this.btnsLayer=this.getNodeByPath("ui/listNoUtil/view/content/map");for(var n=this.btnsLayer.children,a=0;a<n.length;a++){o("monster",n[a]).addComponent(h);var e=o("name/text",n[a]);d.getRowById(s.tableName.map,s.design.towerBeginId+a);e.localize("name"+(s.design.towerBeginId+a),s.catName.mapSystem)}this.qianShouNode=o("monster",n[0]),this.dianJvNode=o("monster",n[1]),this.xieZiNode=o("monster",n[2]),this.nianChouNode=o("monster",n[4]),this.paoDangRenNode=o("monster",n[5])},e.onEnable=function(){t.prototype.onEnable.call(this)},e.onDisable=function(){t.prototype.onDisable.call(this)},e.onDestroy=function(){t.prototype.onDestroy.call(this)},e.initUI=function(){var t=this;this.getNodeByPath("ui/listNoUtil").getComponent(i).scrollToTop();for(var n=this.btnsLayer.children,a=0;a<n.length;a++){var e=n[a],r=d.getRowById(s.tableName.map,s.design.towerBeginId+a);e.row=r;var c=o("hand",e);c&&(c.active=!1),this.needHand()?0==a?(e.active=!0,c.active=!0):e.active=!1:e.active=!0}this.scheduleOnce((function(){t.startQianShouUpdate(),t.needHand()||(t.startDianJvUpdate(),t.startXieziUpdate(),t.startNianChouUpdate(),t.startPaoDangRenUpdate())}),1+Math.random())},e.needHand=function(){return c.getInstance().getTowerMapInfo(101).floor<=1},e.startPaoDangRenUpdate=function(){var t=this;if(Math.random()>.3)"walk"!=this.paoDangRenNode.getComponent(h).spineSkeleton.animation&&this.paoDangRenNode.getComponent(h).playAnimation("walk",!0),this.scheduleOnce((function(){t.startPaoDangRenUpdate()}),1+Math.random());else{var n=Math.random()>.7?"attack1":"attack3";if("attack1"==n){var a=Math.random();n=a<.33?"attackHand1":a<.66?"attackHand2":"attackHand3"}var e=this.paoDangRenNode.getComponent(r);e.pause(),this.paoDangRenNode.getComponent(h).playAnimationOnce(n,(function(){e.resume(),t.startPaoDangRenUpdate()}))}},e.startNianChouUpdate=function(){var t=this;Math.random()>.2?("walk"!=this.nianChouNode.getComponent(h).spineSkeleton.animation&&this.nianChouNode.getComponent(h).playAnimation("walk",!0),this.scheduleOnce((function(){t.startNianChouUpdate()}),1+Math.random())):this.nianChouNode.getComponent(h).playAnimationOnce("attack1",(function(){t.startNianChouUpdate()}))},e.startXieziUpdate=function(){var t=this;if(Math.random()>.2)"walk"!=this.xieZiNode.getComponent(h).spineSkeleton.animation&&this.xieZiNode.getComponent(h).playAnimation("walk",!0),this.scheduleOnce((function(){t.startXieziUpdate()}),1+Math.random());else{var n=Math.random()>.5?"attack1":"attack4";this.xieZiNode.getComponent(h).playAnimationOnce(n,(function(){t.startXieziUpdate()}))}},e.startDianJvUpdate=function(){var t=this;if(Math.random()>.3)"walk"!=this.dianJvNode.getComponent(h).spineSkeleton.animation&&this.dianJvNode.getComponent(h).playAnimation("walk",!0),this.scheduleOnce((function(){t.startDianJvUpdate()}),1+Math.random());else{var n=Math.random()>.5?"attack1":"attack2";this.dianJvNode.getComponent(h).playAnimationOnce(n,(function(){t.startDianJvUpdate()}))}},e.startQianShouUpdate=function(){var t=this;Math.random()>.5?("walk"!=this.qianShouNode.getComponent(h).spineSkeleton.animation&&this.qianShouNode.getComponent(h).playAnimation("walk",!0),this.scheduleOnce((function(){t.startQianShouUpdate()}),1+Math.random())):this.qianShouNode.getComponent(h).playAnimationOnce("attack",(function(){t.startQianShouUpdate()}))},e.processEvent=function(t,n){},e.onButtonClick=function(t,n){},e.openTowerFloorLayer=function(t){var n={id:t};this.openLayer(s.layers.TowerFloorLayer,n)},e.onClickBtnTower=function(t){var n=t.row;this.openTowerFloorLayer(n.id)},a}(p))||l);a._RF.pop()}}}));

System.register("chunks:///_virtual/TowerRoleLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./localText.ts","./audioManager.ts","./designManager.ts","./UserData.ts","./BaseLayer.ts"],(function(t){"use strict";var e,o,a,i,n,r,s,c,h,p,l,g;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,a=t._decorator,i=t.find,n=t.Color},function(t){r=t.cocosUtil},function(t){s=t.constants},function(t){c=t.localText},function(t){h=t.audioManager},function(t){p=t.designManager},function(t){l=t.UserData},function(t){g=t.BaseLayer}],execute:function(){var u;o._RF.push({},"fe276yQJclO3oD0Z2Lncy//","TowerRoleLayer",void 0);var b=a.ccclass;a.property,t("TowerRoleLayer",b("TowerRoleLayer")(u=function(t){function o(){for(var e,o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))||this).propItemUIArr=[],e.atkNode=void 0,e.hpNode=void 0,e.weaponList=void 0,e.costPropIcon=void 0,e.costPropNum=void 0,e}e(o,t);var a=o.prototype;return a.onLoad=function(){t.prototype.onLoad.call(this);var e=this.getNodeByPath("ui/herobg/propLeft").children;for(var o in e)this.propItemUIArr.push(e[o]);for(var a in e=this.getNodeByPath("ui/herobg/propRight").children)this.propItemUIArr.push(e[a]);this.atkNode=this.getNodeByPath("ui/herobg/attackbg/Label"),this.hpNode=this.getNodeByPath("ui/herobg/lifebg/Label"),this.weaponList=this.getNodeByPath("ui/herobg/list"),this.costPropIcon=this.getNodeByPath("ui/herobg/bar/btnOpt/info/icon"),this.costPropNum=this.getNodeByPath("ui/herobg/bar/btnOpt/info/num"),this.setRoleSkin(this.getNodeByPath("ui/herobg/role")),this.getNodeByPath("ui/herobg/btnSkin/ui_text_clo").localizeImg(),this.getNodeByPath("ui/herobg/attackbg/hp").localizeImg(),this.getNodeByPath("ui/herobg/lifebg/hp").localizeImg(),this.getNodeByPath("ui/herobg/bar/Label").localize("myWeapon",s.layers.TowerRoleLayer),this.getNodeByPath("ui/herobg/bar/btnOpt/Label").localize("upgrade",s.layers.TowerRoleLayer),this.getNodeByPath("ui/btnClose/Label").localize("close",s.catName.common)},a.onEnable=function(){t.prototype.onEnable.call(this)},a.onDisable=function(){t.prototype.onDisable.call(this)},a.onDestroy=function(){t.prototype.onDestroy.call(this)},a.initUI=function(){for(var t=l.getInstance().wearProp,e=0;e<t.length;e++){var o=this.propItemUIArr[e],a=i("empty",o),c=i("ui",o),h=t[e];0==e&&(h=l.getInstance().$towerWeaponId),h>0?(o.id=h,a.active=!1,c.active=!0,this.setPropItemIcon(c,h),this.setWeaponbLv(i("lv",c),h)):(o.id=0,a.active=!0,c.active=!1)}var g=l.getInstance().getTowerRoleProInfo();this.setString(this.atkNode,g.atk),this.setString(this.hpNode,g.hp),this.scrollViewSetData(this.weaponList,l.getInstance().$towerWeaponIdArr,this.refreshWeaponItem.bind(this));var u=l.getInstance().getWeaponLv(l.getInstance().$towerWeaponId),b=p.getRowById(s.tableName.weaponOpt,u),d=p.getRowById(s.tableName.prop,b.propId);p.getRowById(s.tableName.weaponOpt,u+1)?(this.getNodeByPath("ui/herobg/bar/btnOpt/Label").active=!0,this.getNodeByPath("ui/herobg/bar/btnOpt/info").active=!0,this.getNodeByPath("ui/herobg/bar/btnOpt/max").active=!1,this.setSpriteFrame(this.costPropIcon,d.icon),this.setString(this.costPropNum,"X"+b.propNum),l.getInstance().getPropNumById(b.propId)>=b.propNum?r.setRenderableColor(this.costPropNum,n.WHITE):r.setRenderableColor(this.costPropNum,n.RED)):(this.getNodeByPath("ui/herobg/bar/btnOpt/Label").active=!1,this.getNodeByPath("ui/herobg/bar/btnOpt/info").active=!1,this.getNodeByPath("ui/herobg/bar/btnOpt/max").active=!0),this.setSpriteFrame(this.getNodeByPath("ui/itemLayer/icon"),d.icon),this.setNumString(this.getNodeByPath("ui/itemLayer/num"),l.getInstance().getPropNumById(b.propId))},a.setPropItemIcon=function(t,e){var o=p.getRowById(s.tableName.prop,e),a="prop/"+o.icon;11==o.type&&(a="weapon/"+p.getRowById(s.tableName.weapon,o.weaponid).icon);this.setSpriteFrame2(i("icon",t),a),this.setSpriteFrame2(i("bg",t),"prop/propbg"+o.quality)},a.setWeaponbLv=function(t,e){if(t){var o=l.getInstance().getWeaponLv(e);t.localize({cat:s.layers.TowerRoleLayer,key:"lv",vars:[o]})}},a.refreshWeaponItem=function(t,e){this.setPropItemIcon(t,e),this.setWeaponbLv(i("lv",t),e);var o=i("chose",t);e==l.getInstance().$towerWeaponId?o.active=!0:o.active=!1},a.processEvent=function(t,e){},a.onButtonClick=function(t,e){},a.onClickPropItem=function(t){var e=t.id;if(e>0){var o={propId:e};11==p.getRowById(s.tableName.prop,e).type&&(o.weaponLv=l.getInstance().getWeaponLv()),this.openLayer(s.layers.PropInfoLayer,o)}},a.onClickWeaponItem=function(t){var e=t.item;l.getInstance().$towerWeaponId=e,this.initUI()},a.onClickBtnOpt=function(){var t=l.getInstance().towerWeaponAddLv();switch(t.st){case 1:this.initUI();break;case 2:this.createNotice(c.maxLv);break;case 3:this.showLackItem(t.propId)}},a.onClickBtnSkin=function(){var t=this;h.playEffect("btnClick"),this.openLayer(s.layers.SkinChangeLayer,(function(){t.setRoleSkin(t.getNodeByPath("ui/herobg/role"))}))},o}(g))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/TransLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseLayer.ts","./constants.ts"],(function(e){"use strict";var t,s,r,o,a,i,c;return{setters:[function(e){t=e.inheritsLoose},function(e){s=e.cclegacy,r=e._decorator,o=e.v3,a=e.tween},function(e){i=e.BaseLayer},function(e){c=e.constants}],execute:function(){var n;s._RF.push({},"1dfd8zP8FFNVqkhq8sr/YEs","TransLayer",void 0);var l=r.ccclass;r.property,e("TransLayer",l("TransLayer")(n=function(e){function s(){for(var t,s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).iconNode=void 0,t.blackNode=void 0,t.processBar=void 0,t.process=void 0,t.percentNode=void 0,t}t(s,e);var r=s.prototype;return r.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.iconNode=this.getNodeByPath("icon"),this.blackNode=this.getNodeByPath("black"),this.processBar=this.getNodeByPath("ProgressBar"),this.percentNode=this.getNodeByPath("ProgressBar/Label/percent"),this.layerCb&&this.layerCb((function(e){t.process=e}),(function(){t.openLayer(c.layers.MapLayer,t.layerData,null,(function(){t.closeLayer(c.layers.TransLayer),t.closeLayer(c.layers.TowerFloorLayer),t.closeLayer(c.layers.HomeLayer)}))}))},r.initUI=function(){var e=this;this.blackNode.active=!1,this.iconNode.scale=o(5,5,1),a(this.iconNode).to(.5,{scale:o(.05,.05,1)},{easing:"quadOut"}).call((function(){e.blackNode.active=!0})).start()},r.update=function(e){if(this.process>0){var t=this.process;t=Math.ceil(1e4*t)/1e4,this.process<=1&&(this.setProgressBar(this.processBar,t),this.setString(this.percentNode,Math.ceil(100*t)+"%"))}},s}(i))||n);s._RF.pop()}}}));

System.register("chunks:///_virtual/tyqAdManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./msgac.ts","./eventManager.ts","./Vivo.ts","./wechat.ts","./WXCustomAd.ts","./tyqSDK.ts","./tyqSDKConfig.ts","./playerModel.ts"],(function(e){"use strict";var t,i,n,a,o,s,h,r,c,d,l,u,A,w;return{setters:[function(e){t=e.createClass},function(e){i=e.cclegacy,n=e.native,a=e.sys,o=e.view},function(e){s=e.msgac},function(e){h=e.eventManager},function(e){r=e.VivoManager},function(e){c=e.Wechat},function(e){d=e.WXCustomAd,l=e.EType},function(e){u=e.tyqSDK},function(e){A=e.tyqSDKConfig},function(e){w=e.playerModel}],execute:function(){var _;e("Channel",void 0),i._RF.push({},"5016fHIeplPW6XZXXcWsDos","tyqAdManager",void 0),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.WECHAT=1]="WECHAT",e[e.ANDROID=2]="ANDROID",e[e.IOS=3]="IOS",e[e.ANDROID_233=4]="ANDROID_233",e[e.ANDROID_4399=5]="ANDROID_4399",e[e.H5_4399=6]="H5_4399",e[e.VIVO_MINI_GAME=7]="VIVO_MINI_GAME",e[e.OPPO_MINI_GAME=8]="OPPO_MINI_GAME"}(_||(_=e("Channel",{})));var g=function(){function e(){if(this.channel=_.DEFAULT,this.customAdSizeObj={rect:{width:360,height:506},horizontal:{width:288,height:90},vertical:{width:62,height:388},grid:{width:68,height:102}},this.adShowType=void 0,this.bannerAdShowing=!1,this.showBannerCount=0,this.shareTime=0,this.shareListenerSuccess=null,this.shareListenerFail=null,this.openID="",this.strategy=1,this.videoCallBack=function(){},this.videoCallBackFail=function(){},this.shareopenID="",this._delayTime=0,a.platform==a.Platform.WECHAT_GAME){this.channel=_.WECHAT;var e=o.getVisibleSize();e.width/e.height>.5&&(c.bannerSize={width:300,height:120})}else this.channel=_.DEFAULT;this.channel=_.OPPO_MINI_GAME}var i=e.prototype;return i.getEnterUrlQuery=function(){if(this.channel==_.WECHAT&&wx.getEnterOptionsSync){var e=wx.getEnterOptionsSync();if(e&&e.query){var t=e.query.shareGameSync;return t&&(this.shareopenID=t,u.eventSendCustomEvent("参与激励托管分享成功进来的玩家")),e.query}}return null},i.showAppMessage=function(){this.shareTime=(new Date).getTime(),console.log("this.openID = ",this.openID),c.shareAppMessage("挑战未知敌人，化身特工","","shareGameSync="+this.openID)},i.getOpenID=function(){wx.login({success:function(e){if(e.code){var t="https://api.weixin.qq.com/sns/jscode2session?appid=###&secret=********&js_code="+e.code+"&grant_type=authorization_code";wx.request({url:t,success:function(e){console.log(e.data)}})}}})},i.getChannel=function(){return this.channel},i.initAdIds=function(){var e=this;if(this.channel==_.WECHAT){wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),wx.onHide(this.wxOnHide.bind(this)),wx.onShow(this.wxOnShow.bind(this));var t=u.getSwitchValue(A.paramsKeys.tyq_ad_banners);t?c._bannerAdUnitId=t.split(";"):u.log("未配置banner广告参数");var i=u.getSwitchValue(A.paramsKeys.tyq_ad_interstitial);i?c._interstitialAdUnitId=i.split(";"):u.log("未配置banner广告参数");var n=u.getSwitchValue(A.paramsKeys.tyq_ad_custom_rect);n?d._customc_rect_adunit=n.split(";"):u.log("未配置原生矩阵广告参数");var a=u.getSwitchValue(A.paramsKeys.tyq_ad_custom_v);a?d._customc_v_adunit=a.split(";"):u.log("未配置原生垂直广告参数");var o=u.getSwitchValue(A.paramsKeys.tyq_ad_custom_h);o?d._customc_h_adunit=o.split(";"):u.log("未配置原生水平广告参数");var r=u.getSwitchValue(A.paramsKeys.tyq_ad_rewarded);r?c._rewardedVideoAdUnitId=r.split(";"):u.log("未配置激励视频广告参数"),c.preLoadBanner(),c.createRewardedVideoAd()}else if(this.channel==_.ANDROID_233||this.channel==_.ANDROID_4399)return console.log(" NATIVE android 平台 initAdIds "),window.rewardedVideoAdCallBack=function(t){console.log("AD_DEMO rewardedVideoAdCallBack ",t),h.send(s.showNotice," 发放视频奖励 "),e.videoCallBack&&e.videoCallBack()},void(window.rewardedVideoAdFailCallBack=function(t){console.log("AD_DEMO rewardedVideoAdCallBack ",t),e.videoCallBackFail&&e.videoCallBackFail()})},i.wxOnHide=function(e){if(e){var t=e.mode,i=e.targetAction,n=e.targetPagePath;-1!=[8,9,10].indexOf(i)&&(this.adShowType?u.adClickUpload(this.adShowType,t,i,n):9!=i?n&&("WCCanvasPageViewController"!=n&&-1==n.indexOf("ad.weixin.qq.com")&&-1==n.indexOf("ad_biz_info")&&-1==n.indexOf("weixinadkey")||u.adClickUpload(A.adShowTypes.bannerAndCustomAd,t,i,n)):u.adClickUpload(A.adShowTypes.bannerAndCustomAd,t,i,n))}},i.wxOnShow=function(e){console.log("wx onShow:",e),this.shareTime>0&&(new Date).getTime()-this.shareTime>=2e3?this.shareListenerSuccess&&this.shareListenerSuccess():(this.reportShareBehavior(5,this.strategy,1),this.shareListenerFail&&this.shareListenerFail()),this.shareListenerFail=null,this.shareListenerSuccess=null,this.shareTime=0},i.showBannerAd=function(e){if(this.showBannerCount++,this.channel==_.WECHAT){if(this.bannerAdShowing)return!0;e||(e=5e3),c.showBannerTurns(e),this.bannerAdShowing=!0}else this.channel==_.ANDROID_4399?n.reflection.callStaticMethod("com/cocos/game/SdkUtil4399","showBanner","(Ljava/lang/String;)Z","展示banner广告"):(this.channel,_.VIVO_MINI_GAME)},i.hideBannerAd=function(e){this.showBannerCount--,e&&(this.showBannerCount=0),this.showBannerCount>0||(this.channel==_.WECHAT?(c.hideBannerAd(),this.bannerAdShowing=!1):this.channel==_.ANDROID_4399?n.reflection.callStaticMethod("com/cocos/game/SdkUtil4399","hideBanner","(Ljava/lang/String;)Z","隐藏banner广告"):(this.channel,_.VIVO_MINI_GAME))},i.isBannerAdShowing=function(){return this.bannerAdShowing},i.showInterstitialAd=function(){var e=this;this.channel==_.WECHAT?c.showInterstitialAd((function(){e.adShowType=""}),(function(){e.adShowType=A.adShowTypes.interstitialAd})):this.channel==_.ANDROID_233?this.showFullRewarded():this.channel==_.ANDROID_4399&&n.reflection.callStaticMethod("com/cocos/game/SdkUtil4399","InterstitialShow","(Ljava/lang/String;)Z","展示插屏广告")},i.showDelayFullVideo=function(){if(this.channel==_.ANDROID_233){var e=(new Date).getTime();e-this._delayTime>=12e4&&(this.showFullRewarded(),this._delayTime=e)}},i.showDelayInterstitialAd=function(){if(this.channel==_.ANDROID_4399){if(this._delayTime<=0)return void(this._delayTime=(new Date).getTime());var e=(new Date).getTime();e-this._delayTime>=2e5&&(this.showInterstitialAd(),this._delayTime=e)}},i.showCustomRectCenterAd=function(e){void 0===e&&(e=null),this.channel==_.WECHAT&&d.createCustomAd("default_custom_ad_rect",l.rect,{centerX:0,centerY:0},this.customAdSizeObj.rect,null,e)},i.hideCustomRectCenterAd=function(){this.channel==_.WECHAT&&d.hideCustomAd("default_custom_ad_rect")},i.showCustomVerticalLeftRightAd=function(){this.channel==_.WECHAT&&(d.createCustomAd("default_custom_ad_v_left",l.vertical,{left:0},this.customAdSizeObj.vertical),d.createCustomAd("default_custom_ad_v_right",l.vertical,{right:0},this.customAdSizeObj.vertical))},i.hideCustomVerticalLeftRightAd=function(){this.channel==_.WECHAT&&(d.hideCustomAd("default_custom_ad_v_left"),d.hideCustomAd("default_custom_ad_v_right"))},i.showCustomHorizontalTopAd=function(){this.channel==_.WECHAT&&d.createCustomAd("default_custom_ad_h",l.horizontal,{top:0},this.customAdSizeObj.horizontal)},i.hideCustomHorizontalTopAd=function(){this.channel==_.WECHAT&&d.hideCustomAd("default_custom_ad_h")},i.showCustomAd=function(e,t,i,n,a,o){this.channel==_.WECHAT&&d.createCustomAd(e,t,i,n,a,o)},i.hideCustomAd=function(e){this.channel==_.WECHAT&&d.hideCustomAd(e)},i.hideCustomAllAd=function(){this.channel==_.WECHAT&&d.hideAllAd()},i.showFullRewarded=function(){if(this.channel==_.ANDROID_233)return console.log("showFullRewarded"),void n.reflection.callStaticMethod("com/cocos/game/MetaAdApiUtil","ShowFullRewardVideoShow","(Ljava/lang/String;)Z","展示全屏视频广告")},i.reportShareBehavior=function(e,t,i){void 0===t&&(t=1),void 0===i&&(i=null),A.isOpenBeHavior&&(""!=this.shareopenID&&(c.reportShareBehavior({operation:6,strategy:1,inviteUser:this.shareopenID}),this.shareopenID=""),c.reportShareBehavior({operation:e,strategy:t,currentShow:i}))},i.showRewardedAd=function(e,t,i){var a=this;if(void 0===i&&(i=!1),this.strategy=1,A.isOpenBeHavior&&this.channel==_.WECHAT)if(c.isShareBehavior()){if(!i)return f.showAppMessage(),this.shareListenerSuccess=e,this.shareListenerFail=t,void c.reportShareBehavior({operation:2,strategy:1,currentShow:1});this.strategy=0,c.reportShareBehavior({operation:2,strategy:0,currentShow:0})}else c.reportShareBehavior({operation:2,strategy:1,currentShow:0});if(A.isCloseAd&&(w.isRecordAd||w.isInDevelopmentEnvironment()))e&&e();else{if(this.channel==_.ANDROID_233)return this.videoCallBack=e,this.videoCallBackFail=t,void(n.reflection.callStaticMethod("com/cocos/game/MetaAdApiUtil","RewardVideoShow","(Ljava/lang/String;)Z","展示广告")||t&&t());if(this.channel==_.ANDROID_4399)return this.videoCallBack=e,this.videoCallBackFail=t,console.log(" NATIVE android 平台 com/cocos/game/SdkUtil4399"),void(n.reflection.callStaticMethod("com/cocos/game/SdkUtil4399","RewardVideoShow","(Ljava/lang/String;)Z","展示广告")||t&&t());this.channel==_.WECHAT&&c.showRewardVideoAd((function(){a.adShowType=A.adShowTypes.rewardedAd})).then((function(i){a.adShowType="",i?e&&e():(a.reportShareBehavior(5,a.strategy,0),t&&t())}),(function(){a.adShowType="",a.reportShareBehavior(5,a.strategy,0),t&&t()})),this.channel!=_.VIVO_MINI_GAME?t&&t(2):r.showRewardVideoAd((function(i){1==i?e&&e():t&&t(i)}))}},t(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();g._instance=void 0;var f=e("tyqAdManager",g.instance);i._RF.pop()}}}));

System.register("chunks:///_virtual/TyqBaseLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./tyqLayerManager.ts"],(function(t){"use strict";var n,e,o,a,i,r,s,c,u;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t.find,a=t.Button,i=t.Label,r=t.RichText,s=t.Component},function(t){c=t.tyqSDK},function(t){u=t.tyqLayerManager}],execute:function(){e._RF.push({},"a66efz9BgNL7Z/VjLWB3zxY","TyqBaseLayer",void 0);t("TyqBaseLayer",function(t){function e(){for(var n,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return(n=t.call.apply(t,[this].concat(o))||this).obj={},n.cb=void 0,n.layerName="DefaultLayer",n.pathNodeObj=new Map,n}n(e,t);var s=e.prototype;return s.onLoad=function(){this.addButtonListener(this.node),this.addPathNode(this.node,"")},s.addPathNode=function(t,n){t!=this.node&&this.pathNodeObj.set(n,t),n&&(n+="/");for(var e=t.children,o=0,a=e.length;o<a;o++){var i=e[o];this.addPathNode(i,n+i.name)}},s.getNodeByPath=function(t){var n=this.pathNodeObj.get(t);return n||((n=o(t,this.node))?(this.pathNodeObj.set(t,n),n):null)},s.addButtonListener=function(t){t.getComponent(a)&&t.on("click",this.preOnButtonClick,this);for(var n=t.children,e=0,o=n.length;e<o;e++){var i=n[e];this.addButtonListener(i)}},s.preOnButtonClick=function(t){var n=t.node,e=n.name;c.log(this.layerName+" onButtonClick "+e),this.onButtonClick(n,n.name)},s.onButtonClick=function(t,n){},s.openLayer=function(t,n,e){u.openLayer(t,n,e)},s.closeLayer=function(){u.closeLayer(this)},s.setString=function(t,n){n+="";var e=t.getComponent(i);if(e)e.string=n;else{var o=t.getComponent(r);o&&(o.string=n)}},e}(s));e._RF.pop()}}}));

System.register("chunks:///_virtual/tyqConstants.ts",["cc"],(function(t){"use strict";var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"cd600cwJNFD5JPQRITwJnyg","tyqConstants",void 0);t("tyqConstants",{paths:{layer:"layer/"},bundles:{tyqSDKBundle:"tyqSDKBundle"},layers:{TyqMoreGameLayer:"TyqMoreGameLayer"}});e._RF.pop()}}}));

System.register("chunks:///_virtual/tyqLayerManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./tyqConstants.ts","./tyqResManager.ts"],(function(n){"use strict";var e,t,a,r,s,o,i,c,u;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy,a=n.Prefab,r=n.instantiate,s=n.UITransform,o=n.find},function(n){i=n.tyqSDK},function(n){c=n.tyqConstants},function(n){u=n.tyqResManager}],execute:function(){t._RF.push({},"f9b90DrhuNGUIR8MI8kci08","tyqLayerManager",void 0);var y=function(){function n(){}var t=n.prototype;return t.openLayer=function(n,e,t){var y=c.paths.layer+n;u.loadAsset(c.bundles.tyqSDKBundle,y,a,null,(function(a,c){if(a)i.log("LayerManager.openLayer error:"+a.message,n,a);else{var u=r(c),y=u.addComponent(n);y.obj=e,y.cb=t,y.layerName=n,u.getComponent(s).priority=999,u.parent=o("Canvas"),i.log("openLayer "+n,e)}}))},t.closeLayer=function(n){n.layerName;n.node.destroy()},e(n,null,[{key:"instance",get:function(){return null==this._instance&&(this._instance=new n),this._instance}}]),n}();y._instance=void 0;n("tyqLayerManager",y.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/TyqMoreGameLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts","./tyqSDKConfig.ts","./TyqBaseLayer.ts"],(function(n){"use strict";var e,t,o,r,s,a;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,o=n._decorator},function(n){r=n.tyqSDK},function(n){s=n.tyqSDKConfig},function(n){a=n.TyqBaseLayer}],execute:function(){var i;t._RF.push({},"522e5j5xKlP9bCP6zpiZ0RM","TyqMoreGameLayer",void 0);var c=o.ccclass;o.property,n("TyqMoreGameLayer",c("TyqMoreGameLayer")(i=function(n){function t(){for(var e,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return(e=n.call.apply(n,[this].concat(o))||this).level=0,e.isShowBanner=!1,e.lastBannerShow=!1,e}e(t,n);var o=t.prototype;return o.onLoad=function(){n.prototype.onLoad.call(this),this.level=this.obj.level,this.lastBannerShow=r.isBannerAdShowing(),r.hideBannerAd(),r.showCustomHorizontalTopAd(!0),r.showCustomRectCenterAd()},o.onButtonClick=function(n,e){switch(e){case"btnGoOn":this.onClickBtnGoOn(n)}},o.onClickBtnGoOn=function(n){var e=r.getSwitchValue(s.paramsKeys.tyq_banner_touch);if(e&&this.level>parseInt(e)&&!this.isShowBanner)return this.isShowBanner=!0,r.showBannerAd(),void this.scheduleOnce((function(){r.hideBannerAd()}),1.5+Math.random());this.unscheduleAllCallbacks(),this.closeLayer(),this.cb&&this.cb(),this.lastBannerShow&&r.showBannerAd()},t}(a))||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/tyqResManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts"],(function(n){"use strict";var e,t,s,a;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy,s=n.assetManager},function(n){a=n.tyqSDK}],execute:function(){t._RF.push({},"fa238FBPppPF5f/CBCqj0Uj","tyqResManager",void 0);var i=function(){function n(){}return n.prototype.loadAsset=function(n,e,t,i,u){var r=s.getBundle(n);if(r&&r.get(e,t))u&&u(null,r.get(e,t));else{var c=function(){r.load(e,t,(function(n,e){i&&i(n,e)}),(function(t,s){if(t)return a.log("ResManager.loadAsset error:"+t.message,n,e,t),void(u&&u(t));u&&u(null,s)}))};r?c():s.loadBundle(n,(function(n,e){n?u&&u(n):(r=e,c())}))}},e(n,null,[{key:"instance",get:function(){return null==this._instance&&(this._instance=new n),this._instance}}]),n}();i._instance=void 0;n("tyqResManager",i.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/tyqSDK.ts",["cc","./tyqLayerManager.ts","./tyqConstants.ts","./conf.ts","./WXCustomAd.ts","./tyqAdManager.ts","./tyqSDKConfig.ts","./weHttp.ts","./weNetworkMgr.ts"],(function(t){"use strict";var e,i,n,a,o,s,r,h,d,l,c,u,_;return{setters:[function(t){e=t.cclegacy,i=t.sys,n=t.game,a=t.Game},function(t){o=t.tyqLayerManager},function(t){s=t.tyqConstants},function(t){r=t.GNetConf},function(t){h=t.EType},function(t){d=t.tyqAdManager,l=t.Channel},function(t){c=t.tyqSDKConfig},function(t){u=t.Http},function(t){_=t.NetworkMgr}],execute:function(){var m,p;t({ChannelFlag:void 0,TyqSDKAppVersion:void 0}),e._RF.push({},"83a26NRnL5AdYsLDFN660As","tyqSDK",void 0),function(t){t[t.VERSION_1=1]="VERSION_1",t[t.VERSION_2=2]="VERSION_2"}(m||(m=t("TyqSDKAppVersion",{}))),function(t){t[t.WECHAT_MRTGD=1]="WECHAT_MRTGD",t[t.WECHAT_JJWS=2]="WECHAT_JJWS",t[t.WECHAT_Box4399=3]="WECHAT_Box4399",t[t.VIVO_MINI_GAME=4]="VIVO_MINI_GAME",t[t.OPPO_MINI_GAME=5]="OPPO_MINI_GAME"}(p||(p=t("ChannelFlag",{})));var f=function(){function t(){this.switch_info={},this.master_switch=0,this.openid="",this._playTime=0,this._gameLevel=0,this.item_openId="tyq_item_openid",this.item_watermark="tyq_item_watermark_",this._watermark="",this._onlineTime=0,this.weixin_ads_data=null,this.wxGameIconData=[],this.levelCount=0,this.timeDiff=0,this.channel=void 0,this.shareTime=void 0,this.shareCallback=void 0}var e=t.prototype;return e.initGame=function(){if(this.channel=p.WECHAT_MRTGD,this.setLogOpen(!0),this.setAppVersion(1),d.getChannel()==l.ANDROID_233)this.init("TyqApp20230213163724","1iK3I97Mx6VuTjPKgUur1RUeV2eHH3OB");else if(d.getChannel()==l.ANDROID_4399)this.init("TyqApp20230214154427","o4gt48BCrJHyAxBco6aY6ydxwhPsJUxl");else if(d.getChannel()==l.WECHAT)switch(this.channel){case p.WECHAT_MRTGD:this.init("TyqApp20221110115330","VE3URwtUCEWyoxCdOqxDs8SxBNTnNpm1");break;case p.WECHAT_JJWS:this.init("TyqApp20230302154121","J1PRD20Bu8rPTtHj2A64xrTiplCRvqbu");break;case p.WECHAT_Box4399:this.init("TyqApp20230214154438","NXdhVUkArhQO3izZAdkMUDeYd4XVNSQl")}else d.getChannel()==l.VIVO_MINI_GAME?this.init("TyqApp20230506150422","RFJowvHuA3CX3ArprdniQo93OPmrN8Sq"):d.getChannel()==l.OPPO_MINI_GAME&&this.init("TyqApp20230518113406","Mo9qrwx4GKfZuFPdW5qp8BZLD1qlUA8S")},e.getUrl=function(){return this.channel==p.WECHAT_MRTGD?{httpUrl:r.mrtgd_HttpUrl,wsUrl:r.mrtgd_WsUrl}:this.channel==p.WECHAT_JJWS?{httpUrl:r.mrtgd_jjws_HttpUrl,wsUrl:r.mrtgd_jjws_WsUrl}:void 0},e.init=function(t,e,o){var s=this;c.appId=t,c.apiKey=e,u.init(c.server,c.apiKey),this._watermark=i.localStorage.getItem(this.item_watermark)||"",this.openid=this.initOpenId(),d.getChannel()!=l.WECHAT&&d.initAdIds(),this.httpPost("api/v1/switch_info",null,(function(t){if(t.data&&(s.timeDiff=t.data.current_time_stamp-s.getTimeStamp(!0),s.switch_info=t.data.switch_info,s.master_switch=t.data.master_switch,d.getChannel()==l.WECHAT&&d.initAdIds(),t.data.weixin_ads_data))for(var e in s.weixin_ads_data=t.data.weixin_ads_data,s.weixin_ads_data){var i=[];s.log("key",e);for(var n=0;n<s.weixin_ads_data[e].length;n++){for(var a in i=[],s.weixin_ads_data[e][n])i.push(s.weixin_ads_data[e][n][a]);var r={name:i[0],appid:i[1],imgUrl:i[2],weixin_ads_data:i[3],key:e};s.wxGameIconData.push(r)}}s.login(),o&&o(1)}),(function(){o&&o(0)})),this._onlineTime=this.getTimeStamp(),n.on(a.EVENT_HIDE,(function(){s.collectPlayeTime()})),n.on(a.EVENT_SHOW,(function(){if(s._onlineTime=s.getTimeStamp(),s.shareTime){var t=(new Date).getTime()-s.shareTime.getTime();s.shareTime=void 0,t>=3e3&&s.shareCallback&&(s.shareCallback(),s.shareCallback=void 0)}}))},e.login=function(){var t=this;if(this.openid){var e=d.getEnterUrlQuery(),n={};e&&(e.ads_id&&(n.ads_id=e.ads_id),e.source_openid&&(n.source_openid=e.source_openid),e.pull_in_ads_id&&(n.pull_in_ads_id=e.pull_in_ads_id)),this.httpPost("api/v1/login",n,(function(e){t.log("登陆："+t.openid),e.data&&(t._watermark=encodeURIComponent(e.data.watermark),i.localStorage.setItem(t.item_watermark,t._watermark))}),(function(){t.error("登录失败,网络错误")}))}else this.error("openId为空")},e.share=function(t,e){d.getChannel()==l.WECHAT&&(this.shareTime=new Date,this.shareCallback=e,wx.shareAppMessage({query:t}))},e.setAppVersion=function(t){c.appVersion=t},e.getSwitchValue=function(t,e){return 0==this.master_switch?0:this.switch_info[t]?"0"==this.switch_info[t]?0:this.switch_info[t]:(this.log(t+"开关不存在"),e||0)},e.getConfigProbability=function(t){var e=this.getSwitchValue(t);return!!e&&Math.random()<e},e.collectPlayeTime=function(){if(this.openid){var t=this.getTimeStamp()-this._onlineTime;this.log("上传停留",t);var e={duration_time:t};this.httpPost("api/v1/collect_open_game_play_time",e)}else this.error("没有openid")},e.httpPost=function(t,e,i,n){var a=this;e||(e={}),e.appid=c.appId,e.nonce_str=this.randomStr(),e.time_stamp=this.getTimeStamp(!0)+this.timeDiff,e.app_version=c.appVersion,e.openid=this.openid,e.watermark=this._watermark,this.log("请求",t,e),_.xhrPost(t,e,(function(e){a.log("请求返回",t,e),i&&i(e)}),(function(){n&&n()}))},e.wxIconData=function(){return this.wxGameIconData},e.wxJumpData=function(){return this.weixin_ads_data},e.collectClickEventGame=function(t,e){if(this.openid){var i={event_id:t,weixin_ads_id:e};this.httpPost("api/v1/collect_weixin_ads_jumb_ok_cb",i)}else this.error("没有openid")},e.randomStr=function(t){void 0===t&&(t=32);for(var e=t,i="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=i.length,a="",o=0;o<e;o++)a+=i.charAt(Math.floor(Math.random()*n));return a},e.getTimeStamp=function(t){void 0===t&&(t=!1);var e=Date.now();return t&&(e=Math.floor(e/1e3)),e},e.initOpenId=function(){var t=i.localStorage.getItem(this.item_openId);return t||(t=this.randOpenId(),i.localStorage.setItem(this.item_openId,t),this.log("注册："+t)),this.log("openid=",t),t},e.randOpenId=function(){for(var t=[],e="0123456789abcdef",i=0;i<40;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]=t[28]="-",t.join("")},e.eventLevelStart=function(t){this._gameLevel=t,this.collectLevelInfo(1)},e.eventLevelEnd=function(t,e){this._gameLevel=t,this.collectLevelInfo(e?2:3)},e.eventSendCustomEvent=function(t,e){if(this.openid){var i=e?t+"-"+e:t;this.log("%cevent:"+i,"color:#FF0000");var n={event_id:i};this.httpPost("api/v1/collect_click_event",n)}else this.error("没有openid")},e.adClickUpload=function(t,e,i,n){if(this.openid){n&&(n=encodeURIComponent(n)),this.log("广告点击上报："+t,e,i,n);var a=0;t==c.adShowTypes.rewardedAd||(t==c.adShowTypes.interstitialAd?a=2:t==c.adShowTypes.bannerAndCustomAd&&(a=3));var o={};o.status=a;var s=d.getEnterUrlQuery();s&&s.pull_in_ads_id&&(o.pull_in_ads_id=s.pull_in_ads_id),this.httpPost("api/v1/collect_weixin_ads_mb_act_info",o)}else this.error("没有openid")},e.collectLevelInfo=function(t){if(this.openid){var e=this.getTimeStamp(!1),i=0;1==t?this._playTime=e:(i=e-this._playTime,this._playTime=0);var n={game_level:this._gameLevel,status:t,play_time:i};this.httpPost("api/v1/collect_user_play_game_level",n)}else this.error("没有openid")},e.setLogOpen=function(t){c.isLogOpen=t},e.log=function(t){if(c.isLogOpen){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var a,o;if("string"==typeof t)(a=console).log.apply(a,["[TyqSDK]"+t].concat(i));else(o=console).log.apply(o,["[TyqSDK]",t].concat(i))}},e.error=function(t){var e;if(c.isLogOpen){for(var i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];(e=console).error.apply(e,["[TyqSDK]"+t].concat(n))}},e.showBannerAd=function(t){var e=this.getSwitchValue(c.paramsKeys.tyq_banner_turns);e?d.showBannerAd(parseInt(e)):t&&d.showBannerAd()},e.hideBannerAd=function(t){d.hideBannerAd(t)},e.isBannerAdShowing=function(){return d.isBannerAdShowing()},e.showInterstitialAd=function(){d.showInterstitialAd()},e.showCustomRectCenterAd=function(t){void 0===t&&(t=null),d.showCustomRectCenterAd(t)},e.hideCustomRectCenterAd=function(){d.hideCustomRectCenterAd()},e.showCustomVerticalLeftRightAd=function(t){(t||this.getSwitchValue(c.paramsKeys.tyq_custom_v_switch))&&d.showCustomVerticalLeftRightAd()},e.hideCustomVerticalLeftRightAd=function(){d.hideCustomVerticalLeftRightAd()},e.showCustomHorizontalTopAd=function(t){(t||this.getSwitchValue(c.paramsKeys.tyq_custom_h_switch))&&d.showCustomHorizontalTopAd()},e.hideCustomHorizontalTopAd=function(){d.hideCustomHorizontalTopAd()},e.showCustomAd=function(t,e,i,n,a,o){if(!n)switch(e){case h.rect:n=d.customAdSizeObj.rect;break;case h.horizontal:n=d.customAdSizeObj.horizontal;break;case h.vertical:n=d.customAdSizeObj.vertical;break;default:n=d.customAdSizeObj.gird}d.showCustomAd(t,e,i,n,a,o)},e.hideCustomAd=function(t){d.hideCustomAd(t)},e.hideCustomAllAd=function(){d.hideCustomAllAd()},e.setCustomRectAdSize=function(t,e){d.customAdSizeObj.rect.width=t,d.customAdSizeObj.rect.height=e},e.setCustomHorizontalAdSize=function(t,e){d.customAdSizeObj.horizontal.width=t,d.customAdSizeObj.horizontal.height=e},e.setCustomVerticalAdSize=function(t,e){d.customAdSizeObj.vertical.width=t,d.customAdSizeObj.vertical.height=e},e.setCustomGridAdSize=function(t,e){d.customAdSizeObj.grid.width=t,d.customAdSizeObj.grid.height=e},e.showRewardedAd=function(t,e){var i=this;t&&this.eventSendCustomEvent(c.eventNames.rewardedAdStart+t),d.showRewardedAd((function(){t&&i.eventSendCustomEvent(c.eventNames.rewardedAdSuccess+t),e&&e(1)}),(function(t){e&&e(t||0)}))},e.onShowLoadingLayer=function(){this.eventSendCustomEvent(c.eventNames.enterLoadingLayer)},e.onShowHomeLayer=function(){this.eventSendCustomEvent(c.eventNames.enterHomeLayer);var t=this.getSwitchValue(c.paramsKeys.tyq_show_main_layer);t&&(1==(t=parseInt(t))?this.showInterstitialAd():2==t&&this.showCustomRectCenterAd(null))},e.addLevelCount=function(t){var e=this.getSwitchValue(c.paramsKeys.tyq_reward_level);if(e&&!(t<=(e=parseInt(e)))){this.levelCount++;var i=w.getSwitchValue(c.paramsKeys.tyq_level_count);i&&(i=parseInt(i),this.levelCount>=i&&(this.levelCount=0,this.showRewardedAd()))}},e.onShowSettlementLayer=function(){this.showInterstitialAd()},e.showMoreGameLayer=function(t,e){if(d.getChannel()==l.WECHAT){var i=this.getSwitchValue(c.paramsKeys.tyq_more_game_level);if(i)if(t<=(i=parseInt(i)))e();else{var n={};n.level=t,o.openLayer(s.layers.TyqMoreGameLayer,n,(function(){e()}))}else e()}},t}();f.instance=new f;var w=t("tyqSDK",f.instance);e._RF.pop()}}}));

System.register("chunks:///_virtual/tyqSDKConfig.ts",["cc"],(function(t){"use strict";var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"a09daxOR+NG0KJMyaVfvvK+","tyqSDKConfig",void 0);t("tyqSDKConfig",{gameName:"末日特工队",gameVersion:"1.0.3",appVersion:1,appId:"",apiKey:"",AppSecret:"1",server:"https://api.game.xmtyq.com/china_app_game_sdk/",isLogOpen:!1,isCloseAd:!0,isOpenBeHavior:!1,paramsKeys:{tyq_ad_banners:"tyq_ad_banners",tyq_ad_interstitial:"tyq_ad_interstitial",tyq_ad_custom_rect:"tyq_ad_custom_rect",tyq_ad_custom_v:"tyq_ad_custom_v",tyq_ad_custom_h:"tyq_ad_custom_h",tyq_ad_rewarded:"tyq_ad_rewarded",tyq_banner_turns:"tyq_banner_turns",tyq_custom_h_switch:"tyq_custom_h_switch",tyq_custom_v_switch:"tyq_custom_v_switch",tyq_show_main_layer:"tyq_show_main_layer",tyq_level_count:"tyq_level_count",tyq_reward_level:"tyq_reward_level",tyq_banner_touch:"tyq_banner_touch",tyq_more_game_level:"tyq_more_game_level",tyq_ad_custom_rect_switch:"tyq_ad_custom_rect_switch"},adShowTypes:{rewardedAd:"激励视频广告点击",interstitialAd:"插屏广告点击",bannerAndCustomAd:"banner与原生广告点击"},eventNames:{enterLoadingLayer:"进入加载页",enterHomeLayer:"进入主界面",rewardedAdStart:"观看激励视频-",rewardedAdSuccess:"观看完激励视频-"}});e._RF.pop()}}}));

System.register("chunks:///_virtual/UserData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./myLog.ts","./conf.ts","./CronCtr.ts","./ServerCtr.ts","./cocosUtil.ts","./constants.ts","./msgac.ts","./audioManager.ts","./designManager.ts","./eventManager.ts","./RedPointLogicMgr.ts","./playerModel.ts"],(function(t){"use strict";var e,a,r,o,i,n,s,h,p,u,d,l,c,f,g,$,m,w,v,I,y,P,D,N;return{setters:[function(t){e=t.inheritsLoose,a=t.createClass},function(t){r=t.cclegacy,o=t.instantiate,i=t.tween,n=t.v3,s=t.game,h=t.Game,p=t.js,u=t.sys,d=t.Component},function(t){l=t.myLog},function(t){c=t.GLoginState},function(t){f=t.default},function(t){g=t.default},function(t){$=t.cocosUtil},function(t){m=t.constants},function(t){w=t.msgac},function(t){v=t.audioManager},function(t){I=t.designManager},function(t){y=t.eventManager},function(t){P=t.RedPointLogicMgr,D=t.RPointMask},function(t){N=t.playerModel}],execute:function(){r._RF.push({},"0f1be+8a5tBc613pNYA6Pnr","UserData",void 0),t("UserData",function(t){function r(){for(var e,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).$localKey="UserData",e.$time=null,e.$roleLv=1,e.$roleExp=1,e.$power=30,e._maxPower=30,e._powerRevoverTime=60,e.$powerTime=0,e.$baoShi=1e3,e.$optStone=0,e.$dayAct=0,e.$coin=1e3,e.$mapHand=0,e._attack=0,e._life=0,e.$curMap=1,e.$openLevel=1,e.$levelData=[],e.$mapData=void 0,e.$propData=[{id:301,num:0,iswear:0}],e.$wearProp=[0,0,0,0,0,0],e.$playerData={},e.$patrolStartTime=0,e.$patrolRewardProp=[],e.$patrolRewardPropArr=[],e.$heroSkin=2001,e.$drawNormalNum=0,e.$drawGradeNum=0,e.$localization=null,e.$towerWeaponIdArr=[10130,10135,10140,10145,10150,10155,10160,10165],e.$towerWeaponId=0,e.$towerWeaponLvObj={},e.$towerMapIdObj={},e.$pyramidState=[0,0,0,0,0,0,0,0,0,0],e.$pyramidDrawTime=0,e.$friendPassCnt=0,e.$videoCalCnt=0,e.$freeDraw=0,e._isShowOpenLevel=!1,e._drawAllWeight=[0,0,0],e._drawAllSureWeight=[0,0,0],e}e(r,t),r.getInstance=function(){return null==this._instance&&(this._instance=new r,this._instance.onInit()),this._instance};var d=r.prototype;return d.onInit=function(){var t=this;console.log("-----比较服务端数据版本号---",g.GetInstance().dataVersion,g.GetInstance().serverDataVersion),g.GetInstance().loginState==c.loginWithAccount&&g.GetInstance().dataVersion<g.GetInstance().serverDataVersion?this.loadServerData(g.GetInstance().serverData):this.load(),this.$time=0,this.initEvent(),this.setBaseConfig(),this.afterLoadData(),g.GetInstance().dataVersion>g.GetInstance().serverDataVersion&&f.getInstance().uploadAllRecord(this.getLocalData()),this.schedule((function(){f.getInstance().uploadAllRecord(t.getLocalData())}),300)},d.setBaseConfig=function(){this._maxPower=I.config.energyMax,this._powerRevoverTime=I.config.energyRecoverTime,this.updateRoleAtkHp()},d.afterLoadData=function(){this.$towerWeaponId||(this.$towerWeaponId=this.$towerWeaponIdArr[0]),this.getPropById(2001)<=0&&this.addPropNum(2001,1)},d.setConfig=function(){this.$baoShi=I.config.basicGem,this.$coin=I.config.basicGold,this.$propData=[{id:301,num:0,iswear:0}],this.$wearProp=[0,0,0,0,0,0],this.$levelData=[],this.$curMap=1,this.$openLevel=1,this.$power=I.config.energyMax,this.$mapData=null,this.$roleExp=0,this.$roleLv=1,this.$mapHand=0,this.$patrolRewardProp=[],this.$patrolRewardPropArr=[],this.$patrolStartTime=(new Date).getTime(),this.$drawNormalNum=0,this.$drawGradeNum=0,this.$pyramidState=[0,0,0,0,0,0,0,0,0,0],this.$friendPassCnt=0,this.$videoCalCnt=0},d.getHeroSkin=function(t){void 0===t&&(t=0),t||(t=this.$heroSkin);var e=I.getRowById(m.tableName.prop,t);return e?"skin"+e.p2:"skin1"},d.isHaveProp=function(t){if("number"==typeof t){for(var e=0;e<this.$propData.length;e++)if(this.$propData[e].id==t&&this.$propData[e].num>0)return!0}else{for(var a=0,r=0;r<t.length;r++)for(var o=0;o<this.$propData.length;o++)this.$propData[o].id==t[r]&&this.$propData[o].num>0&&a++;if(a>=t.length)return!0}return!1},d.towerWeaponAddLv=function(){var t={},e=this.getWeaponLv(this.$towerWeaponId);if(!I.getRowById(m.tableName.weaponOpt,e+1))return t.st=2,t;var a=I.getRowById(m.tableName.weaponOpt,e);return this.getPropNumById(a.propId)<a.propNum?(t.st=3,t.propId=a.propId,t):(this.addPropNum(a.propId,-a.propNum),this.$towerWeaponLvObj[this.$towerWeaponId]=e+1,t.st=1,t)},d.getTowerMapInfo=function(t){var e=this.$towerMapIdObj[t];return e||(e={floor:1}),e},d.addTowerMapFloor=function(t){var e=this.getTowerMapInfo(t),a=e.floor+1;I.getRowById(m.tableName.towerFloor,a)&&(e.floor++,this.$towerMapIdObj[t]=e)},d.getWeaponLv=function(t){void 0===t&&(t=this.$towerWeaponId);var e=this.$towerWeaponLvObj[t];return e||(e=1),e},d.checkPowerTime=function(){if(this.$power<this._maxPower)if(0==this.$powerTime)this.$powerTime=(new Date).getTime();else{var t=(new Date).getTime()-this.$powerTime,e=Math.floor(t/1e3/this._powerRevoverTime);e>0&&(this.$power+=e,this.$power=Math.min(this._maxPower,Math.max(0,this.$power)),this.$powerTime=this.$powerTime+e*this._powerRevoverTime*1e3)}else this.$powerTime=0},d.getCountTime=function(){return this.$power<this._maxPower?Math.max(0,Math.min(this._powerRevoverTime,this._powerRevoverTime-((new Date).getTime()-this.$powerTime)/1e3)):0},d.usePower=function(t){this.$power+=t,this.$power=Math.min(this._maxPower,Math.max(0,this.$power)),this.checkPowerTime()},d.useBaoShi=function(t,e){void 0===e&&(e=!1),this.$baoShi+=t,this.$baoShi=Math.max(0,this.$baoShi),e&&y.send(w.commonResRefresh)},d.useOptStone=function(t){this.$optStone+=t,this.$optStone=Math.max(0,this.$optStone),g.GetInstance().addDataVersion()},d.useDayAct=function(t){this.$dayAct+=t,this.$dayAct=Math.max(0,this.$dayAct),g.GetInstance().addDataVersion()},d.useEnergy=function(t){N.energyObj.num+=t,N.energyObj.num=Math.max(0,N.energyObj.num),g.GetInstance().addDataVersion()},d.checkAndUseBaoshi=function(t,e){return void 0===e&&(e=!1),this.$baoShi>=t&&(this.useBaoShi(0-t,e),!0)},d.useCoin=function(t,e){void 0===e&&(e=!1),this.$coin+=t,this.$coin=Math.max(0,this.$coin),e&&y.send(w.commonResRefresh),g.GetInstance().addDataVersion()},d.cheackAndUseCoin=function(t,e){return void 0===e&&(e=!1),this.$coin>=t&&(this.useCoin(0-t,e),!0)},d.addExp=function(t){this.$roleExp+=t;for(var e=I.getTable(m.tableName.heroLevel),a=this.roleLv+1;a<e.length;a++){var r=e[a-1];if(!(this.$roleExp>=r.exp))return;this.$roleLv=a,this.updateRoleAtkHp()}g.GetInstance().addDataVersion()},d.updateRoleAtkHp=function(){var t=I.getRowById(m.tableName.heroLevel,this.$roleLv);this._attack=t.atk,this._life=t.hp;for(var e=0;e<this.$wearProp.length;e++)if(this.$wearProp[e]>0){var a=I.getRowById(m.tableName.prop,this.$wearProp[e]);a&&a.atk&&(this._attack+=a.atk),a&&a.hp&&(this._life+=a.hp)}var r=this.getSuitPercentAdd();this._attack*=1+r.atk,this._life*=1+r.hp,this._attack=Math.floor(this._attack),this._life=Math.floor(this._life)},d.getSuitPercentAdd=function(){var t=this.getSuitId(),e=0,a=0;if(0!=t){var r=t[0],o=t[1],i=I.getRowById(m.tableName.suit,r);o>=5?(e=i.effectAtk_5,a=i.effectHP_5):o>=3&&(e=i.effectAtk_3,a=i.effectHP_3)}return{atk:e/100,hp:a/100}},d.weaponOptLvEffect=function(t,e){var a=I.getRowById(m.tableName.weaponOpt,e);return a&&(t*=1+a.atk/100,t=Math.ceil(t)),t},d.getTowerRoleProInfo=function(t){void 0===t&&(t=!1);for(var e=I.getRowById(m.tableName.heroLevel,this.$roleLv),a=e.atk,r=e.hp,o=0;o<this.$wearProp.length;o++){var i=this.$wearProp[o];if(0==o&&(i=this.$towerWeaponId,t&&(i=0)),i>0){var n=I.getRowById(m.tableName.prop,i);if(n&&n.atk){var s=n.atk;if(0==o){var h=this.getWeaponLv(i);s=this.weaponOptLvEffect(s,h)}a+=s}n&&n.hp&&(r+=n.hp)}}var p=this.getSuitPercentAdd();return a*=1+p.atk,r*=1+p.hp,{atk:a=Math.floor(a),hp:r=Math.floor(r)}},d.getNextLevelExp=function(){var t=I.getRowById(m.tableName.heroLevel,this.$roleLv+1);return t?t.exp:this.$roleExp},d.setCurMap=function(t){this.$curMap=t,g.GetInstance().addDataVersion()},d.getCurMap=function(){return this.$curMap},d.setWearProp=function(t){if(t){if(this.$wearProp[t.wearIndex-1]==t.id)return;0==this.$wearProp[t.wearIndex-1]?(this.$wearProp[t.wearIndex-1]=t.id,this.setPropWearById(t.id,1)):(this.setPropWearById(this.$wearProp[t.wearIndex-1],0),this.$wearProp[t.wearIndex-1]=t.id,this.setPropWearById(t.id,1)),P.ins().sendValueSettingMsg(D.RPM_PropWear,!1),this.updateRoleAtkHp()}},d.unWearProp=function(t){t&&this.$wearProp[t.wearIndex-1]==t.id&&(this.$wearProp[t.wearIndex-1]=0,this.setPropWearById(t.id,0),this.updateRoleAtkHp(),P.ins().sendValueSettingMsg(D.RPM_PropWear,!1),g.GetInstance().addDataVersion())},d.autoWearProp=function(t){t&&(this.$wearProp[t.wearIndex-1]==t.id?(this.$wearProp[t.wearIndex-1]=0,this.setPropWearById(t.id,0)):(this.$wearProp[t.wearIndex-1]=t.id,this.setPropWearById(t.id,1)),this.updateRoleAtkHp(),P.ins().sendValueSettingMsg(D.RPM_PropWear,!1),g.GetInstance().addDataVersion())},d.checkWearProp=function(t){return!!t&&this.$wearProp[t.wearIndex-1]==t.id},d.checkThisPropBestToWear=function(t){var e=I.getRowById(m.tableName.prop,t);if(e.wearIndex>0){if(0==this.$wearProp[e.wearIndex-1]){for(var a=0;a<this.$propData.length;a++){var r=I.getRowById(m.tableName.prop,this.$propData[a].id);if(r.wearIndex==e.wearIndex&&e.quality<r.quality)return!1}return!0}if(I.getRowById(m.tableName.prop,this.$wearProp[e.wearIndex-1]).quality<e.quality){for(var o=0;o<this.$propData.length;o++){var i=I.getRowById(m.tableName.prop,this.$propData[o].id);if(i.wearIndex==e.wearIndex&&e.quality<i.quality)return!1}return!0}}return!1},d.checkBestPropToWear=function(){for(var t=0;t<this.$propData.length;t++){var e=this.$propData[t],a=I.getRowById(m.tableName.prop,e.id);if(a.wearIndex>0){if(0==this.$wearProp[a.wearIndex-1])return!0;if(I.getRowById(m.tableName.prop,this.$wearProp[a.wearIndex-1]).quality<a.quality)return!0}}return!1},d.setPropById=function(t,e){for(var a=0;a<this.$propData.length;a++){var r=this.$propData[a];if(r.id==t)return void(r.num+=e)}this.$propData.push({id:t,num:e,iswear:0}),g.GetInstance().addDataVersion()},d.blessProp=function(t,e,a){this.setPropById(e,1),this.setPropById(t,a),P.ins().sendValueSettingMsg(D.RPM_BlessProp,!1);for(var r=0;r<this.$wearProp.length;r++)this.$wearProp[r]==t&&(this.$wearProp[r]=e,this.setPropWearById(e,1),this.setPropWearById(t,0),this.updateRoleAtkHp());y.send(w.updateDropData),g.GetInstance().addDataVersion()},d.checkPropCanBless=function(){for(var t=this.$propData,e=0;e<t.length;e++)if(t[e].num>=3){var a=I.getRowById(m.tableName.prop,t[e].id);if(a&&a.blessId&&a.blessId>0)return!0}return!1},d.checkChapterCanReward=function(){for(var t=r.getInstance().getLevelData(r.getInstance().getCurMap()),e=0;e<3;e++)if(t.Time>=60*(5*e+5)&&0==t.ReceiveState[e])return!0;return!1},d.setPropWearById=function(t,e){for(var a=0;a<this.$propData.length;a++){var r=this.$propData[a];if(r.id==t)return void(r.iswear=e)}g.GetInstance().addDataVersion()},d.setLevelData=function(t){if(I.getRowById(m.tableName.map,t.Level).type==m.mapTypes.main){var e=t.Level-1;if(e<0&&(e=0),null==this.$levelData[e]?this.$levelData[e]=t:t.Time>this.$levelData[e].Time&&(this.$levelData[e].Time=t.Time),this.$levelData[e].Time>=900&&this.$openLevel<=t.Level){var a=this.$openLevel+1;I.getRowById(m.tableName.map,a)&&(this.$openLevel++,this.$curMap=this.$openLevel,this._isShowOpenLevel=!0),g.GetInstance().addDataVersion()}}},d.getLevelData=function(t){var e=t-1;if(e<0&&(e=0),this.$levelData[e])return this.$levelData[e];var a={Level:t,Time:0,ReceiveState:[0,0,0]};return r.getInstance().setLevelData(a),a},d.getPropSort=function(){var t=[];for(var e in this.$propData){var a=this.$propData[e],r=I.getRowById(m.tableName.prop,a.id);8!=r.type&&11!=r.type||t.push(a)}return t.sort((function(t,e){var a=I.getRowById(m.tableName.prop,t.id),r=I.getRowById(m.tableName.prop,e.id);return a.wearIndex-r.wearIndex})),t},d.getPropById=function(t){for(var e=0;e<this.$propData.length;e++){var a=this.$propData[e];if(a.id==t)return a.num}return 0},d.getSuitId=function(){for(var t=[],e=0;e<this.$wearProp.length;e++){var a=this.$wearProp[e];if(a>0){var r=I.getRowById(m.tableName.prop,a);t[r.suit_id]||(t[r.suit_id]=0),t[r.suit_id]++}}for(var o=0;o<t.length;o++)if(t[o]>=3)return[o,t[o]];return 0},d.getSuitNum=function(t){for(var e=t.suit_id,a=0,r=0;r<this.$wearProp.length;r++){var o=this.$wearProp[r];if(o>0)I.getRowById(m.tableName.prop,o).suit_id==e&&a++}return a},d.tobePropItem=function(t){for(var e=[],a=0;a<t.length;a++){var r={Id:t[a][0],Num:t[a][1]};e.push(r)}return e},d.getPropNumById=function(t){var e=0;switch(I.getRowById(m.tableName.prop,t).type){case 1:e=this.$coin;break;case 9:e=this.$baoShi;break;case 10:e=this.$roleExp;break;case 12:e=this.$power;break;case 14:e=this.$optStone;break;case 15:e=this.$dayAct;break;default:for(var a in this.$propData){var r=this.$propData[a];if(r.id==t){e=r.num;break}}}return e},d.addPropNum=function(t,e){var a={Id:t,Num:e};return this.getRewardProp([a]),a},d.addPropByDesign=function(t){return this.addPropNum(t[0],t[1])},d.addPropArrByDesign=function(t){var e=[];for(var a in t){var r=t[a],o={Id:r[0],Num:r[1]};e.push(o)}return this.getRewardProp(e),e},d.getRewardProp=function(t,e){void 0===e&&(e=1);for(var a=0;a<t.length;a++){var r=t[a],o=I.getRowById(m.tableName.prop,r.Id);o?1==o.type?this.useCoin(r.Num*e):10==o.type?this.addExp(r.Num*e):8==o.type||11==o.type?(this.setPropById(r.Id,r.Num*e),P.ins().sendValueSettingMsg(D.RPM_PropWear,!1),P.ins().sendValueSettingMsg(D.RPM_BlessProp,!1)):9==o.type?this.useBaoShi(r.Num*e):12==o.type?this.usePower(r.Num*e):14==o.type?this.useOptStone(r.Num*e):15==o.type?this.useDayAct(r.Num*e):16==o.type?this.useEnergy(r.Num*e):this.setPropById(r.Id,r.Num*e):l.e("prop is not in design",o)}y.send(w.commonResRefresh),this.saveData()},d.checkUseProp=function(t){var e=I.getRowById(m.tableName.prop,t.Id);if(e)return 1==e.type?this.$coin>=t.Num&&(this.useCoin(0-t.Num),!0):9==e.type?this.$baoShi>=t.Num&&(this.useBaoShi(0-t.Num),!0):14==e.type?this.$optStone>=t.Num&&(this.useOptStone(0-t.Num),!0):void 0;l.e("prop is not in design",e)},d.showGetAnimal=function(t,e,a,r){for(var s=$.getCircleDirectionArr(10,100),h=0;h<10;h++){var p=o(e);t.addChild(p),p.layer=t.layer,i(p).set({positon:n(a[0],a[1],0)}).to(.2,{positon:n(s[h].x,s[h].y,0)}).to(.5,{positon:n(r[0],r[1],0)}).start(),$.drawCurvePath(p,[s[h].x,s[h].y],[r[0],r[1]],.2+.2*Math.random(),30,.1+.05*h)}},d.stringToArr=function(t){var e=t.indexOf("["),a=t.indexOf("]");return t.substring(e+1,a).split(",")},d.initEvent=function(){var t=this;s.on(h.EVENT_HIDE,(function(){console.log("切到后台了"),t.resetAccount||(N.isInDevelopmentEnvironment()&&t.load(),t.$time=Date.now(),t.saveData(),console.log("保存结束了"),f.getInstance().uploadAllRecord(t.getLocalData()),console.log("执行到这里了结束了"))})),s.on(h.EVENT_SHOW,(function(){v.gameOnShow()}))},d.saveData=function(){y.send(w.saveDataBefore);var t=p.createMap(!0);for(var e in this)-1!=e.indexOf("$")&&(t[e]=this[e]);u.localStorage.setItem(this.$localKey,JSON.stringify(t)),g.GetInstance().addDataVersion(),y.send(w.saveDataAfter)},d.getLocalData=function(){var t=p.createMap(!0);for(var e in this)-1!=e.indexOf("$")&&(t[e]=this[e]);return{userData:JSON.stringify(t),version:g.GetInstance().dataVersion,friendPassCnt:this.$friendPassCnt,videoCalCnt:this.$videoCalCnt}},d.loadServerData=function(t){console.log("---------各种问题---",t),g.GetInstance().dataVersion=t.version;var e=t.userData;e&&p.mixin(this,JSON.parse(e)),u.localStorage.setItem(this.$localKey,JSON.stringify(e))},d.remove=function(){u.localStorage.removeItem(this.$localKey),this.onInit(),y.send(w.commonResRefresh)},d.clearAccountData=function(){g.GetInstance().addDataVersion(),f.getInstance().uploadAllRecord({version:g.GetInstance().dataVersion+1}),u.localStorage.removeItem("dataVersion"),this.resetAccount=!0},d.load=function(){var t=u.localStorage.getItem(this.$localKey);console.log("---------读取本地数据---",t),t?(console.log("---------本地数据存在---"),p.mixin(this,JSON.parse(t))):(console.log("---------本地数据不存在---"),this.setConfig())},d.getDrawItem=function(t){var e=this,a=2;0==t?(this.$drawNormalNum++,a=2):(this.$drawGradeNum++,a=1);var r=!1;2==a?this.$drawNormalNum>=I.config.extra2&&(r=!0,this.$drawNormalNum=0):this.$drawGradeNum>=I.config.extra1&&(r=!0,this.$drawGradeNum=0);var o=I.getRowsByType(m.tableName.draw,a);(NaN==this._drawAllWeight[a]||this._drawAllWeight[a]<=0)&&(this._drawAllSureWeight[a]=0,o.forEach((function(t){a==t.type&&(e._drawAllWeight[a]+=t.weight,""!=t.extra&&(e._drawAllSureWeight[a]+=parseInt(t.extra)))})));var i=null;if(r)for(var n=Math.floor(Math.random()*this._drawAllSureWeight[a]),s=0;s<o.length;s++){var h=o[s];if(a==h.type&&h.extra&&(n-=h.extra)<=0){i=h;break}}else for(var p=Math.floor(Math.random()*this._drawAllWeight[a]),u=0;u<o.length;u++){var d=o[u];if(a==d.type&&(p-=d.weight)<=0){i=d;break}}return null==i&&console.log("item null 没抽中 "),i},d.getCurPatrolData=function(){if(this.$patrolStartTime<=0)this.$patrolStartTime=(new Date).getTime();else{var t=(new Date).getTime(),e=this.getPatrolReward();this.$patrolStartTime=t,this.$patrolRewardPropArr=[],this.$patrolRewardProp=[],this.getRewardProp(e)}},d.getPatrolTime=function(){var t=(new Date).getTime();return Math.min(60*I.config.towerTop,Math.floor((t-this.$patrolStartTime)/1e3))},d.getPatrolReward=function(){var t=this.getPatrolTime(),e=Math.floor(t*I.config.towerExp/60),a=Math.floor(t*I.config.towerCoin/60),r=[];r.push({Id:101,Num:a}),r.push({Id:901,Num:e});for(var o=I.config.towerItem,i=Math.floor(t/600),n=0;n<i;n++)if(1!=this.$patrolRewardProp[n]){for(var s=0;s<o.length;s++){if(Math.random()<o[s][1]/1e4){var h={Id:o[s][0],Num:1};l.i("抽中 ",o[s][0]),this.$patrolRewardPropArr.push(h)}}this.$patrolRewardProp[n]=1}return this.$patrolRewardPropArr.forEach((function(t){r.push(t)})),r},d.getPatrolState=function(){var t=this.getPatrolTime();return t<600?600-t:0},d.getPatrolRewardByTime=function(t){var e=Math.floor(t*I.config.towerExp/60),a=Math.floor(t*I.config.towerCoin/60),r=[];r.push({Id:101,Num:a}),r.push({Id:901,Num:e});for(var o=I.config.towerItem,i=Math.floor(t/600),n=0;n<i;n++)for(var s=0;s<o.length;s++){if(Math.random()<o[s][1]/1e4){var h={Id:o[s][0],Num:1};l.i("抽中 ",o[s][0]),r.push(h)}}return r},d.setPyramidState=function(t){this.$pyramidState[t]=1,g.GetInstance().addDataVersion()},a(r,[{key:"heroSkin",get:function(){return this.$heroSkin},set:function(t){for(var e=0;e<this.$propData.length;e++)if(this.$propData[e].id==t&&this.$propData[e].num>0)return void(this.$heroSkin=t)}},{key:"roleLv",get:function(){return this.$roleLv}},{key:"power",get:function(){return this.checkPowerTime(),this.$power}},{key:"baoshi",get:function(){return this.$baoShi}},{key:"optStone",get:function(){return this.$optStone}},{key:"dayAct",get:function(){return this.$dayAct},set:function(t){this.$dayAct=t,g.GetInstance().addDataVersion()}},{key:"energy",get:function(){return N.energyObj.num}},{key:"coin",get:function(){return this.$coin}},{key:"attack",get:function(){return this._attack}},{key:"life",get:function(){return this._life}},{key:"roleExp",get:function(){return this.$roleExp}},{key:"openLevel",get:function(){return this.$openLevel},set:function(t){this.$openLevel=t,g.GetInstance().addDataVersion()}},{key:"mapData",get:function(){return this.$mapData},set:function(t){this.$mapData=t,g.GetInstance().addDataVersion()}},{key:"playerData",get:function(){return this.$playerData},set:function(t){this.$playerData=t,g.GetInstance().addDataVersion()}},{key:"mapHand",get:function(){return this.$mapHand},set:function(t){this.$mapHand=t,g.GetInstance().addDataVersion()}},{key:"wearProp",get:function(){return this.$wearProp}},{key:"propData",get:function(){return this.$propData}}]),r}(d))._instance=null,r._RF.pop()}}}));

System.register("chunks:///_virtual/utilTools.ts",["cc","./localization.ts"],(function(r){"use strict";var t,n,e;return{setters:[function(r){t=r.cclegacy,n=r.resources},function(r){e=r.localizeManager}],execute:function(){t._RF.push({},"b89676Mxu5K2pyA+Ct5gTyj","utilTools",void 0),String.prototype.format=function(){var r=this;for(var t in arguments)r=r.replace(/\%\w/,arguments[t]);return r};var o=r("utilTools",{getCurGameVersion:function(){return new Promise((function(r,t){n.load("version",(function(n,e){if(n)return console.error("加载 version.json 失败：",n),void t(n);var o=e.json;o.version?r(o.version):t("the version is null")}))}))},getRandomSign:function(){return Math.random()>.5?1:-1},radianToAngle:function(r){return r/Math.PI*180},angleToRadian:function(r){return r/180*Math.PI},forArr:function(r,t){var n=r.length;if(!(n<=0))for(var e=0;e<n;e++){var o=r[e];if(null!=o)if(t(o,e))break}},waterfall:function(r,t){if(t||(t=function(){}),!Array.isArray(r)||r.length<=0)t("taskArr is null");else{var n=0,e={};!function o(){var i=r[n];i?i(e,(function(r){r?t(r,null):(n++,o())})):t(null,e)}()}},valToPercent:function(r,t){return r=Math.floor(1e4*r),null==t&&(t=2),(100*(r/=1e4)).toFixed(t)+"%"},getTimeStr:function(r,t){var n="";r<0&&(r=0),r/=1e3;var e=Math.floor(r/3600),o=Math.floor((r-3600*e)/60),i=Math.floor(r-3600*e-60*o);return t?o+=60*e:n=e>=10?n+e+":":n+"0"+e+":",n=o>=10?n+o+":":n+"0"+o+":",i>=10?n+=i:n=n+"0"+i,n},getTimeStrChinese:function(r,t,n,o){void 0===t&&(t=!0);var i="";r<0&&(r=0),r/=1e3;var a=Math.floor(r/3600),l=Math.floor((r-3600*a)/60),u=Math.floor(r-3600*a-60*l);return a>0&&(i=i+a+e._localize(null,"hour","common")),i=l>=10?i+l+e._localize(null,"min","common"):i+"0"+l+e._localize(null,"min","common"),t&&(i=u>=10?i+u+e._localize(null,"sec","common"):i+"0"+u+e._localize(null,"sec","common")),i},timeStrToDate:function(r){if("object"!=typeof r||null==r)return r;if(Array.isArray(r))for(var t in r){var n=r[t];n&&"object"==typeof n&&o.timeStrToDate(n)}else{var e=Object.keys(r);for(var i in e){var a=e[i]+"",l=r[a];if(l&&"object"==typeof l)o.timeStrToDate(l);else try{a.length>=4&&"time"==a.substring(a.length-4,a.length).toLocaleLowerCase()&&l&&"string"==typeof l&&(r[a]=new Date(l))}catch(t){console.log("utilTools.timeStrToDate error:"+t.message,t,r)}}}return r},sortArr:function(r,t){if(!r||r.length<=1)return r;for(var n=0;n<r.length-1;n++)for(var e=n+1;e<r.length;e++){var o=r[n],i=r[e];t(o,i)&&(r[n]=i,r[e]=o)}},isProb:function(r){return r||(r=0),Math.random()<r},randomArr:function(r,t){void 0===t&&(t=!1),t||(r=JSON.parse(JSON.stringify(r)));for(var n=[];r.length>0;){var e=Math.floor(Math.random()*r.length);n.push(r[e]),r.splice(e,1)}return n},getFloatValue:function(r,t,n){var e=t-r;return 0==e?r:e<0?0:n?r+Math.floor(Math.random()*(e+1)):r+Math.random()*e},overDay:function(r,t){if(!r)return!0;t||(t=new Date);var n=!1;return r.getDate()==t.getDate()?t.getTime()-r.getTime()>=864e5&&(n=!0):n=!0,n},getRowsByWeightAndNum:function(r,t,n){t||(t=1);var e=[];r=o.copyObj(r);for(var i=0;i<t&&!(r.length<=0);i++){var a=this.getRowByWeight(r);if(e.push(a),!n){var l=r.indexOf(a);r.splice(l,1)}}return e},getRowByWeight:function(r,t){if(!t)for(var n in t=0,r){(a=r[n].weight)||(a=0),t+=a}var e=Math.random()*t,o=0,i=null;for(var n in r){var a,l=r[n];if((a=l.weight)||(a=0),e>=o&&e<o+a){i=l;break}o+=a}return i},getRandomItemByArr:function(r,t){if(void 0===t&&(t=!1),!r||r.length<=0)return null;var n=Math.floor(Math.random()*r.length),e=r[n];return t&&r.splice(n,1),e},copyObj:function(r){return JSON.parse(JSON.stringify(r))}});t._RF.pop()}}}));

System.register("chunks:///_virtual/VipLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./sdkManager.ts","./constants.ts","./localText.ts","./msgac.ts","./designManager.ts","./eventManager.ts","./playerModel.ts","./UserData.ts","./BaseLayer.ts"],(function(t){"use strict";var e,i,a,o,n,s,c,r,h,p,l,d,y;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,a=t._decorator,o=t.find},function(t){n=t.sdkManager},function(t){s=t.constants},function(t){c=t.localText},function(t){r=t.msgac},function(t){h=t.designManager},function(t){p=t.eventManager},function(t){l=t.playerModel},function(t){d=t.UserData},function(t){y=t.BaseLayer}],execute:function(){var v;i._RF.push({},"65d95RVlY1HpbS1t/Mm0AZ0","VipLayer",void 0);var u=a.ccclass;a.property,t("VipLayer",u("VipLayer")(v=function(t){function i(){for(var e,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))||this).choseVip=void 0,e}e(i,t);var a=i.prototype;return a.onLoad=function(){t.prototype.onLoad.call(this),this.choseVip=l.vipObj.vip},a.onEnable=function(){t.prototype.onEnable.call(this)},a.onDisable=function(){t.prototype.onDisable.call(this)},a.onDestroy=function(){t.prototype.onDestroy.call(this)},a.initUI=function(){this.getNodeByPath("ui/title").localize("title",s.layers.VipLayer),this.getNodeByPath("ui/info/itemLayer/btnBox1/flag/text").localizeImg(),this.getNodeByPath("ui/info/itemLayer/btnBox2/flag/text").localizeImg();var t=l.vipObj.vip;this.setString(this.getNodeByPath("ui/top/rank/val"),t);var e=this.getNodeByPath("ui/top/bar/info"),i=h.getRowById(s.tableName.vip,t),a=h.getRowById(s.tableName.vip,t+1),n=this.getNodeByPath("ui/top/btnGet");n.getChildByName("text").localize("get",s.catName.common),a?(e.active=!0,n.active=!0,o("text1",e).localize("text1",s.layers.VipLayer),o("text2",e).localize("text2",s.layers.VipLayer),this.setString(o("val",e),i.adNum),this.setString(o("vip",e),"VIP"+a.id),this.setProgressBar(this.getNodeByPath("ui/top/bar"),l.vipObj.adNum/i.adNum),this.setString(this.getNodeByPath("ui/top/bar/val"),l.vipObj.adNum+"/"+i.adNum)):(n.active=!1,e.active=!1,this.setProgressBar(this.getNodeByPath("ui/top/bar"),1),this.setString(this.getNodeByPath("ui/top/bar/val"),c.full)),this.getNodeByPath("ui/vip").localize({cat:s.layers.VipLayer,key:"hint",vars:[this.choseVip]});var r=h.getRowById(s.tableName.vip,this.choseVip);this.getNodeByPath("ui/text").localize({cat:s.layers.VipLayer,key:"info",vars:[100*r.atkAdd]});var p=this.getNodeByPath("ui/info/itemLayer/btnBox1/btnGetBox1"),d=this.getNodeByPath("ui/info/itemLayer/btnBox1/hasGet");p.getChildByName("text").localize("get",s.catName.common),d.getChildByName("text").localize("hasGet",s.catName.common),p.active=!1,d.active=!1,l.vipObj.onceObj[this.choseVip]?d.active=!0:this.choseVip<=t&&(p.active=!0);var y=this.getNodeByPath("ui/info/itemLayer/btnBox2/btnGetBox2"),v=this.getNodeByPath("ui/info/itemLayer/btnBox2/hasGet");y.getChildByName("text").localize("get",s.catName.common),v.getChildByName("text").localize("hasGet",s.catName.common),y.active=!1,v.active=!1,this.choseVip==t&&(l.vipObj.dayAward?v.active=!0:y.active=!0)},a.processEvent=function(t,e){},a.onButtonClick=function(t,e){},a.onClickBtnGetBox1=function(){if(!(this.choseVip>l.vipObj.vip||l.vipObj.onceObj[this.choseVip])){var t=h.getRowById(s.tableName.vip,this.choseVip),e=d.getInstance().addPropArrByDesign(t.award);this.openAwardGetLayer(e),l.vipObj.onceObj[this.choseVip]=1,this.initUI(),p.send(r.refreshRedPoint)}},a.onClickBtnGetBox2=function(){if(!(this.choseVip>l.vipObj.vip||l.vipObj.dayAward)){var t=h.getRowById(s.tableName.vip,this.choseVip),e=d.getInstance().addPropArrByDesign(t.dayAward);this.openAwardGetLayer(e),l.vipObj.dayAward=1,this.initUI(),p.send(r.refreshRedPoint)}},a.onClickBtnLeft=function(){this.choseVip<=1||(this.choseVip--,this.initUI())},a.onClickBtnRight=function(){h.getRowById(s.tableName.vip,this.choseVip+1)&&(this.choseVip++,this.initUI())},a.onClickBtnBox1=function(){if(l.vipObj.onceObj[this.choseVip]){var t=h.getRowById(s.tableName.vip,this.choseVip);this.openAwardInfoLayer(t.award)}else this.onClickBtnGetBox1()},a.onClickBtnBox2=function(){if(l.vipObj.dayAward){var t=h.getRowById(s.tableName.vip,this.choseVip);this.openAwardInfoLayer(t.dayAward)}else this.onClickBtnGetBox2()},a.onClickBtnGet=function(){var t=this;n.openAd("VIP特权",(function(e){1==e&&(l.addVipAdNum()&&(t.choseVip=l.vipObj.vip),t.initUI(),p.send(r.refreshRedPoint))}))},i}(y))||v);i._RF.pop()}}}));

System.register("chunks:///_virtual/Vivo.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){"use strict";var n,e;return{setters:[function(o){n=o.createClass},function(o){e=o.cclegacy}],execute:function(){e._RF.push({},"8eeb4WeZnJL9ZZ3GiwfUkpJ","Vivo",void 0);var i=function(){function o(){this.bannerAd=void 0,this.interstitialAd=void 0,this.nativeAd=void 0,this.videoPosId="74668129b4b442539bed19caae5c8d9d",this.bannerPosId="6caa9e6062d243e195ca6ca8e9a50a0d",this.interstitialPosId="965c0f038e5a4b278940ad5864e1436c",this.nativePosId="9b47cc8e3ec04c6b9232da4618439804"}var e=o.prototype;return e.setKeepScreenOn=function(o){qg.setKeepScreenOn({keepSrceenOn:o,success:function(){console.log("设置屏幕常亮成功")},fail:function(){},complete:function(){}})},e.authorize_code=function(){return new Promise((function(o,n){qg.authorize({type:"code",success:function(n){o(n)},fail:function(o,e){n(o)}})}))},e.authorize_token=function(){return new Promise((function(o,n){qg.authorize({type:"token",success:function(n){o(n)},fail:function(o,e){n(o)}})}))},e.getProfile=function(o){return new Promise((function(n,e){qg.getProfile({token:o,success:function(o){n(o)},fail:function(o,n){e(o)}})}))},e.exitApplication=function(o){qg.exitApplication()},e.vibrateLong=function(o){qg.vibrateLong(),o&&o()},e.vibrateShort=function(o){qg.vibrateShort(),o&&o()},e.showRewardVideoAd=function(o){var n=this;if(this.systemInfo.platformVersionCode<1041)return o&&o(!1);if(!qg.createRewardedVideoAd)return o&&o(!1);this.videoAd||(this.videoAd={adObj:null,isInVideo:!1,callBack:null},this.videoAd.adObj=qg.createRewardedVideoAd({posId:this.videoPosId}),this.videoAd.adObj.onError((function(o){switch(n.videoAd.isInVideo=!1,n.videoAd.callBack&&n.videoAd.callBack(!1),console.log("视频广告创建失败"),o.errCode){case-3:console.log("激励广告加载失败---调用太频繁",JSON.stringify(o));break;case-4:console.log("激励广告加载失败--- 一分钟内不能重复加载",JSON.stringify(o));break;case 30008:break;default:console.log("激励广告展示失败",o)}})),this.videoAd.adObj.onLoad((function(){var o=n.videoAd.adObj.show();o&&o.then((function(){console.log("激励视频广告显示成功"),n.videoAd.isInVideo=!0})).catch((function(o){console.log("激励视频广告显示失败",o),n.videoAd.isInVideo=!1,n.videoAd.callBack&&n.videoAd.callBack(-1)}))})),this.videoAd.adObj.onClose((function(o){n.videoAd.isInVideo=!1,console.log("onClose!",o),o&&o.isEnded?n.videoAd.callBack&&n.videoAd.callBack(1):n.videoAd.callBack&&n.videoAd.callBack(0),n.videoAd.callBack=null}))),this.videoAd.isInVideo=!0,this.videoAd.callBack=o;var e=this.videoAd.adObj.load();e&&e.then((function(){console.log("激励视频广告加载成功"),n.videoAd.isInVideo=!0})).catch((function(o){n.videoAd.isInVideo=!1,console.log("激励视频广告加载失败",o),n.videoAd.callBack&&n.videoAd.callBack(-1)}))},e.showBannerAd=function(){var o=this;if(!(this.systemInfo.platformVersionCode<1041||this.bannerAd)){console.log("显示banner广告3");this.bannerAd=qg.createBannerAd({posId:this.bannerPosId,style:{}}),console.log("创建banner广告第一步",this.bannerAd),this.bannerAd.onSize((function(o){console.log("banner onResize",o)})),this.bannerAd.onLoad((function(){var n;o.bannerAd.offLoad&&o.bannerAd.offLoad(),console.log("banner 广告加载成功 ..."),(n=o.bannerAd.show())&&n.then((function(){console.log("banner广告展示成功")})).catch((function(o){switch(o.code){case 30003:console.log("新用户7天内不能曝光Banner，请将手机时间调整为7天后，退出游戏重新进入");break;case 30009:console.log("10秒内调用广告次数超过1次，10秒后再调用");break;case 30002:console.log("加载广告失败，重新加载广告");break;default:console.log("banner广告展示失败"),console.log(JSON.stringify(o))}}))})),this.bannerAd.onError((function(n){o.bannerAd.offError&&o.bannerAd.offError(),console.log("banner 广告创建失败 ...",n)})),this.bannerAd.onClose((function(n){o.bannerAd.offClose(),console.log("onClose 广告创建 ...",n)}))}},e.hideBannerAd=function(){var o=this;if(this.bannerAd){var n=this.bannerAd.destroy();n&&n.then((function(){console.log("banner广告销毁成功"),o.bannerAd.offLoad(),o.bannerAd.offError(),o.bannerAd.offSize()})).catch((function(o){console.log("banner广告销毁失败",o)}))}},e.showInterstitialAd=function(o){var n=this;if(this.systemInfo.platformVersionCode<1031)return o&&o(!1);if(!this.interstitialAd){console.log("显示插屏广告"),this.interstitialAd=qg.createInterstitialAd({posId:this.interstitialPosId});this.interstitialAd.onLoad((function(){var e;console.log("加载插屏广告成功"),(e=n.interstitialAd.show())&&e.then((function(){console.log("插屏广告展示成功"),o&&o()})).catch((function(o){switch(n.interstitialAd=null,o.code){case 30003:console.log("新用户7天内不能曝光Banner，请将手机时间调整为7天后，退出游戏重新进入");break;case 30009:console.log("10秒内调用广告次数超过1次，10秒后再调用");break;case 30002:console.log("load广告失败，重新加载广告");break;case 3e4:break;default:console.log("插屏广告展示失败"),console.log(o)}}))}),(function(){console.log("加载插屏广告失败"),n.interstitialAd=null})),this.interstitialAd.onError((function(o){console.log("插屏广告创建失败 ...",o),n.interstitialAd=null})),this.interstitialAd.onClose((function(){console.log("插屏 关闭 ..."),n.interstitialAd&&n.interstitialAd.offClose(),n.interstitialAd=null}))}},e.createNativeAd=function(o,n){var e=this;if(this.systemInfo.platformVersionCode<1053)return o&&o(!1);this.nativeAd=qg.createNativeAd({posId:this.nativePosId}),console.log("原生广告原生广告",this.nativeAd),this.nativeAd.onLoad((function(n){n&&n.adList?(console.log("原生广告",n),console.log(n.adList),console.log(n.adList[0]),o&&o(n.adList[0])):o&&o(null),e.reportAdShow(n.adList[0].adId)})),this.nativeAd.onError((function(o){console.log("原生广告加载失败",o),n&&n()}));var i=this.nativeAd.load();i&&i.then((function(){console.log("原生广告加载成功")})).catch((function(o){console.log("原生广告加载失败",JSON.stringify(o)),n&&n()}))},e.clickNativeAd=function(o){this.nativeAd&&this.nativeAd.reportAdClick({adId:o})},e.reportAdShow=function(o){this.nativeAd&&this.nativeAd.reportAdShow({adId:o})},e.desNativeAd=function(){console.log("销毁广告组件，释放资源",this.nativeAd),this.nativeAd.destroy()},e.getSetting=function(o,n){},n(o,[{key:"systemInfo",get:function(){return qg.getSystemInfoSync()}}]),o}();i._instance=new i;o("VivoManager",i._instance);e._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./audioManager.ts","./designManager.ts","./mapModel.ts","./playerModel.ts","./UserData.ts","./physicsGroup.ts","./BaseLayer.ts","./Monster.ts"],(function(t){"use strict";var i,e,o,n,a,s,l,d,c,r,h,u,p,g,f,v,y,w,m,P,U,b;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,n=t.BoxCollider2D,a=t.Contact2DType,s=t.find,l=t.Tween,d=t.v3,c=t.tween,r=t.Vec3,h=t.Vec2},function(t){u=t.cocosUtil},function(t){p=t.utilTools},function(t){g=t.constants},function(t){f=t.audioManager},function(t){v=t.designManager},function(t){y=t.mapModel},function(t){w=t.playerModel},function(t){m=t.UserData},function(t){P=t.physicsGroup},function(t){U=t.BaseLayer},function(t){b=t.Monster}],execute:function(){var k;e._RF.push({},"f10f3YlgP5L4LOzHlrtQCU3","Weapon",void 0);var N=o.ccclass;o.property,t("Weapon",N("Weapon")(k=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).info=void 0,i.id=void 0,i.direction=void 0,i.row=void 0,i.atk=void 0,i.atkPercentAdd=void 0,i.bodyNode=void 0,i.collider=void 0,i.lightNode=void 0,i.forward=void 0,i.targetNode=void 0,i.outV3=d(0,0,0),i.canFace=!0,i.parentPos=void 0,i.timeCount=0,i.weaponUtil=void 0,i}i(e,t);var o=e.prototype;return o.onLoad=function(){this.collider=this.node.getComponent(n),this.collider&&(this.collider.enabled=!1,this.collider.on(a.BEGIN_CONTACT,this.contactBegin,this)),this.bodyNode=s("body",this.node),this.lightNode=s("light",this.node),this.parentPos=this.node.parent.getPosition()},o.onDestroy=function(){this.unscheduleAllCallbacks(),this.weaponUtil&&this.weaponUtil.unscheduleAllCallbacks()},o.init=function(t){this.bodyNode||this.onLoad(),this.info=t;var i=t.id;this.id=i,this.unscheduleAllCallbacks(),l.stopAllByTarget(this.bodyNode);var e=v.getRowById(g.tableName.weapon,i);this.row=e,this.atk=e.atk;try{var o=u.addComponentOnce(this,"Weapon"+e.type);o.unscheduleAllCallbacks(),this.weaponUtil=o,o.init(this)}catch(t){}if(this.weaponUtil&&this.weaponUtil.isFixedPos){var n=this.node.getScale();0==t.uiIndex||3==t.uiIndex?this.node.setScale(d(Math.abs(n.x),n.y,n.z)):this.node.setScale(d(-Math.abs(n.x),n.y,n.z))}if(this.atkPercentAdd=0,this.weaponUtil&&this.weaponUtil.weaponId>0&&y.floor>0){var a=m.getInstance().getWeaponLv(this.weaponUtil.weaponId),s=v.getRowById(g.tableName.weaponOpt,a);this.atkPercentAdd=s.atk/100}if(y.weaponSystem.weaponArr[0]==t){var c=v.getRowById(g.tableName.vip,w.vipObj.vip);c&&(this.atkPercentAdd+=c.atkAdd)}},o.atkByDart=function(){var t=this;f.playEffect(this.row.audio);var i=u.convertToWorldSpace(this.node),e={};e.atkPercentAdd=this.atkPercentAdd,y.bulletSystem.addBullet(this.row.bulletId,P.PLAYER_BULLET,i,this.direction,e),this.timeCount=0,this.bodyNode.active=!1,c(this.bodyNode).delay(this.row.atkTime-.2).call((function(){t.bodyNode.active=!0,t.bodyNode.setScale(d(.1,.1,1))})).to(.2,{scale:d(1,1,1)},{easing:"quadOut"}).start()},o.atkByShot=function(){var t=this;f.playEffect(this.row.audio),this.lightNode&&(this.lightNode.active=!0,this.scheduleOnce((function(){t.lightNode.active=!1}),.03)),this.canFace=!1;var i=this.direction.clone().normalize().negative().multiplyScalar(20),e=this.node.getPosition();c(this.node).to(.05,{position:i},{easing:"quadOut"}).to(.05,{position:e},{easing:"quadIn"}).call((function(){t.canFace=!0,t.timeCount=0})).start()},o.atkByFist=function(t,i){var e=this;if(this.getDisTargetNode()>t)return!0;f.playEffect(this.row.audio);var o=this.direction.clone().normalize().negative().multiplyScalar(20),n=this.direction.clone().normalize().multiplyScalar(t),a=this.node.getPosition();this.canFace=!1,this.forward=!1,c(this.node).to(i,{position:o},{easing:"quadOut"}).call((function(){e.forward=!0,e.collider.enabled=!0})).to(2*i,{position:n},{easing:"quadOut"}).call((function(){e.forward=!1,e.collider.enabled=!1,e.weaponUtil&&e.weaponUtil.moveMaxFar&&e.weaponUtil.moveMaxFar()})).to(2*i,{position:a},{easing:"quadIn"}).call((function(){e.canFace=!0,e.timeCount=0})).start()},o.atkByStick=function(t){var i=this;if(!(this.getDisTargetNode()>t)){f.playEffect(this.row.audio),this.canFace=!1;var e=this.node.angle,o=.03;c(this.node).to(o,{angle:e+90}).call((function(){var t={};t.atkPercentAdd=i.atkPercentAdd,y.bulletSystem.addBullet(i.row.bulletId,P.PLAYER_BULLET,u.convertToWorldSpace(i.node),i.direction,t)})).to(o,{angle:e}).to(o,{angle:e-90}).call((function(){i.canFace=!0,i.timeCount=0})).start()}},o.targetForceMoveBack=function(t){if(this.forward){var i=t.getComponent(b);if(i&&i.row.type!=g.monsterTypes.boss){var e=this.direction.clone().normalize().multiplyScalar(50);c(t).by(.02,{position:e}).start()}}},o.getInfoPosition=function(t,i){var e=this.node.getPosition(),o=s("info",this.node);if(t>0&&(o=s("info"+t,this.node)),o){o.active=!1;var n=o.getPosition();r.rotateZ(n,n,r.ZERO,p.angleToRadian(this.node.angle)),e.x+=n.x,e.y+=n.y}return this.weaponUtil&&this.weaponUtil.isFixedPos&&this.node.scale.x<0&&(e.x=-e.x),i&&(e=u.convertToWorldSpaceWithPos(this.node,e)),e},o.contactBegin=function(t,i){if(i.group==P.MONSTER){var e=i.getComponent(b);if(e){var o=this.atk;this.atkPercentAdd>0&&(o*=1+this.atkPercentAdd,o=Math.ceil(o)),e.hitWithDam(o)}}this.weaponUtil&&this.weaponUtil.contactBegin&&this.weaponUtil.contactBegin(i.node)},o.getCalPosition=function(){var t=y.player.node.getPosition();return t.x+=this.parentPos.x,t.y+=this.parentPos.y,t},o.getDisTargetNode=function(){return this.targetNode?h.distance(this.getCalPosition(),this.targetNode.position):999999},o.updateLogic=function(t){this.targetNode=null;var i=y.mapSystem.getMinDisTargetNode(this.getCalPosition());if(i&&this.canFace){this.targetNode=i;var e=u.convertToWorldSpace(this.node),o=u.convertToWorldSpace(i),n=this.node.getScale();this.weaponUtil&&this.weaponUtil.isFixedPos||(e.x<=o.x?this.node.setScale(d(n.x,Math.abs(n.y),n.z)):this.node.setScale(d(n.x,-Math.abs(n.y),n.z))),o.subtract(e),this.direction=o;var a=p.radianToAngle(Math.atan2(o.y,o.x));this.weaponUtil&&(this.weaponUtil.isFixedDirection&&(a=a>-90&&a<=90?0:180),this.weaponUtil.isFixedPos&&(a=0)),this.node.angle=a,this.weaponUtil&&this.weaponUtil.stopTimeCount||(this.timeCount+=t,this.timeCount>=this.row.atkTime&&this.weaponUtil&&u.isValid(this.targetNode)&&this.weaponUtil.atk())}},e}(U))||k);e._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon1.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var n,e,o,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,r=t.Component}],execute:function(){var a;e._RF.push({},"eb75cIxY7pCw4EqtaskfNq3","Weapon1",void 0);var c=o.ccclass;o.property,t("Weapon1",c("Weapon1")(a=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return(n=t.call.apply(t,[this].concat(o))||this).weapon=void 0,n.weaponId=10130,n}n(e,t);var o=e.prototype;return o.init=function(t){this.weapon=t},o.atk=function(){this.weapon.atkByDart()},e}(r))||a);e._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./mapModel.ts","./physicsGroup.ts","./Hint.ts"],(function(t){"use strict";var n,o,e,c,i,s,a,r,u;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,c=t.Component},function(t){i=t.cocosUtil},function(t){s=t.constants},function(t){a=t.mapModel},function(t){r=t.physicsGroup},function(t){u=t.HintNames}],execute:function(){var p;o._RF.push({},"c5509xfbVZJL4esZufQHnOD","Weapon2",void 0);var l=e.ccclass;e.property,t("Weapon2",l("Weapon2")(p=function(t){function o(){for(var n,o=arguments.length,e=new Array(o),c=0;c<o;c++)e[c]=arguments[c];return(n=t.call.apply(t,[this].concat(e))||this).weapon=void 0,n.weaponId=10135,n.bulletId=7,n}n(o,t);var e=o.prototype;return e.init=function(t){this.weapon=t},e.atk=function(){this.weapon.atkByFist(300,.1)},e.contactBegin=function(t){a.hintSystem.addHint(u.hit1,i.convertToWorldSpace(t)),this.weapon.targetForceMoveBack(t)},e.moveMaxFar=function(){this.weapon.row.lv==s.design.maxLv&&a.bulletSystem.addBullet(this.bulletId,r.PLAYER_BULLET,i.convertToWorldSpace(this.weapon.node),null,this.weapon.node.angle)},o}(c))||p);o._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./mapModel.ts","./Hint.ts"],(function(t){"use strict";var n,o,e,c,i,a,s,r;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,c=t.Component},function(t){i=t.cocosUtil},function(t){a=t.constants},function(t){s=t.mapModel},function(t){r=t.HintNames}],execute:function(){var p;o._RF.push({},"f5930HqAsFLYJwEoWUnW3U5","Weapon3",void 0);var u=e.ccclass;e.property,t("Weapon3",u("Weapon3")(p=function(t){function o(){for(var n,o=arguments.length,e=new Array(o),c=0;c<o;c++)e[c]=arguments[c];return(n=t.call.apply(t,[this].concat(e))||this).weapon=void 0,n.weaponId=10140,n}n(o,t);var e=o.prototype;return e.init=function(t){this.weapon=t},e.atk=function(){this.weapon.atkByFist(300,.1)},e.contactBegin=function(t){this.weapon.row.lv==a.design.maxLv?s.hintSystem.addHint(r.hit7,i.convertToWorldSpace(t)):s.hintSystem.addHint(r.hit3,i.convertToWorldSpace(t)),this.weapon.targetForceMoveBack(t)},o}(c))||p);o._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon4.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){"use strict";var t,o,e,r;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,e=n._decorator,r=n.Component}],execute:function(){var i;o._RF.push({},"87f193XmIVPsoGBgcT84RKn","Weapon4",void 0);var c=e.ccclass;e.property,n("Weapon4",c("Weapon4")(i=function(n){function o(){for(var t,o=arguments.length,e=new Array(o),r=0;r<o;r++)e[r]=arguments[r];return(t=n.call.apply(n,[this].concat(e))||this).weapon=void 0,t.weaponId=10145,t.isFixedDirection=!0,t}t(o,n);var e=o.prototype;return e.init=function(n){this.weapon=n},e.atk=function(){this.weapon.atkByStick(500)},o}(r))||i);o._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon5.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./mapModel.ts","./Hint.ts","./constants.ts"],(function(n){"use strict";var t,o,e,a,i,c,s,r;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,e=n._decorator,a=n.Component},function(n){i=n.cocosUtil},function(n){c=n.mapModel},function(n){s=n.HintNames},function(n){r=n.constants}],execute:function(){var p;o._RF.push({},"e405cst8JNFQLZ6QAhoKYRD","Weapon5",void 0);var u=e.ccclass;e.property,n("Weapon5",u("Weapon5")(p=function(n){function o(){for(var t,o=arguments.length,e=new Array(o),a=0;a<o;a++)e[a]=arguments[a];return(t=n.call.apply(n,[this].concat(e))||this).weapon=void 0,t.weaponId=10150,t}t(o,n);var e=o.prototype;return e.init=function(n){this.weapon=n},e.atk=function(){var n=this,t=300;this.weapon.row.lv==r.design.maxLv&&(t=400),this.weapon.atkByFist(t,.05)||this.scheduleOnce((function(){n.weapon.row.lv==r.design.maxLv?c.hintSystem.addHint(s.hit4,i.convertToWorldSpace(n.weapon.node),n.weapon.node.angle):c.hintSystem.addHint(s.hit6,i.convertToWorldSpace(n.weapon.node),n.weapon.node.angle)}),.1)},e.contactBegin=function(n){c.hintSystem.addHint(s.hit5,i.convertToWorldSpace(n)),this.weapon.targetForceMoveBack(n)},o}(a))||p);o._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon6.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts","./AnimationCtrl.ts"],(function(n){"use strict";var t,e,o,a,i,c,l,s,r,u;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator,a=n.Component},function(n){i=n.cocosUtil},function(n){c=n.constants},function(n){l=n.audioManager},function(n){s=n.mapModel},function(n){r=n.physicsGroup},function(n){u=n.AnimationCtrl}],execute:function(){var p;e._RF.push({},"f797baKKVlBaapupRSrfXVD","Weapon6",void 0);var d=o.ccclass;o.property,n("Weapon6",d("Weapon6")(p=function(n){function e(){for(var t,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return(t=n.call.apply(n,[this].concat(o))||this).weapon=void 0,t.weaponId=10155,t.isFixedPos=!0,t.aniCtrl=void 0,t}t(e,n);var o=e.prototype;return o.init=function(n){this.weapon=n,this.unscheduleAllCallbacks(),this.aniCtrl=i.addComponentOnce(this,u),this.aniCtrl.playAnimation("1",!0)},o.atk=function(){var n=this;this.weapon.getDisTargetNode()>200||(l.playEffect(this.weapon.row.audio),this.weapon.canFace=!1,this.aniCtrl.playAnimationOnce("2"),this.scheduleOnce((function(){var t=n.weapon.getInfoPosition(0,!0),e={};e.atkPercentAdd=n.weapon.atkPercentAdd,s.bulletSystem.addBullet(n.weapon.row.bulletId,r.PLAYER_BULLET,t,null,e),n.weapon.row.lv==c.design.maxLv&&function(){for(var e=n.weapon.direction.clone().normalize(),o=0,a=[100,80,60,40],i=function(i){n.scheduleOnce((function(){o+=a[i]+a[i+1];var c=t.clone().add(e.clone().multiplyScalar(o)),l={};l.scale=.8-.2*i,l.atkPercentAdd=n.weapon.atkPercentAdd,s.bulletSystem.addBullet(n.weapon.row.bulletId,r.PLAYER_BULLET,c,null,l)}),.2*i+.2)},c=0;c<3;c++)i(c)}()}),.1),this.scheduleOnce((function(){n.weapon.canFace=!0,n.weapon.timeCount=0}),.32))},e}(a))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon7.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./audioManager.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var e,i,s,o,n,a,l,u,c,h;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,s=t._decorator,o=t.UITransform,n=t.Component},function(t){a=t.cocosUtil},function(t){l=t.constants},function(t){u=t.audioManager},function(t){c=t.mapModel},function(t){h=t.physicsGroup}],execute:function(){var r;i._RF.push({},"cb7391UjCxAgIU9XcT27b6W","Weapon7",void 0);var p=s.ccclass;s.property,t("Weapon7",p("Weapon7")(r=function(t){function i(){for(var e,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))||this).weapon=void 0,e.weaponId=10160,e.stopTimeCount=void 0,e.atkDis=400,e.isHitPass=!1,e.bullet=void 0,e}e(i,t);var s=i.prototype;return s.init=function(t){this.weapon=t,this.stopTimeCount=!1,this.weapon.row.lv==l.design.maxLv?(this.isHitPass=!0,this.atkDis=1e3):(this.isHitPass=!1,this.atkDis=400)},s.atk=function(){var t=this;if(!(this.weapon.getDisTargetNode()>this.atkDis)){this.stopTimeCount=!0;var e=this.weapon.getInfoPosition(0,!0);this.bullet=null;var i={};i.atkPercentAdd=this.weapon.atkPercentAdd,i.invokeClass=function(e){a.isValid(t.node)?(u.playEffect(t.weapon.row.audio),t.bullet=e,t.update()):t.bullet.recycleSelf()},c.bulletSystem.addBullet(this.weapon.row.bulletId,h.PLAYER_BULLET,e,this.weapon.direction,i),this.scheduleOnce(this.atkEnd,this.weapon.row.lv)}},s.atkEnd=function(){this.unschedule(this.atkEnd),this.weapon.timeCount=0,this.stopTimeCount=!1,a.isValid(this.bullet)&&(this.bullet.recycleSelf(),this.bullet=null)},s.forceDestroy=function(){this.atkEnd()},s.update=function(){if(this.bullet){this.bullet.node.angle=this.node.angle;var t=this.weapon.getInfoPosition(0,!0);if(t=a.convertToNodeSpace(this.bullet.node,t),this.bullet.node.setPosition(t),this.weapon.targetNode){var e=this.weapon.getDisTargetNode();this.isHitPass&&(e=this.atkDis),this.bullet.bulletUtil.setBodyWidth(e-.2*this.weapon.targetNode.getComponent(o).height),e>this.atkDis&&this.atkEnd()}}},i}(n))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon8.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./constants.ts","./mapModel.ts","./physicsGroup.ts"],(function(t){"use strict";var o,n,e,i,c,r,s,a;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,i=t.Component},function(t){c=t.cocosUtil},function(t){r=t.constants},function(t){s=t.mapModel},function(t){a=t.physicsGroup}],execute:function(){var p;n._RF.push({},"0c8d8yDhG9J8Yg5i2BgCTFf","Weapon8",void 0);var u=e.ccclass;e.property,t("Weapon8",u("Weapon8")(p=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this).weapon=void 0,o.weaponId=10165,o}o(n,t);var e=n.prototype;return e.init=function(t){this.weapon=t},e.atk=function(){var t=this,o=this.weapon.getInfoPosition(0,!0),n=1;this.weapon.row.lv==r.design.maxLv&&(n=3);var e=c.getSectorDirectionArr(this.weapon.direction,15,n),i={};i.atkPercentAdd=this.weapon.atkPercentAdd,e.forEach((function(n){s.bulletSystem.addBullet(t.weapon.row.bulletId,a.PLAYER_BULLET,o,n,i)})),this.weapon.atkByShot()},n}(i))||p);n._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./cocosUtil.ts","./utilTools.ts","./constants.ts","./designManager.ts","./resManager.ts","./BaseLayer.ts","./Weapon.ts"],(function(e){"use strict";var n,t,r,a,o,i,s,c,u,p,d,f,l;return{setters:[function(e){n=e.inheritsLoose,t=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){a=e.cclegacy,o=e._decorator,i=e.Prefab},function(e){s=e.cocosUtil},function(e){c=e.utilTools},function(e){u=e.constants},function(e){p=e.designManager},function(e){d=e.resManager},function(e){f=e.BaseLayer},function(e){l=e.Weapon}],execute:function(){var h;a._RF.push({},"b004fNa2AhH0YD5gpIzN4C+","WeaponSystem",void 0);var y=o.ccclass;o.property,e("WeaponSystem",y("WeaponSystem")(h=function(e){function a(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(n=e.call.apply(e,[this].concat(r))||this).weaponArr=void 0,n}n(a,e);var o=a.prototype;return o.onLoad=function(){e.prototype.onLoad.call(this),this.weaponArr=[]},o.onEnable=function(){e.prototype.onEnable.call(this)},o.initData=function(e){this.addWeapon(1,e.weaponId)},o.getSaveData=function(){var e={};return e.arr=this.weaponArr,e},o.loadSaveData=function(e){var n=this;c.forArr(e.arr,(function(e){n.addWeapon(0,e.id)}))},o.loadWeaponPrefab=function(e){return new Promise((function(n,t){d.loadAsset(u.bundles.weapon,e,i,null,(function(e,r){e?t():n(r)}))}))},o.getWeaponInfoByType=function(e){for(var n in this.weaponArr){var t=this.weaponArr[n];if(p.getRowById(u.tableName.weapon,t.id).type==e)return t}return null},o.addWeapon=function(){var e=t(r().mark((function e(n,t){var a,o,i,d,f,h,y,b,g,w,v;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=0),t>0&&(n=p.getRowById(u.tableName.weapon,t).type),a=null,o=0,e.t0=r().keys(this.weaponArr);case 5:if((e.t1=e.t0()).done){e.next=15;break}if(i=e.t1.value,d=this.weaponArr[i],p.getRowById(u.tableName.weapon,d.id).type!=n){e.next=13;break}return a=d,o=parseInt(i),e.abrupt("break",15);case 13:e.next=5;break;case 15:if(!a){e.next=22;break}if((f=p.getRowById(u.tableName.weapon,a.id+1))&&!(f.lv>u.design.maxLv)){e.next=19;break}return e.abrupt("return");case 19:a.id++,e.next=28;break;case 22:if(!(this.weaponArr.length>=u.design.weaponNum)){e.next=24;break}return e.abrupt("return");case 24:(a={}).id=p.getFirstIdByType(n),this.weaponArr.push(a),o=this.weaponArr.length-1;case 28:if(t>0&&(a.id=t),h=this.node.children[o]){e.next=32;break}return e.abrupt("return");case 32:return c.forArr(h.children,(function(e){var n=e.getComponent(l).weaponUtil;n&&n.forceDestroy&&n.forceDestroy(),e.destroy()})),a.uiIndex=o,y=a.id,b=p.getRowById(u.tableName.weapon,y),e.next=38,this.loadWeaponPrefab(b.prefab);case 38:if(g=e.sent,y==a.id&&s.isValid(this)){e.next=41;break}return e.abrupt("return");case 41:w=s.instantiate(g),v=w.addComponent(l),w.parent=h,v.init(a);case 45:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),o.updateLogic=function(e){c.forArr(this.node.children,(function(n,t){if(n.active){var r=n.children[0];r&&r.getComponent(l).updateLogic(e)}}))},a}(f))||h);a._RF.pop()}}}));

System.register("chunks:///_virtual/wechat.ts",["./rollupPluginModLoBabelHelpers.js","cc","./tyqSDK.ts"],(function(e){"use strict";var t,n,i,r;return{setters:[function(e){t=e.createClass},function(e){n=e.cclegacy,i=e.view},function(e){r=e.tyqSDK}],execute:function(){n._RF.push({},"d06fezwCoBE2Y+Q+xMyxDek","wechat",void 0);var o=null,s=null,d=function(){function e(){this.isWxAuthorize=!1,this.systemInfo=null,this.userInfoButton=null,this.bannerAd=null,this.rewardedVideoAd=null,this.interstitialAd=null,this.RiconAD=null,this.LiconAD=null,this.gridAd=null,this.gridAdCunt=null,this.GameRecorder=null,this.startListener=null,this.resumeListener=null,this.pauseListener=null,this.stopListener=null,this.errorListener=null,this.abortListener=null,this.timeUpdateListener=null,this.gameClub=null,this.feedbackButton=null,this.showListener=null,this.hideListener=null,this._bannerAdUnitId=[],this._bannerAdObjList=[],this._bannerShowIndex=0,this._bannerTimer=-1,this._bannerAdRefreshTimeOutId=0,this._rewardedVideoAdUnitId=[],this._curRewardVideoAdUnitId="",this._shareValue=0,this._rewardValue=1,this._interstitialAdUnitId=[],this._latticeAdUnitId="",this._RIconAdunit="",this._LIconAdunit="",this.mainBannerAD=null,this._userInfoButtonData={width:null,height:null,x:null,y:null,url:null},this._feedbackButtonData={width:null,height:null,x:null,y:null,url:null},this._bannerSize={width:600,height:172},this._gameClubSize={icon:"",x:0,y:0,width:0,height:0},this._closeRewardVideoListener=null,window.wx&&this.getSystemInfoSync()}var n=e.prototype;return n.preLoadAd=function(){this.createRewardedVideoAd(),this.preLoadBanner(),this.createInterstitialAd()},n.preLoadBanner=function(){for(var e=0;e<this._bannerAdUnitId.length;e++){var t=this._bannerAdUnitId[e],n=this.createBanner(t);this._bannerAdObjList.push(n)}},n.createBanner=function(e){var t=this,n={width:.65*this._bannerSize.width,height:.35*this._bannerSize.height},i=wx.createBannerAd({adUnitId:e,adIntervals:30,style:{left:this.systemInfo.windowWidth/2-n.width/2,top:this.systemInfo.windowHeight-n.height+.1*this.systemInfo.windowHeight,height:n.height,width:n.width}});return i.onLoad((function(){r.log("=====> @framework, banner广告加载成功"+e)})),i.onError((function(t){r.log("=====> @framework, banner广告加载失败：",e,t)})),i.onResize((function(e){i.style.left=t.systemInfo.windowWidth/2-e.width/2-.1,i.style.top=t.systemInfo.windowHeight-e.height+.1})),i},n.wetchatLogin=function(e,t){var n={wccode:null,wcencrypted:null,wciv:null};this.login((function(t){n.wccode=t,e&&e(t)}),(function(e){n.wcencrypted=e.encryptedData,n.wciv=e.iv,t&&t(n)}))},n.getSetting=function(t,n){e.isSupportedAPI(wx.getSetting)?wx.getSetting({success:function(e){t(e.authSetting["scope.userInfo"])},fail:function(e){n&&n(e)}}):(console.error("----\x3e 微信版本不支持getSetting API"),n&&n("----\x3e 微信版本不支持getSetting API"))},n.createUserInfoButton=function(t,n,o,s){void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=i.getVisibleSize().width),void 0===s&&(s=i.getVisibleSize().height),e.isSupportedAPI(wx.createUserInfoButton)?this.userInfoButton=wx.createUserInfoButton({type:"image",style:{left:t,top:n,width:i.getVisibleSize().width,height:i.getVisibleSize().height}}):r.log("=====> @framework,当前微信版本过低，无法使用授权按钮，请升级到最新微信版本后重试")},n.destroyAuthorizeBtn=function(){this.userInfoButton&&(this.userInfoButton.destroy(),this.userInfoButton=null)},n.onTapUserInfoButton=function(e,t){var n=this;this.userInfoButton?this.userInfoButton.onTap((function(i){r.log("onTap",i),i.userInfo?(n.destroyAuthorizeBtn(),e&&e(i)):t(i)})):t(null)},n.login=function(e,t){wx.login({success:function(t){e(t.code)},fail:function(){t()}})},n.getWxLoginResult=function(e){wx.login({success:function(t){console.warn("-----微信登录--",t),wx.getUserInfo({withCredentials:!0,success:function(n){console.warn("-----获取用户信息结果--",n),e(null,{code:t.code,encryptedData:n.encryptedData,iv:n.iv,userInfo:n.userInfo})},fail:function(){console.error("-----获取用户信息失败--"),e(new Error("获取微信用户信息失败，请检查网络状态"),null)}})},fail:function(){e(new Error("微信登录失败，请检查网络状态"),null)}})},n.wxGetSetting=function(){var e=this;return new Promise((function(t,n){try{wx.getSetting({success:function(i){if(console.log("微信授权信息1",i),i.authSetting["scope.userInfo"])e.isWxAuthorize=!0,console.log("已经授权了2"),t(i);else{console.log("未授权----");var r=wx.getSystemInfoSync(),o=r.screenWidth,s=r.screenHeight,d=wx.createUserInfoButton({type:"text",text:"",style:{left:0,top:0,width:o,height:s,lineHeight:60,backgroundColor:"rgba(0, 0, 0, 0)",color:"rgba(0, 0, 0, 0)",textAlign:"center",fontSize:24,borderRadius:4}});d.onTap((function(i){console.log("授权结果",i),"getUserInfo:ok"==i.errMsg?(e.isWxAuthorize=!0,console.log("授权结果1 resolve",i),t(i)):(console.log("授权结果2 reject",i),n(i)),d.hide()})),console.log("显示授权按钮",d),d.show()}},fail:function(e){console.log("微信授权失败处理函数11"),n(e)}})}catch(e){console.log("微信授权异常处理函数11"),n(e)}}))},n.getUserInfo=function(e,t){this.getSetting((function(n){wx.getUserInfo({success:function(t){e&&e(t)},fail:function(e){t&&t(e)}})}),(function(e){t&&(r.log(e),t("getsetting 失败"))}))},n.shareAppMessage=function(e,t,n){wx.shareAppMessage({title:e,imageUrl:t,query:n})},n.showBannerAd=function(t,n){if(void 0===n&&(n=30),e.isSupportedAPI(wx.createBannerAd))return this.bannerAd?(this.bannerAd.show(),void(t&&t(!0))):(this.createBannerAd(n,t),void this.bannerAd.show())},n.showBannerTurns=function(t){var n=this;e.isSupportedAPI(wx.createBannerAd)&&(clearInterval(this._bannerTimer),this.showBannerNext(),this._bannerTimer=setInterval((function(){n.showBannerNext()}),t))},n.showBannerNext=function(){var e=this;if(this._bannerAdObjList.length<=0)console.error("zzzzzzz无banner广告");else{this._bannerAdObjList.forEach((function(e){e.hide()})),this._bannerAdObjList[this._bannerShowIndex].hide(),this._bannerShowIndex++,this._bannerShowIndex>=this._bannerAdObjList.length&&(this._bannerShowIndex=0);var t=this._bannerAdObjList[this._bannerShowIndex];if(t)t.show().catch((function(){var n=e._bannerAdUnitId[e._bannerShowIndex];(t=e.createBanner(n))&&t.show()}));else{var n=this._bannerAdUnitId[this._bannerShowIndex];(t=this.createBanner(n))&&t.show()}}},n.hideBannerAd=function(){this.bannerAd&&this.bannerAd.hide(),0!=this._bannerAdRefreshTimeOutId&&(clearTimeout(this._bannerAdRefreshTimeOutId),this._bannerAdRefreshTimeOutId=0),clearInterval(this._bannerTimer),this._bannerAdObjList.forEach((function(e){e.hide()}))},n.destroyBannerAd=function(){this.bannerAd&&(this.bannerAd.destroy(),this.bannerAd=null),0!=this._bannerAdRefreshTimeOutId&&(clearTimeout(this._bannerAdRefreshTimeOutId),this._bannerAdRefreshTimeOutId=0)},n.createBannerAd=function(e,t,n){var i=this;void 0===n&&(n=!0),r.log("banner width= ",this._bannerSize.width,this._bannerAdUnitId);var o={width:.65*this._bannerSize.width,height:.35*this._bannerSize.height},s=this._bannerAdUnitId[Math.floor(Math.random()*this._bannerAdUnitId.length)];this.bannerAd=wx.createBannerAd({adUnitId:s,adIntervals:30,style:{left:this.systemInfo.windowWidth/2-o.width/2,top:this.systemInfo.windowHeight-o.height+.1*this.systemInfo.windowHeight,height:o.height,width:o.width}}),r.log("bannerSize: ",o,", systemInfo: ",this.systemInfo,",this.bannerAd.style: ",this.bannerAd.style),this.bannerAd.onLoad((function(){r.log("=====> @framework, banner广告加载成功"),0!=i._bannerAdRefreshTimeOutId&&(clearTimeout(i._bannerAdRefreshTimeOutId),i._bannerAdRefreshTimeOutId=0),n&&i.bannerAd.show(),t&&t(!0)})),this.bannerAd.onError((function(e){r.log("=====> @framework, banner广告加载失败：",e),t&&t(!1)})),this.bannerAd.onResize((function(e){i.bannerAd.style.left=i.systemInfo.windowWidth/2-e.width/2-.1,i.bannerAd.style.top=i.systemInfo.windowHeight-e.height+.1}))},n.showRewardVideoAd=function(e){var t=this;return new Promise((function(n,i){if(t.createRewardedVideoAd(),!t.rewardedVideoAd)return r.log("=====> @framework, 奖励视频对象为不存在"),i(),null;t.rewardedVideoAd.onClose((function e(i){i&&i.isEnded||void 0===i?n(!0):n(!1),t.closeRewardVideo(),t.rewardedVideoAd.offClose(e),t.rewardedVideoAd.offLoad(t.rewardedVideoAdOnLoadListener),t.rewardedVideoAd.offError(t.rewardedVideoAdOnErrorListener),t.rewardedVideoAd=null,t.createRewardedVideoAd()})),t.rewardedVideoAd.onError((function e(n){r.log("=====> @framework, 奖励视频发生错误：",n),t.rewardedVideoAd.load().then((function(){return t.rewardedVideoAd.show()})).then((function(){t.rewardedVideoAd.offError(e),t.rewardedVideoAd.offLoad(t.rewardedVideoAdOnLoadListener),t.rewardedVideoAd.offError(t.rewardedVideoAdOnErrorListener)})).catch((function(){t.rewardedVideoAd.offError(e),t.rewardedVideoAd.offLoad(t.rewardedVideoAdOnLoadListener),t.rewardedVideoAd.offError(t.rewardedVideoAdOnErrorListener),i()}))})),t.rewardedVideoAd.load().then((function(){t.rewardedVideoAd.show().then((function(){e&&e()}))}))}))},n.createRewardedVideoAd=function(){if(wx.createRewardedVideoAd){if(!this.rewardedVideoAd){var e=Math.floor(Math.random()*this._rewardedVideoAdUnitId.length);this.rewardedVideoAd=wx.createRewardedVideoAd({adUnitId:this._rewardedVideoAdUnitId[e]}),this._curRewardVideoAdUnitId=this._rewardedVideoAdUnitId[e],this.rewardedVideoAd.onLoad(this.rewardedVideoAdOnLoadListener.bind(this)),this.rewardedVideoAd.onError(this.rewardedVideoAdOnErrorListener)}}else r.log("=====> @framework,当前微信版本过低，无法使用奖励视频功能，请升级到最新微信版本后重试")},n.rewardedVideoAdOnErrorListener=function(){r.log("=====> @framework, 加载视频广告失败")},n.rewardedVideoAdOnLoadListener=function(e){r.log("=====> @framework, 加载视频广告成功",e),e&&(e.shareValue&&(this._shareValue=parseInt(e.shareValue)),e.rewardValue&&(this._rewardValue=parseInt(e.rewardValue)))},n.isShareBehavior=function(){return 1==this._shareValue},n.isRewardBehavior=function(){return 1==this._rewardValue},n.reportShareBehavior=function(e){e.adunit=this._curRewardVideoAdUnitId,e.sceneID=1,e.shareValue=this._shareValue,e.rewardValue=this._rewardValue,this.rewardedVideoAd.reportShareBehavior(e)?r.log("=====> @framework, 视频广告行为上报-成功",e):r.log("=====> @framework, 视频广告行为上报-失败",e)},n.closeRewardVideo=function(){this._closeRewardVideoListener&&this._closeRewardVideoListener()},n.showInterstitialAd=function(e,t){var n=this;if(wx.createInterstitialAd){this.createInterstitialAd();var i=function t(i){n.interstitialAd.offError(t),n.interstitialAd.offClose(o),n.interstitialAd.offLoad(n.interstitialAdOnLoadListener),n.interstitialAd=null,r.log("=====> @framework,插屏创建失败: ",i),e&&e()};this.interstitialAd.onError(i);var o=function t(o){n.interstitialAd.offError(i),n.interstitialAd.offClose(t),n.interstitialAd.offLoad(n.interstitialAdOnLoadListener),n.interstitialAd=null,r.log("----\x3e 插屏 广告关闭"),e&&e(),n.createInterstitialAd()};this.interstitialAd.onClose(o),this.interstitialAd.show().then((function(){r.log("----\x3e 成功显示插屏广告"),t&&t()}))}else r.log("=====> @framework,当前微信版本过低，无法使用插屏广告功能，请升级到最新微信版本后重试")},n.createInterstitialAd=function(){if(!this.interstitialAd){var e=this._interstitialAdUnitId[Math.floor(Math.random()*this._interstitialAdUnitId.length)];this.interstitialAd=wx.createInterstitialAd({adUnitId:e}),this.interstitialAd.onLoad(this.interstitialAdOnLoadListener)}},n.interstitialAdOnLoadListener=function(){r.log("=====> @framework,插屏创建成功")},n.createGameClubButton=function(){wx.createGameClubButton?this.gameClub||(this.gameClub=wx.createGameClubButton({icon:this._gameClubSize.icon,style:{left:this._gameClubSize.x/this.systemInfo.pixelRatio,top:this._gameClubSize.y/this.systemInfo.pixelRatio,width:this._gameClubSize.width,height:this._gameClubSize.height}}),this.gameClub.hide(),r.log("gameClub",this.gameClub)):r.log("=====> @framework,当前微信版本过低，无法使用游戏圈功能，请升级到最新微信版本后重试")},n.showGameClub=function(){r.log("显示游戏圈：",this.gameClub),this.createGameClubButton(),this.gameClub&&(this.gameClub.show(),r.log("显示游戏圈成功"))},n.hideGameClub=function(){this.gameClub&&this.gameClub.hide()},n.postMessage=function(e,t){var n={message:"",value:t};n.message=e,n.value=t,r.log("发送信息: ",n),wx.getOpenDataContext().postMessage(n)},n.createFeedbackButton=function(t,n){e.isSupportedAPI(wx.createFeedbackButton)?(this.feedbackButton=wx.createFeedbackButton({type:"image",image:this._feedbackButtonData.url,style:{left:this._feedbackButtonData.x,top:this._feedbackButtonData.y,width:this._feedbackButtonData.width,height:this._feedbackButtonData.height}}),t(this.feedbackButton)):(r.log("=====> @framework,当前微信版本过低，无法使用反馈按钮，请升级到最新微信版本后重试"),n())},n.onTapFeedbackButton=function(e,t){this.feedbackButton?this.feedbackButton.onTap((function(){e()})):t()},n.showFeedbackButton=function(){this.feedbackButton&&this.feedbackButton.show()},n.hideFeedbackButton=function(){this.feedbackButton&&this.feedbackButton.hide()},n.getGameRecorder=function(t,n){e.isSupportedAPI(wx.getGameRecorder)?(this.GameRecorder=wx.getGameRecorder(),t()):n()},n.registerRecordScreenEvent=function(){var t=this;e.isSupportedAPI(wx.getGameRecorder)?(this.GameRecorder=wx.getGameRecorder(),this.GameRecorder.on("start",(function(e){t.resumeListener&&t.resumeListener()})),this.GameRecorder.on("pause",(function(e){t.pauseListener&&t.pauseListener()})),this.GameRecorder.on("stop",(function(e){t.stopListener&&(r.log("视频的时长：",e.duration),t.stopListener(e.duration))})),this.GameRecorder.on("error",(function(e){r.log("=====> @framework,录屏错误：",e.error.message,",code: ",e.error.code),t.errorListener&&t.errorListener()})),this.GameRecorder.on("timeUpdate",(function(e){r.log("=====> @framework,录屏到第几秒：",e.currentTime),t.timeUpdateListener&&t.timeUpdateListener()})),this.GameRecorder.on("abort",(function(e){t.abortListener&&t.abortListener()}))):r.log("=====> @framework,当前客户端版过低，无法使用录制功能，请升级到最新客户端版本后重试")},n.startRecordScreen=function(e){},n.pauseRecordScreen=function(e){this.pauseListener=e,this.GameRecorder.pause()},n.resumeRecordScreen=function(e){this.resumeListener=e,this.GameRecorder.resume()},n.stopRecordScreen=function(e){this.stopListener=e,this.GameRecorder.stop()},n.abortRecordScreen=function(e){this.abortListener=e,this.GameRecorder.abort()},n.createGameRecorderShareButton=function(){},n.onShow=function(e){this.showListener=e,wx.onShow(this.onShowListener.bind(this))},n.offShow=function(){wx.offShow(this.onShowListener)},n.onHide=function(e){this.hideListener=e,wx.onHide(this.onHideListener.bind(this))},n.offHide=function(){this.hideListener=null,wx.offHide(this.onHideListener)},n.onShowListener=function(e){this.showListener&&this.showListener(e)},n.onHideListener=function(){this.hideListener&&this.hideListener()},n.navigateToMiniProgram=function(t,n,i,r){e.isSupportedAPI(wx.navigateToMiniProgram)?wx.navigateToMiniProgram({appId:t,path:n,envVersion:"release",success:function(){i()},fail:function(){r()},complete:function(){}}):r()},n.vibrateLong=function(e){e&&console.warn("----\x3e vibrateLong 微信可能没有cb"),wx.vibrateLong()},n.vibrateShort=function(e){console.warn("----\x3e vibrateShort 微信可能没有cb"),wx.vibrateShort()},n.getSystemInfoSync=function(){this.systemInfo=wx.getSystemInfoSync()},e.isSupportedAPI=function(e){return!!e||(wx.showModal({title:"提示",content:"当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。"}),!1)},n.exitMiniProgram=function(e){wx.exitMiniProgram(e)},n.showToast=function(e,t,n){void 0===t&&(t=3e3),wx.showToast({title:e,duration:t,success:function(){n&&n()}})},n.getSystemInfo=function(e){wx.getSystemInfo({success:function(t){e&&e(t)}})},n.aldSendEvent=function(e,t){r.log("send msg: ",e),wx.aldSendEvent?t?wx.aldSendEvent(e):wx.aldSendEvent(e,t):console.error("----\x3e 阿拉丁接入失败，请检查game.js")},n.createIconAd=function(){var e=this,t=[].concat(Array(s+1).map((function(e,t){return{appNameHidden:!1,color:"white",size:100,borderWidth:100,borderColor:"white",left:100*t,top:100}})));this.LiconAD=wx.createGameIcon({adUnitId:this._LIconAdunit,count:s,style:t}),this.LiconAD.onError((function(e){r.log("=====> @framework, 小游戏推荐左边icon加载失败：",e)})),this.LiconAD.onLoad((function(){r.log("=====> @framework, 小游戏推荐左边icon加载成功")})),this.LiconAD.onResize((function(t){var n;n=e.systemInfo.windowHeight/2-s/2*t[0].height;for(var i=0;i<t.length;i++)t[i].left=10,t[i].top=n+72*i}))},n.showIconAd=function(e){var t=this;"R"==e?this.RiconAD?this.RiconAD.load().then((function(){t.RiconAD.show()})).catch((function(e){console.error(e)})):setTimeout(this.createIconAd,1e3):this.LiconAD?this.LiconAD.load().then((function(){t.LiconAD.show()})).catch((function(e){console.error(e)})):setTimeout(this.createIconAd,1e3)},n.createGridAd=function(e){var t=this;this.gridAd=wx.createGridAd({adUnitId:o,adTheme:"white",gridCount:e,adIntervals:30,style:{left:0,top:this.systemInfo.windowHeight/2-350,width:500,opacity:.8}}),this.gridAd.onLoad((function(){r.log("=====> @framework, 格子广告加载成功"),t.gridAdCunt=e})),this.gridAd.onError((function(e){r.log("=====> @framework, 格子广告加载失败：",e)}))},n.showGridAd=function(e){e!=this.gridAdCunt&&(this.gridAd&&this.gridAd.destroy(),this.createGridAd(e)),this.gridAd.show()},n.hideGridAd=function(){this.gridAd.hide()},n.showShareMenu=function(e){void 0===e&&(e=!1),window.wx&&wx.showShareMenu({withShareTicket:e,menus:["shareAppMessage","shareTimeline"]})},t(e,[{key:"RIconAduni",set:function(e){this._RIconAdunit=e}},{key:"LIconAduni",set:function(e){this._LIconAdunit=e}},{key:"bannerAdUnitId",set:function(e){}},{key:"rewardedVideoAdUnitId",set:function(e){}},{key:"interstitialAdUnitId",set:function(e){}},{key:"bannerSize",set:function(e){this._bannerSize.width=e.width,this._bannerSize.height=e.height,console.log("this._bannerSize = ",this._bannerSize)}},{key:"latticeAdUnitId",set:function(e){this._latticeAdUnitId=e}},{key:"gameClubSize",set:function(e){this._gameClubSize.x=e.x,this._gameClubSize.y=e.y,this._gameClubSize.width=e.width,this._gameClubSize.height=e.height,this._gameClubSize.icon=e.icon}},{key:"userInfoButtonData",set:function(e){this._userInfoButtonData.width=e.width,this._userInfoButtonData.height=e.height,this._userInfoButtonData.x=e.x,this._userInfoButtonData.y=e.y,this._userInfoButtonData.url=e.url}},{key:"closeRewardVideoListener",set:function(e){this._closeRewardVideoListener=e}}]),e}();d._instance=new d;e("Wechat",d._instance);n._RF.pop()}}}));

System.register("chunks:///_virtual/weHttp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./weNetworkMgr.ts"],(function(t){"use strict";var r,n,e;return{setters:[function(t){r=t.createClass},function(t){n=t.cclegacy},function(t){e=t.NetworkMgr}],execute:function(){n._RF.push({},"173afuMo01FM6fOhHVnnAqs","weHttp",void 0);var o=function(){function t(){this._timeOut=1e4,this._httpUrl="",this._apiKey=""}var n=t.prototype;return n.init=function(t,r){this._httpUrl=t,this._apiKey=r},n.post=function(t,r,n){var o="";r&&(o=this.createSign(r));var u=new XMLHttpRequest;u.timeout=this._timeOut,u.open("POST",this._httpUrl+t,!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),u.send(o),u.onreadystatechange=function(){if(4===u.readyState&&u.status>=200&&u.status<300){var r=u.responseText;if(!r)return void e.onHttpError(n,null,"http request respone is null");e.checkRespone(t,r,n)}}.bind(this),u.ontimeout=function(t){console.error("http request timeout: ",t),e.onHttpError(n,null,"http request timeout: ")}.bind(this),u.onerror=function(t){e.onHttpError(n,t,"http request error: ")}.bind(this)},n.post2=function(t,r,n){var o=this.MsgToString(r),u=new XMLHttpRequest;u.timeout=this._timeOut,u.open("GET",this._httpUrl+t+"?"+o,!0),u.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),u.send(JSON.stringify(r)),u.onreadystatechange=function(){if(4===u.readyState&&u.status>=200&&u.status<300){var r=u.responseText;if(!r)return void e.onHttpError(n,null,"http request respone is null");e.checkRespone(t,r,n)}}.bind(this),u.ontimeout=function(t){console.error("http request timeout: ",t)}.bind(this),u.onerror=function(t){e.onHttpError(n,t,"http request error: ")}.bind(this)},n.MsgToString=function(t){for(var r="",n=0,e=Object.keys(t);n<e.length;n++){var o=e[n];r+=o+'="'+t[o]+'"&'}return r},n.strToDES3=function(t){},n.createSign=function(t){var r=new Array,n=0;for(var e in t)r[n]=e,n++;var o=r.sort(),u="";for(var e in o)(t[o[e]]||"number"==typeof t[o[e]])&&(u+=o[e]+"="+t[o[e]]+"&&");var i=u;return i+="api_key="+this._apiKey,u+="sign="+this.MD5(decodeURIComponent(i))},n.md5encode=function(t){var r,n=function(t,r){t[r>>5]|=128<<r%32,t[14+(r+64>>>9<<4)]=r;for(var n=1732584193,e=-271733879,c=-1732584194,f=271733878,h=0;h<t.length;h+=16){var p=n,l=e,d=c,v=f;n=o(n,e,c,f,t[h+0],7,-680876936),f=o(f,n,e,c,t[h+1],12,-389564586),c=o(c,f,n,e,t[h+2],17,606105819),e=o(e,c,f,n,t[h+3],22,-1044525330),n=o(n,e,c,f,t[h+4],7,-176418897),f=o(f,n,e,c,t[h+5],12,1200080426),c=o(c,f,n,e,t[h+6],17,-1473231341),e=o(e,c,f,n,t[h+7],22,-45705983),n=o(n,e,c,f,t[h+8],7,1770035416),f=o(f,n,e,c,t[h+9],12,-1958414417),c=o(c,f,n,e,t[h+10],17,-42063),e=o(e,c,f,n,t[h+11],22,-1990404162),n=o(n,e,c,f,t[h+12],7,1804603682),f=o(f,n,e,c,t[h+13],12,-40341101),c=o(c,f,n,e,t[h+14],17,-1502002290),e=o(e,c,f,n,t[h+15],22,1236535329),n=u(n,e,c,f,t[h+1],5,-165796510),f=u(f,n,e,c,t[h+6],9,-1069501632),c=u(c,f,n,e,t[h+11],14,643717713),e=u(e,c,f,n,t[h+0],20,-373897302),n=u(n,e,c,f,t[h+5],5,-701558691),f=u(f,n,e,c,t[h+10],9,38016083),c=u(c,f,n,e,t[h+15],14,-660478335),e=u(e,c,f,n,t[h+4],20,-405537848),n=u(n,e,c,f,t[h+9],5,568446438),f=u(f,n,e,c,t[h+14],9,-1019803690),c=u(c,f,n,e,t[h+3],14,-187363961),e=u(e,c,f,n,t[h+8],20,1163531501),n=u(n,e,c,f,t[h+13],5,-1444681467),f=u(f,n,e,c,t[h+2],9,-51403784),c=u(c,f,n,e,t[h+7],14,1735328473),e=u(e,c,f,n,t[h+12],20,-1926607734),n=i(n,e,c,f,t[h+5],4,-378558),f=i(f,n,e,c,t[h+8],11,-2022574463),c=i(c,f,n,e,t[h+11],16,1839030562),e=i(e,c,f,n,t[h+14],23,-35309556),n=i(n,e,c,f,t[h+1],4,-1530992060),f=i(f,n,e,c,t[h+4],11,1272893353),c=i(c,f,n,e,t[h+7],16,-155497632),e=i(e,c,f,n,t[h+10],23,-1094730640),n=i(n,e,c,f,t[h+13],4,681279174),f=i(f,n,e,c,t[h+0],11,-358537222),c=i(c,f,n,e,t[h+3],16,-722521979),e=i(e,c,f,n,t[h+6],23,76029189),n=i(n,e,c,f,t[h+9],4,-640364487),f=i(f,n,e,c,t[h+12],11,-421815835),c=i(c,f,n,e,t[h+15],16,530742520),e=i(e,c,f,n,t[h+2],23,-995338651),n=a(n,e,c,f,t[h+0],6,-198630844),f=a(f,n,e,c,t[h+7],10,1126891415),c=a(c,f,n,e,t[h+14],15,-1416354905),e=a(e,c,f,n,t[h+5],21,-57434055),n=a(n,e,c,f,t[h+12],6,1700485571),f=a(f,n,e,c,t[h+3],10,-1894986606),c=a(c,f,n,e,t[h+10],15,-1051523),e=a(e,c,f,n,t[h+1],21,-2054922799),n=a(n,e,c,f,t[h+8],6,1873313359),f=a(f,n,e,c,t[h+15],10,-30611744),c=a(c,f,n,e,t[h+6],15,-1560198380),e=a(e,c,f,n,t[h+13],21,1309151649),n=a(n,e,c,f,t[h+4],6,-145523070),f=a(f,n,e,c,t[h+11],10,-1120210379),c=a(c,f,n,e,t[h+2],15,718787259),e=a(e,c,f,n,t[h+9],21,-343485551),n=s(n,p),e=s(e,l),c=s(c,d),f=s(f,v)}return Array(n,e,c,f)},e=function(t,r,n,e,o,u){return s(c(s(s(r,t),s(e,u)),o),n)},o=function(t,r,n,o,u,i,a){return e(r&n|~r&o,t,r,u,i,a)},u=function(t,r,n,o,u,i,a){return e(r&o|n&~o,t,r,u,i,a)},i=function(t,r,n,o,u,i,a){return e(r^n^o,t,r,u,i,a)},a=function(t,r,n,o,u,i,a){return e(n^(r|~o),t,r,u,i,a)},s=function(t,r){var n=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(n>>16)<<16|65535&n},c=function(t,r){return t<<r|t>>>32-r};return function(t){for(var r="0123456789abcdef",n="",e=0;e<4*t.length;e++)n+=r.charAt(t[e>>2]>>e%4*8+4&15)+r.charAt(t[e>>2]>>e%4*8&15);return n}(n(function(t){for(var r=Array(),n=0;n<8*t.length;n+=8)r[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return r}(r=t),8*r.length))},n.MD5=function(t){var r=0;function n(t,r,n,e,o,u){return a((i=a(a(r,t),a(e,u)))<<(s=o)|i>>>32-s,n);var i,s}function e(t,r,e,o,u,i,a){return n(r&e|~r&o,t,r,u,i,a)}function o(t,r,e,o,u,i,a){return n(r&o|e&~o,t,r,u,i,a)}function u(t,r,e,o,u,i,a){return n(r^e^o,t,r,u,i,a)}function i(t,r,e,o,u,i,a){return n(e^(r|~o),t,r,u,i,a)}function a(t,r){var n=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(n>>16)<<16|65535&n}return function(t){for(var n,e=r?"0123456789ABCDEF":"0123456789abcdef",o="",u=0;u<t.length;u++)n=t.charCodeAt(u),o+=e.charAt(n>>>4&15)+e.charAt(15&n);return o}(function(t){return function(t){for(var r="",n=0;n<32*t.length;n+=8)r+=String.fromCharCode(t[n>>5]>>>n%32&255);return r}(function(t,r){t[r>>5]|=128<<r%32,t[14+(r+64>>>9<<4)]=r;for(var n=1732584193,s=-271733879,c=-1732584194,f=271733878,h=0;h<t.length;h+=16){var p=n,l=s,d=c,v=f;n=e(n,s,c,f,t[h+0],7,-680876936),f=e(f,n,s,c,t[h+1],12,-389564586),c=e(c,f,n,s,t[h+2],17,606105819),s=e(s,c,f,n,t[h+3],22,-1044525330),n=e(n,s,c,f,t[h+4],7,-176418897),f=e(f,n,s,c,t[h+5],12,1200080426),c=e(c,f,n,s,t[h+6],17,-1473231341),s=e(s,c,f,n,t[h+7],22,-45705983),n=e(n,s,c,f,t[h+8],7,1770035416),f=e(f,n,s,c,t[h+9],12,-1958414417),c=e(c,f,n,s,t[h+10],17,-42063),s=e(s,c,f,n,t[h+11],22,-1990404162),n=e(n,s,c,f,t[h+12],7,1804603682),f=e(f,n,s,c,t[h+13],12,-40341101),c=e(c,f,n,s,t[h+14],17,-1502002290),n=o(n,s=e(s,c,f,n,t[h+15],22,1236535329),c,f,t[h+1],5,-165796510),f=o(f,n,s,c,t[h+6],9,-1069501632),c=o(c,f,n,s,t[h+11],14,643717713),s=o(s,c,f,n,t[h+0],20,-373897302),n=o(n,s,c,f,t[h+5],5,-701558691),f=o(f,n,s,c,t[h+10],9,38016083),c=o(c,f,n,s,t[h+15],14,-660478335),s=o(s,c,f,n,t[h+4],20,-405537848),n=o(n,s,c,f,t[h+9],5,568446438),f=o(f,n,s,c,t[h+14],9,-1019803690),c=o(c,f,n,s,t[h+3],14,-187363961),s=o(s,c,f,n,t[h+8],20,1163531501),n=o(n,s,c,f,t[h+13],5,-1444681467),f=o(f,n,s,c,t[h+2],9,-51403784),c=o(c,f,n,s,t[h+7],14,1735328473),n=u(n,s=o(s,c,f,n,t[h+12],20,-1926607734),c,f,t[h+5],4,-378558),f=u(f,n,s,c,t[h+8],11,-2022574463),c=u(c,f,n,s,t[h+11],16,1839030562),s=u(s,c,f,n,t[h+14],23,-35309556),n=u(n,s,c,f,t[h+1],4,-1530992060),f=u(f,n,s,c,t[h+4],11,1272893353),c=u(c,f,n,s,t[h+7],16,-155497632),s=u(s,c,f,n,t[h+10],23,-1094730640),n=u(n,s,c,f,t[h+13],4,681279174),f=u(f,n,s,c,t[h+0],11,-358537222),c=u(c,f,n,s,t[h+3],16,-722521979),s=u(s,c,f,n,t[h+6],23,76029189),n=u(n,s,c,f,t[h+9],4,-640364487),f=u(f,n,s,c,t[h+12],11,-421815835),c=u(c,f,n,s,t[h+15],16,530742520),n=i(n,s=u(s,c,f,n,t[h+2],23,-995338651),c,f,t[h+0],6,-198630844),f=i(f,n,s,c,t[h+7],10,1126891415),c=i(c,f,n,s,t[h+14],15,-1416354905),s=i(s,c,f,n,t[h+5],21,-57434055),n=i(n,s,c,f,t[h+12],6,1700485571),f=i(f,n,s,c,t[h+3],10,-1894986606),c=i(c,f,n,s,t[h+10],15,-1051523),s=i(s,c,f,n,t[h+1],21,-2054922799),n=i(n,s,c,f,t[h+8],6,1873313359),f=i(f,n,s,c,t[h+15],10,-30611744),c=i(c,f,n,s,t[h+6],15,-1560198380),s=i(s,c,f,n,t[h+13],21,1309151649),n=i(n,s,c,f,t[h+4],6,-145523070),f=i(f,n,s,c,t[h+11],10,-1120210379),c=i(c,f,n,s,t[h+2],15,718787259),s=i(s,c,f,n,t[h+9],21,-343485551),n=a(n,p),s=a(s,l),c=a(c,d),f=a(f,v)}return Array(n,s,c,f)}(function(t){for(var r=Array(t.length>>2),n=0;n<r.length;n++)r[n]=0;for(n=0;n<8*t.length;n+=8)r[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return r}(t),8*t.length))}(function(t){for(var r,n,e="",o=-1;++o<t.length;)r=t.charCodeAt(o),n=o+1<t.length?t.charCodeAt(o+1):0,55296<=r&&r<=56319&&56320<=n&&n<=57343&&(r=65536+((1023&r)<<10)+(1023&n),o++),r<=127?e+=String.fromCharCode(r):r<=2047?e+=String.fromCharCode(192|r>>>6&31,128|63&r):r<=65535?e+=String.fromCharCode(224|r>>>12&15,128|r>>>6&63,128|63&r):r<=2097151&&(e+=String.fromCharCode(240|r>>>18&7,128|r>>>12&63,128|r>>>6&63,128|63&r));return e}(t)))},n.get=function(t,r,n,e){var o=new XMLHttpRequest;o.timeout=5e3;var u="?";for(var i in r)"?"!=u&&(u+="&"),u+=i+"="+r[i];null==e&&(e=GHttpClient.url);var a=e+t+u;return o.open("GET",a,!0),o.onreadystatechange=function(){if(4===o.readyState&&o.status>=200&&o.status<300)try{var t=JSON.parse(o.responseText);null!==n&&n(null,t)}catch(t){null!==n&&n(t)}},o.send(),o},r(t,[{key:"timeOut",set:function(t){this._timeOut=t}},{key:"httpUrl",set:function(t){this._httpUrl=t}}]),t}();o._instance=new o;t("Http",o._instance);n._RF.pop()}}}));

System.register("chunks:///_virtual/weNetworkMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./weHttp.ts"],(function(e){"use strict";var t,s,i;return{setters:[function(e){t=e.createClass},function(e){s=e.cclegacy},function(e){i=e.Http}],execute:function(){s._RF.push({},"2991fUDIpdHqILuAYJgQGGA","weNetworkMgr",void 0);var r=function(){function e(){this.mid=0,this.messageList={},this.limitMessageNum=5,this.timer=null,this.token="",this.isLock=!1,this._dealHeadListener=null,this._encryptRule=["mid:","uid:","key:","data:"],this._encryptCode="zqkg",this._intervalTime=3e3,this._errorServerCode=500,this._successCode=0,this._errorRestartGameCode=[102],this._errorNetCode={},this._overTime=5e3,this._uid=0,this.lastMessage=null,this.mid=0,this.messageList={},this.timer=null}var s=e.prototype;return s.xhrPost=function(e,t,s,i,r){void 0===r&&(r=!1),this.mid+=1;var n={head:{route:e,mid:this.mid.toString(),uid:this._uid},body:t},o=new a;o.route=e,o.mid=this.mid,o.data=n,s&&(o.callback=s),o.isRepeat=r,i&&(o.failCallBack=i),this.messageList[this.mid]=o,this.startTimer(),this.isLock||this.sendMessage(this.mid)},s.checkRespone=function(e,t,s){var i=this.jsdecrypt(t),r=this.messageList[s];this.succeedResponeBody(r,i,s)},s.succeedResponeHead=function(e){this._dealHeadListener&&this._dealHeadListener(e)},s.succeedResponeBody=function(e,t,s){this.isLock=!1,this.clearTimer(),this.deleteMessageListItem(s,!1),this.checkNextMessage(),e&&e.callback&&e.callback(t)},s.checkErrorCode=function(e,t){e!==this._errorServerCode&&this.deleteMessageListItem(t,!0);for(var s=0;s<this._errorRestartGameCode.length;s++){e===this._errorRestartGameCode[s]&&this.restartGame()}var i=this.getErrorCodeMeaning(e);console.error("----\x3e 返回错误, code:",e,i)},s.checkNextMessage=function(){for(var e in this.messageList){var t=this.messageList[e];0===t.sendNum&&this.sendMessage(t.mid)}},s.deleteMessageListItem=function(e,t){this.messageList&&this.messageList[e]&&(this.messageList[e].failCallBack&&t&&this.messageList[e].failCallBack(),delete this.messageList[e])},s.jsdecrypt=function(e){var t=null;if("string"==typeof e)try{t=JSON.parse(e)}catch(e){}return t},s.sendMessage=function(e,t){if(void 0===t&&(t=!0),0!==Object.keys(this.messageList).length){var s=this.messageList[e];if(t&&s.sendNum>=this.limitMessageNum||!t&&s.errorNum>=this.limitMessageNum)return console.error(s.data.head.route,"message send too much times"),void this.deleteMessageListItem(e,!1);s.sendNum+=1;var r=s.data,a=r.head.route;r.head.token=this.token,this.lastMessage=s,i.post(a,r.body,e)}},s.getErrorCodeMeaning=function(e){var t=this._errorNetCode[e],s=t;return t||(s="服务器错误码： "+e),s},s.restartGame=function(){},s.startTimer=function(){this.timer||(this.timer=setInterval(this.checkPackage.bind(this),this._intervalTime))},s.checkPackage=function(){if(0!==Object.keys(this.messageList).length)for(var e in this.messageList){var t=this.messageList[e];if(Date.now()-t.time>this._overTime&&t.isRepeat){var s=t.mid;this.sendMessage(s);break}this.deleteMessageListItem(t.mid,!1)}else this.clearTimer()},s.clearTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=0)},s.onHttpError=function(e,t,s){var i=this;s?console.error("----\x3e onHttpError",s,t):console.error("----\x3e onHttpError",t);var r=this.messageList[e];r&&(r.isRepeat?setTimeout((function(){r.errorNum++,i.sendMessage(e,!1)}),3e3):this.deleteMessageListItem(e,!0))},t(e,[{key:"errorNetCode",set:function(e){this._errorNetCode=e}},{key:"encryptCode",set:function(e){this._encryptCode=e}},{key:"errorRestartGameCode",set:function(e){this._errorRestartGameCode=e}},{key:"successCode",set:function(e){this._successCode=e}},{key:"errorServerCode",set:function(e){this._errorServerCode=e}},{key:"encryptRule",set:function(e){this._encryptRule=e}},{key:"intervalTime",set:function(e){this._intervalTime=e}},{key:"overTime",set:function(e){this._overTime=e}},{key:"dealHeadListener",set:function(e){this._dealHeadListener=e}},{key:"uid",set:function(e){this._uid=e}}]),e}();r._instance=new r;e("NetworkMgr",r._instance);var a=e("default",(function(e){for(var t in this.route="",this.lock=!1,this.mid=0,this.data=null,this.callback=null,this.failCallBack=null,this.time=0,this.sendNum=0,this.errorNum=0,this.isRepeat=!1,this.time=Date.now(),e){this[t]=e[t]}}));s._RF.pop()}}}));

System.register("chunks:///_virtual/wmsocket.ts",["cc","./env","./tyqSDK.ts","./conf.ts","./ServerCtr.ts"],(function(t){"use strict";var n,s,e,i,c,o,r,a;return{setters:[function(t){n=t.cclegacy,s=t._decorator,e=t.director},function(t){i=t.NATIVE},function(t){c=t.tyqSDK},function(t){o=t.GNetCmd,r=t.GLoginState},function(t){a=t.default}],execute:function(){var h,u;n._RF.push({},"9880dNyHD1CKppdHqsFlPoY","wmsocket",void 0);var f=s.ccclass;s.property,t("WmSocket",f("WmSocket")(((u=function(){function t(){this.eventHandlers=[],this.lastHeartbeatTime=0,this.isWsConnect=!1,this.ws=null,this.wxws=null,this.msgBuff={},this.isFirst=!0,this.addListener()}t.getInstance=function(){return this._instance||(this._instance=new t),this._instance};var n=t.prototype;return n.addListener=function(){e.on("ws_reconnect",this.onReconnect,this),e.on("ws_close",this.onClose,this),e.on(o.StickPack,this.respStickPack,this)},n.respStickPack=function(t){0==t.isEnd?this.sendStickPack(t.stick_id,t.idx+1):delete this.msgBuff[t.stick_id]},n.getGuid=function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var s=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==n?s:3&s|8).toString(16)}))},n.getTotalLen=function(t){for(var n=0,s=0;s<t.length;s++)n+=t[s].length;return n},n.sendStickPack=function(n,s){var e={cmd:o.StickPack,stick_id:n,stick_len:this.getTotalLen(this.msgBuff[n]),stick_val:this.msgBuff[n][s],isEnd:s==this.msgBuff[n].length-1,isStart:0==s,idx:s};t.getInstance().sendSP(JSON.stringify(e))},n.onReconnect=function(){this.isFirst?(this.isFirst=!1,this.connect(),console.log("发起第一次连-------")):this.isConnected()||(this.connect(),console.log("发起重连-------"))},n.onClose=function(){this.isConnected()&&(t.getInstance().isWsConnect?this.wxws.close():this.ws.close())},n.connect=function(){this.ws_connect()},n.ws_connect=function(){var t=this;console.log("ws_connect...........................");try{i||(this.ws=new WebSocket(c.getUrl().wsUrl))}catch(t){console.error("网络连接异常 --- exception---------------- ",t)}this.ws.onopen=function(n){t.isWsConnect=!0,console.log("Send Text WS was opened."),a.GetInstance().wxLoginBegin()},this.ws.onmessage=function(n){t.onMessage(n.data)},this.ws.onerror=function(t){console.error("Send Text fired an error",t),a.GetInstance().loginState=r.loginWithoutAccount},this.ws.onclose=function(n){t.isWsConnect=!1,console.log("WebSocket instance closed."),a.GetInstance().loginState=r.loginWithoutAccount}},n.onMessage=function(t){var n=JSON.parse(t);e.emit(n.cmd+"",n)},n.isConnected=function(){return this.isWsConnect},n.sendSP=function(t){this.isConnected()&&this.ws.send(t)},n.send=function(t){if(this.isConnected()){var n=JSON.stringify(t.data),s=21917.2;if(n.length>s){var e=n,i=[],c=n.length/s+1,o=0;for(e.length;o<c;o++){var r=e.slice(s*o,s*(o+1));i.push(r)}var a=this.getGuid();return this.msgBuff[a]=i,void this.sendStickPack(a,0)}this.ws.send(n)}},t}())._instance=void 0,h=u))||h);n._RF.pop()}}}));

System.register("chunks:///_virtual/WXCustomAd.ts",["cc","./tyqSDK.ts"],(function(t){"use strict";var i,n;return{setters:[function(t){i=t.cclegacy},function(t){n=t.tyqSDK}],execute:function(){var s;t("EType",void 0),i._RF.push({},"66f499zhQ5ApIF9FuOwpPWZ","WXCustomAd",void 0),function(t){t[t.rect=1]="rect",t[t.horizontal=2]="horizontal",t[t.vertical=3]="vertical",t[t.grid=4]="grid"}(s||(s=t("EType",{})));var o=t("WXCustomAd",function(){function t(){this.cb=void 0}return t.setadunit=function(t,i,n,s){this._customc_rect_adunit=t,this._customc_h_adunit=i,this._customc_v_adunit=n,this._customc_one_adunit=s},t.createCustomAd=function(t,i,s,o,e,h){var c=this;if(window.wx){this.sysInfo||(this.sysInfo=wx.getSystemInfoSync());var u=this.sysInfo.SDKVersion,d=null,r="",a=this;if(h&&(this.cb=h),1==i?r=this._customc_rect_adunit[this.rand(0,this._customc_rect_adunit.length-1)]:2==i?r=this._customc_h_adunit[this.rand(0,this._customc_h_adunit.length-1)]:3==i?r=this._customc_v_adunit[this.rand(0,this._customc_v_adunit.length-1)]:4==i&&(r=this._customc_one_adunit[this.rand(0,this._customc_one_adunit.length-1)]),e&&""!==e&&("string"==typeof e?r=e:e instanceof Array&&(r=e[this.rand(0,e.length-1)])),""!=r)if(n.log("显示原生模板广告",t,this._ads,this._waits),this._ads[t])d=this._ads[t],n.log("缓存有"),d.isShow()||d.show();else if(this.compareVersion(u,"2.11.1")>=0){n.log("创建原生模板广告"+t,"id:"+r,"pos:",s);var _=a.getPos(o,s);(d=wx.createCustomAd({adUnitId:r,adIntervals:30,style:{top:_.top,left:_.left,width:o.width,fixed:!1}})).onLoad((function(){a._ads[t]=d;var i=a._waits.indexOf(t);n.log("原生模板广告加载完成："+t,a._waits,i),-1==i?d.show():(a._waits=a._waits.filter((function(i){return i!=t})),d.hide().then((function(){})).catch((function(){n.log("第二次hide"),d.hide().catch((function(){n.log("第三次hide")}))})))})),d.onError((function(t){n.log("原生模板广告加载失败:",t.errCode," ",t.errMsg),1004===parseInt(t.errCode)&&c.cb&&(n.log("拉取失败"),c.cb())})),d.onClose((function(){n.log("原生模板广告关闭")}))}}},t.rand=function(t,i){return t+Math.floor(Math.random()*(i-t+1))},t.hideCustomAd=function(t){var i=null;n.log("隐藏原生模板广告",t,this._ads,this._waits),this._ads[t]?(i=this._ads[t]).isShow()&&i.hide().then((function(){})).catch((function(){n.log("第二次hide"),i.hide().catch((function(){n.log("第三次hide")}))})):-1==this._waits.indexOf(t)&&this._waits.push(t)},t.destroyCustomAd=function(t){this._ads[t]&&(this._ads[t].destroy(),this._ads[t]=null)},t.compareVersion=function(t,i){t=t.split("."),i=i.split(".");for(var n=Math.max(t.length,i.length);t.length<n;)t.push("0");for(;i.length<n;)i.push("0");for(var s=0;s<n;s++){var o=parseInt(t[s]),e=parseInt(i[s]);if(o>e)return 1;if(o<e)return-1}return 0},t.getPos=function(t,i){this.sysInfo||(this.sysInfo=wx.getSystemInfoSync());var n=this.sysInfo,s=t.width,o=t.height,e=n.windowWidth/cc.winSize.width,h=n.windowHeight/cc.winSize.height,c=(n.windowWidth-s)/2,u=(n.windowHeight-o)/2;return i&&null!=i.left&&(c=i.left*e),i&&null!=i.top&&(u=i.top*h),i&&null!=i.right&&(c=n.windowWidth-s-i.right*e),i&&null!=i.bottom&&(u=n.windowHeight-o-i.bottom*h),i&&null!=i.centerX&&(c=(n.windowWidth-s)/2+i.centerX*e),i&&null!=i.centerY&&(u=(n.windowHeight-o)/2+i.centerY*h),{left:c,top:u}},t.hideAllAd=function(){for(var t in this._ads)this.hideCustomAd(t)},t}());o._customc_rect_adunit=[],o._customc_h_adunit=[],o._customc_v_adunit=[],o._customc_one_adunit=[],o._ads={},o._waits=[],o.sysInfo=null,o.cb=void 0,i._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=index.js.map